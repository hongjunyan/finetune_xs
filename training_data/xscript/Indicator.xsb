<Scripts Version="3" AppID="DAQ" UserID="JUSTB-1008" Lang="TW" StatusMask="2">
<Script Type="2" Name="摩台近月未平倉" ID="422a575a9d124682a605a66762f0bbe9" ReturnType="0" ExecType="1" Folder="/期權指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[value1 = getsymbolfield("STW*1.SG","未平倉");
plot1(value1,"摩台近月未平倉");
]]></Code>
<Arg><![CDATA[<Arg seed="8a809182-d908-476b-80c5-dc22bffe6a4e" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="f6b7645d-983f-46f2-a0a0-963d477244d6" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="摩台近月未平倉" number="1" type="0" color="5275903" color2="0" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<Extra><![CDATA[<Extra>
<TotalBar val="0" />
<Maxbb val="0" />
<ScriptComplexity val="6" />
<script>
<freq support="8;11" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{&quot;STW*1.SG&quot;:{&quot;0&quot;:[10]}}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="法人買進比例" ID="ab0cc0d7c04042da90ff62c75929c4a8" ReturnType="0" ExecType="1" Folder="/籌碼指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[{
指標說明
收錄於「三週學會程式交易：打造你的第一筆自動化交易」 326頁
https://www.ipci.com.tw/books_in.php?book_id=724
}

input:length1(5,"短天期均線天期");
input:length2(20,"長天期均線天期");

if barfreq = "Tick" or barfreq = "Min"
	then raiseruntimeerror("不支援此頻率");
	
value1=GetField("法人買張");
if volume<>0 then value2=value1/volume*100;
//法人買張佔成交量比例
value3 = Average(value2,length1);
value4 = Average(value2,length2);
plot1(value3,"短期均線");
plot2(value4,"長期均線");


]]></Code>
<Arg><![CDATA[<Arg seed="6b79f0fc-0bf5-4e2f-9e86-1beb2ba84242" version="1"><Param name="短天期均線天期" varname="length1" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="長天期均線天期" varname="length2" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="f97a903a-a469-41e8-b56a-c315aeefb5eb" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="短期均線" number="1" type="0" color="5275903" color2="5275903" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /><Plot name="長期均線" number="2" type="0" color="255" color2="255" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="8" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{&quot;0&quot;:[48]},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="empirical mode decomposition" ID="6aabd414dde8489cac9ff0c28dc6d939" ReturnType="0" ExecType="3" Folder="/技術指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:
	period(20),
	delta(0.1),
	fraction(0.1);
	
variable: 
	price(0),gamma(0),alpha(0),beta(0),BP(0),
	mean(0),peak(0),valley(0),avgpeak(0),avgvalley(0);

price=(h+l)/2;

beta=cosine(360/period);
gamma=1/cosine(720*delta/period);
alpha=gamma-squareroot(gamma*gamma-1);
BP=0.5*(1-alpha)*(price-price[2])+beta*(1+alpha)*BP[1]-alpha*BP[2];
mean=average(bp,2*period);
peak=peak[1];
valley=valley[1];

if bp[1]>bp and bp[1]>bp[2] then peak=bp[1];
if bp[1]<bp and bp[1]<bp[2] then valley=bp[1];
avgpeak=average(peak,50);
avgvalley=average(valley,50);

plot1(mean);
plot2(fraction*avgpeak);
plot3(fraction*avgvalley);
]]></Code>
<Arg><![CDATA[<Arg seed="ef9ec768-062c-4dc3-b7b2-d2158a0a1c65" version="1"><Param name="period" varname="period" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="delta" varname="delta" type="1" subtype="0" value="0.1" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="fraction" varname="fraction" type="1" subtype="0" value="0.1" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="3531cfbc-9e3c-4ab7-bdde-adf3de1f537c" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="plot1" number="1" type="0" color="5275903" color2="5275903" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /><Plot name="plot2" number="2" type="0" color="255" color2="255" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /><Plot name="plot3" number="3" type="0" color="65280" color2="65280" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="4" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="成交量擺盪指標" ID="b6644f0602fb431cbd6550a69c86df81" ReturnType="0" ExecType="3" Folder="/量能指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[Input: length1(5);	setinputname(1, "短天期");
Input: length2(20);	setinputname(2, "長天期");

Value1 = Average(Volume, length1);
Value2 = Average(Volume, length2);

if value1 = 0 then value3 = 0 else Value3 = (Value1 - Value2) * 100 / Value1;

Plot1(Value3, "OSCV");
]]></Code>
<Arg><![CDATA[<Arg seed="995343b5-d7fc-4220-8bc3-4aa5bed545fa" version="1"><Param name="短天期" varname="length1" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="長天期" varname="length2" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="af94798a-67f0-4a5f-9157-fbb98c356a4a" version="1"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="OSCV" number="1" type="1" color="5275903" color2="0" style="0" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="50" />
<Maxbb val="20" />
<ScriptComplexity val="3" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="ASI(Accumulation Swing Index)振動升降指標" ID="69c9a7b3d7dc4f26baf3e945bcedef4a" ReturnType="0" ExecType="3" Folder="/技術指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:length(10,"si的累計長度");

variable:si(0),asi(0);

value1=high-low;
value2=low-close[1];
value3=high-low[1];
value4=close[1]-open[1];

value5=absvalue(close-close[1]);
value6=absvalue(close-open);
value7=absvalue(close[1]-open[1]);

value8=(value5+0.5*value6+value7);

switch(maxlist(value1,value2,value3)) begin
	case value1:
		value9=value1+0.5*value2+0.25*value4;
	case value2:
		value9=value2+0.5*value1+0.25*value4;
	case value3:
		value9=value3+0.25*value4;
end;

value10=maxlist(value1,value2);
if value9*value10<>0 then 
	si=50*value8/value9*value10/3
else 
	si=si[1];
asi+=si;

plot1(asi,"ASI");]]></Code>
<Arg><![CDATA[<Arg seed="48f892a7-68fe-48fe-99eb-fbb012bbaa91" version="1"><Param name="si的累計長度" varname="length" type="1" subtype="0" value="10" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="8d37bfbd-e270-45c0-9bd7-e6088b276217" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="ASI" number="1" type="0" color="5275903" color2="5275903" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="1" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="力度指標force index" ID="d2ed855b363b4e869be7391531684d8b" ReturnType="0" ExecType="1" Folder="/技術指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[{
指標說明
https://xstrader.net/這個盤接下來到底會不會大跌-建構專屬的大盤儀/
}

input:
	length(10,"短天期"),
	length1(30,"長天期");
	
variable:fis(0),fil(0);
fis=average(volume*(close-close[1]),length);
fil=average(volume*(close-close[1]),length1);

plot1(fis,"短期力度");
plot2(fil,"長期力度");
plot3(fis-fil,"長短力度差");]]></Code>
<Arg><![CDATA[<Arg seed="c28ecb17-3cde-4e98-8020-500ce17803cc" version="1"><Param name="短天期" varname="length" type="1" subtype="0" value="10" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="長天期" varname="length1" type="1" subtype="0" value="30" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="c807114b-a472-412f-a9d2-e652dc7ee3f4" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="短期力度" number="1" type="0" color="5275903" color2="5275903" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /><Plot name="長期力度" number="2" type="0" color="65535" color2="255" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /><Plot name="長短力度差" number="3" type="1" color="255" color2="62464" style="3" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="3" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="adaptive price zone" ID="9d1e6cf020b64922a2848f903f7424b2" ReturnType="0" ExecType="3" Folder="/技術指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[{
指標說明
https://xstrader.net/adaptive-price-zone/
}

input: 
	Length(14,"期數"), 
	BandPct(2.0,"通道寬度");

variable: DSEMA(0), UpBand(0), DownBand(0), RangeEMA(0), period(0), var0(0);

period = squareroot(Length);
DSEMA = xaverage(xaverage(close, period), period);
RangeEMA = xaverage(xaverage(high-low, period), period);
UpBand = DSEMA + BandPct*RangeEMA;
DownBand = DSEMA - BandPct*RangeEMA;

Plot1(UpBand, "Upperband");
Plot2(close, "Close");
Plot3(DownBand, "BottomBand");
]]></Code>
<Arg><![CDATA[<Arg seed="8c073f9b-10ae-417b-b843-ac19ae657091" version="1"><Param name="期數" varname="Length" type="1" subtype="0" value="14" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="通道寬度" varname="BandPct" type="1" subtype="0" value="2" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="81410c94-629c-4b62-839f-33d08d335788" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="Upperband" number="1" type="0" color="5275903" color2="5275903" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /><Plot name="Close" number="2" type="0" color="255" color2="255" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /><Plot name="BottomBand" number="3" type="0" color="65280" color2="65280" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,d02c45cba76f4163a048685f7bc4002b</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="5" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="大戶買賣力" ID="f411c378ca89487fbb98bd54a1a6d95a" ReturnType="0" ExecType="1" Folder="/即時籌碼/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[{"大戶=特大單+大單，資料為開盤迄今的累計張數"
支援商品：台(股票)}

if barfreq <> "Min" and barfreq <> "D" and barfreq <> "AD" then 
	raiseruntimeerror("僅支援分鐘與日頻率（含還原）");
	
value91 = GetField("賣出特大單量");//僅提供給有權限的用戶使用

value1 = GetField("賣出特大單量","D") + GetField("賣出大單量","D");
value2 = GetField("買進特大單量","D") + GetField("買進大單量","D");
value3 = value2 - value1;
plot1(value3,"大戶買賣力");
plot2(value2,"大戶外盤量",checkbox:=0);
plot3(value1,"大戶內盤量",checkbox:=0);]]></Code>
<Arg><![CDATA[<Arg seed="71173f6f-6ffc-4bb2-a423-3e77e62281d9" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="37cbcf1c-5a46-4dcd-ad3d-88da3405019d" version="1"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="1" min="-100" max="100" /></Axises><Plot name="大戶買賣力" number="1" type="1" color="255" color2="65280" style="3" weight="0" axis="1" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="," offset="0" /><Plot name="大戶外盤量" number="2" type="0" color="16711935" color2="255" style="5" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="0" SetDecimalFormat="0" SetNumFormat="0" colors="," offset="0" /><Plot name="大戶內盤量" number="3" type="0" color="15446382" color2="65280" style="5" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="0" SetDecimalFormat="0" SetNumFormat="0" colors="," offset="0" /></Plots>]]></Plots>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="26" />
<script>
<freq support="8;11" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{&quot;0&quot;:[334],&quot;8&quot;:[334,340,331,337]},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="法人持股比例" ID="df654f81c9564f8cb639fddca5dc4470" ReturnType="0" ExecType="1" Folder="/籌碼高手/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[condition999 = symbolexchange = "TW" or symbolexchange = "TE";//台股+興櫃
condition998 = condition999 = true and symboltype = 2;//個股+興櫃

if condition998 = false //個股+興櫃
	then raiseruntimeerror("不支援此商品");


if barfreq = "Tick" or barfreq = "Min"
	then raiseruntimeerror("不支援此頻率");
	
plot1(0.01*GetField("法人持股比例"),"法人持股比例",axis:=1,ScaleLabel:=slpercent,ScaleDecimal:=sd2);]]></Code>
<Arg><![CDATA[<Arg seed="3ba34b3c-741c-4336-ba3f-a87bfa7f93b1" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="f92ff193-4169-4049-9f45-8e67980a1648" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="法人持股比例" number="1" type="0" color="5275903" color2="5275903" style="0" weight="0" axis="0" DecimalFormat="3" NumFormat="2" checkbox="-1" SetDecimalFormat="1" SetNumFormat="1" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="6" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{&quot;0&quot;:[182]},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="價量斜率指標" ID="caba420d30db47ea8528fca19f766475" ReturnType="0" ExecType="1" Folder="/技術指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[value1=average(close,5);
value2=average(volume,5);
value3=linearregslope(value1,5);
value4=linearregslope(value2,5);
value5=value4-value3;

plot1(value3,"價斜率");
plot2(value4,"量斜率");
plot3(value5,"斜率差");]]></Code>
<Arg><![CDATA[<Arg seed="68d7cbbf-5511-4bcf-a80b-40dc98ce5355" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="cacf4add-91e4-46bf-be6d-74ef8f8d513d" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="價斜率" number="1" type="0" color="5275903" color2="5275903" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /><Plot name="量斜率" number="2" type="0" color="255" color2="255" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /><Plot name="斜率差" number="3" type="0" color="65280" color2="65280" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c;1,8c2d025a23c548d3a76fba10c22527b4;1,210d0786cfe340538e34c095bc2ba049;1,626e6e5c42304bbea9809d1a07ae4e01</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="5" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="CMO(錢德動量擺盪指標)" ID="56f5a51282bc4e8fabda8877b365b33c" ReturnType="0" ExecType="3" Folder="/技術指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[Input:length(10);   setinputname(1, "天期");

variable: SU(0),SD(0);   

if close >= close[1] then   
  SU = CLOSE - CLOSE[1]   
else   
  SU = 0;   

if close < close[1] then   
  SD = CLOSE[1] - CLOSE   
else   
  SD = 0;    

value1 = summation(SU,length);   
value2 = summation(SD,length);   
if value1+value2 <> 0 then value3 = (value1-value2)/(value1+value2)*100;
plot1(value3, "CMO");
  ]]></Code>
<Arg><![CDATA[<Arg seed="b4fd1b9e-8e8b-405b-bcc9-b29d22aa9620" version="1"><Param name="天期" varname="length" type="1" subtype="0" value="10" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="e35fb996-c44d-473c-8609-8ed6bafad1f6" version="1"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="CMO" number="1" type="0" color="5275903" color2="0" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="50" />
<Maxbb val="20" />
<ScriptComplexity val="3" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="VAOsc(成交量累積散佈擺盪指標)" ID="bc4d67fdb05d489da908cdc04e26ccca" ReturnType="0" ExecType="2" Folder="/XQ量能指標/" StatusMask="2">
<Desc><![CDATA[畫出數量累積散佈擺盪指標]]></Desc>
<Code><![CDATA[// XQ: VA-Osc指標
//
variable: support(0), resist(0), hlDiff(0), netSupportResist(0);
 
support = (Close - Low);
resist = (High - Close);
hlDiff = (High - Low);

if hlDiff = 0 then
	netSupportResist = 0
else
	netSupportResist = (support - resist) / hlDiff;
	
Plot1(netSupportResist * Volume, "VA-Osc");
		]]></Code>
<Arg><![CDATA[<Arg seed="f76bf52e-8a67-4825-9573-4632c4a31ec1" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="2fff61e9-e4ab-4eff-84e4-d2e1807830da" version="1"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="VA-Osc" number="1" type="0" color="5275903" color2="0" style="0" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<Extra><![CDATA[<Extra>
<TotalBar val="50" />
<Maxbb val="0" />
<ScriptComplexity val="1" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="線性迴歸斜率" ID="8f3d45e943cc49fbac9ed21d20320ddf" ReturnType="0" ExecType="1" Folder="/技術指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[{
指標說明
https://xstrader.net/尋找目前趨勢還向上的股票/
}

input:Length(20,"計算期間");

variable: _Output(0);

LinearReg(close, Length, 0, value1, value2, value3, value4);
{value1:斜率,value4:預期值}

plot1(value1,"線性迴歸斜率");
        ]]></Code>
<Arg><![CDATA[<Arg seed="a5d6c871-5a25-43cc-9013-6a11ada162b4" version="1"><Param name="計算期間" varname="Length" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="c2532dff-f5b9-4fee-8b1a-9c4b17788be1" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="線性迴歸斜率" number="1" type="1" color="16711833" color2="5275903" style="0" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,8c2d025a23c548d3a76fba10c22527b4;1,210d0786cfe340538e34c095bc2ba049</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="2" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="台灣50創新高家數" ID="1fea465cc4d244599f80c82dce912b70" ReturnType="0" ExecType="1" Folder="/市場動能/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[{統計台灣50成分股，最高價創近20期新高的家數。}

if barfreq <> "Min" then raiseruntimeerror("僅支援「分鐘」頻率");

value1 = GetSymbolField("TSE50.SJ","TW50創新高家數");

plot1(value1,"台灣50創新高家數");]]></Code>
<Arg><![CDATA[<Arg seed="76f5a2cf-e3a7-4710-bac6-71b4836d40f0" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="5fc84a9f-6a8d-4ec9-9039-cee8e6e86da1" version="1">
	<Axises>
		<Axis value="1" align="2" min="0.000000" max="50.000000" SetMin="1" SetMax="1" mpvalue="0.000000" />
		<Axis value="2" align="0" min="-100.000000" max="100.000000" SetMin="1" SetMax="1" mpvalue="0.000000" />
	</Axises>
	<Plot name="台灣50創新高家數" number="1" type="1" color="255" color2="5275903" DecimalFormat="1" checkbox="-1" colors="," offset="0" />

</Plots>]]></Plots>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="6" />
<script>
<freq support="8;11" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{&quot;TSE50.SJ&quot;:{&quot;0&quot;:[882]}}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="外資持股比例" ID="fa8689b5fe244273a4c6e91b95fdc3b7" ReturnType="0" ExecType="1" Folder="/籌碼高手/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[condition999 = symbolexchange = "TW" or symbolexchange = "TE";//台股+興櫃
condition998 = condition999 = true and symboltype = 2;//個股+興櫃

if condition998 = false //個股+興櫃
	then raiseruntimeerror("不支援此商品");



if barfreq = "Tick" or barfreq = "Min"
	then raiseruntimeerror("不支援此頻率");
	
plot1(0.01*GetField("外資持股比例"),"外資持股比例",axis:=1,ScaleLabel:=slpercent,ScaleDecimal:=sd2);]]></Code>
<Arg><![CDATA[<Arg seed="98cb88f5-c635-4731-80b7-31c816f91f81" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="c224b4c5-9c71-49ca-b329-28cff9b2c801" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="外資持股比例" number="1" type="0" color="5275903" color2="5275903" style="0" weight="0" axis="0" DecimalFormat="3" NumFormat="2" checkbox="-1" SetDecimalFormat="1" SetNumFormat="1" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="6" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{&quot;0&quot;:[31]},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="RC(價格變動率指標)" ID="84cb11e61d2f4f618afb36bd40af80d5" ReturnType="0" ExecType="3" Folder="/XQ技術指標/" StatusMask="2">
<Desc><![CDATA[畫出價格變動率指標]]></Desc>
<Code><![CDATA[// XQ: RC指標
//
input: Length(12), EMALength(12);

SetInputName(1, "天數");
SetInputName(2, "平滑天數");

value1 = (Close - Close[Length]) / Close[Length];
value2 = XAverage(value1, EMALength);

Plot1(value1, "RC");
Plot2(value2, "ERC");
        
		]]></Code>
<Arg><![CDATA[<Arg seed="3e1ca6a2-1a90-47bb-8344-69d77243c88d" version="1"><Param name="天數" varname="Length" type="1" subtype="0" value="12" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="平滑天數" varname="EMALength" type="1" subtype="0" value="12" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="65181a76-3f98-4cc2-8f46-69ce71e68dc6" version="1"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="RC" number="1" type="0" color="5275903" color2="0" style="0" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /><Plot name="ERC" number="2" type="0" color="255" color2="0" style="0" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,d02c45cba76f4163a048685f7bc4002b</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="100" />
<Maxbb val="12" />
<ScriptComplexity val="2" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="台股指數近月投信未平倉" ID="8f3c460901294a8791f68d7f49addfb0" ReturnType="0" ExecType="1" Folder="/期權指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[value1 = getsymbolfield("FITX*1.TF","投信買方未平倉口數");
value2 = getsymbolfield("FITX*1.TF","投信賣方未平倉口數");
value3 = value1 - value2;
plot1(value1,"投信未平倉買口");
plot2(value2,"投信未平倉賣口");
plot3(value3,"投信未平倉淨口");

]]></Code>
<Arg><![CDATA[<Arg seed="a0ef6c44-758c-47b2-a6f7-eaf91290e64b" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="5f2c3454-7d72-47f1-964c-54690ba331e7" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="投信未平倉買口" number="1" type="0" color="5275903" color2="0" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /><Plot name="投信未平倉賣口" number="2" type="0" color="6750207" color2="0" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /><Plot name="投信未平倉淨口" number="3" type="1" color="13311" color2="0" style="0" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<Extra><![CDATA[<Extra>
<TotalBar val="0" />
<Maxbb val="0" />
<ScriptComplexity val="11" />
<script>
<freq support="8;11" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{&quot;FITX*1.TF&quot;:{&quot;0&quot;:[144,145]}}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="OBV(能量潮指標)" ID="00461cc948de4f4bbbc7a1bdc8d53e14" ReturnType="0" ExecType="3" Folder="/XQ量能指標/" StatusMask="2">
<Desc><![CDATA[畫出能量潮指標]]></Desc>
<Code><![CDATA[// XQ: OBV指標
//
input:SMAlength(5,"OBV的短MA期數"), MMAlength(20,"OBV的中MA期數");
variable: obvolume(0), obvSMA(0), obvSMA_Str(""), obvMMA(0), obvMMA_Str("");

if CurrentBar = 1 then
	obvolume = 0
else
  begin	
	if close > close[1] then
		obvolume = obvolume[1] + volume
	else
	  begin
		if close < close[1] then
			obvolume = obvolume[1] - volume
		else
			obvolume = obvolume[1];
	  end;		
  end;

obvSMA = average(obvolume,SMAlength);
obvMMA = average(obvolume,MMAlength);

obvSMA_Str = text(numToStr(SMAlength,0),"MA");
obvMMA_Str = text(numToStr(MMAlength,0),"MA");
  
Plot1(obvolume,"OBV");
plot2(obvSMA,"SMA",checkbox:=1);
plot3(obvMMA,"MMA",checkbox:=1);
setplotLabel(2,obvSMA_Str);
setplotLabel(3,obvMMA_Str);
		]]></Code>
<Arg><![CDATA[<Arg seed="bb146011-5c84-4d66-9a2b-29f6968a618e" version="1"><Param name="OBV的短MA期數" varname="SMAlength" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="OBV的中MA期數" varname="MMAlength" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="9c46a3e9-c1b8-4cbd-82dc-6ac504b19fa1" version="1"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="OBV" number="1" type="1" color="5275903" color2="0" style="0" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="," offset="0" /><Plot name="SMA" number="2" type="0" color="65535" color2="255" style="0" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="1" SetDecimalFormat="0" SetNumFormat="0" colors="," offset="0" /><Plot name="MMA" number="3" type="0" color="65280" color2="65280" style="0" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="3" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="VVA指標" ID="9a7ff8e3e8b6400fb487805e2b9e9704" ReturnType="0" ExecType="3" Folder="/XQ量能指標/" StatusMask="2">
<Desc><![CDATA[畫出VVA指標]]></Desc>
<Code><![CDATA[// XQ: VVA指標
//
variable: _vva(0);

if High <> Low then
	Value1 = (Close - Open)/(High - Low) * Volume
else
	Value1 = 0;

If CurrentBar = 1 then
	_vva = Value1
else	
	_vva = Value1 + _vva[1];

Plot1(_vva, "VVA");
		]]></Code>
<Arg><![CDATA[<Arg seed="89d00998-9a5d-44be-84aa-3452f2f6c8da" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="6ef9d0f9-8e4f-4a18-ab6e-507faa86de7b" version="1"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="VVA" number="1" type="0" color="5275903" color2="0" style="0" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<Extra><![CDATA[<Extra>
<TotalBar val="100" />
<Maxbb val="0" />
<ScriptComplexity val="1" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="Zero Lag Heikin-Ashi" ID="1027587e4bd2407e84a3459161048d47" ReturnType="0" ExecType="3" Folder="/技術指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[{
指標說明
https://xstrader.net/先進指標zero-lag-heikinashi/
}

input: Length(14,"期數");

variable: 
		price(0), haO(0), haC(0), haMax(0), haMin(0), 
		TEMA1(0), EMAValue1(0), DbEMAValue1(0), 
		TEMA2(0), EMAValue2(0), DbEMAValue2(0), ZeroLagHA(0);
 
price = (close+open+high+low)/4;
haO = (haO[1]+price)/2;
haMax = maxlist(high, haO);
haMin = minlist(low, haO);
 
haC = (price+haO+haMax+haMin)/4;
 
EMAValue1 = xaverage(haC, Length);
DbEMAValue1 = xaverage(EMAValue1, Length);
TEMA1 = 3*EMAValue1-3*DbEMAValue1+xaverage(DbEMAValue1, Length);
EMAValue2 = xaverage(TEMA1, Length);
DbEMAValue2 = xaverage(EMAValue2, Length);
TEMA2 = 3*EMAValue2-3*DbEMAValue2+xaverage(DbEMAValue2, Length);
 
ZeroLagHA = 2*TEMA1-TEMA2;
 
plot1(ZeroLagHA, "Zero Lag HeikinAshi");
plot2(average(C,20),"Average");]]></Code>
<Arg><![CDATA[<Arg seed="15dfd1b3-09fa-4982-b8be-5f9a6c15946e" version="1"><Param name="期數" varname="Length" type="1" subtype="0" value="14" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="3ac960eb-08c6-4589-92df-762bc3558f09" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="Zero Lag HeikinAshi" number="1" type="0" color="5275903" color2="5275903" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /><Plot name="Average" number="2" type="0" color="65535" color2="255" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,d02c45cba76f4163a048685f7bc4002b;1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="8" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="MFI(資金流向指標)" ID="d6ba0ff95f9748dd8cddac27583b48b9" ReturnType="0" ExecType="3" Folder="/XQ量能指標/" StatusMask="2">
<Desc><![CDATA[畫出資金流量指標]]></Desc>
<Code><![CDATA[// XQ: MFI指標
//
Input: Length(6);
variable: tp(0), tv(0), utv(0), dtv(0), pmf(0), nmf(0), mfivalue(0);

SetInputName(1, "天數");

tp = TypicalPrice;
tv = tp * Volume;

if tp > tp[1] then
  begin
	utv = tv;
	dtv = 0;
  end
else
  begin
	utv = 0;
	dtv = tv;
  end;

pmf = Average(utv, MinList(CurrentBar, length));
nmf = Average(dtv, MinList(CurrentBar, length));


if CurrentBar < Length or (pmf + nmf) = 0 then
	mfivalue = 50
else 
	mfivalue = 100 * pmf /(pmf + nmf);

Plot1(mfivalue, "MFI");

		]]></Code>
<Arg><![CDATA[<Arg seed="0f5007dc-83aa-4f60-a133-c50f08cca0ab" version="1"><Param name="天數" varname="Length" type="1" subtype="0" value="6" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="44d781db-95c0-4f91-ac90-6d65c8f0055b" version="1"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="MFI" number="1" type="0" color="5275903" color2="0" style="0" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,949e616a0b17470eb3397b099c2dec83;1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="50" />
<Maxbb val="12" />
<ScriptComplexity val="4" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="台指選Delta" ID="bf35976c6da24e538da62305c2a720bf" ReturnType="0" ExecType="3" Folder="/期權指標/" StatusMask="2">
<Desc><![CDATA[台股指數選擇權Delta值]]></Desc>
<Code><![CDATA[input: 
	iRate100(2,"無風險利率%"),
	iVolity100(20,"波動率%"),
	iHV(false, "波動率", inputkind:=dict(["標的20日歷史波動率",true],["固定波動率",false]));

variable:vStrikePrice(0),vVolity100(0);

if instr(symbol,".TF") = 0 or leftstr(symbol,1) = "F" or instr(symbol,"TX") = 0 then 
	raiseruntimeerror("僅支援台指選擇權");



if iHV then 
	vVolity100 = HVolatility(getsymbolfield("FITX*1.TF","收盤價","D"),20)
else 
	vVolity100 = iVolity100;

vStrikePrice = getsymbolinfo("履約價");

value1 = bsdelta(leftstr(getsymbolinfo("買賣權"),1),getsymbolfield("FITX*1.TF","收盤價"),vStrikePrice,daystoexpirationtf,iRate100,0,vVolity100);

plot1(value1,"Delta");
]]></Code>
<Arg><![CDATA[<Arg seed="dfd2ded0-414d-434e-b734-98919fbfbf9a" version="1"><Param name="無風險利率%" varname="iRate100" type="1" subtype="0" value="2" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="波動率%" varname="iVolity100" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="波動率" varname="iHV" type="2" subtype="0" value="0" isSerial="0" isArray="0" isRef="0" inputkind="1" quickedit="0" keytype="3"><Pair key="標的20日歷史波動率" value="1" /><Pair key="固定波動率" value="0" /></Param></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="e312a44e-c5c8-4f60-ae4f-040d96629d9b" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="Delta" number="1" type="0" color="5275903" color2="0" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="," offset="0" /></Plots>]]></Plots>
<RefFunc>1,8c2d025a23c548d3a76fba10c22527b4;1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c;1,9c4f476d319b4f109a8dc8557099ded4;1,c1cda70a714d44999e5171fc53c95b0a;1,52ede3e3fd6241998947a34920400c95;1,2661174c578842599ba79c24c1c33cd6;1,4ccd60568ab94d4085a852218b37ba80;1,7adc0732a0b144149d70fb38c0965960;1,0999f843523c4d6eb18ccc461892eaa2;1,9726eaec317b4b98a68524683ea2ae92;1,8462f7081ead4113ba3aef780bc1040f;1,5e90542dbb364f80a285f1e2e06aa6c3</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="14" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{&quot;FITX*1.TF&quot;:{&quot;0&quot;:[8]}}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="威廉指標" ID="c4179bac726c494a9d66f1d920aae0e3" ReturnType="0" ExecType="3" Folder="/XQ技術指標/" StatusMask="2">
<Desc><![CDATA[畫出威廉指標]]></Desc>
<Code><![CDATA[// XQ: 威廉指標
//
input: Length1(14), Length2(28), Length3(42);

SetInputName(1, "天數一");
SetInputName(2, "天數二");
SetInputName(3, "天數三");

value1 = PercentR(Length1) - 100;
value2 = PercentR(Length2) - 100;
value3 = PercentR(Length3) - 100;

Plot1(value1, "威廉指標1");
Plot2(value2, "威廉指標2");
Plot3(value3, "威廉指標3");
        
		]]></Code>
<Arg><![CDATA[<Arg seed="7838c950-ac51-4166-b654-3f97940a2971" version="1"><Param name="天數一" varname="Length1" type="1" subtype="0" value="14" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="天數二" varname="Length2" type="1" subtype="0" value="28" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="天數三" varname="Length3" type="1" subtype="0" value="42" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="a8191f74-cedf-40d1-a96d-54598e742048" version="1"><Axises><Axis value="1" align="2" min="-100" max="0" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="威廉指標1" number="1" type="0" color="5275903" color2="0" style="0" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /><Plot name="威廉指標2" number="2" type="0" color="255" color2="0" style="0" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /><Plot name="威廉指標3" number="3" type="0" color="65280" color2="0" style="0" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,61c06064ad98469db9ce30287ae4a2c8;1,2bca774c6b7549c1b0b008d2a54b288e;1,f1b429ac13b2447c909302198c18ca56;1,b348a25d74c84ec4b6c1807d146a49fa</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="4" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="Elder 空頭力道指標" ID="6015f3356a054df0a37dbffff5d52e16" ReturnType="0" ExecType="3" Folder="/技術指標/" StatusMask="2">
<Desc><![CDATA[畫出艾達賣出力道指標

		]]></Desc>
<Code><![CDATA[// Elder 空頭力道指標
//
input: Length(13);

SetInputName(1, "天數");

Value1 = Low - XAverage(Close, Length);

Plot1(Value1, "空頭");

        
		]]></Code>
<Arg><![CDATA[<Arg seed="7e287ca8-c3c8-496b-b804-e1d197d3bbf1" version="1"><Param name="天數" varname="Length" type="1" subtype="0" value="13" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="3bd978a1-3665-4373-967e-8a93e20d6755" version="1"><Axises><Axis value="1" align="1" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="空頭" number="1" type="1" color="5275903" color2="0" style="0" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,d02c45cba76f4163a048685f7bc4002b</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="100" />
<Maxbb val="20" />
<ScriptComplexity val="2" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="bandpass filter" ID="98ea4de242f6463da937a01cabe11e8e" ReturnType="0" ExecType="3" Folder="/技術指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:
	period(20),
	delta(0.1);
	
variable: price(0),gamma(0),alpha(0),beta(0),BP(0);
price=(h+l)/2;

beta=cosine(360/period);
gamma=1/cosine(720*delta/period);
alpha=gamma-squareroot(gamma*gamma-1);
BP=0.5*(1-alpha)*(price-price[2])+beta*(1+alpha)*BP[1]-alpha*BP[2];

plot1(BP);
plot2(0);]]></Code>
<Arg><![CDATA[<Arg seed="2813782d-9626-41d2-b333-23cb4ad85216" version="1"><Param name="period" varname="period" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="delta" varname="delta" type="1" subtype="0" value="0.1" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="de5dc113-3107-4e22-9e6a-eb13508294dc" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="plot1" number="1" type="0" color="5275903" color2="5275903" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /><Plot name="plot2" number="2" type="0" color="255" color2="255" style="0" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="1" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="散戶賣出比例" ID="37927c18e3794c99825dcdd27e494756" ReturnType="0" ExecType="1" Folder="/籌碼指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:Period(5,"MA期數");

if barfreq = "Tick" or barfreq = "Min"
	then raiseruntimeerror("不支援此頻率");
	
value1=GetField("散戶賣張");
if volume<>0 then 
	value2=value1/volume*100;
value3=average(value2,Period);

plot1(value3,"散戶賣出比例");

]]></Code>
<Arg><![CDATA[<Arg seed="95107637-f8ed-4af5-b4cd-ea1b92af5973" version="1"><Param name="MA期數" varname="Period" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="13d45605-ddf2-430a-9c5a-adbdc5fb2255" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="散戶賣出比例" number="1" type="0" color="5275903" color2="5275903" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="7" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{&quot;0&quot;:[57]},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="demand index" ID="c6b2a940f65b4a338fea8f8a0518bfc0" ReturnType="0" ExecType="3" Folder="/技術指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[{ 
James Sibbet's Demand Index Indicator 
The Demand Index combines price and volume in 
such a way that it is often a leading indicator of 
price change. 
} 

input: Length (10,"期數"); 

variable : 
	WtCRatio(1), VolRatio(1), VolAvg(Volume), 
	bu(1), sel(1), Sign1(+1), 
	WghtClose(Close), AvgTR(High - Low), 
	Constant(1), bures(1), selres(1), 
	TempDI(1), DMI(1); 

If CurrentBar = 1 then 
	VolAvg = Average(Volume, Length); 

WghtClose = (High + Low + Close + Close) * 0.25; 
AvgTR = Average (Highest (High, 2) - Lowest ( Low, 2), Length); 
VolAvg = ((VolAvg [1] * (Length - 1)) + Volume) / Length; 

If WghtClose <> 0 and WghtClose[1] <> 0 and 
	AvgTR <> 0 and VolAvg <> 0 then Begin 
	WtCRatio = (WghtClose - WghtClose[1]) / MinList(WghtClose,WghtClose[1]) ; 
	VolRatio = Volume / VolAvg; 
	Constant = ((WghtClose * 3) /AvgTR) * AbsValue (WtCRatio); 
	If Constant > 88 then Constant = 88; 
	Constant = VolRatio / ExpValue (Constant); 
	If WtCRatio > 0 then Begin 
		bu = VolRatio; 
		sel = Constant; 
	End Else Begin 
		bu = Constant; 
		sel = VolRatio; 
	End; 

	bures = ((bures [1] * (Length - 1)) + bu) / Length; 
	selres = ((selres [1] * (Length - 1)) + sel) / Length; 

	TempDI = +1; 

	If selres > bures then Begin 
		Sign1 = -1; 
		If selres <> 0 then TempDI = bures / selres; 
	End Else Begin 
		Sign1 = +1; 
		If bures <> 0 then TempDI = selres / bures; 
	End; 

	TempDI = TempDI * Sign1; 
	If TempDI < 0 then 
		DMI = -1 - TempDI 
	else 
		DMI = +1 - TempDI ; 
End;

Plot1(dmi);
]]></Code>
<Arg><![CDATA[<Arg seed="a97b7767-e9e6-491b-9ccb-e796cc816290" version="1"><Param name="期數" varname="Length" type="1" subtype="0" value="10" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="1f5883ca-e720-4960-bd82-62c64d30cd2c" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="Plot1" number="1" type="0" color="5275903" color2="5275903" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c;1,61c06064ad98469db9ce30287ae4a2c8;1,2bca774c6b7549c1b0b008d2a54b288e;1,f1b429ac13b2447c909302198c18ca56</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="5" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="反脆弱指標" ID="64a79441b41b44a4b0c3e6d318e1af8c" ReturnType="0" ExecType="1" Folder="/大盤指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[{
指標說明
https://xstrader.net/反脆弱選股法/
}

array:ValueArray[21](0);
valuearray[1]=GetSymbolField("1477.tw","總市值");
valuearray[2]=GetSymbolField("1536.tw","總市值");
valuearray[3]=GetSymbolField("1702.tw","總市值");
valuearray[4]=GetSymbolField("2231.tw","總市值");
valuearray[5]=GetSymbolField("2207.tw","總市值");
valuearray[6]=GetSymbolField("2355.tw","總市值");
valuearray[7]=GetSymbolField("2377.tw","總市值");
valuearray[8]=GetSymbolField("2379.tw","總市值");
valuearray[9]=GetSymbolField("2383.tw","總市值");
valuearray[10]=GetSymbolField("2492.tw","總市值");
valuearray[11]=GetSymbolField("2905.tw","總市值");
valuearray[12]=GetSymbolField("3023.tw","總市值");
valuearray[13]=GetSymbolField("3552.tw","總市值");
valuearray[14]=GetSymbolField("4938.tw","總市值");
valuearray[15]=GetSymbolField("4958.tw","總市值");
valuearray[16]=GetSymbolField("5347.tw","總市值");
valuearray[17]=GetSymbolField("5871.tw","總市值");
valuearray[18]=GetSymbolField("5904.tw","總市值");
valuearray[19]=GetSymbolField("8016.tw","總市值");
valuearray[20]=GetSymbolField("9910.tw","總市值");
valuearray[21]=GetSymbolField("9938.tw","總市值");
value1=array_sum(valuearray,1,21);
plot1(value1);

]]></Code>
<Arg><![CDATA[<Arg seed="78cb54e8-fbf3-4dc5-ae57-5223eb380f16" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="f378e4c6-d923-4151-a6b5-2d768b6ca1b3" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="plot1" number="1" type="0" color="5275903" color2="5275903" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="106" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{&quot;1477.TW&quot;:{&quot;0&quot;:[119]},&quot;1536.TW&quot;:{&quot;0&quot;:[119]},&quot;1702.TW&quot;:{&quot;0&quot;:[119]},&quot;2231.TW&quot;:{&quot;0&quot;:[119]},&quot;2207.TW&quot;:{&quot;0&quot;:[119]},&quot;2355.TW&quot;:{&quot;0&quot;:[119]},&quot;2377.TW&quot;:{&quot;0&quot;:[119]},&quot;2379.TW&quot;:{&quot;0&quot;:[119]},&quot;2383.TW&quot;:{&quot;0&quot;:[119]},&quot;2492.TW&quot;:{&quot;0&quot;:[119]},&quot;2905.TW&quot;:{&quot;0&quot;:[119]},&quot;3023.TW&quot;:{&quot;0&quot;:[119]},&quot;3552.TW&quot;:{&quot;0&quot;:[119]},&quot;4938.TW&quot;:{&quot;0&quot;:[119]},&quot;4958.TW&quot;:{&quot;0&quot;:[119]},&quot;5347.TW&quot;:{&quot;0&quot;:[119]},&quot;5871.TW&quot;:{&quot;0&quot;:[119]},&quot;5904.TW&quot;:{&quot;0&quot;:[119]},&quot;8016.TW&quot;:{&quot;0&quot;:[119]},&quot;9910.TW&quot;:{&quot;0&quot;:[119]},&quot;9938.TW&quot;:{&quot;0&quot;:[119]}}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="融資累計張數" ID="fa99e55c9c144937bb3d112c2504c211" ReturnType="0" ExecType="3" Folder="/籌碼指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input: Length(5); setinputname(1,"計算天數");
input:TXT("僅適用日線以上"); setinputname(2,"使用限制");

variable: _buyTotal(0), volTotal(0);

_buyTotal = summation(GetField("融資增減張數"), Length);
volTotal = summation(Volume, Length);

Plot1(_buyTotal, "累計增減");
Plot2(_buyTotal * 100 / volTotal, "比例%");

]]></Code>
<Arg><![CDATA[<Arg seed="e6551713-4921-4785-9e9e-e09ea26b9968" version="1"><Param name="計算天數" varname="Length" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="使用限制" varname="TXT" type="3" subtype="0" value="僅適用日線以上" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="be7f5a99-41f3-4dcb-bcf1-c4d49350d06d" version="1"><Axises><Axis value="1" align="1" min="-100" max="100" /><Axis value="2" align="1" min="-100" max="100" /></Axises><Plot name="累計增減" number="1" type="1" color="5275903" color2="0" style="0" weight="0" axis="1" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /><Plot name="比例%" number="2" type="0" color="255" color2="0" style="0" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="30" />
<Maxbb val="20" />
<ScriptComplexity val="8" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{&quot;0&quot;:[43]},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="大戶成本線" ID="fedc9f0a94f24279a2df562af8f28869" ReturnType="0" ExecType="3" Folder="/主圖指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[{大戶成本線有兩個線圖, 可以分開勾選, 
一個是買進成本線, 計算方式都是累計當日大單+特大單的買進金額/買進量
一個是賣出成本線, 計算方式都是累計當日大單+特大單的賣出金額/買進量
支援商品：台股}

value91 = GetField("買進特大單金額");//僅提供給有權限的用戶使用

if barfreq <> "Min" and barfreq <> "D" then 
	raiseruntimeerror("僅支援分鐘與日頻率");
	
//買進成本
value1 = GetField("買進特大單金額","D") + GetField("買進大單金額","D");
value2 = GetField("買進特大單量","D") + GetField("買進大單量","D");
if value2 <> 0 then
	value3 = value1 / (value2*1000)
else
	value3 = value3[1];

//賣出成本
value11 = GetField("賣出特大單金額","D") + GetField("賣出大單金額","D");
value21 = GetField("賣出特大單量","D") + GetField("賣出大單量","D");
if value21 <> 0 then 
	value31 = value11 / (value21*1000)
else
	value31 = value31[1];

plot1(value3,"大戶買進成本線",checkbox:=1);
plot2(value31,"大戶賣出成本線",checkbox:=1);]]></Code>
<Arg><![CDATA[<Arg seed="f63981da-226f-45fd-b93b-001eb503adc6" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="82c6f93c-05be-4b8f-b5cd-065b0dba10b4" version="1">
	<Axises>
		<Axis value="1" align="0" min="-100.000000" max="100.000000" SetMin="1" SetMax="1" mpvalue="0.000000" />
		<Axis value="2" align="0" min="-100.000000" max="100.000000" SetMin="1" SetMax="1" mpvalue="0.000000" />
	</Axises>
	<Plot name="大戶買進成本線" number="1" color="255" color2="5275903" weight="1" checkbox="1" colors="," offset="0" />

	<Plot name="大戶賣出成本線" number="2" color="65280" color2="255" weight="1" checkbox="1" colors="," offset="0" />

</Plots>]]></Plots>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="46" />
<script>
<freq support="8;11" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{&quot;0&quot;:[332],&quot;8&quot;:[332,338,331,337,335,341,334,340]},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="分公司買賣家數指標" ID="34ec30d4b3d541ed9aa08e956cab145c" ReturnType="0" ExecType="1" Folder="/籌碼指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[if barfreq = "Tick" or barfreq = "Min"
	then raiseruntimeerror("不支援此頻率");

value1=GetField("分公司買進家數");
value2=GetField("分公司賣出家數");
value3=value2-value1;

plot1(value3,"家數差");
]]></Code>
<Arg><![CDATA[<Arg seed="8b23a2d1-19c4-406a-aad8-fbb921ad51de" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="118d7604-81d5-4308-92b2-4d31c10f7680" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="家數差" number="1" type="1" color="255" color2="62464" style="3" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="11" />
<script>
<freq support="8;11" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{&quot;0&quot;:[176,177]},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="外盤成交比例指標" ID="b91923cb155347c99fb4cf8817e7c649" ReturnType="0" ExecType="1" Folder="/技術指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[{
指標說明
https://xstrader.net/外盤成交比例指標/
}

input:
	short1(5,"短期平均"),
	mid1(12,"長期平均");

if barfreq = "Tick" or barfreq = "Min" then
begin
	value1=GetField("內盤量");//單位:元
	value2=GetField("外盤量");//單位:元
end else begin
	value1=GetField("內盤量","D");//單位:元
	value2=GetField("外盤量","D");//單位:元
end;
value3=value1+value2;
if value3<>0 then 
	value4=value2/value3*100;
value5=average(value4,short1);
value6=average(value4,mid1);

plot1(value5,"短期均線");
plot2(value6,"長期均線");

]]></Code>
<Arg><![CDATA[<Arg seed="8620f35a-559a-4f54-88c7-d289c1d96d74" version="1"><Param name="短期平均" varname="short1" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="長期平均" varname="mid1" type="1" subtype="0" value="12" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="fbba9b46-9777-4f0e-ad84-3cca07eecb11" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="短期均線" number="1" type="0" color="5275903" color2="5275903" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /><Plot name="長期均線" number="2" type="0" color="65535" color2="255" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="23" />
<script>
<freq support="8;11" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{&quot;0&quot;:[20,21],&quot;8&quot;:[20,21]},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="估波指標(Coppock Indicator)" ID="0986e588719446d986bc6cdf446d612a" ReturnType="0" ExecType="3" Folder="/大盤指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[{ 一般適用於大盤月線資料 }

input:length1(14);		setinputname(1, "天期一");
input:length2(11);		setinputname(2, "天期二");
input:length3(10);   	setinputname(3, "平均天期");

variable:coppock(0); 
Value1=rateofchange(close,length1);   
Value2=rateofchange(close,length2);   
coppock=xaverage(Value1+Value2,length3);   

plot1(coppock,"Coppock Indicator");
]]></Code>
<Arg><![CDATA[<Arg seed="6ab0721e-7569-41dd-a5e2-0e044c762111" version="1"><Param name="天期一" varname="length1" type="1" subtype="0" value="14" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="天期二" varname="length2" type="1" subtype="0" value="11" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="平均天期" varname="length3" type="1" subtype="0" value="10" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="913d4adc-6f0b-4bce-8a1e-e09a488cf38a" version="1"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="Coppock Indicator" number="1" type="0" color="5275903" color2="0" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,c9f2641e5de0497cb352ace96f64236e;1,d02c45cba76f4163a048685f7bc4002b</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="50" />
<Maxbb val="15" />
<ScriptComplexity val="4" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="PVI(正量指標)" ID="f905ecfe67bf42b88d3bcc5e822e0b81" ReturnType="0" ExecType="3" Folder="/XQ量能指標/" StatusMask="2">
<Desc><![CDATA[畫出正量指標]]></Desc>
<Code><![CDATA[// XQ: PVI指標
//
Variable: _pvi(1);

If CurrentBar = 1 then
	_pvi = 1
else
  begin	
	if Volume > Volume[1] then
		_pvi = _pvi[1] + (Close - Close[1]) / Close[1]
	else
		_pvi = _pvi[1];
  end;
  
Plot1(_pvi, "PVI");
		]]></Code>
<Arg><![CDATA[<Arg seed="a3017358-258c-48a9-90f1-2136a2a26a4b" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="23eb1c56-8987-4dcc-9793-214b5f6e0d18" version="1"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="PVI" number="1" type="0" color="5275903" color2="0" style="0" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<Extra><![CDATA[<Extra>
<TotalBar val="100" />
<Maxbb val="2" />
<ScriptComplexity val="1" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="開盤第N根的每日高低價線" ID="ee310303cb564103b981f585fa9a267e" ReturnType="0" ExecType="1" Folder="/主圖指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[Input:Length(1,"第N根K棒");

Var:_MH(0), _ML(0), _HHMMSS(0), _ChageDNum(0), _MaxCDN(0);

if barfreq <> "Min" then raiseRunTimeError("僅支援分鐘頻率");
if Length = 0 then raiseRunTimeError("參數請設定大於0的合理數值");
if gettotalBar = currentBar and Length - 1 > _MaxCDN then raiseRunTimeError("參數設定超過每日分鐘K棒數");

if getfieldDate("date") <> getfieldDate("date")[1] then 
	_ChageDNum = 0
else begin
	_ChageDNum += 1;
end;

if _ChageDNum > _MaxCDN then _MaxCDN = _ChageDNum;

if _ChageDNum < Length - 1  then begin
	NoPlot(1);
	NoPlot(2);
	NoPlot(3);
end else if _ChageDNum = Length - 1  then begin
	_MH = GetField("最高價", "D");
	_ML = GetField("最低價", "D");
	_HHMMSS = time;
	plot1(_HHMMSS,"時間");
	plot2(_MH,"最高價");
	plot3(_ML,"最低價");
end else begin
	plot1(_HHMMSS,"時間");
	plot2(_MH,"最高價");
	plot3(_ML,"最低價");
end;

setplotLabel(1,Text("第",NumToStr(Length, 0),"根時間"));
]]></Code>
<Arg><![CDATA[<Arg seed="678b9189-ad8c-49a9-b717-a170a025ff22" version="1"><Param name="第N根K棒" varname="Length" type="1" subtype="0" value="1" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="b21644e9-ffc7-40e3-a9ae-9eb2853637df" version="1">
	<Axises>
		<Axis value="1" align="3" min="-100.000000" max="100.000000" SetMin="1" SetMax="1" mpvalue="0.000000" />
		<Axis value="2" align="0" min="-100.000000" max="100.000000" SetMin="1" SetMax="1" mpvalue="0.000000" />
	</Axises>
	<Plot name="時間" number="1" style="5" color="5275903" color2="5275903" axis="1" checkbox="-1" colors="," offset="0" />

	<Plot name="最高價" number="2" type="3" color="255" color2="255" weight="2" checkbox="-1" colors="," offset="0" />

	<Plot name="最低價" number="3" type="3" color="65280" color2="65280" weight="2" checkbox="-1" colors="," offset="0" />

</Plots>]]></Plots>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="11" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{&quot;8&quot;:[6,7]},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="散戶持股" ID="25f39d57ec8a4ac5a6ac84aba13ccd70" ReturnType="0" ExecType="1" Folder="/籌碼高手/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input: _input1(400,"散戶標準",inputkind:= Dict(["10",10],["50",50],["100",100],["200",200],["400",400],["600",600],["800",800],["1000",1000]),quickedit:=true);

condition999 = symbolexchange = "TW" or symbolexchange = "TE";//台股+興櫃
condition998 = condition999 = true and (symboltype = 2 or symbolType = 1);//個股+興櫃+類股

if condition998 = false //個股+興櫃+類股
	then raiseruntimeerror("不支援此商品");

if barfreq = "Tick" or barfreq = "Min"
	then raiseruntimeerror("不支援此頻率");
	
switch (_input1)
begin
	case 10:
		if barFreq = "D" then begin
			value1 = Getfield("散戶持股比例","W",param:=10);
			value2 = Getfield("散戶持股張數","W",param:=10);
			value3 = Getfield("散戶持股人數","W",param:=10);
		end else begin
			value1 = Getfield("散戶持股比例",param:=10);
			value2 = Getfield("散戶持股張數",param:=10);
			value3 = Getfield("散戶持股人數",param:=10);
		end;	
		plot1(0.01*value1,"散戶持股比例",checkbox:=1,axis:=1,ScaleLabel:=slpercent,ScaleDecimal:=sd2);//請RD加，Getfield("散戶持股比例",param:=10)
		plot2(value2,"持股張數",checkbox:=0,axis:=2,ScaleLabel:=sltypewy,ScaleDecimal:=sdauto);
		plot3(value3,"持股人數",checkbox:=0,axis:=11,ScaleLabel:=slfull,ScaleDecimal:=sd0);//請RD加
		
	case 50:
		if barFreq = "D" then begin
			value1 = Getfield("散戶持股比例","W",param:=50);
			value2 = Getfield("散戶持股張數","W",param:=50);
			value3 = Getfield("散戶持股人數","W",param:=50);
		end else begin
			value1 = Getfield("散戶持股比例",param:=50);
			value2 = Getfield("散戶持股張數",param:=50);
			value3 = Getfield("散戶持股人數",param:=50);
		end;
		plot1(0.01*value1,"散戶持股比例",checkbox:=1,axis:=1,ScaleLabel:=slpercent,ScaleDecimal:=sd2);//請RD加，Getfield("散戶持股比例",param:=50)
		plot2(value2,"持股張數",checkbox:=0,axis:=2,ScaleLabel:=sltypewy,ScaleDecimal:=sdauto);
		plot3(value3,"持股人數",checkbox:=0,axis:=11,ScaleLabel:=slfull,ScaleDecimal:=sd0);//請RD加

	case 100:
		if barFreq = "D" then begin
			value1 = Getfield("散戶持股比例","W",param:=100);
			value2 = Getfield("散戶持股張數","W",param:=100);
			value3 = Getfield("散戶持股人數","W",param:=100);
		end else begin
			value1 = Getfield("散戶持股比例",param:=100);
			value2 = Getfield("散戶持股張數",param:=100);
			value3 = Getfield("散戶持股人數",param:=100);
		end;
		plot1(0.01*value1,"散戶持股比例",checkbox:=1,axis:=1,ScaleLabel:=slpercent,ScaleDecimal:=sd2);//請RD加，新增參數設定選擇：[400/600/800/1000] 張以上
		plot2(value2,"持股張數",checkbox:=0,axis:=2,ScaleLabel:=sltypewy,ScaleDecimal:=sdauto);
		plot3(value3,"持股人數",checkbox:=0,axis:=11,ScaleLabel:=slfull,ScaleDecimal:=sd0);//請RD加
		
	case 200:
		if barFreq = "D" then begin
			value1 = Getfield("散戶持股比例","W",param:=200);
			value2 = Getfield("散戶持股張數","W",param:=200);
			value3 = Getfield("散戶持股人數","W",param:=200);
		end else begin
			value1 = Getfield("散戶持股比例",param:=200);
			value2 = Getfield("散戶持股張數",param:=200);
			value3 = Getfield("散戶持股人數",param:=200);
		end;
		plot1(0.01*value1,"散戶持股比例",checkbox:=1,axis:=1,ScaleLabel:=slpercent,ScaleDecimal:=sd2);//請RD加，新增參數設定選擇：[400/600/800/1000] 張以上
		plot2(value2,"持股張數",checkbox:=0,axis:=2,ScaleLabel:=sltypewy,ScaleDecimal:=sdauto);
		plot3(value3,"持股人數",checkbox:=0,axis:=11,ScaleLabel:=slfull,ScaleDecimal:=sd0);//請RD加
	
	case 600:
		if barFreq = "D" then begin
			value1 = Getfield("散戶持股比例","W",param:=600);
			value2 = Getfield("散戶持股張數","W",param:=600);
			value3 = Getfield("散戶持股人數","W",param:=600);
		end else begin
			value1 = Getfield("散戶持股比例",param:=600);
			value2 = Getfield("散戶持股張數",param:=600);
			value3 = Getfield("散戶持股人數",param:=600);
		end;
		plot1(0.01*value1,"散戶持股比例",checkbox:=1,axis:=1,ScaleLabel:=slpercent,ScaleDecimal:=sd2);//請RD加，新增參數設定選擇：[400/600/800/1000] 張以上
		plot2(value2,"持股張數",checkbox:=0,axis:=2,ScaleLabel:=sltypewy,ScaleDecimal:=sdauto);
		plot3(value3,"持股人數",checkbox:=0,axis:=11,ScaleLabel:=slfull,ScaleDecimal:=sd0);//請RD加
		
	case 800:
		if barFreq = "D" then begin
			value1 = Getfield("散戶持股比例","W",param:=800);
			value2 = Getfield("散戶持股張數","W",param:=800);
			value3 = Getfield("散戶持股人數","W",param:=800);
		end else begin
			value1 = Getfield("散戶持股比例",param:=800);
			value2 = Getfield("散戶持股張數",param:=800);
			value3 = Getfield("散戶持股人數",param:=800);
		end;
		plot1(0.01*value1,"散戶持股比例",checkbox:=1,axis:=1,ScaleLabel:=slpercent,ScaleDecimal:=sd2);//請RD加，新增參數設定選擇：[400/600/800/1000] 張以上
		plot2(value2,"持股張數",checkbox:=0,axis:=2,ScaleLabel:=sltypewy,ScaleDecimal:=sdauto);
		plot3(value3,"持股人數",checkbox:=0,axis:=11,ScaleLabel:=slfull,ScaleDecimal:=sd0);//請RD加
	
	case 1000:
		if barFreq = "D" then begin
			value1 = Getfield("散戶持股比例","W",param:=1000);
			value2 = Getfield("散戶持股張數","W",param:=1000);
			value3 = Getfield("散戶持股人數","W",param:=1000);
		end else begin
			value1 = Getfield("散戶持股比例",param:=1000);
			value2 = Getfield("散戶持股張數",param:=1000);
			value3 = Getfield("散戶持股人數",param:=1000);
		end;
		plot1(0.01*value1,"散戶持股比例",checkbox:=1,axis:=1,ScaleLabel:=slpercent,ScaleDecimal:=sd2);//請RD加，新增參數設定選擇：[400/600/800/1000] 張以上
		plot2(value2,"持股張數",checkbox:=0,axis:=2,ScaleLabel:=sltypewy,ScaleDecimal:=sdauto);
		plot3(value3,"持股人數",checkbox:=0,axis:=11,ScaleLabel:=slfull,ScaleDecimal:=sd0);//請RD加

	default:
		if barFreq = "D" then begin
			value1 = Getfield("散戶持股比例","W",param:=400);
			value2 = Getfield("散戶持股張數","W",param:=400);
			value3 = Getfield("散戶持股人數","W",param:=400);
		end else begin
			value1 = Getfield("散戶持股比例",param:=400);
			value2 = Getfield("散戶持股張數",param:=400);
			value3 = Getfield("散戶持股人數",param:=400);
		end;
		plot1(0.01*value1,"散戶持股比例",checkbox:=1,axis:=1,ScaleLabel:=slpercent,ScaleDecimal:=sd2);//請RD加，新增參數設定選擇：[400/600/800/1000] 張以上
		plot2(value2,"持股張數",checkbox:=0,axis:=2,ScaleLabel:=sltypewy,ScaleDecimal:=sdauto);
		plot3(value3,"持股人數",checkbox:=0,axis:=11,ScaleLabel:=slfull,ScaleDecimal:=sd0);//請RD加

end;]]></Code>
<Arg><![CDATA[<Arg seed="ac4dd5e4-d1b0-45ba-a996-31dd299c6c20" version="1"><Param name="散戶標準" varname="_input1" type="1" subtype="0" value="400" isSerial="0" isArray="0" isRef="0" inputkind="1" quickedit="1" keytype="3"><Pair key="10" value="10" /><Pair key="50" value="50" /><Pair key="100" value="100" /><Pair key="200" value="200" /><Pair key="400" value="400" /><Pair key="600" value="600" /><Pair key="800" value="800" /><Pair key="1000" value="1000" /></Param></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="319a0f2a-11dd-4a2c-a88f-65e44c7c02e0" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="散戶持股比例" number="1" type="1" color="255" color2="62464" style="4" weight="0" axis="0" DecimalFormat="3" NumFormat="2" checkbox="1" SetDecimalFormat="1" SetNumFormat="1" colors="-1,-1" offset="0" /><Plot name="持股張數" number="2" type="0" color="16711935" color2="255" style="5" weight="0" axis="1" DecimalFormat="0" NumFormat="3" checkbox="0" SetDecimalFormat="0" SetNumFormat="1" colors="-1,-1" offset="0" /><Plot name="持股人數" number="3" type="0" color="65280" color2="65280" style="5" weight="0" axis="10" DecimalFormat="1" NumFormat="1" checkbox="0" SetDecimalFormat="1" SetNumFormat="1" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="241" />
<script>
<freq support="9;12;10;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{&quot;9&quot;:[238,221,222],&quot;0&quot;:[238,221,222]},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="台灣50上漲家數" ID="bcf25753f9874dff91f1151fd893ca9f" ReturnType="0" ExecType="1" Folder="/市場動能/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[{統計台灣50成分股，這一根K棒上漲的家數。
K棒上漲的定義為，目前收盤價 > 前一根K棒的收盤價}

if barfreq <> "Min" then raiseruntimeerror("僅支援「分鐘」頻率");

value1 = GetSymbolField("TSE50.SJ","TW50價格上漲家數");

plot1(value1,"台灣50上漲家數");]]></Code>
<Arg><![CDATA[<Arg seed="117c3b9a-70a4-4a0c-b55c-29354fa3a73a" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="5e7e9bf4-2fbc-448e-aaad-ec3699e5b2ee" version="1">
	<Axises>
		<Axis value="1" align="2" min="0.000000" max="50.000000" SetMin="1" SetMax="1" mpvalue="0.000000" />
		<Axis value="2" align="0" min="-100.000000" max="100.000000" SetMin="1" SetMax="1" mpvalue="0.000000" />
	</Axises>
	<Plot name="台灣50上漲家數" number="1" type="1" color="255" color2="5275903" DecimalFormat="1" checkbox="-1" colors="," offset="0" />

</Plots>]]></Plots>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="6" />
<script>
<freq support="8;11" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{&quot;TSE50.SJ&quot;:{&quot;0&quot;:[879]}}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="3-6乖離率轉折點" ID="2f2492db3d7c417092e7fa137ef49843" ReturnType="0" ExecType="2" Folder="/XQ技術指標/" StatusMask="2">
<Desc><![CDATA[畫出3-6乖離率轉折點]]></Desc>
<Code><![CDATA[// XQ: 3-6乖離率轉折點
//
Value1 = 2 * Close[3] - Close[6];
Plot1(Value1, "T");
		]]></Code>
<Arg><![CDATA[<Arg seed="d6a76662-b4bd-4fad-a07b-6d1b7fe35ad5" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="17ec7d70-ee5f-473b-b055-f2279d570ec3" version="1"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="T" number="1" type="0" color="5275903" color2="0" style="0" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<Extra><![CDATA[<Extra>
<TotalBar val="12" />
<Maxbb val="6" />
<ScriptComplexity val="1" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="買賣成交筆數" ID="7361375778354cbdb0efcbaa418fbf9b" ReturnType="0" ExecType="1" Folder="/期權指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[{指標數值定義："委買委賣成筆差 = 委買成交筆數 - 委賣成交筆數"
支援商品：期貨/選擇權}

if barfreq <> "Min" and barfreq <> "D" then 
	raiseruntimeerror("僅支援分鐘與日頻率");

value1 = GetField("累買成筆");
value2 = GetField("累賣成筆");
value3 = GetField("累賣成筆") - GetField("累買成筆");

plot1(value3,"委買委賣成筆差");
plot2(value1,"委買成筆",checkbox:=0);
plot3(value2,"委賣成筆",checkbox:=0);
]]></Code>
<Arg><![CDATA[<Arg seed="f777eaeb-6940-4c4f-91d3-c26c84658d2f" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="a26d7304-c774-4366-a13b-31ae19899075" version="1">
	<Axises>
		<Axis value="1" align="0" min="-100.000000" max="100.000000" SetMin="1" SetMax="1" mpvalue="0.000000" />
		<Axis value="2" align="1" min="-100.000000" max="100.000000" SetMin="1" SetMax="1" mpvalue="0.000000" />
	</Axises>
	<Plot name="委買委賣成筆差" number="1" type="1" style="3" color="255" color2="65280" axis="1" checkbox="-1" colors="," offset="0" />

	<Plot name="委買成筆" number="2" style="5" color="16711935" color2="255" checkbox="0" colors="," offset="0" />

	<Plot name="委賣成筆" number="3" style="5" color="16776960" color2="65280" checkbox="0" colors="," offset="0" />

</Plots>]]></Plots>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="21" />
<script>
<freq support="8;11" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{&quot;0&quot;:[319,320]},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="ETF成交量統計指標" ID="a6fa0fc2d0864c5e91cb1e2dd7cb6151" ReturnType="0" ExecType="1" Folder="/大盤指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[array:ETF[50](0);
etf[1]=GetSymbolField("0050.tw","成交金額");
etf[2]=GetSymbolField("0051.tw","成交金額");
etf[3]=GetSymbolField("0052.tw","成交金額");
etf[4]=GetSymbolField("0053.tw","成交金額");
etf[5]=GetSymbolField("0054.tw","成交金額");
etf[6]=GetSymbolField("0055.tw","成交金額");
etf[7]=GetSymbolField("0056.tw","成交金額");
etf[8]=GetSymbolField("0057.tw","成交金額");
etf[9]=GetSymbolField("0058.tw","成交金額");
etf[10]=GetSymbolField("0059.tw","成交金額");
etf[11]=GetSymbolField("0061.tw","成交金額");
etf[12]=GetSymbolField("006201.tw","成交金額");
etf[13]=GetSymbolField("006203.tw","成交金額");
etf[14]=GetSymbolField("006204.tw","成交金額");
etf[15]=GetSymbolField("006205.tw","成交金額");
etf[16]=GetSymbolField("006206.tw","成交金額");
etf[17]=GetSymbolField("006207.tw","成交金額");
etf[18]=GetSymbolField("006208.tw","成交金額");
etf[19]=GetSymbolField("00631L.tw","成交金額");
etf[20]=GetSymbolField("00632R.tw","成交金額");
etf[21]=GetSymbolField("00633L.tw","成交金額");
etf[22]=GetSymbolField("00634R.tw","成交金額");
etf[23]=GetSymbolField("00635U.tw","成交金額");
etf[24]=GetSymbolField("00636.tw","成交金額");
etf[25]=GetSymbolField("00637L.tw","成交金額");
etf[26]=GetSymbolField("00638R.tw","成交金額");
etf[27]=GetSymbolField("00639.tw","成交金額");
etf[28]=GetSymbolField("00640L.tw","成交金額");
etf[29]=GetSymbolField("00641R.tw","成交金額");
etf[30]=GetSymbolField("00642U.tw","成交金額");
etf[31]=GetSymbolField("00643.tw","成交金額");
etf[32]=GetSymbolField("00645.tw","成交金額");
etf[33]=GetSymbolField("00646.tw","成交金額");
etf[34]=GetSymbolField("00647L.tw","成交金額");
etf[35]=GetSymbolField("00648R.tw","成交金額");
etf[36]=GetSymbolField("00649.tw","成交金額");
etf[37]=GetSymbolField("00650L.tw","成交金額");
etf[38]=GetSymbolField("00651R.tw","成交金額");
etf[39]=GetSymbolField("00652.tw","成交金額");
etf[40]=GetSymbolField("00653L.tw","成交金額");
etf[41]=GetSymbolField("00654R.tw","成交金額");
etf[42]=GetSymbolField("00655L.tw","成交金額");
etf[43]=GetSymbolField("00656R.tw","成交金額");
etf[44]=GetSymbolField("00657.tw","成交金額");
etf[45]=GetSymbolField("00658L.tw","成交金額");
etf[46]=GetSymbolField("00659R.tw","成交金額");
etf[47]=GetSymbolField("00660.tw","成交金額");
etf[48]=GetSymbolField("00661.tw","成交金額");
etf[49]=GetSymbolField("00662.tw","成交金額");
etf[50]=GetSymbolField("008201.tw","成交金額");

value1=array_sum(etf,1,50);

if volume<>0 then 
	value3=value1/volume*100;
plot1(value3);


 


]]></Code>
<Arg><![CDATA[<Arg seed="92d2f793-c202-40fb-8faf-c6793a0918a1" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="755dd975-c33a-4c99-a1b9-cde5eea5c555" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="plot1" number="1" type="0" color="5275903" color2="5275903" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="251" />
<script>
<freq support="8;11;9;12;10;13" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{&quot;0050.TW&quot;:{&quot;0&quot;:[19]},&quot;0051.TW&quot;:{&quot;0&quot;:[19]},&quot;0052.TW&quot;:{&quot;0&quot;:[19]},&quot;0053.TW&quot;:{&quot;0&quot;:[19]},&quot;0054.TW&quot;:{&quot;0&quot;:[19]},&quot;0055.TW&quot;:{&quot;0&quot;:[19]},&quot;0056.TW&quot;:{&quot;0&quot;:[19]},&quot;0057.TW&quot;:{&quot;0&quot;:[19]},&quot;0058.TW&quot;:{&quot;0&quot;:[19]},&quot;0059.TW&quot;:{&quot;0&quot;:[19]},&quot;0061.TW&quot;:{&quot;0&quot;:[19]},&quot;006201.TW&quot;:{&quot;0&quot;:[19]},&quot;006203.TW&quot;:{&quot;0&quot;:[19]},&quot;006204.TW&quot;:{&quot;0&quot;:[19]},&quot;006205.TW&quot;:{&quot;0&quot;:[19]},&quot;006206.TW&quot;:{&quot;0&quot;:[19]},&quot;006207.TW&quot;:{&quot;0&quot;:[19]},&quot;006208.TW&quot;:{&quot;0&quot;:[19]},&quot;00631L.TW&quot;:{&quot;0&quot;:[19]},&quot;00632R.TW&quot;:{&quot;0&quot;:[19]},&quot;00633L.TW&quot;:{&quot;0&quot;:[19]},&quot;00634R.TW&quot;:{&quot;0&quot;:[19]},&quot;00635U.TW&quot;:{&quot;0&quot;:[19]},&quot;00636.TW&quot;:{&quot;0&quot;:[19]},&quot;00637L.TW&quot;:{&quot;0&quot;:[19]},&quot;00638R.TW&quot;:{&quot;0&quot;:[19]},&quot;00639.TW&quot;:{&quot;0&quot;:[19]},&quot;00640L.TW&quot;:{&quot;0&quot;:[19]},&quot;00641R.TW&quot;:{&quot;0&quot;:[19]},&quot;00642U.TW&quot;:{&quot;0&quot;:[19]},&quot;00643.TW&quot;:{&quot;0&quot;:[19]},&quot;00645.TW&quot;:{&quot;0&quot;:[19]},&quot;00646.TW&quot;:{&quot;0&quot;:[19]},&quot;00647L.TW&quot;:{&quot;0&quot;:[19]},&quot;00648R.TW&quot;:{&quot;0&quot;:[19]},&quot;00649.TW&quot;:{&quot;0&quot;:[19]},&quot;00650L.TW&quot;:{&quot;0&quot;:[19]},&quot;00651R.TW&quot;:{&quot;0&quot;:[19]},&quot;00652.TW&quot;:{&quot;0&quot;:[19]},&quot;00653L.TW&quot;:{&quot;0&quot;:[19]},&quot;00654R.TW&quot;:{&quot;0&quot;:[19]},&quot;00655L.TW&quot;:{&quot;0&quot;:[19]},&quot;00656R.TW&quot;:{&quot;0&quot;:[19]},&quot;00657.TW&quot;:{&quot;0&quot;:[19]},&quot;00658L.TW&quot;:{&quot;0&quot;:[19]},&quot;00659R.TW&quot;:{&quot;0&quot;:[19]},&quot;00660.TW&quot;:{&quot;0&quot;:[19]},&quot;00661.TW&quot;:{&quot;0&quot;:[19]},&quot;00662.TW&quot;:{&quot;0&quot;:[19]},&quot;008201.TW&quot;:{&quot;0&quot;:[19]}}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="當日成本線" ID="171625c290b94208bab0cecb21a9b87b" ReturnType="0" ExecType="1" Folder="/主圖指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[{均線 = 當日所有成交Tick的平均價格(sum(pv)/sum(v)), 也就是當日的成本
支援商品：台股/期貨/選擇權/陸股/港股/美股/大盤/類股}

if barfreq <> "Min" and barfreq <> "D" then 
	raiseruntimeerror("僅支援分鐘與日頻率");
	
plot1(GetField("均價"),"均價");]]></Code>
<Arg><![CDATA[<Arg seed="472cd00c-25ea-4643-a9ab-6c706c87c734" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="c4e2759e-414d-4969-aa98-dd3e28fc5582" version="1">
	<Axises>
		<Axis value="1" align="0" min="-100.000000" max="100.000000" SetMin="1" SetMax="1" mpvalue="0.000000" />
		<Axis value="2" align="0" min="-100.000000" max="100.000000" SetMin="1" SetMax="1" mpvalue="0.000000" />
	</Axises>
	<Plot name="均價" number="1" color="39423" color2="5275903" weight="2" checkbox="-1" colors="," offset="0" />

</Plots>]]></Plots>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="6" />
<script>
<freq support="8;11" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{&quot;0&quot;:[315]},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="放空佔成交均量倍數" ID="dac678a4319648a7ba9d3258b1eed0b2" ReturnType="0" ExecType="1" Folder="/籌碼指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[{
指標說明
https://xstrader.net/借券相關欄位在交易策略上的應用/
}

if barfreq <> "D" then raiseruntimeerror("不支援此頻率");

value1=GetField("借券餘額張數","D");
value2=GetField("融券餘額張數","D");
if volume<>0 then 
	value3=(value1+value2)/average(volume,20);
plot1(value3,"放空佔成交均量倍數");]]></Code>
<Arg><![CDATA[<Arg seed="b6175c5d-566d-44f8-865a-5d96a67adace" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="ef4c51d0-939b-4d14-8a04-708d406f8464" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="放空佔成交均量倍數" number="1" type="0" color="5275903" color2="5275903" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="12" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{&quot;8&quot;:[67,46]},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="vortex indicator" ID="3de58c52f5234df3912fde6e36e687b1" ReturnType="0" ExecType="1" Folder="/技術指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input: period(14,"設定區間");

variable:pvm(0);
variable:nvm(0);

pvm=absvalue(high-low[1]);
nvm=absvalue(low-high[1]);
value1=summation(pvm,period);
value2=summation(nvm,period);
value3=summation(truerange,period);
value4=value1/value3;
value5=value2/value3;
value6=value4-value5;

plot1(value6,"vortex");
 ]]></Code>
<Arg><![CDATA[<Arg seed="b087a8d5-43a0-4659-9ee7-0462a3057419" version="1"><Param name="設定區間" varname="period" type="1" subtype="0" value="14" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="47d35eee-b265-4714-bc51-7d625a139a34" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="vortex" number="1" type="0" color="5275903" color2="5275903" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d;1,36d1fc033c6f48f8a136f9e1fdec110f;1,81394f9cf0c8469ea5f8832700aec8b7;1,9e03682196e24611b2fe326b6a56433d</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="5" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="散戶買賣力" ID="1e57d3cd52d34afd82525259f44cb696" ReturnType="0" ExecType="1" Folder="/即時籌碼/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[{指標數值定義："散戶單=小單資料為開盤迄今的累計張數"

支援商品：台(股票)}

if barfreq <> "Min" and barfreq <> "D" and barfreq <> "AD" then 
	raiseruntimeerror("僅支援分鐘與日頻率（含還原）");

value91 = GetField("賣出小單量");//僅提供給有權限的用戶使用

value1 = GetField("賣出小單量","D");
value2 = GetField("買進小單量","D");
value3 = value2 - value1;
plot1(value3,"散戶買賣力"); //bar，axis2
plot2(value2,"散戶外盤量",checkbox:=0); //line，axis11
plot3(value1,"散戶內盤量",checkbox:=0); //line，axis11]]></Code>
<Arg><![CDATA[<Arg seed="6cc99f1a-41e4-4e2d-b774-0eff69f0d7a3" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="4c7353d5-3f45-4a9c-aabc-194b34a5f215" version="1">
	<Axises>
		<Axis value="1" align="0" min="-100.000000" max="100.000000" SetMin="1" SetMax="1" mpvalue="0.000000" />
		<Axis value="2" align="1" min="-100.000000" max="100.000000" SetMin="1" SetMax="1" mpvalue="0.000000" />
	</Axises>
	<Plot name="散戶買賣力" number="1" type="1" style="3" color="255" color2="65280" axis="1" checkbox="-1" colors="," offset="0" />

	<Plot name="散戶外盤量" number="2" color="16711935" color2="255" checkbox="0" colors="," offset="0" />

	<Plot name="散戶內盤量" number="3" color="15446382" color2="65280" checkbox="0" colors="," offset="0" />

</Plots>]]></Plots>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="16" />
<script>
<freq support="8;11" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{&quot;0&quot;:[352],&quot;8&quot;:[352,349]},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="EMA" ID="f304be515b06481ead0b9366a6fed276" ReturnType="0" ExecType="3" Folder="/主圖指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[Input: Period1(50); SetInputName(1, "EMA1");
Input: Period2(120); SetInputName(2, "EMA2");
Input: Period3(240); setinputname(3, "EMA3");

Plot1(EMA(Close, Period1), "EMA1");
Plot2(EMA(Close, Period2), "EMA2");
Plot3(EMA(Close, Period3), "EMA3");]]></Code>
<Arg><![CDATA[<Arg seed="6430dd94-e461-4c71-aaa7-69e9109a2636" version="1"><Param name="EMA1" varname="Period1" type="1" subtype="0" value="50" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="EMA2" varname="Period2" type="1" subtype="0" value="120" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="EMA3" varname="Period3" type="1" subtype="0" value="240" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="6a39a06e-735b-4198-9349-87f3eddef1b7" version="0"><Axises><Axis value="1" align="3" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="EMA1" number="1" type="0" color="6750207" color2="0" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /><Plot name="EMA2" number="2" type="0" color="65280" color2="0" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /><Plot name="EMA3" number="3" type="0" color="13311" color2="0" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,acd8e9a292d64600bec9591361584e6f</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="300" />
<Maxbb val="240" />
<ScriptComplexity val="4" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="月線與收盤價差" ID="32faa5a1ec9f4684b68073c082bbc836" ReturnType="0" ExecType="1" Folder="/技術指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[{
指標說明
https://xstrader.net/自訂指標/
}

value1=average(close,22);
value2=close-value1;
value3=average(value2,3);

plot1(value3,"月線與收盤價差三日移動平均");
plot2(0);]]></Code>
<Arg><![CDATA[<Arg seed="1d3aeb65-5b05-4ce3-acb2-2ce04dfc9192" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="f8005c26-8e6f-448e-a9fe-20f8dcbbccdb" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="月線與收盤價差三日移動平均" number="1" type="0" color="5275903" color2="5275903" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /><Plot name="plot2" number="2" type="0" color="65535" color2="255" style="0" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="3" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="上漲下跌幅度強弱度指標" ID="ce443992222b49758d7f100b8c538212" ReturnType="0" ExecType="3" Folder="/技術指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[{
指標說明
https://xstrader.net/雲端策略中心精進版之34多頭轉強策略/
}

input:length(10,"期數"); 

variable: sumUp(0), sumDown(0), up(0), down(0),RS(0);

if CurrentBar = 1 then begin
	sumUp = Average(maxlist(close - close[1], 0), length); 
	sumDown = Average(maxlist(close[1] - close, 0), length); 
end else begin
	up = maxlist(close - close[1], 0);
	down = maxlist(close[1] - close, 0);	 
	sumUp = sumUp[1] + (up - sumUp[1]) / length;
	sumDown = sumDown[1] + (down - sumDown[1]) / length;
end;
if sumdown<>0 then rs=sumup/sumdown;

plot1(rs,"強弱度");]]></Code>
<Arg><![CDATA[<Arg seed="6e3fc33e-a744-4edf-ba56-350e9ebf6146" version="1"><Param name="期數" varname="length" type="1" subtype="0" value="10" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="d00c1b8c-27de-4473-ae43-fe981b764dcd" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="強弱度" number="1" type="0" color="5275903" color2="5275903" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="3" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="投信均價線" ID="37e5c869d5ab4953a049ea233be60dfd" ReturnType="0" ExecType="3" Folder="/主圖指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[Input: period(20);	setinputname(1, "期間(天)");

if barfreq = "Tick" or barfreq = "Min"
	then raiseruntimeerror("不支援此頻率");
	
variable: avg_b(0), avg_s(0);

if GetField("Volume") > 0 then 
begin
	Value5 = GetField("投信買張")*GetField("成交金額")/(GetField("Volume")*1000);
	Value6 = GetField("投信賣張")*GetField("成交金額")/(GetField("Volume")*1000);
end else begin
	Value5 = 0;
	Value6 = 0;
end;

Value1 = summation(Value5, period);
Value2 = summation(GetField("投信買張"), period);
Value3 = summation(Value6, period);
Value4 = summation(GetField("投信賣張"), period);
 
if Value2 > 0 and Value2 <> Value2[1] then avg_b = Value1 / Value2;
if Value4 > 0 and Value4 <> Value4[1]  then avg_s = Value3 / Value4;

Plot1(avg_b, "投信買進均價");
Plot2(avg_s, "投信賣出均價");


]]></Code>
<Arg><![CDATA[<Arg seed="fb3089ec-235b-48fe-bad2-fd71c08fe292" version="1"><Param name="期間(天)" varname="period" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="e90cb303-7271-4365-acdf-6f8f49b63e3f" version="0"><Axises><Axis value="1" align="3" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="投信買進均價" number="1" type="0" color="255" color2="0" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /><Plot name="投信賣出均價" number="2" type="0" color="65280" color2="255" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="50" />
<script>
<freq support="8;11;9;12;10;13" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{&quot;0&quot;:[9,32,19,33]},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="Mass Index" ID="18ef2f43eadd462ca2a1b7932051d126" ReturnType="0" ExecType="3" Folder="/技術指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input: length1(9);	setinputname(1, "天期一");
input: length2(25); setinputname(2, "天期二");
  
value1 = average(range,length1);   
value2 = average(value1,length1);   
if value2 = 0 then value3 = 0 else value3 = value1/value2;
value4 = summation(value3,length2); 

plot1(value4,"Mass Index");    
]]></Code>
<Arg><![CDATA[<Arg seed="5b15c35a-426c-4a51-803b-cb9b0ef803f4" version="1"><Param name="天期一" varname="length1" type="1" subtype="0" value="9" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="天期二" varname="length2" type="1" subtype="0" value="25" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="63526001-db1a-45cf-9d43-fd98a4505367" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="Mass Index" number="1" type="0" color="5275903" color2="0" style="0" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,b7522a72975a4d4bbc36f4fb684d6f77;1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="100" />
<Maxbb val="50" />
<ScriptComplexity val="5" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="自訂散戶買賣力" ID="53831e5ebc0043c68d3f2a3944df9c9c" ReturnType="0" ExecType="1" Folder="/即時籌碼/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[{指標數值定義：散戶 = 成交單量 < X的委託由Tick資料去累計計算
支援商品：台(股票)、台(期貨)}

if symbolexchange <> "TW" and symbolexchange <> "TF" then raiseruntimeerror("不支援此商品");
if SymbolType <> 2 and SymbolType <> 3 then raiseruntimeerror("不支援此商品");

if barfreq <> "Min" then 
	raiseruntimeerror("僅支援分鐘頻率");
	
value91 = GetField("上漲量");//僅提供給有權限的用戶使用

{
	顯示開盤迄今的累計外盤小單 - 累計內盤小單, 也就是盤中散戶的買賣力趨勢
	小單定義: 成交單量 <= X
}

input: threshold(30, "小單門檻(張or口)");

var: intrabarpersist _v_buy_acc(0), intrabarpersist _v_sell_acc(0);
var: intrabarpersist _last_seq(0);
var: _cur_seq(0), _i(0), _curbar_date(0); 
var: _last_date(0);

if getfielddate("date") <> _last_date then begin
	_last_date = getfielddate("date");
	_v_buy_acc = 0;
	_v_sell_acc = 0;
	_last_seq = 0;
end;

// 抓洗價當時最新一筆Tick的位置跟日期
//
_cur_seq = GetField("SeqNo", "Tick");
_curbar_date = GetField("Date", "Tick");

if symbolexchange = "TW" and SymbolType = 2 then begin	//台(股票)
	if _curbar_date <> date then begin
		// 如果開盤到有某些分鐘沒有成交, 此時會對到昨日之前的Tick => 這些分鐘不要計算
		//
		_cur_seq = 0;

	end else if _cur_seq > 0 and _cur_seq > _last_seq then begin
		// _last_seq是上一次畫圖時最後一筆Tick的位置
		//
		// 所以就統計 _cur_seq .. _last_seq之間的Tick的成交資料
		//
		_i = _last_seq + 1;	
		while _i <= _cur_seq begin
			var: tv(0), _first(0), _complete(0);
		
			value1 = GetField("BidAskFlag", "Tick")[_cur_seq - _i];	// 外盤=1, 內盤=-1
			value2 = GetField("Close", "Tick")[_cur_seq - _i];		// 價格
			value3 = GetField("Volume", "Tick")[_cur_seq - _i];		// 單量
			value4 = GetField("SeqNo", "Tick")[_cur_seq - _i];		// Tick編號
			//-------------------------------------------------
			// multitick的處理
			//
			// TickGroup回傳以下數值
			//  -1 = 集合競價(每天第一盤, 最後一盤, 包含暫緩之後的搓合, etc.) 
			//	0 = 逐筆搓合單筆
			//	1 = 逐筆搓合開始
			//  2 = 逐筆搓合中間
			//  3 = 逐筆搓合結束
			//
			value5 = GetField("TickGroup", "Tick")[_cur_seq - _i];

			tv = value3;
			_complete = 0;

			if value5 = -1 then begin
				// 集合競價: 不列入統計
				_i = _i + 1;
				tv = 0;
			end else if value5 = 0 then begin
				// 獨立一筆: 列入統計
				_i = _i + 1;
			end else if value5 = 1 then begin
				// 把連續撮合的所有資料合併成一筆統計
				// 連續撮合的第一筆 = 1, 中間 = 2, 最後 = 3
				_first = _i;
				_i = _i + 1;
				while _i <= _cur_seq and _complete = 0 begin
					value99 = GetField("Time", "Tick")[_cur_seq - _i];			// 價格
					value22 = GetField("Close", "Tick")[_cur_seq - _i];			// 價格
					value33 = GetField("Volume", "Tick")[_cur_seq - _i];		// 單量
					value44 = GetField("SeqNo", "Tick")[_cur_seq - _i];			// Seq
					value55 = GetField("TickGroup", "Tick")[_cur_seq - _i];
					tv = tv + value33;
					
					_i = _i + 1;
					if value55 = 3 then _complete = 1;
				end;

				if _complete = 0 then begin
					// 有可能交易所還沒有傳送完整的連續撮合Ticks, 所以等下一次洗價時再處理
					//
					_cur_seq = _first;
					break;
				end;
			end else begin	
				// 異常狀況: 跳過
				_i = _i + 1;
			end;	
			
			// 如果小於門檻, 則依照外盤/內盤分別累計(成交量)
			//
			if tv <= threshold then begin
				if value1 = 1 then _v_buy_acc = _v_buy_acc + tv;
				if value1 = -1 then _v_sell_acc = _v_sell_acc + tv;
			end;	
		end;
	end;	
end;

if symbolexchange = "TF" and SymbolType = 3 then begin	//台(期貨)
	if _curbar_date <> date then begin
		// 如果開盤到有某些分鐘沒有成交, 此時會對到昨日之前的Tick => 這些分鐘不要計算
		//
		_cur_seq = 0;

	end else if _cur_seq > 0 and _cur_seq > _last_seq then begin
		// _last_seq是上一次畫圖時最後一筆Tick的位置
		//
		// 所以就統計 _cur_seq .. _last_seq之間的Tick的成交資料
		//
		_i = _last_seq + 1;	
		while _i <= _cur_seq begin
			value1 = GetField("BidAskFlag", "Tick")[_cur_seq - _i];	// 外盤=1, 內盤=-1
			value2 = GetField("Close", "Tick")[_cur_seq - _i];		// 價格
			value3 = GetField("Volume", "Tick")[_cur_seq - _i];		// 單量
			value4 = GetField("SeqNo", "Tick")[_cur_seq - _i];		// Tick編號
			
			// 如果超過門檻, 則依照外盤/內盤分別累計(成交量)
			//
			if value3 < threshold then begin
				if value1 = 1 then _v_buy_acc = _v_buy_acc + value3;
				if value1 = -1 then _v_sell_acc = _v_sell_acc + value3;
			end;	
			
			_i = _i + 1;
		end;
	end;
end;

_last_seq = _cur_seq;

plot1(_v_buy_acc - _v_sell_acc, "散戶買賣力(自訂)");
plot2(_v_buy_acc, "大戶(自訂)外盤量",checkbox:=0);
plot3(_v_sell_acc, "大戶(自訂)內盤量",checkbox:=0);]]></Code>
<Arg><![CDATA[<Arg seed="c250d5b1-464e-47b0-9c1d-a520a6757971" version="1"><Param name="小單門檻(張or口)" varname="threshold" type="1" subtype="0" value="30" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="1849ca4a-199b-4e5f-960d-a5874f5c5b14" version="1">
	<Axises>
		<Axis value="1" align="0" min="-100.000000" max="100.000000" SetMin="1" SetMax="1" mpvalue="0.000000" />
		<Axis value="2" align="1" min="-100.000000" max="100.000000" SetMin="1" SetMax="1" mpvalue="0.000000" />
	</Axises>
	<Plot name="散戶買賣力(自訂)" number="1" type="1" style="3" color="255" color2="65280" axis="1" checkbox="-1" colors="," offset="0" />

	<Plot name="大戶(自訂)外盤量" number="2" color="16711935" color2="255" checkbox="0" colors="," offset="0" />

	<Plot name="大戶(自訂)內盤量" number="3" color="15912094" color2="65280" checkbox="0" colors="," offset="0" />

</Plots>]]></Plots>
<Extra><![CDATA[<Extra>
	<TotalBar val="200" />
	<Maxbb val="0" />
	<IsScriptSetTB val="0" />
	<IsScriptSetBB val="0" />
</Extra>]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="2" Name="RSI指標" ID="5755c0fea5ff4dd49a60eb3c31e4f2da" ReturnType="0" ExecType="3" Folder="/XQ技術指標/" StatusMask="2">
<Desc><![CDATA[畫出RSI相對強弱勢指標，共有兩條一條為短天期RSI，另一條為長天期RSI]]></Desc>
<Code><![CDATA[// XQ: RSI指標
//
input: Length1(6), Length2(12);

SetInputName(1, "天數一");
SetInputName(2, "天數二");

Plot1(RSI(Close, Length1), "RSI1");
Plot2(RSI(Close, Length2), "RSI2");

        
		]]></Code>
<Arg><![CDATA[<Arg seed="7e70b469-4dbf-4428-a696-1e1d6c86ee34" version="1"><Param name="天數一" varname="Length1" type="1" subtype="0" value="6" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="天數二" varname="Length2" type="1" subtype="0" value="12" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="66983f6e-f69c-4d8e-81ad-8ff14c059941" version="1"><Axises><Axis value="1" align="2" min="0" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="RSI1" number="1" type="0" color="5275903" color2="0" style="0" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /><Plot name="RSI2" number="2" type="0" color="255" color2="0" style="0" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c;1,d64c2a71d3ea43d985ca22ef62a5a8de</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="3" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="融資均價線" ID="3537d33987d14e8899f2bdef668f0b0a" ReturnType="0" ExecType="3" Folder="/主圖指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[Input: period(20);	setinputname(1, "期間(天)");

if barfreq = "Tick" or barfreq = "Min"
	then raiseruntimeerror("不支援此頻率");

variable: avg(0);

if GetField("Volume") > 0 then 
	Value3 = GetField("融資買進張數")*GetField("成交金額")/(GetField("Volume")*1000)
else
	Value3 = 0;

Value1 = summation(Value3, period);
Value2 = summation(GetField("融資買進張數"), period);
 
if Value2 > 0 and Value2 <> Value2[1] then avg = Value1 / Value2;

Plot1(avg, "融資買進均價");

]]></Code>
<Arg><![CDATA[<Arg seed="4f5e3125-0807-4c53-847a-4b0c2b187895" version="1"><Param name="期間(天)" varname="period" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="641b82ef-9027-4c48-8bf9-39642c190f89" version="0"><Axises><Axis value="1" align="3" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="融資買進均價" number="1" type="0" color="5275903" color2="0" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="28" />
<script>
<freq support="8;11;9;12;10;13" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{&quot;0&quot;:[9,170,19]},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="融資維持率" ID="6af808e6a2da418cb5fbdfedbf428f32" ReturnType="0" ExecType="3" Folder="/籌碼高手/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[condition996 = symbolexchange = "TW" = true and symboltype = 2;//個股
condition994 = symbol = "TSE.TW" or symbol = "TWSE.FS" or symbol = "OTC.TW";//大盤

if condition994 = false and condition996 = false //大盤+個股
	then raiseruntimeerror("不支援此商品");

if barfreq = "Tick" or barfreq = "Min"
	then raiseruntimeerror("不支援此頻率");

plot1(GetField("融資維持率")*0.01, "融資維持率",axis:=1,ScaleLabel:=slpercent,ScaleDecimal:=sd2);
//plot1(1, "融資維持率",checkbox:=1,axis:=1);

if symboltype = 1 then begin
	plot2(GetField("融資增減金額"),"融資增減(元)",checkbox:=0,axis:=2,ScaleLabel:=sltypewy,ScaleDecimal:=sdauto);//單位：元
	setplotlabel(2,"融資增減(元)");
end else begin
	plot2(GetField("融資增減張數"),"融資增減(張)",checkbox:=0,axis:=2,ScaleLabel:=slfull,ScaleDecimal:=sd0);//單位：張
	setplotlabel(2,"融資增減(張)");
end;

]]></Code>
<Arg><![CDATA[<Arg seed="1c66289a-1975-494c-973e-4b21bb3a9a01" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="b1067ff8-116a-4b01-b5e2-7445b561ac1b" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="融資維持率" number="1" type="0" color="5275903" color2="5275903" style="0" weight="0" axis="0" DecimalFormat="3" NumFormat="2" checkbox="-1" SetDecimalFormat="1" SetNumFormat="1" colors="-1,-1" offset="0" /><Plot name="融資增減(張)" number="2" type="1" color="255" color2="62464" style="4" weight="0" axis="1" DecimalFormat="1" NumFormat="1" checkbox="0" SetDecimalFormat="1" SetNumFormat="1" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="16" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{&quot;0&quot;:[235,199,43]},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="作多意願指標" ID="f0b1c4b77aaf4146b4f365814967f97a" ReturnType="0" ExecType="1" Folder="/大盤指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:length1(20,"長天期"),length2(9,"短天期");

variable:count1(0),x1(0);

count1=0;
for x1=1 to length2-1 begin
	if high < close*1.01 then 
		count1=count1+1;
	if open > close[1]*1.005 then
		count1=count1+1;
	if close > close[1] and volume>volume[1] then
		count1=count1+1;
	if GetField("外盤量") > GetField("內盤量") then
		count1=count1+1;
end;


value2=average(count1,length1);
value3=average(count1,length2);

plot1(value2,"長期意願");
plot2(value3,"短期意願");


]]></Code>
<Arg><![CDATA[<Arg seed="775d8cc3-3af8-439c-acb1-9283f5c78569" version="1"><Param name="長天期" varname="length1" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="短天期" varname="length2" type="1" subtype="0" value="9" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="5bd8954a-e74e-4155-95bb-55ea5051ff39" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="長期意願" number="1" type="0" color="5275903" color2="5275903" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /><Plot name="短期意願" number="2" type="0" color="255" color2="255" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="13" />
<script>
<freq support="8;11" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{&quot;0&quot;:[21,20]},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="LRR線性迴歸反轉指標" ID="a33223bbca00486ea41228a61d4bcd33" ReturnType="0" ExecType="3" Folder="/技術指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:period(10,"期數");

variable:lrr(0);

value1=linearregslope(close,period);
if value1>value1[1] then
	lrr=1
else
	lrr=-1;

plot1(lrr,"線性迴歸反轉指標");]]></Code>
<Arg><![CDATA[<Arg seed="305e77e0-f007-4bd4-83cc-e9f0938dba97" version="1"><Param name="期數" varname="period" type="1" subtype="0" value="10" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="f97727e6-2cd1-4ee9-83c7-80cd90cd5a67" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="線性迴歸反轉指標" number="1" type="0" color="5275903" color2="5275903" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,8c2d025a23c548d3a76fba10c22527b4;1,210d0786cfe340538e34c095bc2ba049;1,626e6e5c42304bbea9809d1a07ae4e01</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="2" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="內外盤量差" ID="a352d8bfffa7493282ded046a4a0d5bd" ReturnType="0" ExecType="3" Folder="/大盤指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[{
指標說明
https://xstrader.net/內外盤量比在預測大盤後市上的應用/
收錄於「三週學會程式交易：打造你的第一筆自動化交易」242頁
https://www.ipci.com.tw/books_in.php?book_id=724
}

if barfreq = "Tick" or barfreq = "Min" then 
begin
	value1=GetField("內盤量");//單位:元
	value2=GetField("外盤量");//單位:元
end else begin
	value1=GetField("內盤量","D");//單位:元
	value2=GetField("外盤量","D");//單位:元
end;

if volume <> 0 then begin
	value3=value2/volume*100;//外盤量比
	value4=value1/volume*100;//內盤量比
end else begin
	value3=value3[1];
	value4=value4[1];
end;

value5=average(value3,5);
value6=average(value4,5);
value7=value5-value6+5;
plot1(value7,"內外盤量比差");



]]></Code>
<Arg><![CDATA[<Arg seed="8e3764e3-7195-4ba4-b27d-224eee099d59" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="2b064a73-03b3-4cd6-aaf4-da260caa699f" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="內外盤量比差" number="1" type="1" color="255" color2="62464" style="3" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="23" />
<script>
<freq support="8;11" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{&quot;0&quot;:[20,21],&quot;8&quot;:[20,21]},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="BW MFI" ID="357dfe1989794591983f704fc7cb1def" ReturnType="0" ExecType="3" Folder="/技術指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[{
指標說明
Market Facilitation Index
}

if volume <> 0 then
	value1=(high-low)/volume;
if value1>value1[1] and volume>volume[1] then begin
	plot1(volume,"綠燈");
	noplot(2);
	noplot(3);
	noplot(4);
end;
if value1>value1[1] and volume<=volume[1] then begin
	plot2(volume,"偽裝");
	noplot(1);
	noplot(3);
	noplot(4);
end;
if value1<=value1[1] and volume>volume[1] then begin
	plot3(volume,"蟄伏");
	noplot(1);
	noplot(2);
	noplot(4);
end;
if value1<=value1[1] and volume<=volume[1] then begin
	plot4(volume,"衰退");
	noplot(1);
	noplot(2);
	noplot(3);
end;
]]></Code>
<Arg><![CDATA[<Arg seed="bb2982f5-b3c7-4344-bebe-885b9e65efdc" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="800de134-4b87-4a3c-9c9e-7e38b505291d" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="綠燈" number="1" type="1" color="65280" color2="5275903" style="0" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /><Plot name="偽裝" number="2" type="1" color="16711935" color2="255" style="0" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /><Plot name="蟄伏" number="3" type="1" color="16711680" color2="65280" style="0" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /><Plot name="衰退" number="4" type="1" color="255" color2="14680319" style="0" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="1" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="DBCD 異同離差乖離率 " ID="b18ccfff1a7a474f85faa67733ae1702" ReturnType="0" ExecType="1" Folder="/技術指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[{
指標說明
https://xstrader.net/異同離差乖離率dbcd在單一國家股票型基金的應用/
}

input:
	length1(10,"短天期"),
	length2(20,"長天期"),
	length3(14,"平均天期");

value1=bias(length1);
value2=bias(length2);
value3=value2-value1;
value4=average(value3,length3);
plot1(value4,"DBCD");]]></Code>
<Arg><![CDATA[<Arg seed="e1cdd615-51d6-4bdc-b1ac-530336d1c034" version="1"><Param name="短天期" varname="length1" type="1" subtype="0" value="10" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="長天期" varname="length2" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="平均天期" varname="length3" type="1" subtype="0" value="14" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="b12ad027-b0a6-4ec6-b07e-dbb6b343ed93" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="DBCD" number="1" type="0" color="5275903" color2="5275903" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c;1,aa300d6ee3de439ea5eeb2f9ff3a7ed2</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="4" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="台灣50MTM多方家數" ID="9b9363af71bf493babefa40af10dad76" ReturnType="0" ExecType="1" Folder="/市場動能/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[{統計台灣50成分股內, Momentum(10) > 0的家數.
Momentum(N) = 目前價格 - N筆資料前的Close。}

if barfreq <> "Min" then raiseruntimeerror("僅支援「分鐘」頻率");

value1 = GetSymbolField("TSE50.SJ","TW50MTM多空家數");

plot1(value1,"台灣50MTM多方家數");]]></Code>
<Arg><![CDATA[<Arg seed="508113d6-9a9c-4f13-8155-5cf1a3743dce" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="a6786fc8-7861-44c5-8acc-49dd1a2f3afc" version="1">
	<Axises>
		<Axis value="1" align="2" min="0.000000" max="50.000000" SetMin="1" SetMax="1" mpvalue="0.000000" />
		<Axis value="2" align="0" min="-100.000000" max="100.000000" SetMin="1" SetMax="1" mpvalue="0.000000" />
	</Axises>
	<Plot name="台灣50MTM多方家數" number="1" type="1" color="255" color2="5275903" DecimalFormat="1" checkbox="-1" colors="," offset="0" />

</Plots>]]></Plots>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="6" />
<script>
<freq support="8;11" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{&quot;TSE50.SJ&quot;:{&quot;0&quot;:[884]}}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="營收" ID="1632a74a243649f7ab40b2c7fb3a0a32" ReturnType="0" ExecType="1" Folder="/籌碼高手/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[condition999 = symbolexchange = "TW" or symbolexchange = "TE";//台股+興櫃
condition998 = condition999 = true and (symboltype = 2 or symboltype = 1);//個股+興櫃+類股

if condition998 = false //個股+興櫃+類股
	then raiseruntimeerror("不支援此商品");

if barfreq = "Tick" or barfreq = "Min" or barfreq = "Q" or barfreq = "H" or barfreq = "Y"
	then raiseruntimeerror("不支援此頻率");

plot1(GetField("月營收","M")*100000000,"月營收",axis:=1,ScaleLabel:=sltypewy,ScaleDecimal:=sd2);			//單位：張
]]></Code>
<Arg><![CDATA[<Arg seed="263f0875-9d64-4c0c-a807-021b83fb4d2f" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="837443d4-d0d1-4e8c-8687-59b1d9c90921" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="月營收" number="1" type="1" color="255" color2="62464" style="4" weight="0" axis="0" DecimalFormat="3" NumFormat="3" checkbox="-1" SetDecimalFormat="1" SetNumFormat="1" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="6" />
<script>
<freq support="10;8;9;11;12;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{&quot;10&quot;:[242]},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="週DMI" ID="c3d3dc18baec4e5ab0bbd29260cf2e90" ReturnType="0" ExecType="3" Folder="/跨頻率指標/" StatusMask="2">
<Desc><![CDATA[畫出週趨向指標]]></Desc>
<Code><![CDATA[// 跨頻率週DMI指標
// 不支援大頻率跨小頻率，例如：
// 不支援主頻率週資料，跨頻率計算日DMI技術指標。
//
if barfreq <> "Tick" and barfreq <> "Min" and barfreq <> "D" and barfreq <> "W" and barfreq <> "AD" and barfreq <> "AW" then raiseruntimeerror("不支援大頻率跨小頻率");

input: Length(14);
variable: pdi_value(0), ndi_value(0), adx_value(0);

SetInputName(1, "天數");

xf_DirectionMovement("W", Length, pdi_value, ndi_value, adx_value);

// 初始區波動較大, 先不繪出
//
if CurrentBar < Length then
 begin
	pdi_value = 0;
	ndi_value = 0;
	adx_value = 0;
 end;
 
Plot1(pdi_value, "週+DI");
Plot2(ndi_value, "週-DI");
Plot3(adx_value, "週ADX");


		]]></Code>
<Arg><![CDATA[<Arg seed="12a54207-ea61-417c-b572-d4bff69130b5" version="1"><Param name="天數" varname="Length" type="1" subtype="0" value="14" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="6a58b39b-9e5d-44c9-93e5-0e8f5d030ca6"><Plot name="週+DI" number="1" type="0" color="5275903" color2="0" style="0" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /><Plot name="週-DI" number="2" type="0" color="255" color2="0" style="0" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /><Plot name="週ADX" number="3" type="0" color="65280" color2="0" style="0" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,57f222578a2c4d17b2b88b65b8f28696;1,d6c8ec6b762c4f47b2ad9bfd806fea5f;1,a46fc11bfc3a4c45abfb6011b2be5b5a</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="20" />
<ScriptComplexity val="2" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="快速KD 隨機指標" ID="e8e5e6feb64b4b2ea3414ac0221ae28d" ReturnType="0" ExecType="3" Folder="/XQ技術指標/" StatusMask="2">
<Desc><![CDATA[畫出快速隨機指標]]></Desc>
<Code><![CDATA[// XQ: 快速KD指標
//
input: Length(9), RSVt(3);
variable: rsv(0), k(0), _d(0);

SetInputName(1, "天數");
SetInputName(2, "RSVt權數");

Stochastic(Length, RSVt, 3, rsv, k, _d);

Plot1(rsv, "K(%)");
Plot2(k, "D(%)");
		]]></Code>
<Arg><![CDATA[<Arg seed="b06f17b3-a850-4831-94d3-d5314a6e0ac6" version="1"><Param name="天數" varname="Length" type="1" subtype="0" value="9" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="RSVt權數" varname="RSVt" type="1" subtype="0" value="3" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="097c4f55-2c78-4f58-84f3-d622cd91969f" version="1"><Axises><Axis value="1" align="2" min="0" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="K(%)" number="1" type="0" color="5275903" color2="0" style="0" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /><Plot name="D(%)" number="2" type="0" color="255" color2="0" style="0" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,61c06064ad98469db9ce30287ae4a2c8;1,2bca774c6b7549c1b0b008d2a54b288e;1,f1b429ac13b2447c909302198c18ca56;1,847bcd706dda4a9caf2b783e181a8e42</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="2" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="CVI(累計成交量指標)" ID="24178337e08b448bb53177c3154e5e20" ReturnType="0" ExecType="3" Folder="/XQ量能指標/" StatusMask="2">
<Desc><![CDATA[累計成交量指標
註:只適用於大盤指數/台股指數商品]]></Desc>
<Code><![CDATA[// XQ: CVI指標
//
variable: _cvi(0);

If CurrentBar > 1 then
	_cvi = _cvi[1] + GetField("UpVolume") - GetField("DownVolume");

Plot1(_cvi, "CVI");
]]></Code>
<Arg><![CDATA[<Arg seed="91129980-2bf7-483d-a543-ea6a6a8ba8d7" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="2fde8cb1-9200-4581-bb21-7332123218ff" version="1"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="CVI" number="1" type="0" color="5275903" color2="0" style="0" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<Extra><![CDATA[<Extra>
<TotalBar val="100" />
<Maxbb val="1" />
<ScriptComplexity val="11" />
<script>
<freq support="8;11" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{&quot;0&quot;:[71,72]},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="大盤儀表板" ID="6fbcba47a206473e8ece64cc2a58df98" ReturnType="0" ExecType="3" Folder="/大盤指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[{
指標說明
https://xstrader.net/進場點一目了然的大盤儀表板/
收錄於「三週學會程式交易：打造你的第一筆自動化交易」 260頁
https://www.ipci.com.tw/books_in.php?book_id=724
}

if barfreq <> "D" then raiseruntimeerror("不支援此頻率");

condition1=false;
condition2=false;
condition3=false;
condition4=false;
condition5=false;

//==========OTC 佔大盤成交量比================
value1=GetSymbolField("tse.tw","成交量");
value2=GetSymbolField("otc.tw","成交量");
value3=value2/value1*100;
value4=average(value3,5);
value5=low*0.98;
if value4 crosses over 20 then
	condition1=true;
if condition1 then
	plot1(value5,"OTC 進場訊號");

//============內外盤量比差====================
value6=GetField("內盤量");//單位:元
value7=GetField("外盤量");//單位:元
value8=value7/volume*100;//外盤量比
value9=value6/volume*100;//內盤量比
value10=average(value8,5);
value11=average(value9,5);
value7=value10-value11+5;
if value7 crosses over 0 then 
	condition2=true;
if condition2 then 
	plot2(value5*0.98,"內外盤量比差");

//===========上漲下跌家數 RSI 指標==============
input: _TEXT1("===============","上漲下跌家數RSI指標參數");
input:period(10,"RSI計算天數");
value12=GetField("上漲家數");
value13=GetField("下跌家數");
value14=value12-value13;
value15=summation(value14,period);
value16=rsi(value15,period);
if value16 crosses over 50 then
	condition3=true;
if condition3 then
	plot3(value5*0.97,"上漲下跌家數 RSI");

//===========上漲家數突破 200 檔================
value17=lowest(value12,5);
value18=average(value17,15);
if value18 crosses over 200 then
	condition4=true;
if condition4=true then
	plot4(value5*0.96,"上漲家數突破 200 家");

//==========上漲下跌量指標=====================
input: _TEXT2("===============","上漲下跌量指標參數");
input:p1(3,"上漲下跌量平均天數");
value19=GetField("上漲量");
value20=GetField("下跌量");
value21=average(value19,period);
value22=average(value20,period);
value23=value21-value22;
value24=average(value23,5);
if value24 crosses over 0 then
	condition5=true;
if condition5=true then
	plot5(value5*0.95,"上漲量突破下跌量");




]]></Code>
<Arg><![CDATA[<Arg seed="88069573-013b-4b28-9abb-1ce49afb662f" version="1"><Param name="上漲下跌家數RSI指標參數" varname="_TEXT1" type="3" subtype="0" value="===============" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="RSI計算天數" varname="period" type="1" subtype="0" value="10" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="上漲下跌量指標參數" varname="_TEXT2" type="3" subtype="0" value="===============" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="上漲下跌量平均天數" varname="p1" type="1" subtype="0" value="3" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="6a7279da-4c61-42ca-89d6-d79c895c661d" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="OTC 進場訊號" number="1" type="2" color="39423" color2="5275903" style="2" weight="1" axis="10002" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /><Plot name="內外盤量比差" number="2" type="2" color="255" color2="255" style="2" weight="1" axis="10002" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /><Plot name="上漲下跌家數 RSI" number="3" type="2" color="16711680" color2="65280" style="2" weight="1" axis="10002" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /><Plot name="上漲家數突破 200 家" number="4" type="2" color="16711833" color2="14680319" style="2" weight="1" axis="10002" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /><Plot name="上漲量突破下跌量" number="5" type="2" color="16711935" color2="65535" style="2" weight="1" axis="10002" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c;1,6850ead727a842bf883a1501d030ba98;1,d64c2a71d3ea43d985ca22ef62a5a8de;1,61c06064ad98469db9ce30287ae4a2c8;1,f1b429ac13b2447c909302198c18ca56</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="56" />
<script>
<freq support="8;11" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{&quot;0&quot;:[20,21,79,80,71,72]},&quot;symbol_freq_field&quot;:{&quot;TSE.TW&quot;:{&quot;0&quot;:[9]},&quot;OTC.TW&quot;:{&quot;0&quot;:[9]}}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="控盤者成本線" ID="9c4dd3732cfb4554be96d1851e66e447" ReturnType="0" ExecType="1" Folder="/籌碼指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[if barfreq = "Tick" or barfreq = "Min"
	then raiseruntimeerror("不支援此頻率");
	
value1=GetField("控盤者成本線");
plot1(value1,"控盤者成本線");

]]></Code>
<Arg><![CDATA[<Arg seed="0a694104-f88f-4948-961f-6175f96d57ea" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="f2285f78-bfcc-4898-b585-926dba23e717" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="控盤者成本線" number="1" type="0" color="5275903" color2="5275903" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="6" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{&quot;0&quot;:[90]},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="多方力道線" ID="915e32a6267b44cfb9bd1938a483eef9" ReturnType="0" ExecType="1" Folder="/技術指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:
	period1(10,"計算期數"),
	period2(5,"平滑期數");

value1=summation(high-close,period1);//上檔賣壓
value2=summation(close-open,period1); //多空實績
value3=summation(close-low,period1);//下檔支撐
value4=summation(open-close[1],period1);//隔夜力道
if close<>0 then
	value5=(value2+value3+value4-value1)/close;
value6=average(value5,period2);

plot1(value6,"多方力道");
]]></Code>
<Arg><![CDATA[<Arg seed="6c19aec1-6aab-4c36-a5f1-dab31d0263ee" version="1"><Param name="計算期數" varname="period1" type="1" subtype="0" value="10" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="平滑期數" varname="period2" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="85415ae8-38e3-4600-b188-22e2a23f0da2" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="多方力道" number="1" type="0" color="5275903" color2="5275903" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="6" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="Aroon" ID="7aa8b192f2684f9f8c811f8b63c428e5" ReturnType="0" ExecType="3" Folder="/技術指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:length(25); setinputname(1, "計算週期");
   
variable: aroon_up(0), aroon_down(0), aroon_oscillator(0);   

aroon_up = (length-nthhighestbar(1,high,length))/length*100;   
aroon_down = (length-nthlowestbar(1,low,length))/length*100;   
aroon_oscillator=aroon_up-aroon_down;   

plot1(aroon_up,"aroon_up");   
plot2(aroon_down,"aroon_down");   
plot3(aroon_oscillator,"aroon_oscillator");  
]]></Code>
<Arg><![CDATA[<Arg seed="56f3c0c3-db40-4393-b6d1-0d87084b7f90" version="1"><Param name="計算週期" varname="length" type="1" subtype="0" value="25" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="f22366e6-7879-47d4-97eb-cf60289a8ffd" version="1"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="aroon_up" number="1" type="0" color="13311" color2="0" style="0" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /><Plot name="aroon_down" number="2" type="0" color="65280" color2="0" style="0" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /><Plot name="aroon_oscillator" number="3" type="1" color="6724044" color2="0" style="0" weight="0" axis="1" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,f2404d9ffb2f49b3a38c431fcfc254b5;1,de75aec76c414cb0b78812a623b506e8;1,6bbc72256c3d4dbd9c7b3abd21a0be15</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="50" />
<Maxbb val="30" />
<ScriptComplexity val="3" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="台灣50大單成交次數" ID="ae7cfeaaa3634402a872ed36b10cf2e4" ReturnType="0" ExecType="1" Folder="/市場動能/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[{統計台灣50成分股, 近10分鐘(買進大單次數+買進特大單次數)的平均值}

if barfreq <> "Min" then raiseruntimeerror("僅支援「分鐘」頻率");

value1 = GetSymbolField("TSE50.SJ","TW50大單成交次數");

plot1(value1,"台灣50大單成交次數");]]></Code>
<Arg><![CDATA[<Arg seed="83311ea3-c43e-4221-bb4c-ca44d39ef358" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="bc083c1d-8618-4110-baee-a705964a8bd3" version="1">
	<Axises>
		<Axis value="1" align="0" min="-100.000000" max="100.000000" SetMin="1" SetMax="1" mpvalue="0.000000" />
		<Axis value="2" align="0" min="-100.000000" max="100.000000" SetMin="1" SetMax="1" mpvalue="0.000000" />
	</Axises>
	<Plot name="台灣50大單成交次數" number="1" type="1" color="255" color2="5275903" DecimalFormat="1" checkbox="-1" colors="," offset="0" />

</Plots>]]></Plots>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="6" />
<script>
<freq support="8;11" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{&quot;TSE50.SJ&quot;:{&quot;0&quot;:[889]}}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="DMI" ID="ccd02a0e9b794eb390504dc3fbdcba5b" ReturnType="0" ExecType="3" Folder="/技術指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[{
指標說明
https://xstrader.net/787/
}

input:length(10,"期數");

variable: pdi_value(0), ndi_value(0), adx_value(0);

DirectionMovement(Length, pdi_value, ndi_value, adx_value);
value1=pdi_value-ndi_value;

plot1(pdi_value,"向上力量");
plot2(ndi_value,"向下力量");
plot3(value1,"多空力道差");

]]></Code>
<Arg><![CDATA[<Arg seed="50b4e55e-0642-48ed-b3ca-df84cdac9c16" version="1"><Param name="期數" varname="length" type="1" subtype="0" value="10" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="4ff437be-c369-483f-b738-3acbbcd2fdad" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="向上力量" number="1" type="0" color="255" color2="5275903" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /><Plot name="向下力量" number="2" type="0" color="65280" color2="255" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /><Plot name="多空力道差" number="3" type="1" color="16711680" color2="65280" style="0" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,7721dca8cc7242c09d21b782bbb59bd9</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="2" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="自營商" ID="5fb77f475f834d22ba1ec12218dfd3cc" ReturnType="0" ExecType="1" Folder="/籌碼高手/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input: _input1(1,"自營商",inputkind:= Dict(["全部",1],["自行買賣",2],["避險",3]),quickedit:=true);

condition999 = symbolexchange = "TW" or symbolexchange = "TE";//台股+興櫃
condition994 = symbol = "TSE.TW" or symbol = "TWSE.FS" or symbol = "OTC.TW";//大盤
condition993 = symbolexchange = "TW" and symboltype = 1;//類股

if condition999 = false and condition994 = false//大盤, 個股, 權證, 興櫃, 類股指數
	then raiseruntimeerror("不支援此商品");

if barfreq = "Tick" or barfreq = "Min"
	then raiseruntimeerror("不支援此頻率");

if condition994 then begin
	switch (_input1)
	begin
		case 2:
			value1 = GetField("自營商自行買賣買進金額");
			value2 = GetField("自營商自行買賣賣出金額");
			value3 = GetField("自營商自行買賣買賣超金額");
			value4 = value4 + GetField("自營商自行買賣買賣超金額");
		case 3:
			value1 = GetField("自營商避險買進金額");
			value2 = GetField("自營商避險賣出金額");
			value3 = GetField("自營商避險買賣超金額");
			value4 = value4 + GetField("自營商避險買賣超金額");
		default:
			value1 = GetField("自營商買進金額");
			value2 = GetField("自營商賣出金額");
			value3 = GetField("自營商買賣超金額");
			value4 = value4 + GetField("自營商買賣超金額");
	end;
	plot2(value4,"自營商累計買賣超",checkbox:=1,axis:=2,ScaleLabel:=sltypewy,ScaleDecimal:=sdauto); //line，axis1
	setplotlabel(1,"買賣超(元)");
	setplotlabel(2,"自營商累計買賣超(元)");
	setplotlabel(3,"買進(元)");
	setplotlabel(4,"賣出(元)");
	plot1(value3,"買賣超",checkbox:=1,axis:=1,ScaleLabel:=sltypewy,ScaleDecimal:=sdauto); //bar，axis2
	plot3(value1,"買進",checkbox:=0,axis:=11,ScaleLabel:=sltypewy,ScaleDecimal:=sdauto); //line，axis2
	plot4(value2,"賣出",checkbox:=0,axis:=11,ScaleLabel:=sltypewy,ScaleDecimal:=sdauto); //line，axis2
end else begin
	switch (_input1)
	begin
		case 2:
			if symbolexchange <> "TE" and condition993 = false then begin
				value1 = GetField("自營商自行買賣買張");
				value2 = GetField("自營商自行買賣賣張");
			end;
			value3 = GetField("自營商自行買賣買賣超");
		case 3:
			if symbolexchange <> "TE" and condition993 = false then begin
				value1 = GetField("自營商避險買張");
				value2 = GetField("自營商避險賣張");
			end;
			value3 = GetField("自營商避險買賣超");
		default:
			if symbolexchange <> "TE" and condition993 = false then begin
				value1 = GetField("自營商買張");
				value2 = GetField("自營商賣張");
			end;
			value3 = GetField("自營商買賣超張數");
	end;
	plot2(GetField("自營商持股"),"自營商持股",checkbox:=1,axis:=2,ScaleLabel:=slfull,ScaleDecimal:=sd0); //line，axis1
	setplotlabel(1,"買賣超(張)");
	setplotlabel(2,"自營商持股(張)");
	setplotlabel(3,"買進(張)");
	setplotlabel(4,"賣出(張)");
	if condition993 = false then begin
		plot5(0.01*GetField("自營商持股比例"),"自營商持股比例",axis:=12,ScaleLabel:=slpercent,ScaleDecimal:=sd2);
	end;
	plot1(value3,"買賣超",checkbox:=1,axis:=1,ScaleLabel:=slfull,ScaleDecimal:=sd0); //bar，axis2
	if symbolexchange <> "TE" and condition993 = false then begin
		plot3(value1,"買進",checkbox:=0,axis:=11,ScaleLabel:=slfull,ScaleDecimal:=sd0); //line，axis2
		plot4(value2,"賣出",checkbox:=0,axis:=11,ScaleLabel:=slfull,ScaleDecimal:=sd0); //line，axis2
	end;
end;

]]></Code>
<Arg><![CDATA[<Arg seed="82e1eef6-b56a-4ba9-8bbd-3c7c0ac00336" version="1"><Param name="自營商" varname="_input1" type="1" subtype="0" value="1" isSerial="0" isArray="0" isRef="0" inputkind="1" quickedit="1" keytype="3"><Pair key="全部" value="1" /><Pair key="自行買賣" value="2" /><Pair key="避險" value="3" /></Param></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="c4116d98-0ae2-4b87-9aee-c67edc70b0b6" version="0"><Axises><Axis value="1" align="1" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="買賣超" number="1" type="1" color="255" color2="62464" style="3" weight="0" axis="0" DecimalFormat="1" NumFormat="1" checkbox="1" SetDecimalFormat="1" SetNumFormat="1" colors="," offset="0" /><Plot name="自營商持股" number="2" type="0" color="39423" color2="62464" style="0" weight="0" axis="1" DecimalFormat="1" NumFormat="1" checkbox="1" SetDecimalFormat="1" SetNumFormat="1" colors="," offset="0" /><Plot name="買進" number="3" type="0" color="16711935" color2="65280" style="0" weight="0" axis="10" DecimalFormat="1" NumFormat="1" checkbox="0" SetDecimalFormat="1" SetNumFormat="1" colors="," offset="0" /><Plot name="賣出" number="4" type="0" color="65280" color2="14680319" style="0" weight="0" axis="10" DecimalFormat="1" NumFormat="1" checkbox="0" SetDecimalFormat="1" SetNumFormat="1" colors="," offset="0" /><Plot name="自營商持股比例" number="5" type="0" color="65535" color2="65535" style="5" weight="0" axis="11" DecimalFormat="3" NumFormat="2" checkbox="-1" SetDecimalFormat="1" SetNumFormat="1" colors="," offset="0" /></Plots>]]></Plots>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="116" />
<script>
<freq support="8;11" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{&quot;0&quot;:[253,254,255,256,257,258,111,112,110,208,209,207,211,212,210,37,38,188,39,40]},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="整體籌碼收集指標" ID="3ac6dc88c6aa4885a2147f61c235a887" ReturnType="0" ExecType="3" Folder="/籌碼指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[{
指標說明
https://xstrader.net/一個交易策略的熟成-2/
}

input:Period(5,"MA期數");

if barfreq = "Tick" or barfreq = "Min"
	then raiseruntimeerror("不支援此頻率");
	
value1=GetField("現股當沖張數","D");
value2=GetField("外資買賣超","D");
value3=GetField("投信買賣超","D");
value4=GetField("自營商買賣超","D");
value5=GetField("主力買賣超張數","D");
value6=GetField("融資增減張數","D");
value7=GetField("融券增減張數","D");
value8=volume-value1;//當日淨交易張數
value9=value2+value3+value4+value5-value6+value7;

//籌碼收集張數
if value8<>0 then 
	value10=value9/value8*100
else
	value10=value10[1];

value11=average(value10,Period);
plot1(value11,"集中度");]]></Code>
<Arg><![CDATA[<Arg seed="17bf4db8-ccfa-440a-8493-41748f2508b6" version="1"><Param name="MA期數" varname="Period" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="9b2f14a8-d69e-43a1-b01f-de2f34a4a466" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="集中度" number="1" type="0" color="5275903" color2="5275903" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="37" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{&quot;8&quot;:[184,29,36,41,54,43,44]},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="關鍵券商買賣超" ID="7a2b6104684d437fa2175b2590594514" ReturnType="0" ExecType="1" Folder="/籌碼高手/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[condition999 = symbolexchange = "TW";//台股

if condition999 = false //個股
	then raiseruntimeerror("不支援此商品");

if barfreq <> "D" and barfreq <> "AD"
	then raiseruntimeerror("不支援此頻率");

value1 = GetField("關鍵券商買賣超張數");
value2 += value1;
plot1(value1,"買賣超",checkbox:=1,axis:=2,ScaleLabel:=sltypewy,ScaleDecimal:=sd0); //bar，axis2
plot2(value2,"關鍵券商累計買賣超",checkbox:=1,axis:=1,ScaleLabel:=sltypewy,ScaleDecimal:=sd0); //line，axis1

]]></Code>
<Arg><![CDATA[<Arg seed="d48322df-3641-4565-9ee0-0b57d2c54369" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="e61574ae-678f-4751-ae70-7cfce61982fe" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="買賣超" number="1" type="1" color="255" color2="65280" style="3" weight="0" axis="1" DecimalFormat="1" NumFormat="3" checkbox="1" SetDecimalFormat="1" SetNumFormat="1" colors="," offset="0" /><Plot name="關鍵券商累計買賣超" number="2" type="0" color="65535" color2="255" style="0" weight="0" axis="0" DecimalFormat="1" NumFormat="3" checkbox="1" SetDecimalFormat="1" SetNumFormat="1" colors="," offset="0" /></Plots>]]></Plots>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="6" />
<script>
<freq support="8;11" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{&quot;0&quot;:[231]},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="融券均價線" ID="4a068a6b0205420ca2560d03003c4664" ReturnType="0" ExecType="3" Folder="/主圖指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[Input: period(20);	setinputname(1, "期間(天)");

if barfreq = "Tick" or barfreq = "Min"
	then raiseruntimeerror("不支援此頻率");

variable: avg(0);

if GetField("Volume") > 0 then 
	Value3 = GetField("融券賣出張數")*GetField("成交金額")/(GetField("Volume")*1000)
else
	Value3 = 0;

Value1 = summation(Value3, period);
Value2 = summation(GetField("融券賣出張數"), period);
 
if Value2 > 0 and Value2 <> Value2[1] then avg = Value1 / Value2;

Plot1(avg, "融券賣出均價");

]]></Code>
<Arg><![CDATA[<Arg seed="b8fb42b2-3739-496c-bb9d-9786a071f129" version="1"><Param name="期間(天)" varname="period" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="5044a713-ca56-4286-9ed3-7b2195158291" version="0"><Axises><Axis value="1" align="3" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="融券賣出均價" number="1" type="0" color="5275903" color2="0" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="28" />
<script>
<freq support="8;11;9;12;10;13" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{&quot;0&quot;:[9,173,19]},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="動量指標" ID="6c765043d442444ca3e7f410126ad932" ReturnType="0" ExecType="1" Folder="/技術指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[{
指標說明
https://xstrader.net/尋找趨勢是否成形的指標動量指標/
}

if barfreq = "Tick" or barfreq = "Min" then
begin
	value1=GetField("內盤量");//單位:元
	value2=GetField("外盤量");//單位:元
end else begin
	value1=GetField("內盤量","D");//單位:元
	value2=GetField("外盤量","D");//單位:元
end;
value3=(high+low)/2;//計算當天波動的平均價位
//質量就是內外盤差乘均價
if value2>value1 then
	value4=value3*(value2-value1)
else
	value4=value3*(value1-value2);
if close>=close[1] then begin //(方向是往上)
	value5=(close-close[1])/close[1]*value4;//質量乘以速度
	value6=0;
end else begin//(方向是往下)
	value5=0;
	value6=(close[1]-close)/close[1]*value4;
end;
value8=average(value5,2);
value9=average(value6,2);
value10=value8-value9;

plot1(value10,"動能差");






]]></Code>
<Arg><![CDATA[<Arg seed="43ce0e49-a0bc-490c-8267-df5ebd99b48b" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="d597d023-bf15-4c34-9e0d-ba0f50cfe8cd" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="動能差" number="1" type="0" color="5275903" color2="5275903" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="23" />
<script>
<freq support="8;11" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{&quot;0&quot;:[20,21],&quot;8&quot;:[20,21]},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="分公司交易家數" ID="d6c54703775a460a90439a811347d382" ReturnType="0" ExecType="1" Folder="/籌碼高手/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[condition999 = symbolexchange = "TW" or symbolexchange = "TE";//台股+興櫃
condition997 = condition999 and (symboltype = 2 or symboltype = 4);//個股+權證+興櫃

if condition997 = false //個股+權證+興櫃
	then raiseruntimeerror("不支援此商品");


if barfreq <> "D" and barfreq <> "AD" 
	then raiseruntimeerror("不支援此頻率");

if GetField("市場總分點數") <> 0 then value1 = GetField("分公司交易家數")/GetField("市場總分點數");

plot1(GetField("分公司交易家數"),"交易家數",checkbox:=1,axis:=1,ScaleLabel:=slfull,ScaleDecimal:=sd0);//單位：家
plot2(value1,"參與率",checkbox:=0,axis:=2,ScaleLabel:=slpercent,ScaleDecimal:=sd2);//請RD加"市場總分點數"
plot3(GetField("分公司買進家數"),"買進家數",checkbox:=0,axis:=1,ScaleLabel:=slfull,ScaleDecimal:=sd0);//單位：家，可勾選畫圖選項 (參數設定) 
plot4(GetField("分公司賣出家數"),"賣出家數",checkbox:=0,axis:=1,ScaleLabel:=slfull,ScaleDecimal:=sd0);//單位：家，可勾選畫圖選項 (參數設定) ]]></Code>
<Arg><![CDATA[<Arg seed="ffb68c20-a0e8-48ce-8c2d-cc92eb909601" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="0c2d0fa0-9b67-4a32-986e-4981de0ba8e8" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="交易家數" number="1" type="1" color="5275903" color2="5275903" style="0" weight="0" axis="0" DecimalFormat="1" NumFormat="1" checkbox="1" SetDecimalFormat="1" SetNumFormat="1" colors="-1,-1" offset="0" /><Plot name="參與率" number="2" type="0" color="255" color2="255" style="0" weight="0" axis="1" DecimalFormat="3" NumFormat="2" checkbox="0" SetDecimalFormat="1" SetNumFormat="1" colors="-1,-1" offset="0" /><Plot name="買進家數" number="3" type="0" color="16711935" color2="65280" style="0" weight="0" axis="0" DecimalFormat="1" NumFormat="1" checkbox="0" SetDecimalFormat="1" SetNumFormat="1" colors="-1,-1" offset="0" /><Plot name="賣出家數" number="4" type="0" color="65280" color2="14680319" style="0" weight="0" axis="0" DecimalFormat="1" NumFormat="1" checkbox="0" SetDecimalFormat="1" SetNumFormat="1" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="31" />
<script>
<freq support="8;11" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{&quot;0&quot;:[214,164,176,177]},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="PSY 心理線" ID="9c6c2dafc89443bc9e7c05592f6b8509" ReturnType="0" ExecType="3" Folder="/XQ技術指標/" StatusMask="2">
<Desc><![CDATA[畫出心理線]]></Desc>
<Code><![CDATA[// XQ: 心理線
//
input: Length1(12), Length2(24);

SetInputName(1, "天數一");
SetInputName(2, "天數二");

Value1 = 100 * CountIf(Close > Close[1], Length1) / Length1;
Value2 = 100 * CountIf(Close > Close[1], Length2) / Length2;

Plot1(Value1, "PSY1");
Plot2(Value2, "PSY2");


        
		]]></Code>
<Arg><![CDATA[<Arg seed="eebf2b90-f6c8-4e93-8e39-b4dadaa9830c" version="1"><Param name="天數一" varname="Length1" type="1" subtype="0" value="12" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="天數二" varname="Length2" type="1" subtype="0" value="24" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="f18d3858-1a8b-46f3-ba37-4bd33b012b17" version="1"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="PSY1" number="1" type="0" color="5275903" color2="0" style="0" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /><Plot name="PSY2" number="2" type="0" color="255" color2="0" style="0" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,d80cf92ddfcc42e0a6c53ec47edebd49</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="50" />
<Maxbb val="25" />
<ScriptComplexity val="3" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="CR指標" ID="9a6d3cba3a2f4bab802beb626646d845" ReturnType="0" ExecType="3" Folder="/技術指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:Length(26,"N日累積");
variable:Upsum(0),Downsum(0),CR(0); 
 
Upsum =  summation(high - WeightedClose[1],Length);
Downsum = summation(WeightedClose[1] - low,Length); 
 
if Downsum <> 0 then
	CR = Upsum / Downsum *100
else
	CR = CR[1]; 
 
plot1(CR,"CR(%)");]]></Code>
<Arg><![CDATA[<Arg seed="28788c70-2760-4796-aa37-270ad2b2fed0" version="1"><Param name="N日累積" varname="Length" type="1" subtype="0" value="26" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="0e7db8c7-55e6-49f9-897f-4d5a4618d084"><Plot name="CR(%)" number="1" type="0" color="5275903" color2="5275903" style="0" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,2549534038c6445884c25787277c86db;1,c122bd6485c544f2bce8f374b5c7440d</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="20" />
<ScriptComplexity val="5" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="漲跌成交量" ID="d5befddff742427a883d441a03a52ec2" ReturnType="0" ExecType="1" Folder="/即時籌碼/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[{指標數值定義：(上漲)量 = 開盤累計到目前比前一價(上漲)的成交量的加總

支援商品：台股,大盤,類股,期貨,選擇權}

if barfreq <> "Min" and barfreq <> "D" and barfreq <> "AD" then 
	raiseruntimeerror("僅支援分鐘與日頻率（含還原）");
	
value91 = GetField("上漲量");//僅提供給有權限的用戶使用

value1 = GetField("上漲量","D");
value2 = GetField("下跌量","D");
value3 = value1 - value2;
plot1(value3,"漲跌成交");
plot2(value1,"上漲量",checkbox:=0);
plot3(value2,"下跌量",checkbox:=0);]]></Code>
<Arg><![CDATA[<Arg seed="06201751-4a37-4951-bd6b-1dfd22618fd4" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="39e70622-e6be-405a-a726-17e56918e62c" version="1">
	<Axises>
		<Axis value="1" align="0" min="-100.000000" max="100.000000" SetMin="1" SetMax="1" mpvalue="0.000000" />
		<Axis value="2" align="1" min="-100.000000" max="100.000000" SetMin="1" SetMax="1" mpvalue="0.000000" />
	</Axises>
	<Plot name="漲跌成交" number="1" type="1" style="3" color="255" color2="65280" axis="1" checkbox="-1" colors="," offset="0" />

	<Plot name="上漲量" number="2" color="16711935" color2="255" checkbox="0" colors="," offset="0" />

	<Plot name="下跌量" number="3" color="16776960" color2="65280" checkbox="0" colors="," offset="0" />

</Plots>]]></Plots>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="16" />
<script>
<freq support="8;11" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{&quot;0&quot;:[71],&quot;8&quot;:[71,72]},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="投信累計買賣超" ID="e6054b900bb94b948e9e849e825f693a" ReturnType="0" ExecType="3" Folder="/籌碼指標/" StatusMask="2">
<Desc><![CDATA[計算一段時間的投信累計買賣超張數以及占成交的比重]]></Desc>
<Code><![CDATA[input: Length(5); setinputname(1,"計算天數");
input:TXT("僅適用日線以上"); setinputname(2,"使用限制");

if barfreq = "Tick" or barfreq = "Min"
	then raiseruntimeerror("不支援此頻率");
	
variable: _buyTotal(0), volTotal(0);

_buyTotal = summation(GetField("投信買賣超"), Length);
volTotal = summation(Volume, Length);

Plot1(_buyTotal, "累計買賣超");
Plot2(_buyTotal * 100 / volTotal, "比例%");
]]></Code>
<Arg><![CDATA[<Arg seed="968e2803-4833-4ddf-9b94-4142c8a3e164" version="1"><Param name="計算天數" varname="Length" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="使用限制" varname="TXT" type="3" subtype="0" value="僅適用日線以上" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="4d5af748-a11a-4d20-bef6-b1102f4e31c4" version="1"><Axises><Axis value="1" align="1" min="-100" max="100" /><Axis value="2" align="1" min="-100" max="100" /></Axises><Plot name="累計買賣超" number="1" type="1" color="5275903" color2="0" style="0" weight="0" axis="1" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /><Plot name="比例%" number="2" type="0" color="255" color2="0" style="0" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="30" />
<Maxbb val="20" />
<ScriptComplexity val="8" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{&quot;0&quot;:[36]},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="外盤成本線" ID="8eb4885bbd2148e6995cc46ab9161ab2" ReturnType="0" ExecType="3" Folder="/主圖指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[{外盤成本線 = 累計當日買進金額(元) / 累計當日買進量*1000, 就是特大+大+中+小, 不分大小單
支援商品：台股}

value91 = GetField("買進特大單金額");//僅提供給有權限的用戶使用

if barfreq <> "Min" and barfreq <> "D" then 
	raiseruntimeerror("僅支援分鐘與日頻率");

value1 = GetField("買進特大單金額","D") + GetField("買進大單金額","D") + GetField("買進中單金額","D") + GetField("買進小單金額","D");
value2 = GetField("買進特大單量","D") + GetField("買進大單量","D") + GetField("買進中單量","D") + GetField("買進小單量","D");
if value2 <> 0 then
	value3 = value1 / (value2 * 1000)
else
	value3 = value3[1];

plot1(value3,"外盤成本線");]]></Code>
<Arg><![CDATA[<Arg seed="d9c11a13-78cc-4f06-8dce-f87a299f486f" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="73580625-bb9e-4538-a563-a584e73a2ab2" version="1">
	<Axises>
		<Axis value="1" align="0" min="-100.000000" max="100.000000" SetMin="1" SetMax="1" mpvalue="0.000000" />
		<Axis value="2" align="0" min="-100.000000" max="100.000000" SetMin="1" SetMax="1" mpvalue="0.000000" />
	</Axises>
	<Plot name="外盤成本線" number="1" color="255" color2="5275903" weight="2" checkbox="-1" colors="," offset="0" />

</Plots>]]></Plots>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="46" />
<script>
<freq support="8;11" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{&quot;0&quot;:[332],&quot;8&quot;:[332,338,344,350,331,337,343,349]},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="VRC(成交量變動指標)" ID="4e5b3f6a39cf4eb1ab8ab2abfbe407ea" ReturnType="0" ExecType="2" Folder="/XQ量能指標/" StatusMask="2">
<Desc><![CDATA[畫出成交量變動指標]]></Desc>
<Code><![CDATA[// XQ: VRC指標
//
Input: Length(12);
Variable: _vrc(0);

SetInputName(1, "天數");

if volume[Length] <> 0 then
	_vrc = 100 * (volume - volume[Length])/volume[Length]
else
	_vrc = 50;

Plot1(_vrc, "VRC");
		]]></Code>
<Arg><![CDATA[<Arg seed="56c5e0d4-a589-473d-a903-7cf1d8fe516e" version="1"><Param name="天數" varname="Length" type="1" subtype="0" value="12" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="828758f3-b394-426d-8386-5afe308e4bcd" version="1"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="VRC" number="1" type="0" color="5275903" color2="0" style="0" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<Extra><![CDATA[<Extra>
<TotalBar val="50" />
<Maxbb val="12" />
<ScriptComplexity val="1" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="吉尼系數" ID="977f9be7b1d04451b9d8f092673318e0" ReturnType="0" ExecType="1" Folder="/籌碼高手/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[condition999 = symbolexchange = "TW" or symbolexchange = "TE";//台股+興櫃
condition998 = condition999 = true and symboltype = 2;//個股+興櫃

if condition998 = false //個股+興櫃
	then raiseruntimeerror("不支援此商品");


if barfreq <> "D" and barfreq <> "AD" 
	then raiseruntimeerror("不支援此頻率");

plot1(Getfield("吉尼係數","D"),"吉尼係數",axis:=1,ScaleLabel:=slfull,ScaleDecimal:=sd2);
plot2(GetField("分公司交易家數"),"分公司交易家數",axis:=2,ScaleLabel:=slfull,ScaleDecimal:=sd0);//單位：家]]></Code>
<Arg><![CDATA[<Arg seed="72c529c3-eec4-4e60-a63f-81466821e1b4" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="7530d954-808d-4642-af58-c4db7d93d3d3" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="吉尼係數" number="1" type="0" color="5275903" color2="5275903" style="0" weight="0" axis="0" DecimalFormat="3" NumFormat="1" checkbox="-1" SetDecimalFormat="1" SetNumFormat="1" colors="-1,-1" offset="0" /><Plot name="分公司交易家數" number="2" type="0" color="255" color2="255" style="5" weight="0" axis="1" DecimalFormat="1" NumFormat="1" checkbox="-1" SetDecimalFormat="1" SetNumFormat="1" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="11" />
<script>
<freq support="8;11" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{&quot;8&quot;:[218],&quot;0&quot;:[164]},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="主力進出" ID="e69a607a4fb64353a68a51fc09789590" ReturnType="0" ExecType="1" Folder="/籌碼高手/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[condition999 = symbolexchange = "TW" or symbolexchange = "TE";//台股+興櫃
condition994 = symbol = "TSE.TW" or symbol = "TWSE.FS" or symbol = "OTC.TW";//大盤
condition997 = condition999 and (symboltype = 2 or symboltype = 4);//個股+權證+興櫃

if condition999 = false and condition994 = false//大盤, 個股, 權證, 興櫃, 類股指數
	then raiseruntimeerror("不支援此商品");
	
if barfreq = "Min" then raiseruntimeerror("不支援此頻率");

if condition994 then begin
	value1 = GetField("主力買進金額");
	value2 = GetField("主力賣出金額");
	value3 = value1 - value2;
	value4 = GetField("主力累計買賣超金額");
	plot2(value4,"主力累計買賣超",checkbox:=1,axis:=1,ScaleLabel:=sltypewy,ScaleDecimal:=sd0); //line，axis1
	setplotlabel(1,"買賣超(元)");
	setplotlabel(2,"主力累計買賣超(元)");
	setplotlabel(3,"買進(元)");
	setplotlabel(4,"賣出(元)");
	plot1(value3,"買賣超",checkbox:=1,axis:=2,ScaleLabel:=sltypewy,ScaleDecimal:=sd0); //bar，axis2
	plot3(value1,"買進",checkbox:=0,axis:=11,ScaleLabel:=sltypewy,ScaleDecimal:=sd0); //line，axis2
	plot4(value2,"賣出",checkbox:=0,axis:=11,ScaleLabel:=sltypewy,ScaleDecimal:=sd0); //line，axis2
end else begin
	if symbolexchange <> "TE" and symboltype <> 1 then begin
		value1 = GetField("主力買張");
		value2 = GetField("主力賣張");
	end;
	value3 = GetField("主力買賣超張數");
	plot2(GetField("主力持股"),"主力持股",checkbox:=1,axis:=1,ScaleLabel:=slfull,ScaleDecimal:=sd0); //line，axis1
	setplotlabel(1,"買賣超(張)");
	setplotlabel(2,"主力持股(張)");
	setplotlabel(3,"買進(張)");
	setplotlabel(4,"賣出(張)");
	plot1(value3,"買賣超",checkbox:=1,axis:=2,ScaleLabel:=slfull,ScaleDecimal:=sd0); //bar，axis2
	if symbolexchange <> "TE" and symboltype <> 1 then begin
		plot3(value1,"買進",checkbox:=0,axis:=11,ScaleLabel:=slfull,ScaleDecimal:=sd0); //line，axis2
		plot4(value2,"賣出",checkbox:=0,axis:=11,ScaleLabel:=slfull,ScaleDecimal:=sd0); //line，axis2
	end;
end;

]]></Code>
<Arg><![CDATA[<Arg seed="c2f5f9a8-e06b-47a0-a8f8-e4cbf45f437d" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="0aa58286-3465-416d-910e-5105d5663418" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="1" min="-100" max="100" /></Axises><Plot name="買賣超" number="1" type="1" color="255" color2="62464" style="3" weight="0" axis="1" DecimalFormat="1" NumFormat="1" checkbox="1" SetDecimalFormat="1" SetNumFormat="1" colors="," offset="0" /><Plot name="主力持股" number="2" type="0" color="39423" color2="62464" style="0" weight="0" axis="0" DecimalFormat="1" NumFormat="1" checkbox="1" SetDecimalFormat="1" SetNumFormat="1" colors="," offset="0" /><Plot name="買進" number="3" type="0" color="16711935" color2="65280" style="0" weight="0" axis="10" DecimalFormat="1" NumFormat="1" checkbox="0" SetDecimalFormat="1" SetNumFormat="1" colors="," offset="0" /><Plot name="賣出" number="4" type="0" color="65280" color2="14680319" style="0" weight="0" axis="10" DecimalFormat="1" NumFormat="1" checkbox="0" SetDecimalFormat="1" SetNumFormat="1" colors="," offset="0" /></Plots>]]></Plots>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="36" />
<script>
<freq support="8;11" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{&quot;0&quot;:[213,236,202,52,53,54,55]},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="分公司買進賣出家數" ID="ff219353d1ca48a185e9dfe0debe1f1b" ReturnType="0" ExecType="1" Folder="/籌碼高手/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[condition999 = symbolexchange = "TW" or symbolexchange = "TE";//台股+興櫃
condition992 = condition999 and  (symbol <> "TSE.TW" and symbol <> "TWSE.FS" and symbol <> "OTC.TW");//類股+個股+權證+興櫃

if condition992 = false //類股+個股+權證+興櫃
	then raiseruntimeerror("不支援此商品");



if barfreq <> "D" and barfreq <> "AD" 
	then raiseruntimeerror("不支援此頻率");
	

{
plot1(GetField("分公司淨賣超金額家數") - GetField("分公司淨買超金額家數"),"買賣家數差",checkbox:=1,axis:=2,ScaleLabel:=slfull,ScaleDecimal:=sd0);//單位：家
plot2(GetField("分公司淨買超金額家數"),"買進",checkbox:=0,axis:=1,ScaleLabel:=slfull,ScaleDecimal:=sd0);//單位：家，可勾選畫圖選項 (參數設定) 
plot3(GetField("分公司淨賣超金額家數"),"賣出",checkbox:=0,axis:=1,ScaleLabel:=slfull,ScaleDecimal:=sd0);//單位：家，可勾選畫圖選項 (參數設定) 

plot1(GetField("買家數")-GetField("賣家數"),"買賣家數差",checkbox:=1,axis:=2);//單位：家
plot2(GetField("買家數"),"買進",checkbox:=0,axis:=1);//單位：家，可勾選畫圖選項 (參數設定) 
plot3(GetField("賣家數"),"賣出",checkbox:=0,axis:=1);//單位：家，可勾選畫圖選項 (參數設定) 
}

//	20180730 針對以下Mail與Alex、雅慧姐進行討論，決定更改為分公司買進/賣出家數來計算；並將指標名稱改成“分公司買進賣出”。
//	Mail Re: Fw: 有關買賣家數問題
//	Mon, 30 Jul 2018 13:18:30		
plot1(GetField("分公司賣出家數")-GetField("分公司買進家數"),"買賣家數差",checkbox:=1,axis:=2);//單位：家
plot2(GetField("分公司買進家數"),"買進",checkbox:=0,axis:=1);//單位：家，可勾選畫圖選項 (參數設定) 
plot3(GetField("分公司賣出家數"),"賣出",checkbox:=0,axis:=1);//單位：家，可勾選畫圖選項 (參數設定) ]]></Code>
<Arg><![CDATA[<Arg seed="f03905b9-21a5-4a4e-b48f-fc2384c09ce8" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="029e3dbd-3023-4c32-a094-12dd43b02de6" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="1" min="-100" max="100" /></Axises><Plot name="買賣家數差" number="1" type="1" color="255" color2="62464" style="3" weight="0" axis="1" DecimalFormat="0" NumFormat="0" checkbox="1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /><Plot name="買進" number="2" type="0" color="16711935" color2="255" style="0" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="0" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /><Plot name="賣出" number="3" type="0" color="65280" color2="65280" style="0" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="0" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="21" />
<script>
<freq support="8;11" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{&quot;0&quot;:[177,176]},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="散戶作多指標" ID="096354fd993742a787a66abf0c33eae7" ReturnType="0" ExecType="1" Folder="/籌碼指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:Period(10,"MA期數");

if barfreq = "Tick" or barfreq = "Min"
	then raiseruntimeerror("不支援此頻率");
	
value1=GetField("融資買進張數");
value2=GetField("融券買進張數");
if volume <> 0 then
	value3=(value1+value2)/volume;
value4=average(value3,Period);

plot1(value4,"散戶作多指標");
]]></Code>
<Arg><![CDATA[<Arg seed="b65833dd-d261-44a5-909e-aca3151ccd4c" version="1"><Param name="MA期數" varname="Period" type="1" subtype="0" value="10" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="0fe0673f-e7da-41f7-aabf-a51b152b7e42" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="散戶作多指標" number="1" type="0" color="5275903" color2="5275903" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="12" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{&quot;0&quot;:[170,172]},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="波動率指標" ID="15f053e5e61448e88f94d3c78a326354" ReturnType="0" ExecType="1" Folder="/技術指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[{
指標說明
https://xstrader.net/918/
}

value1 = 100*(average(H/L-1,20)+standarddev(H/L-1,20,1)*3);
value2 = value1- average(value1,10);

plot1(value1,"波動指標");
if value2> 0 then plot2(value2,"波動放大");
if value2<= 0 then plot3(value2,"波動縮小");]]></Code>
<Arg><![CDATA[<Arg seed="85d80488-fc6b-43f3-be83-b8b6d07b39bc" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="510680c1-eacf-4a3f-8c23-5ddb2cfbbc5a" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="波動指標" number="1" type="0" color="39423" color2="62464" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /><Plot name="波動放大" number="2" type="1" color="255" color2="255" style="0" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /><Plot name="波動縮小" number="3" type="1" color="65280" color2="65280" style="0" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c;1,8c2d025a23c548d3a76fba10c22527b4;1,9c4f476d319b4f109a8dc8557099ded4;1,c1cda70a714d44999e5171fc53c95b0a</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="4" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="BBand寬度指標" ID="e95d376cb2654c15b644c7d87e5dc960" ReturnType="0" ExecType="1" Folder="/大盤指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[{
指標說明
https://xstrader.net/bband-width/
}

input: 
	Length(20, "MA的天數"), 
	UpperBand(2, "上通道標準差倍數"), 
	LowerBand(2, "下通道標準差倍數");
variable: mid(0), up(0), down(0), bbandwidth(0) ;

up = bollingerband(Close, Length, UpperBand);
down = bollingerband(Close, Length, -1 * LowerBand);
mid = (up + down) / 2;

bbandwidth = 100 * (up - down) / mid;
 
Plot1(bbandwidth , "BBand width(%)");
plot2(4,"低檔");



]]></Code>
<Arg><![CDATA[<Arg seed="609e796d-08d3-46e6-9bca-f64d4500be11" version="1"><Param name="MA的天數" varname="Length" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="上通道標準差倍數" varname="UpperBand" type="1" subtype="0" value="2" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="下通道標準差倍數" varname="LowerBand" type="1" subtype="0" value="2" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="b88703dc-385a-462e-80c7-9fcf966797b3" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="BBand width(%)" number="1" type="0" color="5275903" color2="5275903" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /><Plot name="低檔" number="2" type="0" color="65280" color2="255" style="0" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c;1,8c2d025a23c548d3a76fba10c22527b4;1,9c4f476d319b4f109a8dc8557099ded4;1,c1cda70a714d44999e5171fc53c95b0a;1,5f76de57dba441808c8c784d8fa54994</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="3" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="Q指標" ID="80bfd59e40864bd8802e190379b6478a" ReturnType="0" ExecType="3" Folder="/大盤指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:t1(10);	setinputname(1,"天期");
input:t2(5);	setinputname(2,"平均天期");
input:t3(20);	setinputname(3,"雜訊平滑天期");


value1=close-close[1];			//價格變化
value2=summation(value1,t1);	//累積價格變化
value3=average(value2,t2);
value4=absvalue(value2-value3);	//雜訊
value5=average(value4,t3);		//把雜訊移動平均

variable:Qindicator(0);
if value5 = 0 then 
	Qindicator = 0
else
	Qindicator = value3 / value5*5;
	
plot1(Qindicator,"Q-indicator");

]]></Code>
<Arg><![CDATA[<Arg seed="e4fc4f34-470c-403e-81c6-2cbc5bb585c2" version="1"><Param name="天期" varname="t1" type="1" subtype="0" value="10" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="平均天期" varname="t2" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="雜訊平滑天期" varname="t3" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="a9c11094-8bf0-46e5-a683-0da7bf51344e" version="1"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="Q-indicator" number="1" type="0" color="5275903" color2="0" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="100" />
<Maxbb val="50" />
<ScriptComplexity val="4" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="3-6 乖離率" ID="57fee1099c21434eb653fcd209a7619b" ReturnType="0" ExecType="3" Folder="/XQ技術指標/" StatusMask="2">
<Desc><![CDATA[畫出3-6乖離率指標]]></Desc>
<Code><![CDATA[// XQ 3-6 乖離率
//
input: Length1(3), Length2(6);

SetInputName(1, "天數一");
SetInputName(2, "天數二");

Plot1(Bias(Length1) - Bias(Length2), "3-6乖離率(%)");

		]]></Code>
<Arg><![CDATA[<Arg seed="90362fc2-0350-49b6-8a2f-cbe395e0daa6" version="1"><Param name="天數一" varname="Length1" type="1" subtype="0" value="3" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="天數二" varname="Length2" type="1" subtype="0" value="6" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="6bc7932d-b79e-41f1-a470-aa46481f71c2" version="1"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="3-6乖離率(%)" number="1" type="0" color="5275903" color2="0" style="0" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c;1,aa300d6ee3de439ea5eeb2f9ff3a7ed2</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="15" />
<Maxbb val="12" />
<ScriptComplexity val="3" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="R平方" ID="6f219bedb9304cfa8ef4525123a7c368" ReturnType="0" ExecType="1" Folder="/技術指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[{
指標說明
https://xstrader.net/趨勢檢定器/
}

input:Length(20,"計算期間");
 
LinearReg(close, Length, 0, value1, value2, value3, value4);
//做收盤價20天線性回歸
{value1:斜率,value4:預期值}
value5=rsquare(close,value4,Length);//算收盤價與線性回歸值的R平方 

plot1(value5,"R平方");
plot2(0.2,"趨勢成形線");]]></Code>
<Arg><![CDATA[<Arg seed="4ef691ee-64dd-4a59-b608-e3b6e7966000" version="1"><Param name="計算期間" varname="Length" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="1fe32492-c19c-4baa-9f71-0b0be1380e7d" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="R平方" number="1" type="0" color="5275903" color2="5275903" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /><Plot name="趨勢成形線" number="2" type="0" color="255" color2="255" style="0" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,8c2d025a23c548d3a76fba10c22527b4;1,210d0786cfe340538e34c095bc2ba049;1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c;1,92fc51a453da4cd1b4448cc9a7677e84;1,63d7a17cf80a49098dfc97fc4b986abc</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="3" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="BB指標" ID="7da8636db4b8402cb15b6d7f8460f79f" ReturnType="0" ExecType="1" Folder="/技術指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[{
指標說明
https://xstrader.net/％b指標/
}

input: 
	Length(20, "天數"), 
	UpperBand(2, "上"), 
	LowerBand(2, "下"), 
	pbLength(5, "%B平均天數");
	
variable: up(0), down(0), mid(0), bbandwidth(0), pb(0);

up = bollingerband(Close, Length, UpperBand);
down = bollingerband(Close, Length, -1 * LowerBand);
mid = (up + down) / 2;

bbandwidth = 100 * (up - down) / mid;
pb=(close-down)/(up-down);
value1=average(pb,pbLength);

plot1(pb,"%b");
plot2(value1,"%b移動平均");
]]></Code>
<Arg><![CDATA[<Arg seed="7fb48035-acba-460e-ae36-ea2002f87464" version="1"><Param name="天數" varname="Length" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="上" varname="UpperBand" type="1" subtype="0" value="2" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="下" varname="LowerBand" type="1" subtype="0" value="2" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="%B平均天數" varname="pbLength" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="c207feac-639d-4bb9-8289-641a409c9427" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="%b" number="1" type="0" color="5275903" color2="5275903" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /><Plot name="%b移動平均" number="2" type="0" color="65535" color2="255" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c;1,8c2d025a23c548d3a76fba10c22527b4;1,9c4f476d319b4f109a8dc8557099ded4;1,c1cda70a714d44999e5171fc53c95b0a;1,5f76de57dba441808c8c784d8fa54994</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="4" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="ZDZB築底指標" ID="a5c44f71632f4a4a8c273e420abd8db8" ReturnType="0" ExecType="1" Folder="/技術指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[{
指標說明
https://xstrader.net/築底指標-2/
}

input:
	period(125,"計算期數"),
	length1(5,"短MA期數"),
	length2(20,"長MA期數");
	
variable:zd(0),zdma1(0),zdma2(0);

zd=countif(close>=close[1],period)/countif(close<close[1],period);
zdma1=average(zd,length1);
zdma2=average(zd,length2);

plot1(zdma1,"短天期築底指標");
plot2(zdma2,"長天期築底指標");
plot3(1,"多空分界");



 ]]></Code>
<Arg><![CDATA[<Arg seed="7317cb72-9bc6-4a0c-bdf3-c5430afd5043" version="1"><Param name="計算期數" varname="period" type="1" subtype="0" value="125" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="短MA期數" varname="length1" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="長MA期數" varname="length2" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="202f53c3-5e52-46bd-9e2e-186be4c57082" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="短天期築底指標" number="1" type="0" color="5275903" color2="5275903" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /><Plot name="長天期築底指標" number="2" type="0" color="255" color2="255" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /><Plot name="多空分界" number="3" type="0" color="65280" color2="65280" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,d80cf92ddfcc42e0a6c53ec47edebd49;1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="5" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="修正式價量指標" ID="e6d4df1f4cbb483eaaa26bc25a74f1b2" ReturnType="0" ExecType="3" Folder="/量能指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[{
指標說明
https://xstrader.net/修正式價量指標vptvolume-price-trend/
}

input:day(5,"移動平均線天數");

variable:tvp(0),mpc(0);
mpc=(open+high+low+close)/4;
 
if mpc[1]<>0 then
	tvp=tvp[1]+(mpc-mpc[1])/mpc[1]*volume
else
	tvp=tvp[1];

plot1(tvp,"修正型價量指標");
 ]]></Code>
<Arg><![CDATA[<Arg seed="c27a7637-9438-4314-85b4-14fb3628a61d" version="1"><Param name="移動平均線天數" varname="day" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="6b132ecb-471b-416b-9f16-b1dc81afe515" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="修正型價量指標" number="1" type="0" color="5275903" color2="5275903" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="1" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="分鐘與日DMI" ID="e78b958b52bd4113b21c996870501649" ReturnType="0" ExecType="3" Folder="/跨頻率指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[// 分頻率DMI指標，預設跨分頻率為30分鐘
// 不支援大頻率跨小頻率，例如：
// 不支援主頻率60分鐘，跨頻率計算30分鐘DMI技術指標。
//
input:	Length(14, "天數"),
		FreqType("30", "跨頻率週期", inputkind:=dict(["1分鐘","1"],["5分鐘","5"],["10分鐘","10"],["15分鐘","15"],["30分鐘","30"],["60分鐘","60"],["日","D"],["還原日","AD"]));

variable: pdi_value(0), ndi_value(0), adx_value(0);

if barfreq <> "Tick" and barfreq <> "Min" and barfreq <> "D" and barfreq <> "AD" then raiseruntimeerror("此範例僅支援分鐘、日與還原日頻率");

xfMin_DirectionMovement(FreqType, Length, pdi_value, ndi_value, adx_value);

// 初始區波動較大, 先不繪出
//
if CurrentBar < Length then
 begin
	pdi_value = 0;
	ndi_value = 0;
	adx_value = 0;
 end;

Plot1(pdi_value, "分鐘與日+DI");
Plot2(ndi_value, "分鐘與日-DI");
Plot3(adx_value, "分鐘與日ADX");


// 防呆，大頻率跨小頻率時，在線圖秀不支援
//
switch (FreqType)
begin
	case  "1":
		if barfreq <> "Tick" and barfreq <> "Min" then raiseruntimeerror("不支援大頻率跨小頻率：主頻率大於1分鐘");
		if barinterval <> 1 then raiseruntimeerror("不支援大頻率跨小頻率：主頻率大於1分鐘");
		setplotlabel(1, "1分+DI");
		setplotlabel(2, "1分-DI");
		setplotlabel(3, "1分ADX");

	case  "5":
		if barfreq <> "Tick" and barfreq <> "Min" then raiseruntimeerror("不支援大頻率跨小頻率：主頻率大於5分鐘");
		if barinterval <> 1 and barinterval <> 2 and barinterval <> 3 and barinterval <> 5 then raiseruntimeerror("不支援大頻率跨小頻率：主頻率大於5分鐘");
		setplotlabel(1, "5分+DI");
		setplotlabel(2, "5分-DI");
		setplotlabel(3, "5分ADX");

	case "10":
		if barfreq <> "Tick" and barfreq <> "Min" then raiseruntimeerror("不支援大頻率跨小頻率：主頻率大於10分鐘");
		if barinterval <> 1 and barinterval <> 2 and barinterval <> 3 and barinterval <> 5 and barinterval <> 10 then raiseruntimeerror("不支援大頻率跨小頻率：主頻率大於10分鐘");
		setplotlabel(1, "10分+DI");
		setplotlabel(2, "10分-DI");
		setplotlabel(3, "10分ADX");

	case "15":
		if barfreq <> "Tick" and barfreq <> "Min" then raiseruntimeerror("不支援大頻率跨小頻率：主頻率大於15分鐘");
		if barinterval <> 1 and barinterval <> 2 and barinterval <> 3 and barinterval <> 5 and barinterval <> 10 and barinterval <> 15 then raiseruntimeerror("不支援大頻率跨小頻率：主頻率大於15分鐘");
		setplotlabel(1, "15分+DI");
		setplotlabel(2, "15分-DI");
		setplotlabel(3, "15分ADX");
		
	case "30":
		if barfreq <> "Tick" and barfreq <> "Min" then raiseruntimeerror("不支援大頻率跨小頻率：主頻率大於30分鐘");
		if barinterval <> 1 and barinterval <> 2 and barinterval <> 3 and barinterval <> 5 and barinterval <> 10 and barinterval <> 15 and barinterval <> 20 and barinterval <> 30 then raiseruntimeerror("不支援大頻率跨小頻率：主頻率大於30分鐘");
		setplotlabel(1, "30分+DI");
		setplotlabel(2, "30分-DI");
		setplotlabel(3, "30分ADX");

	case "60":
		if barfreq <> "Tick" and barfreq <> "Min" then raiseruntimeerror("不支援大頻率跨小頻率：主頻率大於60分鐘");
		if barinterval <> 1 and barinterval <> 2 and barinterval <> 3 and barinterval <> 5 and barinterval <> 10 and barinterval <> 15 and barinterval <> 20 and barinterval <> 30 and barinterval <> 45 and barinterval <> 60 then raiseruntimeerror("不支援大頻率跨小頻率：主頻率大於60分鐘");
		setplotlabel(1, "60分+DI");
		setplotlabel(2, "60分-DI");
		setplotlabel(3, "60分ADX");
		
	case "D":
		if barfreq <> "Tick" and barfreq <> "Min" and barfreq <> "D" and barfreq <> "AD" then raiseruntimeerror("不支援大頻率跨小頻率：主頻率大於日");
		setplotlabel(1, "日+DI");
		setplotlabel(2, "日-DI");
		setplotlabel(3, "日ADX");
	
	case "AD":
		if barfreq <> "Tick" and barfreq <> "Min" and barfreq <> "D" and barfreq <> "AD" then raiseruntimeerror("不支援大頻率跨小頻率：主頻率大於還原日");
		setplotlabel(1, "還原日+DI");
		setplotlabel(2, "還原日-DI");
		setplotlabel(3, "還原日ADX");
	
end;
]]></Code>
<Arg><![CDATA[<Arg seed="a9ccdeb7-8dec-4de9-ba16-03383c94f87a" version="1"><Param name="天數" varname="Length" type="1" subtype="0" value="14" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="跨頻率週期" varname="FreqType" type="3" subtype="0" value="30" isSerial="0" isArray="0" isRef="0" inputkind="1" quickedit="0" keytype="3"><Pair key="1分鐘" value="1" /><Pair key="5分鐘" value="5" /><Pair key="10分鐘" value="10" /><Pair key="15分鐘" value="15" /><Pair key="30分鐘" value="30" /><Pair key="60分鐘" value="60" /><Pair key="日" value="D" /><Pair key="還原日" value="AD" /></Param></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="1e9463ec-23b1-496c-a65c-89fb633e7c1a"><Plot name="分鐘與日+DI" number="1" type="0" color="5275903" color2="5275903" style="0" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /><Plot name="分鐘與日-DI" number="2" type="0" color="255" color2="255" style="0" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /><Plot name="分鐘與日ADX" number="3" type="0" color="65280" color2="65280" style="0" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,de5550c0989b434681e18c65fcc79915;1,8e4cc5f4d71342f9a5b6c2e5dc9a6966;1,aced678c83804b088f72d66788ddde3c;1,dc58546bafca4f169bf376e4ff00dbd4</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="20" />
<ScriptComplexity val="2" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="加速器指標" ID="f9fdac082ed24235b962555ab5b9edd1" ReturnType="0" ExecType="3" Folder="/技術指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[{
指標說明
https://xstrader.net/495/
}

variable:Xslope(0); 

Xslope = linearregslope((H+L)/(H+L)[20],20);

plot1(Xslope,"方向速度" );
plot2(Xslope-Xslope[1],"速度變化");]]></Code>
<Arg><![CDATA[<Arg seed="a0e64eed-c74f-4c3c-9424-660dde637680" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="cd16c1a5-049f-4838-ac89-728eaea668b0" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="方向速度" number="1" type="0" color="5275903" color2="5275903" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /><Plot name="速度變化" number="2" type="1" color="255" color2="62464" style="3" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,8c2d025a23c548d3a76fba10c22527b4;1,210d0786cfe340538e34c095bc2ba049;1,626e6e5c42304bbea9809d1a07ae4e01</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="2" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="bband當沖操作指標" ID="fee886e0440348659fd150f42d9245a2" ReturnType="0" ExecType="3" Folder="/技術指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:length(30,"期數");
variable:up1(0),down1(0),mid1(0),bbandwidth(0);
variable:dayprofit(0),accprofit(0);
up1 = bollingerband(Close[1], Length, 2);
down1 = bollingerband(Close[1], Length, -2 );
if open*1.01>up1 then begin
	dayprofit=open-close;
end else if down1*1.01>open then begin
	dayprofit=close-open;
end else
	dayprofit=0;
accprofit=accprofit[1]+dayprofit;
plot1(accprofit,"累計獲利");



]]></Code>
<Arg><![CDATA[<Arg seed="41214e5b-377d-4f08-bee4-2bb42ae9fe94" version="1"><Param name="期數" varname="length" type="1" subtype="0" value="30" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="f78e3429-f4c5-40d5-9b06-89613b7e7c00" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="累計獲利" number="1" type="0" color="5275903" color2="5275903" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c;1,8c2d025a23c548d3a76fba10c22527b4;1,9c4f476d319b4f109a8dc8557099ded4;1,c1cda70a714d44999e5171fc53c95b0a;1,5f76de57dba441808c8c784d8fa54994</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="3" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="MAM(移動平均動量指標)" ID="9bb439d30ea044b88890790547d47f32" ReturnType="0" ExecType="3" Folder="/XQ技術指標/" StatusMask="2">
<Desc><![CDATA[畫出移動平均動量指標]]></Desc>
<Code><![CDATA[// XQ: MAM指標
//
Input: Length(10), Distance(10);
Variable: mam(0);

SetInputName(1, "天數一");
SetInputName(2, "天數二");

Value1 = Average(Close, Length);
Value2 = Average(Close, Length)[Distance];

mam = Value1 - Value2;
	
Plot1(mam, "MAM");
		]]></Code>
<Arg><![CDATA[<Arg seed="7fb7631b-e4f0-4188-9a73-2c9d94679715" version="1"><Param name="天數一" varname="Length" type="1" subtype="0" value="10" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="天數二" varname="Distance" type="1" subtype="0" value="10" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="322319aa-7b42-47d0-a88d-eb6cf584d3a1" version="1"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="MAM" number="1" type="0" color="5275903" color2="0" style="0" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="50" />
<Maxbb val="19" />
<ScriptComplexity val="3" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="KD 隨機指標" ID="637460b1727543c784c6c07870453729" ReturnType="0" ExecType="3" Folder="/XQ技術指標/" StatusMask="2">
<Desc><![CDATA[畫出KD指標]]></Desc>
<Code><![CDATA[// XQ: KD指標
//
input: Length(9), RSVt(3), Kt(3);
variable: rsv(0), k(0), _d(0);

SetInputName(1, "天數");
SetInputName(2, "RSVt權數");
SetInputName(3, "Kt權數");

Stochastic(Length, RSVt, Kt, rsv, k, _d);

Plot1(k, "K(%)");
Plot2(_d, "D(%)");

	
	
		]]></Code>
<Arg><![CDATA[<Arg seed="c76719f6-2fc0-4d2c-b3c3-5ec9264d987e" version="1"><Param name="天數" varname="Length" type="1" subtype="0" value="9" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="RSVt權數" varname="RSVt" type="1" subtype="0" value="3" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="Kt權數" varname="Kt" type="1" subtype="0" value="3" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="c67712fd-2d86-448f-bbf7-9e2a00c28cd2" version="1"><Axises><Axis value="1" align="2" min="0" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="K(%)" number="1" type="0" color="5275903" color2="0" style="0" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /><Plot name="D(%)" number="2" type="0" color="255" color2="0" style="0" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,61c06064ad98469db9ce30287ae4a2c8;1,2bca774c6b7549c1b0b008d2a54b288e;1,f1b429ac13b2447c909302198c18ca56;1,847bcd706dda4a9caf2b783e181a8e42</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="2" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="分時漲跌成交量" ID="79197dfc94b145289aac6a4a9143e61e" ReturnType="0" ExecType="1" Folder="/即時籌碼/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[{支援商品類型：台股/期權/選擇權/大盤/類股指數}

if barfreq <> "Min" and barfreq <> "D" and barfreq <> "AD" then 
	raiseruntimeerror("僅支援分鐘與日頻率（含還原）");

value1 = GetField("上漲量");
value2 = GetField("下跌量");
value3 = value1 - value2;
plot1(value3,"漲跌成交(分時)");
plot2(value1,"上漲量",checkbox:=0);
plot3(value2,"下跌量",checkbox:=0);]]></Code>
<Arg><![CDATA[<Arg seed="17184a50-2cc0-4e84-aa63-86a13ff60266" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="23b6bf82-072e-46bf-a2ba-bcec666b983c" version="1">
	<Axises>
		<Axis value="1" align="0" min="-100.000000" max="100.000000" SetMin="1" SetMax="1" mpvalue="0.000000" />
		<Axis value="2" align="1" min="-100.000000" max="100.000000" SetMin="1" SetMax="1" mpvalue="0.000000" />
	</Axises>
	<Plot name="漲跌成交(分時)" number="1" type="1" style="3" color="255" color2="65280" axis="1" checkbox="-1" colors="," offset="0" />

	<Plot name="上漲量" number="2" color="16711935" color2="255" checkbox="0" colors="," offset="0" />

	<Plot name="下跌量" number="3" color="16776960" color2="65280" checkbox="0" colors="," offset="0" />

</Plots>]]></Plots>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="11" />
<script>
<freq support="8;11" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{&quot;0&quot;:[71,72]},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="台灣50大戶買賣力" ID="0be19fb25ccd46df831edaf221c0b019" ReturnType="0" ExecType="1" Folder="/市場動能/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[{統計台灣50成分股, 當分鐘大戶買賣力金額。
大戶買賣力為，買進(大單+特大單)-賣出(大單+特大單)}

if barfreq <> "Min" then raiseruntimeerror("僅支援「分鐘」頻率");

value1 = GetSymbolField("TSE50.SJ","TW50大戶買賣力");

plot1(value1,"台灣50大戶買賣力（元）");]]></Code>
<Arg><![CDATA[<Arg seed="0c9c8402-38c1-4fc7-92d5-495085a64551" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="3c87a41e-8362-4973-bf90-fc9c6d84587b" version="1">
	<Axises>
		<Axis value="1" align="0" min="-100.000000" max="100.000000" SetMin="1" SetMax="1" mpvalue="0.000000" />
		<Axis value="2" align="0" min="-100.000000" max="100.000000" SetMin="1" SetMax="1" mpvalue="0.000000" />
	</Axises>
	<Plot name="台灣50大戶買賣力（元）" number="1" type="1" style="3" color="255" color2="65280" checkbox="-1" colors="," offset="0" />

</Plots>]]></Plots>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="6" />
<script>
<freq support="8;11" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{&quot;TSE50.SJ&quot;:{&quot;0&quot;:[887]}}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="RunScore" ID="3251021ba417489faab50ad3512471a8" ReturnType="0" ExecType="1" Folder="/技術指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[{
指標說明
https://xstrader.net/Runscore指標/
}

input:QDate(20140630,"起算日");
//先設定一個季結束的日子
variable:RunScore(0),vs(0),i(0);

if date > QDate then begin
	if C>C[1] then RunScore += 1;//收漲加1分
	if H>H[1] then RunScore += 1;//漲過昨高加1分
	if C>H[1] then RunScore += 1;//收過昨高加1分
	if C<C[1] then RunScore -= 1;//收跌扣1分
	if L<L[1] then RunScore -= 1;//破昨低扣1分
	if C<L[1] then RunScore -= 1;//收破昨低扣1分
	vs += v; 
	i += 1;
end;

plot1( RunScore,"漲跌分數");]]></Code>
<Arg><![CDATA[<Arg seed="e73e80b5-d915-4f08-b6e9-59cae22251af" version="1"><Param name="起算日" varname="QDate" type="1" subtype="0" value="20140630" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="02a3a929-7660-4a70-a76f-bf08873c4b19" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="漲跌分數" number="1" type="0" color="5275903" color2="5275903" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="1" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="WVAD威廉變異離散量" ID="bc2d9fc93fcd4f9585775c45c3bd4889" ReturnType="0" ExecType="3" Folder="/量能指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[{
指標說明
https://xstrader.net/wvad威廉變異離散量/
}

input:length(5,"期數");

variable:wvad(0);

value1=close-open;
value2=high-low;

if high<>low then 
	value3=value1/value2*volume
else
	value3=value3[1];

wvad=summation(value3,length);

plot1(wvad,"威廉變異離散量");

]]></Code>
<Arg><![CDATA[<Arg seed="83d3135a-cc3f-4df8-82e1-086235b77dfb" version="1"><Param name="期數" varname="length" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="6e742342-6bc9-49ff-88f9-0fc20fb0a08c" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="威廉變異離散量" number="1" type="1" color="255" color2="62464" style="3" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="2" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="上漲下跌家數差RSI指標" ID="0e1cbd3dee234246b89227f5c64e08c9" ReturnType="0" ExecType="3" Folder="/大盤指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[{
指標說明
https://xstrader.net/上漲下跌家數差RSI指標/
收錄於「三週學會程式交易：打造你的第一筆自動化交易」 256頁
https://www.ipci.com.tw/books_in.php?book_id=724
}

input:period(10,"RSI計算天數");

if barfreq <> "D" then raiseruntimeerror("不支援此頻率");

value1=getfield("上漲家數");
value2=getfield("下跌家數");
value3=value1-value2;
value4=summation(value3,period);
value5=rsi(value4,period);
plot1(value5,"上漲家數RSI");
]]></Code>
<Arg><![CDATA[<Arg seed="a746b55d-458e-4b36-9d3f-174fd89bf2ca" version="1"><Param name="RSI計算天數" varname="period" type="1" subtype="0" value="10" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="4491f289-3034-4d5c-afa7-96c9af4989fb" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="上漲家數RSI" number="1" type="0" color="5275903" color2="5275903" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c;1,d64c2a71d3ea43d985ca22ef62a5a8de</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="13" />
<script>
<freq support="8;11" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{&quot;0&quot;:[79,80]},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="KDJ 隨機指標" ID="8da744cb018646c8a9af98ee84c6f607" ReturnType="0" ExecType="3" Folder="/XQ技術指標/" StatusMask="2">
<Desc><![CDATA[畫出隨機指標(KDJ)]]></Desc>
<Code><![CDATA[// XQ: KDJ指標
//
input: Length(9), RSVt(3), Kt(3), JType(0);
variable: rsv(0), k(0), _d(0), j(0);

SetInputName(1, "天數");
SetInputName(2, "RSVt權數");
SetInputName(3, "Kt權數");

Stochastic(Length, RSVt, Kt, rsv, k, _d);

Plot1(k, "K(%)");
Plot2(_d, "D(%)");

if JType = 0 then
	j = 3 * k - 2 * _d
else
	j = 3 * _d - 2 * k;

Plot3(j, "J(%)");
	
		]]></Code>
<Arg><![CDATA[<Arg seed="0be005f7-e94e-493b-b86f-ab66b1c99ebd" version="1"><Param name="天數" varname="Length" type="1" subtype="0" value="9" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="RSVt權數" varname="RSVt" type="1" subtype="0" value="3" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="Kt權數" varname="Kt" type="1" subtype="0" value="3" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="JType" varname="JType" type="1" subtype="0" value="0" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="eec6f3c3-8d42-4612-a36c-c45ede3bf32a" version="1"><Axises><Axis value="1" align="2" min="0" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="K(%)" number="1" type="0" color="5275903" color2="0" style="0" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /><Plot name="D(%)" number="2" type="0" color="255" color2="0" style="0" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /><Plot name="J(%)" number="3" type="0" color="65280" color2="0" style="0" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,61c06064ad98469db9ce30287ae4a2c8;1,2bca774c6b7549c1b0b008d2a54b288e;1,f1b429ac13b2447c909302198c18ca56;1,847bcd706dda4a9caf2b783e181a8e42</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="2" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="現股當沖金額" ID="dc5ddd98298c4db4bddcc37bf420ab22" ReturnType="0" ExecType="1" Folder="/籌碼高手/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[condition996 = symbolexchange = "TW" and symboltype = 2;//個股
condition994 = symbol = "TSE.TW" or symbol = "TWSE.FS" or symbol = "OTC.TW";//大盤
condition993 = symbolexchange = "TW" and symboltype = 1;//類股

if condition994 =false and condition993 = false and condition996 = false //大盤+類股+個股
	then raiseruntimeerror("不支援此商品");

if barfreq = "Tick" or barfreq = "Min"
	then raiseruntimeerror("不支援此頻率");

if symboltype = 1 then begin
	if volume <> 0 then
		value1 = (GetField("現股當沖買進金額")+GetField("現股當沖賣出金額"))/(volume*2)
	else
		value1 = 0;
	plot1(value1,"當沖比率",checkbox:=1,axis:=2,ScaleLabel:=slpercent,ScaleDecimal:=sd2);//單位：％
	plot2(GetField("現股當沖買進金額"),"買進",checkbox:=0,axis:=1,ScaleLabel:=sltypewy,ScaleDecimal:=sdauto);//單位：元，可勾選畫圖選項 (參數設定) 
	plot3(GetField("現股當沖賣出金額"),"賣出",checkbox:=0,axis:=1,ScaleLabel:=sltypewy,ScaleDecimal:=sdauto);//單位：元，可勾選畫圖選項 (參數設定) 
end else begin
	if GetField("成交金額(元)") <> 0 then
		value1 = (GetField("現股當沖買進金額")+GetField("現股當沖賣出金額"))/(GetField("成交金額(元)")*2)
	else
		value1 = 0;
	plot1(value1,"當沖比率",checkbox:=1,axis:=2,ScaleLabel:=slpercent,ScaleDecimal:=sd2);//單位：％
	plot2(GetField("現股當沖買進金額"),"買進",checkbox:=0,axis:=1,ScaleLabel:=sltypewy,ScaleDecimal:=sdauto);//單位：元，可勾選畫圖選項 (參數設定) 
	plot3(GetField("現股當沖賣出金額"),"賣出",checkbox:=0,axis:=1,ScaleLabel:=sltypewy,ScaleDecimal:=sdauto);//單位：元，可勾選畫圖選項 (參數設定) 
end;]]></Code>
<Arg><![CDATA[<Arg seed="891f911f-bccf-47aa-b11a-f4bd71c60bce" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="38babb9b-15d1-49db-8b04-6cac930044bb" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="當沖比率" number="1" type="0" color="5275903" color2="5275903" style="0" weight="0" axis="1" DecimalFormat="3" NumFormat="2" checkbox="1" SetDecimalFormat="1" SetNumFormat="1" colors="," offset="0" /><Plot name="買進" number="2" type="0" color="255" color2="255" style="0" weight="0" axis="0" DecimalFormat="0" NumFormat="3" checkbox="0" SetDecimalFormat="0" SetNumFormat="1" colors="," offset="0" /><Plot name="賣出" number="3" type="0" color="65280" color2="65280" style="0" weight="0" axis="0" DecimalFormat="0" NumFormat="3" checkbox="0" SetDecimalFormat="0" SetNumFormat="1" colors="," offset="0" /></Plots>]]></Plots>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="51" />
<script>
<freq support="8;11;9;12;10;13" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{&quot;0&quot;:[165,166,19]},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="加速指標" ID="81cbaaffd9084e5cb78d41defd7128a1" ReturnType="0" ExecType="1" Folder="/技術指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:period1(5,"計算天期");
input:period2(9,"MA天期");

variable:aspeed(0),dspeed(0),a1(0),d1(0),p1(0),ap1(0);

if close>close[1] then
	aspeed=(close-close[1])/close*100
else 
	aspeed=0;
	
if close<close[1] then
	dspeed=(close[1]-close)/close*100
else
	dspeed=0;

a1=average(aspeed,period1);
d1=average(dspeed,period1);


p1=a1-d1;
ap1=average(p1,period2);

plot1(p1,"加速度");
plot2(ap1,"移動平均");

]]></Code>
<Arg><![CDATA[<Arg seed="8a6dc57b-f81d-48f3-9385-034052b4b744" version="1"><Param name="計算天期" varname="period1" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="MA天期" varname="period2" type="1" subtype="0" value="9" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="ba5e0e03-73f5-4d90-ab48-4dcf42a34276" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="加速度" number="1" type="0" color="5275903" color2="5275903" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /><Plot name="移動平均" number="2" type="0" color="65535" color2="255" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="4" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="投信" ID="91b6b5d9397b4598a6da2c2e6e3ea44e" ReturnType="0" ExecType="1" Folder="/籌碼高手/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[condition999 = symbolexchange = "TW" or symbolexchange = "TE";//台股+興櫃
condition994 = symbol = "TSE.TW" or symbol = "TWSE.FS" or symbol = "OTC.TW";//大盤
condition993 = symbolexchange = "TW" and symboltype = 1;//類股

if condition999 = false and condition994 = false//大盤, 個股, 權證, 興櫃, 類股指數
	then raiseruntimeerror("不支援此商品");


if barfreq = "Tick" or barfreq = "Min"
	then raiseruntimeerror("不支援此頻率");

if condition994 then begin
	value1 = GetField("投信買進金額");
	value2 = GetField("投信賣出金額");
	value3 = GetField("投信買賣超金額");
	value4 = value4 + GetField("投信買賣超金額");
	plot2(value4,"投信累計買賣超",checkbox:=1,axis:=2,ScaleLabel:=sltypewy,ScaleDecimal:=sdauto); //line，axis1
	setplotlabel(1,"買賣超(元)");
	setplotlabel(2,"投信累計買賣超(元)");
	setplotlabel(3,"買進(元)");
	setplotlabel(4,"賣出(元)");
	plot1(value3,"買賣超",checkbox:=1,axis:=1,ScaleLabel:=sltypewy,ScaleDecimal:=sdauto); //bar，axis2
	plot3(value1,"買進",checkbox:=0,axis:=11,ScaleLabel:=sltypewy,ScaleDecimal:=sdauto); //line，axis2
	plot4(value2,"賣出",checkbox:=0,axis:=11,ScaleLabel:=sltypewy,ScaleDecimal:=sdauto); //line，axis2
end else begin
	if symbolexchange <> "TE" and condition993 = false then begin
		value1 = GetField("投信買張");
		value2 = GetField("投信賣張");
	end;
	value3 = GetField("投信買賣超張數");
	plot2(GetField("投信持股"),"投信持股",checkbox:=1,axis:=2,ScaleLabel:=slfull,ScaleDecimal:=sd0); //line，axis1
	setplotlabel(1,"買賣超(張)");
	setplotlabel(2,"投信持股(張)");
	setplotlabel(3,"買進(張)");
	setplotlabel(4,"賣出(張)");
	if condition993 = false then begin
		plot5(0.01*GetField("投信持股比例"),"投信持股比例",axis:=12,ScaleLabel:=slpercent,ScaleDecimal:=sd2);
	end;
	plot1(value3,"買賣超",checkbox:=1,axis:=1,ScaleLabel:=slfull,ScaleDecimal:=sd0); //bar，axis2
	if symbolexchange <> "TE" and condition993 = false then begin
		plot3(value1,"買進",checkbox:=0,axis:=11,ScaleLabel:=slfull,ScaleDecimal:=sd0); //line，axis2
		plot4(value2,"賣出",checkbox:=0,axis:=11,ScaleLabel:=slfull,ScaleDecimal:=sd0); //line，axis2
	end;
end;

]]></Code>
<Arg><![CDATA[<Arg seed="c3e1dcbc-bba7-46c1-8722-334dee4bf312" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="c82d3011-1ca9-4f86-8558-57edc73917ab" version="0">
	<Axises>
		<Axis value="1" align="1" min="-100.000000" max="100.000000" SetMin="1" SetMax="1" mpvalue="0.000000" />
		<Axis value="2" align="0" min="-100.000000" max="100.000000" SetMin="1" SetMax="1" mpvalue="0.000000" />
	</Axises>
	<Plot name="買賣超" number="1" type="1" style="3" color="255" color2="62464" DecimalFormat="1" NumFormat="1" checkbox="1" SetDecimalFormat="1" SetNumFormat="1" colors="," offset="0" />

	<Plot name="投信持股" number="2" color="39423" color2="62464" axis="1" DecimalFormat="1" NumFormat="1" checkbox="1" SetDecimalFormat="1" SetNumFormat="1" colors="," offset="0" />

	<Plot name="買進" number="3" style="5" color="16711935" color2="65280" axis="10" DecimalFormat="1" NumFormat="1" checkbox="0" SetDecimalFormat="1" SetNumFormat="1" colors="," offset="0" />

	<Plot name="賣出" number="4" style="5" color="65280" color2="14680319" axis="10" DecimalFormat="1" NumFormat="1" checkbox="0" SetDecimalFormat="1" SetNumFormat="1" colors="," offset="0" />

	<Plot name="投信持股比例" number="5" style="5" color="65535" color2="65535" axis="11" DecimalFormat="3" NumFormat="2" checkbox="-1" SetDecimalFormat="1" SetNumFormat="1" colors="," offset="0" />

</Plots>]]></Plots>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="46" />
<script>
<freq support="8;11;9;12;10;13;14;15" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{&quot;0&quot;:[108,109,107,32,33,187,34,35]},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="價差" ID="c438145ffd2847d08b330a362bdb3fdd" ReturnType="0" ExecType="1" Folder="/期權指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[condition999 = symbolexchange = "TF";//期貨
condition994 = symbol = "TSE.TW" or symbol = "TWSE.FS" or symbol = "OTC.TW";//大盤
condition993 = symbolexchange = "TF" and symboltype = 5;//選擇權

if (condition999 = false and condition994 = true) or symbolType = 5	//僅支援期貨
	then raiseruntimeerror("不支援此商品");
	
if symbolexchange = "TF" and symboltype = 3  then	//期貨
	value1 = GetSymbolField("Underlying", "收盤價");	

plot1(close-value1,"價差");]]></Code>
<Arg><![CDATA[<Arg seed="b20cb55d-80e3-4a2d-aa36-a545e9ebf8b8" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="2cf2e8ea-ea2e-49e2-aecc-183be876e2e8" version="1">
	<Axises>
		<Axis value="1" align="0" min="-100.000000" max="100.000000" SetMin="1" SetMax="1" mpvalue="0.000000" />
		<Axis value="2" align="0" min="-100.000000" max="100.000000" SetMin="1" SetMax="1" mpvalue="0.000000" />
	</Axises>
	<Plot name="價差" number="1" color="5275903" color2="5275903" weight="2" checkbox="-1" colors="," offset="0" />

</Plots>]]></Plots>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="6" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{&quot;UNDERLYING&quot;:{&quot;0&quot;:[8]}}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="控盤者買賣盤" ID="6d1fb133b0f84f2e840ec41623e6262c" ReturnType="0" ExecType="1" Folder="/籌碼高手/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[condition999 = symbolexchange = "TW" or symbolexchange = "TE";//台股+興櫃
condition998 = condition999 = true and symboltype = 2;//個股+興櫃

if condition998 = false //個股+興櫃
	then raiseruntimeerror("不支援此商品");

if barfreq = "Tick" or barfreq = "Min"
	then raiseruntimeerror("不支援此頻率");

value1 = GetField("控盤者買賣超張數")+value1;
plot1(value1,"累計買賣超(張)",checkbox:=1,axis:=1,ScaleLabel:=slfull,ScaleDecimal:=sd0);//單位:張
plot2(GetField("控盤者買賣超張數"),"控盤者買賣超(張)",checkbox:=1,axis:=2,ScaleLabel:=slfull,ScaleDecimal:=sd0);//單位:張]]></Code>
<Arg><![CDATA[<Arg seed="9e2d5348-8916-4aea-b269-7bfc3b9689a9" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="30450b6f-a69a-4e21-9403-2e816a513bc9" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="1" min="-100" max="100" /></Axises><Plot name="累計買賣超(張)" number="1" type="0" color="5275903" color2="5275903" style="0" weight="0" axis="0" DecimalFormat="1" NumFormat="1" checkbox="1" SetDecimalFormat="1" SetNumFormat="1" colors="-1,-1" offset="0" /><Plot name="控盤者買賣超(張)" number="2" type="1" color="255" color2="62464" style="3" weight="0" axis="1" DecimalFormat="1" NumFormat="1" checkbox="1" SetDecimalFormat="1" SetNumFormat="1" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="11" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{&quot;0&quot;:[64]},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="順勢指標" ID="ea5cf57b37f343cd822648293729522d" ReturnType="0" ExecType="1" Folder="/技術指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[{
指標說明
https://xstrader.net/為自己的觀察名單標上交易訊號/
}

input:
	length1(5,"短期平均"),
	length2(10,"長期平均");

variable:bp1(0),abp1(0),abp2(0);

bp1=(close-close[1])/truerange*100;
abp1=average(bp1,length1);
abp2=average(bp1,length2);

plot1(abp1,"短期平均");
plot2(abp2,"長期平均");

]]></Code>
<Arg><![CDATA[<Arg seed="75ff5c81-ad00-42cd-8193-60cd8691add4" version="1"><Param name="短期平均" varname="length1" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="長期平均" varname="length2" type="1" subtype="0" value="10" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="45a454bd-85d3-4543-aa81-7f09f983032f" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="短期平均" number="1" type="0" color="5275903" color2="5275903" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /><Plot name="長期平均" number="2" type="0" color="65535" color2="255" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,36d1fc033c6f48f8a136f9e1fdec110f;1,81394f9cf0c8469ea5f8832700aec8b7;1,9e03682196e24611b2fe326b6a56433d;1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="4" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="KST確認指標" ID="eb1cbea2a6ff4abe99bb0bf58575882c" ReturnType="0" ExecType="3" Folder="/大盤指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[variable:kst(0);

value1=average(rateofchange(close,12),10);
value2=average(rateofchange(close,20),10);
value3=average(rateofchange(close,30),8);
value4=average(rateofchange(close,40),15);

kst=value1+value2*2+value3*3+value4*4;

plot1(kst,"KST確認指標");]]></Code>
<Arg><![CDATA[<Arg seed="dcc36158-0d4c-42ae-aa67-a6221f3afe0e" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="707619c7-a8a0-4ca6-9065-70eb5f931153" version="1"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="KST確認指標" number="1" type="0" color="5275903" color2="0" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,c9f2641e5de0497cb352ace96f64236e;1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="80" />
<Maxbb val="60" />
<ScriptComplexity val="9" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="期貨散戶多空比" ID="446fd69eea6f442dbf3ccd9107018c36" ReturnType="0" ExecType="1" Folder="/期權指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[variable: OI_all(0), OI_small_bull(0), OI_small_bear(0), OI_small_ratio(0), OI_big_ratio(0);

OI_all = getsymbolfield("FITX*1.TF","未平倉","D") 
	+ getsymbolfield("FITX*2.TF","未平倉","D")
	+ getsymbolfield("FIMTX*1.TF","未平倉","D") * 0.25 
	+ getsymbolfield("FIMTX*2.TF","未平倉","D") * 0.25;
OI_small_bull = OI_all - getsymbolfield("FITX*1.TF","十大交易人未沖銷買口","D");
OI_small_bear = OI_all - getsymbolfield("FITX*1.TF","十大交易人未沖銷賣口","D");
if OI_small_bull + OI_small_bear = 0 then
	OI_small_ratio = 0
else
	OI_small_ratio = 100 * OI_small_bull / (OI_small_bull + OI_small_bear) - 50;
plot1(OI_small_ratio,"散戶");

]]></Code>
<Arg><![CDATA[<Arg seed="b3baf2a5-1c7a-4bf8-94e5-34dff22c2db0" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="f2be8e45-57c4-4350-a0cb-e6391f1093a3" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="散戶" number="1" type="1" color="13434726" color2="0" style="0" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<Extra><![CDATA[<Extra>
<TotalBar val="0" />
<Maxbb val="0" />
<ScriptComplexity val="31" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{&quot;FITX*1.TF&quot;:{&quot;8&quot;:[10,126,127]},&quot;FITX*2.TF&quot;:{&quot;8&quot;:[10]},&quot;FIMTX*1.TF&quot;:{&quot;8&quot;:[10]},&quot;FIMTX*2.TF&quot;:{&quot;8&quot;:[10]}}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="上漲家數" ID="ab73d3d0ad47437f9394dba40b8f85c2" ReturnType="0" ExecType="1" Folder="/大盤指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[{
指標說明
https://xstrader.net/大盤多空轉換點之探討系列一-上漲的股票有沒有200/
收錄於「三週學會程式交易：打造你的第一筆自動化交易」 252頁
https://www.ipci.com.tw/books_in.php?book_id=724
}

input:shortterm(5,"期間");
input:midterm(15,"平均");

value1=GetField("上漲家數");
value2=lowest(value1,shortterm);
value3=average(value2,midterm);
plot1(value3,"平均上漲家數");
plot2(200,"多");
plot3(100,"空");
]]></Code>
<Arg><![CDATA[<Arg seed="54a87cf0-b7f9-431b-82d2-a0bdfbd515b0" version="1"><Param name="期間" varname="shortterm" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="平均" varname="midterm" type="1" subtype="0" value="15" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="443fd48f-fa0a-43ae-93ca-25f3903e3b8c" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="平均上漲家數" number="1" type="0" color="5275903" color2="5275903" style="0" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /><Plot name="多" number="2" type="0" color="255" color2="255" style="0" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /><Plot name="空" number="3" type="0" color="65280" color2="65280" style="0" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,61c06064ad98469db9ce30287ae4a2c8;1,f1b429ac13b2447c909302198c18ca56;1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="8" />
<script>
<freq support="8;11" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{&quot;0&quot;:[79]},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="天羅地網線" ID="dc2ea05993cb4190808f3fc9287b2607" ReturnType="0" ExecType="1" Folder="/技術指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:period(60,"期數");

value5=average(close,period);
value6=standarddev(close,period,1);
value7=value5+value6;
value8=value5+2*value6;
value9=value5-value6;
value10=value5-2*value6;

plot1(value8,"+2SD");
plot2(value7,"+1SD");
plot3(value5,"MA");
plot4(value9,"-1SD");
plot5(value10,"-2SD");]]></Code>
<Arg><![CDATA[<Arg seed="e854bdaf-aee7-4a5b-ae3d-c7c3a9569f02" version="1"><Param name="期數" varname="period" type="1" subtype="0" value="60" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="6b3dcabe-d17a-452c-b30a-7864a4619420" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="+2SD" number="1" type="0" color="5487733" color2="5275903" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /><Plot name="+1SD" number="2" type="0" color="1470258" color2="255" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /><Plot name="MA" number="3" type="0" color="255" color2="65280" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /><Plot name="-1SD" number="4" type="0" color="1470258" color2="14680319" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /><Plot name="-2SD" number="5" type="0" color="5487733" color2="65535" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c;1,8c2d025a23c548d3a76fba10c22527b4;1,9c4f476d319b4f109a8dc8557099ded4;1,c1cda70a714d44999e5171fc53c95b0a</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="3" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="MFO資金流震盪指標" ID="adc6761024a744d79feaac113743e444" ReturnType="0" ExecType="3" Folder="/技術指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[{
指標說明
https://xstrader.net/大盤多空轉換點之探討系列三-mfo資金流震盪指標/
}

input:period(20,"計算天期");

if ((high-low[1])+(high[1]-low)) <> 0 then
	value1= ((high-low[1])-(high[1]-low))/((high-low[1])+(high[1]-low))*volume
else
	value1=value1[1];
	
value2= summation(value1,period)/summation(volume,period);

plot1(value2,"MFO資金流震盪指標");
]]></Code>
<Arg><![CDATA[<Arg seed="1110124d-e184-4452-a2b1-adf6569f7308" version="1"><Param name="計算天期" varname="period" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="7c7ba5bb-54bc-4111-adbb-c8669fed509e" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="MFO資金流震盪指標" number="1" type="0" color="5275903" color2="5275903" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="3" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="自訂大戶買賣力" ID="17675f3b32184e2bbac65e4ed886ac1e" ReturnType="0" ExecType="1" Folder="/即時籌碼/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[{指標數值定義：主力 = 成交單量 >= X的委託由Tick資料去累積計算
支援商品：台(股票)、台(期貨)}

value91 = GetField("上漲量");//僅提供給有權限的用戶使用

if symbolexchange <> "TW" and symbolexchange <> "TF" then raiseruntimeerror("不支援此商品");
if SymbolType <> 2 and SymbolType <> 3 then raiseruntimeerror("不支援此商品");

if barfreq <> "Min" then 
	raiseruntimeerror("僅支援分鐘頻率");

{
	顯示開盤迄今的累計外盤大單 - 累計內盤大單, 也就是盤中大戶的買賣力趨勢
	大單定義: 成交單量 > X
}

input: threshold(100, "大單門檻(張or口)");

var: intrabarpersist _v_buy_acc(0), intrabarpersist _v_sell_acc(0);
var: intrabarpersist _last_seq(0);
var: _cur_seq(0), _i(0), _curbar_date(0); 
var: _last_date(0);

if getfielddate("date") <> _last_date then begin
	_last_date = getfielddate("date");
	_v_buy_acc = 0;
	_v_sell_acc = 0;
	_last_seq = 0;
end;

// 抓洗價當時最新一筆Tick的位置跟日期
//
_cur_seq = GetField("SeqNo", "Tick");
_curbar_date = GetField("Date", "Tick");

if symbolexchange = "TW" and SymbolType = 2 then begin	//台(股票)
	if _curbar_date <> date then begin
		// 如果開盤到有某些分鐘沒有成交, 此時會對到昨日之前的Tick => 這些分鐘不要計算
		//
		_cur_seq = 0;

	end else if _cur_seq > 0 and _cur_seq > _last_seq then begin
		// _last_seq是上一次畫圖時最後一筆Tick的位置
		//
		// 所以就統計 _cur_seq .. _last_seq之間的Tick的成交資料
		//
		_i = _last_seq + 1;	
		while _i <= _cur_seq begin
			var: tv(0), _first(0), _complete(0);
		
			value1 = GetField("BidAskFlag", "Tick")[_cur_seq - _i];	// 外盤=1, 內盤=-1
			value2 = GetField("Close", "Tick")[_cur_seq - _i];		// 價格
			value3 = GetField("Volume", "Tick")[_cur_seq - _i];		// 單量
			value4 = GetField("SeqNo", "Tick")[_cur_seq - _i];		// Tick編號
			//-------------------------------------------------
			// multitick的處理
			//
			// TickGroup回傳以下數值
			//  -1 = 集合競價(每天第一盤, 最後一盤, 包含暫緩之後的搓合, etc.) 
			//	0 = 逐筆搓合單筆
			//	1 = 逐筆搓合開始
			//  2 = 逐筆搓合中間
			//  3 = 逐筆搓合結束
			//
			value5 = GetField("TickGroup", "Tick")[_cur_seq - _i];

			tv = value3;
			_complete = 0;

			if value5 = -1 then begin
				// 集合競價: 不列入統計
				_i = _i + 1;
				tv = 0;
			end else if value5 = 0 then begin
				// 獨立一筆: 列入統計
				_i = _i + 1;
			end else if value5 = 1 then begin
				// 把連續撮合的所有資料合併成一筆統計
				// 連續撮合的第一筆 = 1, 中間 = 2, 最後 = 3
				_first = _i;
				_i = _i + 1;
				while _i <= _cur_seq and _complete = 0 begin
					value99 = GetField("Time", "Tick")[_cur_seq - _i];			// 價格
					value22 = GetField("Close", "Tick")[_cur_seq - _i];			// 價格
					value33 = GetField("Volume", "Tick")[_cur_seq - _i];		// 單量
					value44 = GetField("SeqNo", "Tick")[_cur_seq - _i];			// Seq
					value55 = GetField("TickGroup", "Tick")[_cur_seq - _i];
					tv = tv + value33;
					
					_i = _i + 1;
					if value55 = 3 then _complete = 1;
				end;

				if _complete = 0 then begin
					// 有可能交易所還沒有傳送完整的連續撮合Ticks, 所以等下一次洗價時再處理
					//
					_cur_seq = _first;
					break;
				end;
			end else begin	
				// 異常狀況: 跳過
				_i = _i + 1;
			end;	

			
			// 如果超過門檻, 則依照外盤/內盤分別累計(成交量)
			//
			if tv > threshold then begin
				if value1 = 1 then _v_buy_acc = _v_buy_acc + tv;
				if value1 = -1 then _v_sell_acc = _v_sell_acc + tv;
			end;	
		end;
	end;
end;

if symbolexchange = "TF" and SymbolType = 3 then begin	//台(期貨)
	if _curbar_date <> date then begin
		// 如果開盤到有某些分鐘沒有成交, 此時會對到昨日之前的Tick => 這些分鐘不要計算
		//
		_cur_seq = 0;

	end else if _cur_seq > 0 and _cur_seq > _last_seq then begin
		// _last_seq是上一次畫圖時最後一筆Tick的位置
		//
		// 所以就統計 _cur_seq .. _last_seq之間的Tick的成交資料
		//
		_i = _last_seq + 1;	
		while _i <= _cur_seq begin
			value1 = GetField("BidAskFlag", "Tick")[_cur_seq - _i];	// 外盤=1, 內盤=-1
			value2 = GetField("Close", "Tick")[_cur_seq - _i];		// 價格
			value3 = GetField("Volume", "Tick")[_cur_seq - _i];		// 單量
			value4 = GetField("SeqNo", "Tick")[_cur_seq - _i];		// Tick編號
			
			// 如果超過門檻, 則依照外盤/內盤分別累計(成交量)
			//
			if value3 >= threshold then begin
				if value1 = 1 then _v_buy_acc = _v_buy_acc + value3;
				if value1 = -1 then _v_sell_acc = _v_sell_acc + value3;
			end;	
			_i = _i + 1;
		end;
	end;
end;

_last_seq = _cur_seq;

plot1(_v_buy_acc - _v_sell_acc, "大戶買賣力(自訂)");
plot2(_v_buy_acc, "大戶(自訂)外盤量",checkbox:=0);
plot3(_v_sell_acc, "大戶(自訂)內盤量",checkbox:=0);]]></Code>
<Arg><![CDATA[<Arg seed="7376d3a4-681d-4017-a77d-8e6aadf7d3a2" version="1"><Param name="大單門檻(張or口)" varname="threshold" type="1" subtype="0" value="100" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="14a7f480-3873-4749-b992-c0d195d8c15f" version="1">
	<Axises>
		<Axis value="1" align="0" min="-100.000000" max="100.000000" SetMin="1" SetMax="1" mpvalue="0.000000" />
		<Axis value="2" align="1" min="-100.000000" max="100.000000" SetMin="1" SetMax="1" mpvalue="0.000000" />
	</Axises>
	<Plot name="大戶買賣力(自訂)" number="1" type="1" style="3" color="255" color2="65280" axis="1" checkbox="-1" colors="," offset="0" />

	<Plot name="大戶(自訂)外盤量" number="2" color="16711935" color2="255" checkbox="0" colors="," offset="0" />

	<Plot name="大戶(自訂)內盤量" number="3" color="14669717" color2="65280" checkbox="0" colors="," offset="0" />

</Plots>]]></Plots>
<Extra><![CDATA[<Extra>
	<TotalBar val="200" />
	<Maxbb val="0" />
	<IsScriptSetTB val="0" />
	<IsScriptSetBB val="0" />
</Extra>]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="2" Name="coppock indicator" ID="7571a7438dba4175910b5c1037ab6e33" ReturnType="0" ExecType="3" Folder="/技術指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[variable:coppock(0);
value1=rateofchange(close,14);
value2=rateofchange(close,11);
value3=value1+value2;
value4=xaverage(value3,10);
plot1(value4,"coppock indicator");
]]></Code>
<Arg><![CDATA[<Arg seed="663171f2-e051-48e8-be02-d77b89e897f4" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="21bd916c-de0a-44de-acf9-083f047330dd" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="coppock indicator" number="1" type="0" color="5275903" color2="5275903" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,c9f2641e5de0497cb352ace96f64236e;1,d02c45cba76f4163a048685f7bc4002b</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="4" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="大盤多空對策判斷分數" ID="4fd1db98f6964e358558a17e22e26c97" ReturnType="0" ExecType="3" Folder="/大盤指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[{
指標說明
https://xstrader.net/大盤多空對策訊號/
收錄於「三週學會程式交易：打造你的第一筆自動化交易」 265頁
https://www.ipci.com.tw/books_in.php?book_id=724
}

if barfreq <> "D" then raiseruntimeerror("僅支援日頻率");

variable: XData(0),YData(0),ZData(0),Z(0),count(0);

//透過Z的時間安排來決定現在用的是那一根Bar的資料 
if currenttime > 180000 
or currenttime < 083000 then 
	Z =0 
else 
	Z=1;

//每天的分數都先歸零
if date <> date[1] then 
	count=0;

//外資買超
XData = GetField("外資買賣超金額")[Z];
if xdata > 0 then 
	count=count+1;

//投信買超
YData = GetField("投信買賣超金額")[Z];
if ydata > 0 then
	count=count+1;

//自營商買超
ZData = GetField("自營商買賣超金額")[Z];
if zdata > 0 then 
	count=count+1;

//上漲量超過一半
value6 = GetField("上漲量");
if value6/volume > 0.5 then
	count=count+1;

//外盤量超過一半
value7 = GetField("外盤量");
if value7/volume>0.5 then
	count=count+1;

//RSI多頭
value8=rsi(close,5);
value9=rsi(close,10);
if value8 > value9 and value8 < 90 then
	count=count+1;

//MACD 多頭
variable:Dif_val(0), MACD_val(0), Osc_val(0);
MACD(Close, 12, 26, 9, Dif_val, MACD_val, Osc_val);
if osc_val > 0 then
	count=count+1;

//MTM  多頭
value10=mtm(10);
if value10 > 0 then
	count=count+1;

//KD多頭
variable:rsv1(0),k1(0),d1(0);
stochastic(9,3,3,rsv1,k1,d1);
if k1 > d1 and k1 < 80 then
	count=count+1;

//+DI>-DI
variable:pdi_value(0),ndi_value(0),adx_value(0);
DirectionMovement(14,pdi_value,ndi_value,adx_value);
if pdi_value > ndi_value then
	count=count+1;

//AR趨勢向上
value14=ar(26);
value15=linearregslope(value14,5);
if value15 > 0 then 
	count=count+1;

//ACC大於零
value16=acc(10);
if value16 > 0 then 
	count=count+1;

//TRIX多頭
value17=trix(close,9);
value18=trix(close,15);
if value17 > value18 then
	count=count+1;

//SAR多頭
value19=SAR(0.02, 0.02, 0.2);
if close > value19 then
	count=count+1;

//週線大於月線
if average(close,5) > average(close,20) then
	count=count+1;

//計算平均分數
value11=average(count,10);
plot1(value11,"分數");
Plot2(10,"多");
plot3(5,"空");]]></Code>
<Arg><![CDATA[<Arg seed="fc843958-b11a-431d-b6dc-6116c623acf4" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="e32c150e-a8e3-4494-ab7c-ebc390de5c01" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="分數" number="1" type="0" color="16711833" color2="5275903" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /><Plot name="多" number="2" type="0" color="255" color2="255" style="0" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /><Plot name="空" number="3" type="0" color="65280" color2="65280" style="0" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c;1,d64c2a71d3ea43d985ca22ef62a5a8de;1,d02c45cba76f4163a048685f7bc4002b;1,8216021f4b11489b8faca5f2af7d0750;1,239cb1c1f329431ea731982d8f5d94f2;1,607a9823aec54a91ab43847239ccd4dd;1,61c06064ad98469db9ce30287ae4a2c8;1,2bca774c6b7549c1b0b008d2a54b288e;1,f1b429ac13b2447c909302198c18ca56;1,847bcd706dda4a9caf2b783e181a8e42;1,7721dca8cc7242c09d21b782bbb59bd9;1,d21d5975992d4975839416bad676689d;1,8c2d025a23c548d3a76fba10c22527b4;1,210d0786cfe340538e34c095bc2ba049;1,626e6e5c42304bbea9809d1a07ae4e01;1,162ffb45c75346a596029f2fea1df8c2;1,31df812470ed4d30af3a7592649c9054;1,1ac64461c4f341bc8e1d3ac1998fd29e</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="41" />
<script>
<freq support="8;11" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{&quot;0&quot;:[104,107,110,71,21]},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="不明買盤指標" ID="c019d383580043e39c24966fa5a5aea2" ReturnType="0" ExecType="1" Folder="/籌碼指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:period(5,"期數");

if barfreq = "Tick" or barfreq = "Min"
	then raiseruntimeerror("不支援此頻率");
	
value1=GetField("法人買張");
value2=GetField("當日沖銷張數");
value3=GetField("散戶買張");
value4=volume-value1-value2-value3;
if volume <> 0 then
	value5=value4/volume;
value6=average(value5,period);
plot1(value6,"不明買盤比例");]]></Code>
<Arg><![CDATA[<Arg seed="0544502e-783e-4af4-8c2f-4135365c7f76" version="1"><Param name="期數" varname="period" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="b2405a6b-b294-47a3-be26-5d5f11e8de35" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="不明買盤比例" number="1" type="0" color="5275903" color2="5275903" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="17" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{&quot;0&quot;:[48,47,56]},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="多空力道指標" ID="33bd2fb7d48a48b69429e7c26a246f8c" ReturnType="0" ExecType="3" Folder="/技術指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input: length(5);	setinputname(1, "天期");

Value1 = high - close;   
Value2 = close - low; 

Value3 = average(Value1,length);   
Value4 = average(Value2,length);   

plot1(Value4 - Value3, "力道");  
]]></Code>
<Arg><![CDATA[<Arg seed="7748c521-be9a-494e-bc7a-bcc064fb6704" version="1"><Param name="天期" varname="length" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="78cea1b5-aa9a-4485-998f-6fa2abdc747e" version="1"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="力道" number="1" type="0" color="5275903" color2="0" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="20" />
<Maxbb val="10" />
<ScriptComplexity val="3" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="PVC(成交量變動百分比指標)" ID="f9bef2c70b524d02b289268268c08c61" ReturnType="0" ExecType="3" Folder="/XQ量能指標/" StatusMask="2">
<Desc><![CDATA[畫出成交量變動百分比指標]]></Desc>
<Code><![CDATA[// XQ: PVC指標
//
Input: Length(10);
Variable: _pvc(0);

SetInputName(1, "天數");

value1 = Average(Volume, Length);
if value1 <> 0 then
	_pvc = 100 * (Volume - value1) / value1
else
	_pvc = 0;

Plot1(_pvc, "PVC");
		]]></Code>
<Arg><![CDATA[<Arg seed="c0bac0bc-c038-4571-8148-40a711d00a19" version="1"><Param name="天數" varname="Length" type="1" subtype="0" value="10" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="b95cba8e-8c97-4812-a985-e65eedb5ac90" version="1"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="PVC" number="1" type="0" color="5275903" color2="0" style="0" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="50" />
<Maxbb val="12" />
<ScriptComplexity val="2" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="%b指標" ID="f89674f3d031442684521ea2267adfb7" ReturnType="0" ExecType="3" Folder="/技術指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input: Length(20);	SetInputName(1, "布林通道天數");
input: BandRange(2);SetInputName(2, "上下寬度");
input: MALength(10);SetInputName(3, "MA天期");

variable: up(0), down(0), mid(0);

up = bollingerband(Close, Length, BandRange);
down = bollingerband(Close, Length, -1 * BandRange);

if up - down = 0 then value1 = 0 else value1 = (close - down) * 100 / (up - down);
value2 = average(value1, MALength);

Plot1(value1, "%b");
Plot2(value2, "%b平均");
]]></Code>
<Arg><![CDATA[<Arg seed="b88cbbca-d4d6-411b-a210-2eba9da9b283" version="1"><Param name="布林通道天數" varname="Length" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="上下寬度" varname="BandRange" type="1" subtype="0" value="2" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="MA天期" varname="MALength" type="1" subtype="0" value="10" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="f920eede-48b0-45ae-a74a-1e8d54cfb77c" version="1"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="%b" number="1" type="0" color="5275903" color2="0" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /><Plot name="%b平均" number="2" type="0" color="16764006" color2="0" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c;1,8c2d025a23c548d3a76fba10c22527b4;1,9c4f476d319b4f109a8dc8557099ded4;1,c1cda70a714d44999e5171fc53c95b0a;1,5f76de57dba441808c8c784d8fa54994</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="30" />
<Maxbb val="20" />
<ScriptComplexity val="4" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="BR 指標" ID="f84c684f920e4973ba63ced2fde49a03" ReturnType="0" ExecType="3" Folder="/XQ技術指標/" StatusMask="2">
<Desc><![CDATA[畫出BR指標]]></Desc>
<Code><![CDATA[// XQ BR指標
//
input: Length(26);
variable: sum(0), _br(0);

SetInputName(1, "天數");

sum= Summation((Close[1] - Low), length);
if sum <> 0 then
	_br = 100 * Summation((High - Close[1]), length) / sum
else
	_br = _br[1];

Plot1(_br, "BR(%)");
		]]></Code>
<Arg><![CDATA[<Arg seed="d776949e-0693-4726-9f30-0244b9bba1d6" version="1"><Param name="天數" varname="Length" type="1" subtype="0" value="26" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="d520ef4f-904e-4dbf-8282-a71efef0cbbc" version="1"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="BR(%)" number="1" type="0" color="5275903" color2="0" style="0" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="50" />
<Maxbb val="26" />
<ScriptComplexity val="3" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="台指選IV" ID="68f71f14bb774362a0e6b3a320e4455c" ReturnType="0" ExecType="3" Folder="/期權指標/" StatusMask="2">
<Desc><![CDATA[台股指數選擇權隱含波動率]]></Desc>
<Code><![CDATA[input: 
	iRate100(2,"無風險利率%");

variable:vStrikePrice(0);

if instr(symbol,".TF") = 0 or leftstr(symbol,1) = "F" or instr(symbol,"TX") = 0 then 
	raiseruntimeerror("僅支援台指選擇權");

vStrikePrice = getsymbolinfo("履約價");

value1 = ivolatility(leftstr(getsymbolinfo("買賣權"),1),getsymbolfield("FITX*1.TF","收盤價"),vStrikePrice,daystoexpirationtf,iRate100,0,c);

plot1(value1,"隱含波動率%");
]]></Code>
<Arg><![CDATA[<Arg seed="dc3e3cec-c5bf-4f7c-a102-9f5503e6b1a2" version="1"><Param name="無風險利率%" varname="iRate100" type="1" subtype="0" value="2" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="0e364714-a74d-411a-a4de-4cc72acefb3a" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="隱含波動率%" number="1" type="0" color="5275903" color2="0" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,8c2d025a23c548d3a76fba10c22527b4;1,2661174c578842599ba79c24c1c33cd6;1,4ccd60568ab94d4085a852218b37ba80;1,7adc0732a0b144149d70fb38c0965960;1,0999f843523c4d6eb18ccc461892eaa2;1,9726eaec317b4b98a68524683ea2ae92;1,8462f7081ead4113ba3aef780bc1040f;1,6f695b87f1f047f5b162d222df2e7edf;1,09c46fdb219b4b7a8bdaf1279d80071b</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="0" />
<Maxbb val="0" />
<ScriptComplexity val="8" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{&quot;FITX*1.TF&quot;:{&quot;0&quot;:[8]}}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="外盤量bband" ID="5b278878ab9c4d4a97b404375139c8a8" ReturnType="0" ExecType="1" Folder="/量能指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[{
指標說明
https://xstrader.net/外盤量異常突出的買進策略/
}

input:length(20,"期數");

variable:bv(0),bva(0);

if volume<>0 then 
	bv=GetField("外盤量")/volume*100;
bva=average(bv,3);

variable:up1(0),down1(0),mid1(0),bbandwidth(0);

up1 = bollingerband(bva, Length, 1);
down1 = bollingerband(bva, Length, -1 );
mid1 = (up1 + down1) / 2;
if mid1<>0 then 
	bbandwidth = 100 * (up1 - down1) / mid1;

plot1(up1, "UB");
plot2(bva, "外盤量佔比");
plot3(down1, "LB");
plot4(bbandwidth, "BW");
]]></Code>
<Arg><![CDATA[<Arg seed="db171c87-8be9-4a65-b807-7bd4d5af5379" version="1"><Param name="期數" varname="length" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="ac32bab0-070f-40e5-a1d1-440513c6423f" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="UB" number="1" type="0" color="255" color2="5275903" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /><Plot name="外盤量佔比" number="2" type="0" color="39423" color2="255" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /><Plot name="LB" number="3" type="0" color="65280" color2="65280" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /><Plot name="BW" number="4" type="0" color="14680319" color2="14680319" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c;1,8c2d025a23c548d3a76fba10c22527b4;1,9c4f476d319b4f109a8dc8557099ded4;1,c1cda70a714d44999e5171fc53c95b0a;1,5f76de57dba441808c8c784d8fa54994</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="9" />
<script>
<freq support="8;11" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{&quot;0&quot;:[21]},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="淨買賣力指標" ID="c1aaf4948dd947248a8a6d200795284b" ReturnType="0" ExecType="3" Folder="/技術指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input: Period(20,"期數");

if high<>low and truerange <> 0 then begin 
	value1=((high-open)+(close-low))/truerange;
	value2=((open-low)+(high-close))/truerange;
end else begin
	value1=value1[1];
	value2=value2[1];
end;
value3=value1-value2;
value4=average(value3,Period);
 
plot1(value4,"平均淨買賣力");
]]></Code>
<Arg><![CDATA[<Arg seed="0e6128f9-0174-4fc5-9ce5-b3f490936734" version="1"><Param name="期數" varname="Period" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="23d7b6ce-d4b5-4d3b-afc9-da2a2d3c9c72" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="平均淨買賣力" number="1" type="0" color="5275903" color2="5275903" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,36d1fc033c6f48f8a136f9e1fdec110f;1,81394f9cf0c8469ea5f8832700aec8b7;1,9e03682196e24611b2fe326b6a56433d;1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="5" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="蔡金波動指標" ID="8255457751d440bc97fde9d5422b1969" ReturnType="0" ExecType="3" Folder="/技術指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:length(9,"期數");

variable:REMA(0),cv1(0);

if currentbar=1 then begin
	cv1=0;
end else if range<>0 then begin
	REMA=xaverage(range,length);
	if rema[length-1]=0 then 
		cv1=cv1[1]
	else 
		cv1=(REMA-REMA[length-1])/rema[length-1];
end;
plot1(cv1,"波動率");
]]></Code>
<Arg><![CDATA[<Arg seed="d959dc9c-c491-47f8-b9ab-19f08bbc1912" version="1"><Param name="期數" varname="length" type="1" subtype="0" value="9" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="e53d75e7-d33d-4560-890c-948880627394" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="波動率" number="1" type="0" color="5275903" color2="5275903" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,b7522a72975a4d4bbc36f4fb684d6f77;1,d02c45cba76f4163a048685f7bc4002b</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="4" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="BBI多空指數" ID="3d28b6f8a7294911ba93307b2d5c9b37" ReturnType="0" ExecType="1" Folder="/量能指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[{
指標說明
https://xstrader.net/用自訂指標來看a股後市/
}

input:
a1(3,"第一根均線天期"),
a2(6,"第二根均線天期"),
a3(12,"第三根均線天期"),
a4(24,"第四根均線天期");

variable:BBI(0);

BBI=(average(close,a1)+average(close,a2)+average(close,a3)+average(close,a4))/4;
plot1(close-bbi,"多空線");



]]></Code>
<Arg><![CDATA[<Arg seed="f6d3f3f3-ad94-4b58-95da-d0c0f7862355" version="1"><Param name="第一根均線天期" varname="a1" type="1" subtype="0" value="3" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="第二根均線天期" varname="a2" type="1" subtype="0" value="6" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="第三根均線天期" varname="a3" type="1" subtype="0" value="12" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="第四根均線天期" varname="a4" type="1" subtype="0" value="24" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="cb15f002-3a2a-4c6c-8953-05cef0da184d" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="多空線" number="1" type="0" color="5275903" color2="5275903" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="5" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="CCI (商品通道指標)" ID="21c83d56fee646238a0437f93322cd4f" ReturnType="0" ExecType="3" Folder="/XQ技術指標/" StatusMask="2">
<Desc><![CDATA[畫出商品通道指標]]></Desc>
<Code><![CDATA[// XQ: CCI指標
//
input: 
Length1(14,"天數一"), 
Length2(28,"天數二"), 
Length3(42,"天數三"),
UpBaseLine(100,"上基準線"), 
MidBaseLine(0,"中基準線"), 
UnderBaseLine(-100,"下基準線");

Plot1(CommodityChannel(Length1), "CCI1");
Plot2(CommodityChannel(Length2), "CCI2");
Plot3(CommodityChannel(Length3), "CCI3");
plot4(UpBaseLine, "上基準線", checkbox:=0);
plot5(MidBaseLine, "中基準線", checkbox:=0);
plot6(UnderBaseLine, "下基準線" , checkbox:=0);
		]]></Code>
<Arg><![CDATA[<Arg seed="61070615-c75d-4fd6-8fe4-b4c07dbf6c3d" version="1"><Param name="天數一" varname="Length1" type="1" subtype="0" value="14" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="天數二" varname="Length2" type="1" subtype="0" value="28" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="天數三" varname="Length3" type="1" subtype="0" value="42" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="上基準線" varname="UpBaseLine" type="1" subtype="0" value="100" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="中基準線" varname="MidBaseLine" type="1" subtype="0" value="0" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="下基準線" varname="UnderBaseLine" type="1" subtype="0" value="-100" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="1bc56391-d0f2-4eba-afb8-ff9bce0c52b8" version="1"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="CCI1" number="1" type="0" color="5275903" color2="0" style="0" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /><Plot name="CCI2" number="2" type="0" color="255" color2="0" style="0" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /><Plot name="CCI3" number="3" type="0" color="65280" color2="0" style="0" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /><Plot name="上基準線" number="4" type="0" color="14680319" color2="14680319" style="0" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="0" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /><Plot name="中基準線" number="5" type="0" color="65535" color2="65535" style="0" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="0" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /><Plot name="下基準線" number="6" type="0" color="16776960" color2="16776960" style="0" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="0" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c;1,6673d58f85784adc88e05084868c3d49</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="100" />
<Maxbb val="42" />
<ScriptComplexity val="4" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="移動平均線再平均指標" ID="8f60a0b471b442f89c579f99c1a16842" ReturnType="0" ExecType="1" Folder="/大盤指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[{
指標說明
https://xstrader.net/移動平均線再平均指標/
收錄於「三週學會程式交易：打造你的第一筆自動化交易」 257頁
https://www.ipci.com.tw/books_in.php?book_id=724
}
input: Period1(5,"一次平均期數");
input: Period2(5,"二次平均期數");
input: Period3(10,"累計期數");

value1=average(close,Period1);
value2=average(value1,Period2);
value3=value1-value2;
value4=summation(value3,Period3);
plot1(value4,"多空");
]]></Code>
<Arg><![CDATA[<Arg seed="0df8372d-e0e5-487c-94c9-a58968532d11" version="1"><Param name="一次平均期數" varname="Period1" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="二次平均期數" varname="Period2" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="累計期數" varname="Period3" type="1" subtype="0" value="10" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="6d26e173-32b3-4c4b-9dc2-58e22b567de7" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="多空" number="1" type="1" color="255" color2="62464" style="3" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="4" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="ease of movement指標" ID="23885a544d744283acfb39d172a5cad4" ReturnType="0" ExecType="3" Folder="/技術指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:
	length1(9,"一次平滑期數"),
	length2(9,"二次平滑期數");

value1=(high+low)/2;
value2=value1-value1[1];
value3=volume/(high-low);
value4=value2/value3;
value5=average(value4,length1);
value6=average(value5,length2);

plot1(value5,"EMV");
plot2(value6,"EMV-MA");]]></Code>
<Arg><![CDATA[<Arg seed="c472fdbb-a538-4cde-a046-7b3c138d5ee5" version="1"><Param name="一次平滑期數" varname="length1" type="1" subtype="0" value="9" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="二次平滑期數" varname="length2" type="1" subtype="0" value="9" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="15c62d93-1d38-41dc-a2dd-b6dd3bd20d8e" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="EMV" number="1" type="0" color="5275903" color2="5275903" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /><Plot name="EMV-MA" number="2" type="0" color="65535" color2="255" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="3" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="散戶買進比例" ID="8e0f281d51ae4a1bbcbc9a64514e28af" ReturnType="0" ExecType="1" Folder="/籌碼指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:Period(5,"MA期數");

if barfreq = "Tick" or barfreq = "Min"
	then raiseruntimeerror("不支援此頻率");
	
value1=GetField("散戶買張");
if volume<>0 then 
	value2=value1/volume*100;
value3=average(value2,Period);

plot1(value3,"散戶買進比例");

]]></Code>
<Arg><![CDATA[<Arg seed="7a0d2c59-49b6-4511-82e6-93484997298b" version="1"><Param name="MA期數" varname="Period" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="de48e082-6204-4065-be77-4408d711c53c" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="散戶買進比例" number="1" type="0" color="5275903" color2="5275903" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="7" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{&quot;0&quot;:[56]},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="借券餘額" ID="a24a70570acd4888bc963aae77ece500" ReturnType="0" ExecType="1" Folder="/籌碼高手/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[condition996 = symbolexchange = "TW" = true and symboltype = 2;//個股
condition994 = symbol = "TSE.TW" or symbol = "TWSE.FS" or symbol = "OTC.TW";//大盤

if condition994 = false and condition996 = false //大盤+個股
	then raiseruntimeerror("不支援此商品");

if barfreq = "Tick" or barfreq = "Min"
	then raiseruntimeerror("不支援此頻率");


if symboltype = 1 then begin
	plot1(GetField("借券餘額張數"),"借券餘額(張)",checkbox:=1,axis:=1,ScaleLabel:=sltypewy,ScaleDecimal:=sdauto);//單位：張
	plot2(GetField("借券張數") - GetField("還券張數"),"差額(張)",checkbox:=1,axis:=2,ScaleLabel:=sltypewy,ScaleDecimal:=sdauto);//單位：張
	plot3(GetField("借券張數"),"借券(張)",checkbox:=0,axis:=11,ScaleLabel:=sltypewy,ScaleDecimal:=sdauto);//單位：張，新增查價顯示 (繪圖形式->隱藏, 不畫圖)
	plot4(getfield("還券張數"),"還券(張)",checkbox:=0,axis:=11,ScaleLabel:=sltypewy,ScaleDecimal:=sdauto);//單位：張，新增查價顯示 (繪圖形式->隱藏, 不畫圖)
end else begin
	plot1(GetField("借券餘額張數"),"借券餘額(張)",checkbox:=1,axis:=1,ScaleLabel:=slfull,ScaleDecimal:=sd0);//單位：張
	plot2(GetField("借券張數") - GetField("還券張數"),"差額(張)",checkbox:=1,axis:=2,ScaleLabel:=slfull,ScaleDecimal:=sd0);//單位：張
	plot3(GetField("借券張數"),"借券(張)",checkbox:=0,axis:=11,ScaleLabel:=slfull,ScaleDecimal:=sd0);//單位：張，新增查價顯示 (繪圖形式->隱藏, 不畫圖)
	plot4(getfield("還券張數"),"還券(張)",checkbox:=0,axis:=11,ScaleLabel:=slfull,ScaleDecimal:=sd0);//單位：張，新增查價顯示 (繪圖形式->隱藏, 不畫圖)
end;
]]></Code>
<Arg><![CDATA[<Arg seed="4e9743f3-64c0-4e71-83fd-26f0d95c40be" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="c6dcfa40-bf49-4c77-894f-670fb5f40235" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="1" min="-100" max="100" /></Axises><Plot name="借券餘額(張)" number="1" type="0" color="5275903" color2="5275903" style="0" weight="0" axis="0" DecimalFormat="1" NumFormat="1" checkbox="1" SetDecimalFormat="1" SetNumFormat="1" colors="-1,-1" offset="0" /><Plot name="差額(張)" number="2" type="1" color="255" color2="62464" style="3" weight="0" axis="1" DecimalFormat="1" NumFormat="1" checkbox="1" SetDecimalFormat="1" SetNumFormat="1" colors="-1,-1" offset="0" /><Plot name="借券(張)" number="3" type="0" color="65280" color2="65280" style="5" weight="0" axis="10" DecimalFormat="1" NumFormat="1" checkbox="0" SetDecimalFormat="1" SetNumFormat="1" colors="-1,-1" offset="0" /><Plot name="還券(張)" number="4" type="0" color="14680319" color2="14680319" style="5" weight="0" axis="10" DecimalFormat="1" NumFormat="1" checkbox="0" SetDecimalFormat="1" SetNumFormat="1" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="51" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{&quot;0&quot;:[67,65,66]},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="買賣力" ID="df8b7d3d65bc42d88fe9d423435374cf" ReturnType="0" ExecType="1" Folder="/即時籌碼/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[{指標數值定義：(外盤)量 = 開盤累計到目前的(外盤)成交量

支援商品：台股/期貨/選擇權}

if symbolexchange <> "TW" and symbolexchange <> "TF" then raiseruntimeerror("不支援此商品");
if SymbolType <> 2 and SymbolType <> 3 and SymbolType <> 5 then raiseruntimeerror("不支援此商品");

if barfreq <> "Min" and barfreq <> "D" and barfreq <> "AD" then 
	raiseruntimeerror("僅支援分鐘與日頻率（含還原）");

value91 = GetField("外盤量");//僅提供給有權限的用戶使用

value1 = GetField("外盤量","D");
value2 = GetField("內盤量","D");
value3 = value1 - value2;
plot1(value3,"買賣力");
plot2(value1,"外盤量",checkbox:=0);
plot3(value2,"內盤量",checkbox:=0);]]></Code>
<Arg><![CDATA[<Arg seed="ca09eb51-db04-4e58-9081-178d2ec2add7" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="c792f17c-7a74-4cdd-99de-878324b4cfd4" version="1"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="1" min="-100" max="100" /></Axises><Plot name="買賣力" number="1" type="1" color="255" color2="65280" style="3" weight="0" axis="1" DecimalFormat="1" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="," offset="0" /><Plot name="外盤量" number="2" type="0" color="16711935" color2="255" style="0" weight="0" axis="0" DecimalFormat="1" NumFormat="0" checkbox="0" SetDecimalFormat="0" SetNumFormat="0" colors="," offset="0" /><Plot name="內盤量" number="3" type="0" color="15446382" color2="65280" style="0" weight="0" axis="0" DecimalFormat="1" NumFormat="0" checkbox="0" SetDecimalFormat="0" SetNumFormat="0" colors="," offset="0" /></Plots>]]></Plots>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="16" />
<script>
<freq support="8;11" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{&quot;0&quot;:[21],&quot;8&quot;:[21,20]},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="趨勢線" ID="798b5c65b3cd4556b75d7d99c32f6326" ReturnType="0" ExecType="1" Folder="/主圖指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input: periods(30, "期間");
input: startyear(2017, "起始年份");

variable: maxh_bar(0), idx(0), line_a(0), line_b(0), x_bar(0), idx2(0), temp_y(0), base_bar(0);

// 起始年之前的資料不計算
if year(date) < startyear then return;

// 如果已經有趨勢線的話, 檢查是否突破
if base_bar > 0 then begin
	temp_y = line_a * (currentbar - base_bar) + line_b;
	if high > temp_y then 
		plot1(high) 
	else 
		noplot(1);	
end;

// 計算過去N期的趨勢線
maxh_bar = nthhighestbar(1, high, periods);

base_bar = 0;	// 用來追蹤最近一個趨勢線的x=0的位置
idx = maxh_bar-1;
while idx >= 0 begin
	// 畫一條曲線從maxh_bar to idx, 假設maxh_bar的位置x=0
	//
	// x0 = 0, y0 = high[maxh_bar] == b
	// x1 = maxh_bar - idx, y1 = high[idx]
	//
	line_b = high[maxh_bar];
	line_a = (high[idx] - line_b) / (maxh_bar - idx);
	x_bar = idx;

	// 檢查是否所有的點都落在這條切線底下
	//
	condition1 = false;
	for idx2 = maxh_bar - 1 downto 0 begin
		// x = maxh_bar - idx2
		//
		temp_y = line_a * (maxh_bar - idx2) + line_b;
		if high[idx2] > temp_y then begin
			condition1 = true;
			break;
		end;
	end;
	if not condition1 then begin
		base_bar = currentbar - maxh_bar;
		break; 
	end;
    idx = idx - 1;	
end;




]]></Code>
<Arg><![CDATA[<Arg seed="5ce40412-80ca-433b-a64c-019a615a53fe" version="1"><Param name="期間" varname="periods" type="1" subtype="0" value="30" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="起始年份" varname="startyear" type="1" subtype="0" value="2017" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="988a9a7e-43c1-4fcd-8048-9410453df9dc" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="plot1" number="1" type="0" color="5275903" color2="5275903" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,f2404d9ffb2f49b3a38c431fcfc254b5;1,de75aec76c414cb0b78812a623b506e8</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="2" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="KO成交量擺盪指標" ID="8daede2c673c4a28a4ac3ec92efe0b28" ReturnType="0" ExecType="3" Folder="/量能指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[Input: length1(34);	setinputname(1, "短天期");
Input: length2(55);	setinputname(2, "長天期");
Input: length3(13);	setinputname(3, "平均天期");

variable: kovolume(0), tp(0), ko(0), koaverage(0);   

tp =(close+high+low)/3;   

if tp >= tp[1] then   
	kovolume = volume   
else    
	kovolume = -volume;
  
ko = average(kovolume, length1) - average(kovolume, length2);
koaverage = average(ko, length3);

Plot1(ko, "KO");
Plot2(koaverage, "平均");

 ]]></Code>
<Arg><![CDATA[<Arg seed="ee560459-f3c1-4582-a067-f2a8232d5b9d" version="1"><Param name="短天期" varname="length1" type="1" subtype="0" value="34" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="長天期" varname="length2" type="1" subtype="0" value="55" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="平均天期" varname="length3" type="1" subtype="0" value="13" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="0c8cd4fe-11f8-4fe1-abd1-ed4adac4adcf" version="1"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="KO" number="1" type="0" color="5275903" color2="0" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /><Plot name="平均" number="2" type="0" color="16764006" color2="0" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="100" />
<Maxbb val="60" />
<ScriptComplexity val="4" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="創新高天數減破底天數" ID="c53da56834064445ab0d5a26d3d8a704" ReturnType="0" ExecType="1" Folder="/技術指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:period(12,"期數");

value1=countif(low<lowest(low[1],period),period);//近期創新低天數
value2=countif(high>highest(high[1],period),period);//近期創新高天數
value3=value2-value1;

plot1(value3,"天數差");
plot2(3);
plot3(-3);]]></Code>
<Arg><![CDATA[<Arg seed="1f09eeb7-9b8a-4ad9-9ac9-8debf6076e56" version="1"><Param name="期數" varname="period" type="1" subtype="0" value="12" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="ed4ce527-6876-4174-b0f1-72fe7bc91954" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="天數差" number="1" type="0" color="5275903" color2="5275903" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /><Plot name="plot2" number="2" type="0" color="255" color2="255" style="0" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /><Plot name="plot3" number="3" type="0" color="65280" color2="65280" style="0" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,61c06064ad98469db9ce30287ae4a2c8;1,f1b429ac13b2447c909302198c18ca56;1,d80cf92ddfcc42e0a6c53ec47edebd49;1,2bca774c6b7549c1b0b008d2a54b288e</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="5" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="法人累計買賣超" ID="41fa630c7b2b4ea3bc20212bb6bea3be" ReturnType="0" ExecType="3" Folder="/籌碼指標/" StatusMask="2">
<Desc><![CDATA[計算一段時間的三大法人累計買賣超張數以及占成交的比重]]></Desc>
<Code><![CDATA[input: Length(5); setinputname(1,"計算天數");
input:TXT("僅適用日線以上"); setinputname(2,"使用限制");

if barfreq = "Tick" or barfreq = "Min"
	then raiseruntimeerror("不支援此頻率");
	
variable: _buyTotal(0), volTotal(0);

_buyTotal = summation(GetField("法人買賣超張數"), Length);
volTotal = summation(Volume, Length);

Plot1(_buyTotal, "累計買賣超");
Plot2(_buyTotal * 100 / volTotal, "比例%");
]]></Code>
<Arg><![CDATA[<Arg seed="97aa73bb-892b-4a73-a452-1e246022c10c" version="1"><Param name="計算天數" varname="Length" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="使用限制" varname="TXT" type="3" subtype="0" value="僅適用日線以上" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="bfccefa4-831a-44b4-a521-ba638e396314" version="1"><Axises><Axis value="1" align="1" min="-100" max="100" /><Axis value="2" align="1" min="-100" max="100" /></Axises><Plot name="累計買賣超" number="1" type="1" color="5275903" color2="0" style="0" weight="0" axis="1" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /><Plot name="比例%" number="2" type="0" color="255" color2="0" style="0" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="30" />
<Maxbb val="20" />
<ScriptComplexity val="8" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{&quot;0&quot;:[50]},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="週MACD" ID="fadf9f4da3684973a71e3189c5ca1230" ReturnType="0" ExecType="3" Folder="/跨頻率指標/" StatusMask="2">
<Desc><![CDATA[畫出週MACD指標]]></Desc>
<Code><![CDATA[// 跨頻率週MACD指標
// 不支援大頻率跨小頻率，例如：
// 不支援主頻率週資料，跨頻率計算日MACD技術指標。
//
if barfreq <> "Tick" and barfreq <> "Min" and barfreq <> "D" and barfreq <> "W" and barfreq <> "AD" and barfreq <> "AW" then raiseruntimeerror("不支援大頻率跨小頻率");

input: FastLength(12), SlowLength(26), MACDLength(9);

SetInputName(1, "DIF短天數");
SetInputName(2, "DIF長天數");
SetInputName(3, "MACD天數");

xf_macd("W",xf_weightedclose("W"),FastLength,SlowLength,MACDLength,value1,value2,value3);

// 前面區段資料變動較大, 先不繪出
//
if CurrentBar <= SlowLength then
begin
	Value1 = 0;
	Value2 = 0;
	Value3 = 0;
end;

Plot1(Value1, "週DIF");
Plot2(Value2, "週MACD");
Plot3(Value3, "週Osc");
]]></Code>
<Arg><![CDATA[<Arg seed="51de947c-8187-4bf2-9919-b5fdc269d498" version="1"><Param name="DIF短天數" varname="FastLength" type="1" subtype="0" value="12" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="DIF長天數" varname="SlowLength" type="1" subtype="0" value="26" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="MACD天數" varname="MACDLength" type="1" subtype="0" value="9" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="41466b1c-a27b-4740-b0c9-1ac7dce7d287" version="0">
	<Axises>
		<Axis value="1" align="1" min="-100.000000" max="100.000000" SetMin="1" SetMax="1" mpvalue="0.000000" />
		<Axis value="2" align="1" min="-100.000000" max="100.000000" SetMin="1" SetMax="1" mpvalue="0.000000" />
	</Axises>
	<Plot name="週DIF" number="1" color="5275903" color2="0" axis="1" checkbox="-1" colors="," offset="0" />

	<Plot name="週MACD" number="2" color="65535" color2="0" axis="1" checkbox="-1" colors="," offset="0" />

	<Plot name="週Osc" number="3" type="1" style="3" color="255" color2="65280" checkbox="-1" colors="," offset="0" />

</Plots>]]></Plots>
<RefFunc>1,9a3ac889d48d420cacce0746079cf8da;1,57f222578a2c4d17b2b88b65b8f28696;1,d6c8ec6b762c4f47b2ad9bfd806fea5f;1,a631841c1a7244f9aa969b2cca247c07;1,233ddb3b239c47afbc4bb39cadc78be6</RefFunc>
<Extra><![CDATA[<Extra>
	<TotalBar val="200" />
	<Maxbb val="0" />
	<IsScriptSetTB val="0" />
	<IsScriptSetBB val="0" />
</Extra>]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="2" Name="分公司交易家數差" ID="90b889f8fe204e60b6a74fea7afa6834" ReturnType="0" ExecType="1" Folder="/籌碼指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:period1(22,"MA天期");
input:period2(10,"差異MA天期");

if barfreq = "Tick" or barfreq = "Min"
	then raiseruntimeerror("不支援此頻率");
	
value1=GetField("分公司交易家數");
value2=average(value1,period1);
value3=value1-value2;
value4=average(value3,period2);
plot1(value3,"分公司家數差");
plot2(value4,"家數差移動平均線");]]></Code>
<Arg><![CDATA[<Arg seed="ece37f2e-52ee-43d2-8190-0f117c09185a" version="1"><Param name="MA天期" varname="period1" type="1" subtype="0" value="22" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="差異MA天期" varname="period2" type="1" subtype="0" value="10" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="2ccaabbc-0ebd-4680-8867-4fab91d0ddb2" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="分公司家數差" number="1" type="0" color="5275903" color2="5275903" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /><Plot name="家數差移動平均線" number="2" type="0" color="255" color2="255" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="8" />
<script>
<freq support="8;11" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{&quot;0&quot;:[164]},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="range trading指標" ID="98d4d80201be4c5e945aecc12c068c4a" ReturnType="0" ExecType="3" Folder="/技術指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[value1=average(range,200);
value2=average(range,3);
value3=(value2-value1)/value1;
plot1(value3,"長短天期range差");
 
]]></Code>
<Arg><![CDATA[<Arg seed="8b91803b-c12d-408f-92b9-39c687a012ed" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="469ec74a-9446-4bfb-a519-aff7b17619ac" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="長短天期range差" number="1" type="0" color="5275903" color2="5275903" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,b7522a72975a4d4bbc36f4fb684d6f77;1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="5" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="自營商持股比例" ID="de3943a5fc7c4fceac51ddd1b020e33f" ReturnType="0" ExecType="1" Folder="/籌碼高手/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[condition999 = symbolexchange = "TW" or symbolexchange = "TE";//台股+興櫃
condition998 = condition999 = true and symboltype = 2;//個股+興櫃

if condition998 = false //個股+興櫃
	then raiseruntimeerror("不支援此商品");


if barfreq = "Tick" or barfreq = "Min"
	then raiseruntimeerror("不支援此頻率");
	
plot1(0.01*GetField("自營商持股比例"),"自營商持股比例",axis:=1,ScaleLabel:=slpercent,ScaleDecimal:=sd2);]]></Code>
<Arg><![CDATA[<Arg seed="06036cf8-c7c6-432c-a731-70d97ae9a03a" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="e5ecdadc-b832-427c-9ffa-4f7f004a1573" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="自營商持股比例" number="1" type="0" color="5275903" color2="5275903" style="0" weight="0" axis="0" DecimalFormat="3" NumFormat="2" checkbox="-1" SetDecimalFormat="1" SetNumFormat="1" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="6" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{&quot;0&quot;:[40]},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="庫藏股指標" ID="e8212992ec69430da84f5318a43c7b68" ReturnType="0" ExecType="1" Folder="/籌碼高手/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[condition994 = symbol = "TSE.TW" or symbol = "TWSE.FS" or symbol = "OTC.TW" or symbolType = 1;//大盤、類股

if condition994 = false //大盤、類股
	then raiseruntimeerror("不支援此商品");

if barfreq = "Tick" or barfreq = "Min"
	then raiseruntimeerror("不支援此頻率");

plot1(GetField("庫藏股申請總市值")*1000,"申報總市值",axis:=1,ScaleLabel:=sltypewy,ScaleDecimal:=sdauto);//單位:千元
plot2(GetField("庫藏股申請家數"),"申報家數",checkbox:=0,axis:=2,ScaleLabel:=slfull,ScaleDecimal:=sd0);//單位:家]]></Code>
<Arg><![CDATA[<Arg seed="902d284a-c97a-45b9-ad1e-69adcf91b1a6" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="c7d36402-a847-4ff1-ab23-b1f1f1b82aec" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="申報總市值" number="1" type="1" color="255" color2="62464" style="4" weight="0" axis="0" DecimalFormat="0" NumFormat="3" checkbox="-1" SetDecimalFormat="0" SetNumFormat="1" colors="-1,-1" offset="0" /><Plot name="申報家數" number="2" type="0" color="16711935" color2="255" style="5" weight="0" axis="1" DecimalFormat="1" NumFormat="1" checkbox="0" SetDecimalFormat="1" SetNumFormat="1" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="11" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{&quot;0&quot;:[198,196]},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="DPO (非趨勢價格擺盪指標)" ID="5c61b5cf07134ff78d28e2eca413c4f8" ReturnType="0" ExecType="3" Folder="/XQ技術指標/" StatusMask="2">
<Desc><![CDATA[畫出非趨勢價格擺盪指標]]></Desc>
<Code><![CDATA[// XQ: DPO指標
//
input: Length(10);
variable: dpo(0);

SetInputName(1, "天數");

dpo = Close - Average(Close, Length)[(Length /2) + 1];

Plot1(dpo, "DPO"); 
        
		]]></Code>
<Arg><![CDATA[<Arg seed="fe70de57-a38a-40d2-80b0-eb30796a5162" version="1"><Param name="天數" varname="Length" type="1" subtype="0" value="10" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="7d1eef3f-40ec-409f-98bf-e049d86cd2e6" version="1"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="DPO" number="1" type="0" color="5275903" color2="0" style="0" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="20" />
<Maxbb val="15" />
<ScriptComplexity val="2" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="SAR" ID="438b01104b994078bb72150cc118a273" ReturnType="0" ExecType="3" Folder="/主圖指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:		
	AFInitial(0.02, "加速因子起始值"), 
	AFIncrement(0.02, "加速因子累加值"), 
	AFMax(0.2, "加速因子最高值");

plot1(SAR(AFInitial, AFIncrement, AFMax), "SAR");]]></Code>
<Arg><![CDATA[<Arg seed="36deaca9-de64-4906-924a-64cb3d34b264" version="1"><Param name="加速因子起始值" varname="AFInitial" type="1" subtype="0" value="0.02" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="加速因子累加值" varname="AFIncrement" type="1" subtype="0" value="0.02" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="加速因子最高值" varname="AFMax" type="1" subtype="0" value="0.2" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="7cc9e96e-5dab-4a71-8d4e-d9888c7ec8ba" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="SAR" number="1" type="2" color="13421772" color2="0" style="6" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,1ac64461c4f341bc8e1d3ac1998fd29e</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="300" />
<Maxbb val="50" />
<ScriptComplexity val="2" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="法人買進及賣出比例" ID="e6766a5ecf424bde881bce0486f73dc1" ReturnType="0" ExecType="1" Folder="/籌碼指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[if barfreq = "Tick" or barfreq = "Min"
	then raiseruntimeerror("不支援此頻率");
	
value1=GetField("外資買張");
value2=GetField("外資賣張");
value3=GetField("投信買張");
value4=GetField("投信賣張");
value5=value1+value3;
value6=value2+value4;
if volume <> 0 then begin
	value7=value5/volume*100;
	value8=value6/volume*100;
end;

plot1(value7,"法人買進比例");
plot2(value8,"法人賣出比例");
]]></Code>
<Arg><![CDATA[<Arg seed="3de58e55-a045-450b-93c6-d3611b110386" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="bd11fb4b-b155-4af3-8afe-f7f51d961552" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="法人買進比例" number="1" type="0" color="255" color2="5275903" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /><Plot name="法人賣出比例" number="2" type="0" color="65280" color2="255" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="21" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{&quot;0&quot;:[27,28,32,33]},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="實戶累計買賣超" ID="1d8f7c722e8946cf8c3b0fde48c259ad" ReturnType="0" ExecType="3" Folder="/籌碼指標/" StatusMask="2">
<Desc><![CDATA[計算一段時間的實戶累計買賣超張數以及占成交的比重]]></Desc>
<Code><![CDATA[input: Length(5); setinputname(1,"計算天數");
input:TXT("僅適用日線以上"); setinputname(2,"使用限制");

if barfreq = "Tick" or barfreq = "Min"
	then raiseruntimeerror("不支援此頻率");
	
variable: _buyTotal(0), volTotal(0);

_buyTotal = summation(GetField("實戶買賣超張數"), Length);
volTotal = summation(Volume, Length);

Plot1(_buyTotal, "累計買賣超");
Plot2(_buyTotal * 100 / volTotal, "比例%");
]]></Code>
<Arg><![CDATA[<Arg seed="63fa3f95-5afe-4ad2-bc14-2f696f0b2e5a" version="1"><Param name="計算天數" varname="Length" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="使用限制" varname="TXT" type="3" subtype="0" value="僅適用日線以上" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="56c3c2ee-15eb-4be2-8042-e363a4c73c17" version="1"><Axises><Axis value="1" align="1" min="-100" max="100" /><Axis value="2" align="1" min="-100" max="100" /></Axises><Plot name="累計買賣超" number="1" type="1" color="5275903" color2="0" style="0" weight="0" axis="1" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /><Plot name="比例%" number="2" type="0" color="255" color2="0" style="0" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="40" />
<Maxbb val="20" />
<ScriptComplexity val="8" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{&quot;0&quot;:[61]},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="股性綜合分數指標" ID="bde492be412942998a52cb6e9a53f47b" ReturnType="0" ExecType="3" Folder="/技術指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[{
指標說明
https://xstrader.net/當xs遇到ai-從特徵值的選取開始/
}

input:day(20);
input:ratio(10);

if barfreq = "Tick" or barfreq = "Min"
	then raiseruntimeerror("不支援此頻率");

variable:count(0),x(0);

value1=GetField("總成交次數","D");
value2=average(value1,day);
value3=GetField("強弱指標");
value5=GetField("外盤均量");
value6=average(value5,day);
value7=GetField("主動買力");
value8=average(value7,day);
value9=GetField("開盤委買");
value10=average(value9,day);
value11=GetField("資金流向");
value12=average(value11,day);
value13=countif(value3>1,day);
value14=average(value13,day);//比大盤強天數
value16=GetField("法人買張");

count=0;
if value1>value2*(1+ratio/100) then count=count+1;
//比大盤強的天數
if value13>value14*(1+ratio/100) then count=count+1;
if value5>value6*(1+ratio/100) then count=count+1;
if value7>value8*(1+ratio/100) then count=count+1;
if value9>value10*(1+ratio/100) then count=count+1;
//真實波動區間
if truerange> average(truerange,20) then count=count+1;
//計算承接的力道
if truerange<>0 then begin
	if close<=open then
		value15=(close-low)/truerange*100
	else
		value15=(open-low)/truerange*100;
end;
if value15 > average(value15,day)*(1+ratio/100) then count=count+1;
//法人買張佔成交量比例
if volume<>0 then value17=value16/volume*100;
if value17>average(value17,10)*(1+ratio/100) then count=count+1;
if value11>average(value11,10)*(1+ratio/100) then count=count+1;

value18=countif(close>=close[1]*1.02,5);
//N日來漲幅較大的天數
if value18 >= 2 then count=count+1;

value19=GetField("融資買進張數");
value20=GetField("融券買進張數");
value21=(value19+value20);
value22=average(value21,day);
//散戶作多指標
if value21<value22*0.9 then count=count+1;

plot1(average(count,3),"股性綜合分數指標");
plot2(3);
 



]]></Code>
<Arg><![CDATA[<Arg seed="db844287-17d2-4d73-986e-e35374bb15cb" version="1"><Param name="day" varname="day" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="ratio" varname="ratio" type="1" subtype="0" value="10" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="9ba687bf-050d-4a3e-8600-3e1739b180b3" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="股性綜合分數指標" number="1" type="0" color="5275903" color2="5275903" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /><Plot name="plot2" number="2" type="0" color="255" color2="255" style="0" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c;1,d80cf92ddfcc42e0a6c53ec47edebd49;1,36d1fc033c6f48f8a136f9e1fdec110f;1,81394f9cf0c8469ea5f8832700aec8b7;1,9e03682196e24611b2fe326b6a56433d</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="65" />
<script>
<freq support="8;11" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{&quot;8&quot;:[183],&quot;0&quot;:[178,97,86,73,75,48,170,172]},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="修正式移動平均線" ID="9e2155bfac034f498bbe53e74fb004da" ReturnType="0" ExecType="3" Folder="/主圖指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:n(20,"計算期數");
variable: w(0);

if barfreq = "Tick" or barfreq = "Min" then
begin
	value1=GetField("內盤量");//單位:元
	value2=GetField("外盤量");//單位:元
end else begin
	value1=GetField("內盤量","D");//單位:元
	value2=GetField("外盤量","D");//單位:元
end;

//計算內外盤比
if value2<>0 then
	value3=value1/value2*100
else
	value3=100;

if close>close[1] then begin
	if value3>130 then 
		w=2.5
	else if value3>120 then
		w=2.2
	else if value3>110 then
		w=2.1
	else if value3>100 then
		w=1.9
	else
		w=1.8;
end else if value3<70 then 
		w=2.5
	else if value3<80 then 
		w=2.2
	else if value3<90 then 
		w=2.1
	else if value3<100 then 
		w=1.9
	else
		w=1.8;

value4=(w/(n+1))*close+(n-1)/(n+1)*value4[1];
value5=average(close,n);

plot2(value5,"移動平均線");



 

]]></Code>
<Arg><![CDATA[<Arg seed="583fd95d-f809-4f3b-9c7e-cb307235f2b8" version="1"><Param name="計算期數" varname="n" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="8f4b7918-de18-4a85-9fd4-9cb91a7046ad" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="移動平均線" number="2" type="0" color="255" color2="255" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="22" />
<script>
<freq support="8;11" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{&quot;0&quot;:[20,21],&quot;8&quot;:[20,21]},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="比大盤強的天數" ID="a49778867f7f4cd99c02b20ed1a4cd41" ReturnType="0" ExecType="1" Folder="/技術指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[{
指標說明
https://xstrader.net/股性系列之七-比大盤強的天數/
}

input:day(10,"統計天數");
input:period(20,"平滑天數");

if barfreq <> "D" then raiseruntimeerror("不支援此頻率");

value1=GetField("強弱指標");
value2=countif(value1>1,day);
value3=average(value2,period);

plot1(Value2,"比大盤強的天數");
plot2(value3,"移動平均");
]]></Code>
<Arg><![CDATA[<Arg seed="4e87725a-97cb-4f49-9e1a-c8d214715612" version="1"><Param name="統計天數" varname="day" type="1" subtype="0" value="10" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="平滑天數" varname="period" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="30028f0a-9b8e-47ca-b54b-30dff216f98d" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="比大盤強的天數" number="1" type="0" color="5275903" color2="5275903" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /><Plot name="移動平均" number="2" type="0" color="65535" color2="255" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,d80cf92ddfcc42e0a6c53ec47edebd49;1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="8" />
<script>
<freq support="8;11" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{&quot;0&quot;:[178]},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="分時大戶買賣力" ID="f1dd6bdeeba342479a412222e36fb5da" ReturnType="0" ExecType="1" Folder="/即時籌碼/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[{指標數值定義："大戶單=特大單+大單資料為分鐘統計張數"

支援商品：台(股票)}

if barfreq <> "Min" and barfreq <> "D" and barfreq <> "AD" then 
	raiseruntimeerror("僅支援分鐘與日頻率（含還原）");

value1 = GetField("賣出特大單量") + GetField("賣出大單量");
value2 = GetField("買進特大單量") + GetField("買進大單量");
value3 = value2 - value1;
plot1(value3,"大戶買賣力");
plot2(value2,"大戶外盤量",checkbox:=0);
plot3(value1,"大戶內盤量",checkbox:=0);]]></Code>
<Arg><![CDATA[<Arg seed="1cdb3bdf-e2ae-43c4-880f-b40fd1a14d08" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="e433a241-bb06-435d-9fbc-4d1c399beaae" version="1"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="1" min="-100" max="100" /></Axises><Plot name="大戶買賣力" number="1" type="1" color="255" color2="65280" style="3" weight="0" axis="1" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="," offset="0" /><Plot name="大戶外盤量" number="2" type="0" color="16711935" color2="255" style="5" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="0" SetDecimalFormat="0" SetNumFormat="0" colors="," offset="0" /><Plot name="大戶內盤量" number="3" type="0" color="15446382" color2="65280" style="5" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="0" SetDecimalFormat="0" SetNumFormat="0" colors="," offset="0" /></Plots>]]></Plots>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="21" />
<script>
<freq support="8;11" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{&quot;0&quot;:[334,340,331,337]},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="大戶散戶籌碼流向(金額)" ID="fb82035fd28942f3bf3ab7bea7f74d0e" ReturnType="0" ExecType="1" Folder="/即時籌碼/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[{指標數值定義："大戶=特大單+大單, 散戶=小單 
資料為大戶/散戶從開盤累計到現在的(外盤-內盤)金額"

支援商品：台(股票)}

if barfreq <> "Min" and barfreq <> "D" and barfreq <> "AD" then 
	raiseruntimeerror("僅支援分鐘與日頻率（含還原）");
	
value91 = GetField("賣出特大單金額");//僅提供給有權限的用戶使用

value1 = GetField("賣出特大單金額","D") + GetField("賣出大單金額","D");
value2 = GetField("買進特大單金額","D") + GetField("買進大單金額","D");
value3 = value2 - value1;
value11 = GetField("賣出小單金額","D");
value21 = GetField("買進小單金額","D");
value31 = value21 - value11;
plot1(value3,"大戶買賣力(金額)");
plot2(value31,"散戶買賣力(金額)");]]></Code>
<Arg><![CDATA[<Arg seed="3df0301b-322a-4552-a58d-af2c6d125528" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="9e18ea2d-ef18-4360-86de-5ed614042b75" version="1"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="大戶買賣力(金額)" number="1" type="0" color="255" color2="5275903" style="0" weight="2" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="," offset="0" /><Plot name="散戶買賣力(金額)" number="2" type="0" color="65280" color2="255" style="0" weight="2" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="," offset="0" /></Plots>]]></Plots>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="36" />
<script>
<freq support="8;11" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{&quot;0&quot;:[335],&quot;8&quot;:[335,341,332,338,353,350]},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="分公司淨買賣超家數指標" ID="5fb1cb55f282413aa07c94d6fc714c45" ReturnType="0" ExecType="1" Folder="/籌碼指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[if barfreq = "Tick" or barfreq = "Min"
	then raiseruntimeerror("不支援此頻率");
	
value1=GetField("分公司淨買超金額家數");
value2=GetField("分公司淨賣超金額家數");
value3=value2-value1;

plot1(value3,"家數差");
]]></Code>
<Arg><![CDATA[<Arg seed="ea8b76f8-b5c5-4893-9fdb-09d320e4a93c" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="90d6e225-0eec-4f90-b031-8ca3ada32c7e" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="家數差" number="1" type="1" color="255" color2="62464" style="3" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="11" />
<script>
<freq support="8;11" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{&quot;0&quot;:[162,163]},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="HV歷史波動率指標" ID="9a931e12fc0a434b809ecd44fa76198d" ReturnType="0" ExecType="1" Folder="/技術指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:LENGTH1(6,"短天期"),LENGTH2(100,"短天期");

variable:HVS(0),HVL(0),HVindex(0);
value1=log(close/close[1]);
HVS=STANDARDDEV(value1,LENGTH1,1)*100*SQUAREROOT(252);
HVL=STANDARDDEV(VALUE1,LENGTH2,1)*100*SQUAREROOT(252);
HVindex=HVS/HVL;

plot1(hvindex,"歷史波動率指標");]]></Code>
<Arg><![CDATA[<Arg seed="ae8c0512-4757-4f44-97be-f8859bacdc66" version="1"><Param name="短天期" varname="LENGTH1" type="1" subtype="0" value="6" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="短天期" varname="LENGTH2" type="1" subtype="0" value="100" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="7796d210-60fb-467c-8caa-0d4c958ab720" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="歷史波動率指標" number="1" type="0" color="5275903" color2="5275903" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,8c2d025a23c548d3a76fba10c22527b4;1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c;1,9c4f476d319b4f109a8dc8557099ded4;1,c1cda70a714d44999e5171fc53c95b0a</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="3" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="溢價率" ID="51c592abc12a4568a14d3a6402958d31" ReturnType="0" ExecType="1" Folder="/期權指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[variable:vRatio(0);

if symboltype <> 5 then 
	raiseruntimeerror("僅支援選擇權");

vRatio = 100 * (
iff(leftstr(getsymbolinfo("買賣權"),1)="C",1,-1) * (getsymbolinfo("履約價") - getsymbolfield("Underlying","收盤價")) + close)
/getsymbolfield("Underlying","收盤價");

plot1(vRatio,"溢價率%");
]]></Code>
<Arg><![CDATA[<Arg seed="30df3cff-aea6-459f-ba2a-03a35098a387" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="53ea2b49-7392-4728-a4eb-05e09f7e3f29" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="溢價率%" number="1" type="0" color="5275903" color2="5275903" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="," offset="0" /></Plots>]]></Plots>
<RefFunc>1,8c2d025a23c548d3a76fba10c22527b4</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="12" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{&quot;UNDERLYING&quot;:{&quot;0&quot;:[8]}}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="實質買賣盤比" ID="f27bd35b167649fdbb46ccb68dc6763c" ReturnType="0" ExecType="1" Folder="/籌碼高手/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[condition996 = symbolexchange = "TW" and symboltype = 2;//個股
condition994 = symbol = "TSE.TW" or symbol = "TWSE.FS" or symbol = "OTC.TW";//大盤
condition993 = symbolexchange = "TW" and symboltype = 1;//類股

if condition994 =false and condition993 = false and condition996 = false //大盤+類股+個股
	then raiseruntimeerror("不支援此商品");

if barfreq = "Tick" or barfreq = "Min"
	then raiseruntimeerror("不支援此頻率");

plot1(0.01*(GetField("實質買盤比")-GetField("實質賣盤比")),"買賣差值",checkbox:=1,axis:=2,ScaleLabel:=slpercent,ScaleDecimal:=sd2);
plot2(0.01*GetField("實質買盤比"),"買盤比",checkbox:=0,axis:=1,ScaleLabel:=slpercent,ScaleDecimal:=sd2);
plot3(0.01*GetField("實質賣盤比"),"賣盤比",checkbox:=0,axis:=1,ScaleLabel:=slpercent,ScaleDecimal:=sd2);]]></Code>
<Arg><![CDATA[<Arg seed="45100979-3c64-4778-822a-e6d82f3dd624" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="2a115a92-a6f0-41da-a192-e317197032e5" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="1" min="-100" max="100" /></Axises><Plot name="買賣差值" number="1" type="1" color="255" color2="62464" style="3" weight="0" axis="1" DecimalFormat="3" NumFormat="2" checkbox="1" SetDecimalFormat="1" SetNumFormat="1" colors="-1,-1" offset="0" /><Plot name="買盤比" number="2" type="0" color="16711935" color2="255" style="5" weight="0" axis="0" DecimalFormat="3" NumFormat="2" checkbox="0" SetDecimalFormat="1" SetNumFormat="1" colors="-1,-1" offset="0" /><Plot name="賣盤比" number="3" type="0" color="65280" color2="65280" style="5" weight="0" axis="0" DecimalFormat="3" NumFormat="2" checkbox="0" SetDecimalFormat="1" SetNumFormat="1" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="21" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{&quot;0&quot;:[98,99]},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="WAD 威廉多空力度線" ID="395edb13d5e146469b22486090b9a6ae" ReturnType="0" ExecType="3" Folder="/XQ技術指標/" StatusMask="2">
<Desc><![CDATA[畫出威廉多空力度線]]></Desc>
<Code><![CDATA[// XQ: WA/D 指標
//

variable: wad(0), _ad(0);

if CurrentBar = 1 then
	wad = 0
else
  begin	
	if close = close[1] then
		_ad = 0
	else	
	  begin
		if close < close[1] then
			_ad = close - TrueHigh
		else { close > close[1] }
			_ad = close - TrueLow;
	  end;

	wad = _ad + wad[1];
  end;
  
Plot1(wad, "WA/D");
		]]></Code>
<Arg><![CDATA[<Arg seed="0db9aba5-073d-40b2-86a7-0bfa1cc2952c" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="ee1df719-e5fa-414e-8649-d914d5d0704a" version="1"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="WA/D" number="1" type="0" color="5275903" color2="0" style="0" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,36d1fc033c6f48f8a136f9e1fdec110f;1,81394f9cf0c8469ea5f8832700aec8b7</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="100" />
<Maxbb val="0" />
<ScriptComplexity val="3" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="當日成交密度" ID="a0d11323d0cd4fd48745c0f4e7397809" ReturnType="0" ExecType="1" Folder="/量能指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[variable:II(0);

if high-low<>0 and volume<>0 then 
	II=(2*CLOSE-HIGH-LOW)/(HIGH-LOW)*VOLUME;

PLOT1(average(II,5),"成交密度");
]]></Code>
<Arg><![CDATA[<Arg seed="d76ecdd7-71c1-4433-818a-540edaf9357c" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="f4f3042a-9f66-4825-9975-26750746f032" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="成交密度" number="1" type="0" color="5275903" color2="5275903" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="2" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="融資使用率" ID="f8c225d517024cf9b38d2839509992f0" ReturnType="0" ExecType="1" Folder="/籌碼高手/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[condition996 = symbolexchange = "TW" = true and symboltype = 2;//個股

if condition996 = false //個股
	then raiseruntimeerror("不支援此商品");

if barfreq = "Tick" or barfreq = "Min"
	then raiseruntimeerror("不支援此頻率");

plot1(GetField("融資使用率")*0.01,"融資使用率",axis:=1,ScaleLabel:=slpercent,ScaleDecimal:=sd2);//單位%]]></Code>
<Arg><![CDATA[<Arg seed="23afb8dc-20c4-4c7e-bf75-4236d4b6dffa" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="90b59d29-f11b-4176-9931-2a745778e650" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="融資使用率" number="1" type="0" color="5275903" color2="5275903" style="0" weight="0" axis="0" DecimalFormat="3" NumFormat="2" checkbox="-1" SetDecimalFormat="1" SetNumFormat="1" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="6" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{&quot;0&quot;:[42]},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="外資換手比例" ID="59881eb02f224f6f85421c70d93f63eb" ReturnType="0" ExecType="3" Folder="/籌碼指標/" StatusMask="2">
<Desc><![CDATA[計算一段時間的外資買進賣出占成交的換手比例]]></Desc>
<Code><![CDATA[input: Length(5); setinputname(1,"計算天數");
input:TXT("僅適用日線以上"); setinputname(2,"使用限制");

if barfreq = "Tick" or barfreq = "Min"
	then raiseruntimeerror("不支援此頻率");
	
variable: _buyTotal(0), volTotal(0);

_buyTotal = summation(GetField("外資買張") + GetField("外資賣張"), Length);
volTotal = summation(Volume * 2, Length);

Plot1(_buyTotal, "換手張數");
Plot2(_buyTotal * 100 / volTotal, "比例%");
	


]]></Code>
<Arg><![CDATA[<Arg seed="ed28fc0d-cb5e-4223-a4da-b77f8089e422" version="1"><Param name="計算天數" varname="Length" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="使用限制" varname="TXT" type="3" subtype="0" value="僅適用日線以上" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="adb17526-296d-4c06-88af-9c7be0c5cc83" version="1"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="2" min="0" max="100" /></Axises><Plot name="換手張數" number="1" type="1" color="5275903" color2="0" style="0" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /><Plot name="比例%" number="2" type="0" color="255" color2="0" style="0" weight="0" axis="1" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="30" />
<Maxbb val="20" />
<ScriptComplexity val="13" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{&quot;0&quot;:[27,28]},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="當日沖銷張數" ID="5e69133f8ed04b5ca68f19e645691fcc" ReturnType="0" ExecType="1" Folder="/大盤指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:length(5,"期數");

if barfreq = "Tick" or barfreq = "Min"
	then raiseruntimeerror("不支援此頻率");

value1=GetField("當日沖銷張數");
value2=average(value1,length);
plot1(value2,"當日沖銷張數的移動平均");

]]></Code>
<Arg><![CDATA[<Arg seed="198bf634-fa36-4d0a-b0e6-ac676b024733" version="1"><Param name="期數" varname="length" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="0c18f813-475d-4dc0-ac5a-22d7d868911b" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="當日沖銷張數的移動平均" number="1" type="0" color="5275903" color2="5275903" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="7" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{&quot;0&quot;:[47]},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="ado聚散擺盪平均線" ID="a294dfe823944f5cab606b45a0e4f181" ReturnType="0" ExecType="1" Folder="/技術指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:period(10,"移動平均線天期");
value1=average(ado,period);
plot1(value1,"ado聚散擺盪平均線");]]></Code>
<Arg><![CDATA[<Arg seed="faac14cb-7a98-48a0-994e-080ba0b8f921" version="1"><Param name="移動平均線天期" varname="period" type="1" subtype="0" value="10" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="c523abb3-1ef4-4594-b1a2-f6e4a3e32199" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="ado聚散擺盪平均線" number="1" type="0" color="5275903" color2="5275903" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,e44b5a475730463d9cc08a4c6a18e691;1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="3" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="上漲量比重" ID="f5884f67fb24460da15651bdd6cf6685" ReturnType="0" ExecType="1" Folder="/大盤指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[{
指標說明
https://xstrader.net/盤上成交是否真的是重要指標/
}

if barfreq = "Tick" or barfreq = "Min" then 
begin
	value1=GetField("上漲量");
end else begin
	value1=GetField("上漲量","D");
end;

if volume<>0 then
	value2=value1/volume;
plot1(average(value2,5),"上漲量比重");]]></Code>
<Arg><![CDATA[<Arg seed="a3489afd-6c86-4446-a2e1-04e4168d0285" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="9acfbe20-104a-4694-8954-35e9e6065364" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="上漲量比重" number="1" type="0" color="5275903" color2="5275903" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="12" />
<script>
<freq support="8;11" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{&quot;0&quot;:[71],&quot;8&quot;:[71]},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="台股指數近月外資未平倉" ID="7cc224d775a74eb5b836752ead7b8bf4" ReturnType="0" ExecType="1" Folder="/期權指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[value1 = getsymbolfield("FITX*1.TF","外資買方未平倉口數");
value2 = getsymbolfield("FITX*1.TF","外資賣方未平倉口數");
value3 = value1 - value2;
plot1(value1,"外資未平倉買口");
plot2(value2,"外資未平倉賣口");
plot3(value3,"外資未平倉淨口");

]]></Code>
<Arg><![CDATA[<Arg seed="a0ef6c44-758c-47b2-a6f7-eaf91290e64b" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="5f2c3454-7d72-47f1-964c-54690ba331e7" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="外資未平倉買口" number="1" type="0" color="5275903" color2="0" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /><Plot name="外資未平倉賣口" number="2" type="0" color="6750207" color2="0" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /><Plot name="外資未平倉淨口" number="3" type="1" color="13311" color2="0" style="0" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<Extra><![CDATA[<Extra>
<TotalBar val="0" />
<Maxbb val="0" />
<ScriptComplexity val="11" />
<script>
<freq support="8;11" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{&quot;FITX*1.TF&quot;:{&quot;0&quot;:[140,141]}}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="散戶成本線" ID="b459a83a9580458da65c36d6875ebc0d" ReturnType="0" ExecType="3" Folder="/主圖指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[{散戶成本線內有兩個線圖, 可以分開勾選, 
一個是散戶買進成本線, 計算方式都是累計當日小單的買進金額/買進量
一個是散戶賣出成本線, 計算方式都是累計當日小單的賣出金額/買進量
支援商品：台股}

value91 = GetField("買進小單金額");//僅提供給有權限的用戶使用

if barfreq <> "Min" and barfreq <> "D" then 
	raiseruntimeerror("僅支援分鐘與日頻率");
	
//買進成本
value1 = GetField("買進小單金額","D");
value2 = GetField("買進小單量","D");
if value2 <> 0 then
	value3 = value1 / (value2*1000)
else
	value3 = value3[1];

//賣出成本
value11 = GetField("賣出小單金額","D");
value21 = GetField("賣出小單量","D");
if value21 <> 0 then 
	value31 = value11 / (value21*1000)
else
	value31 = value31[1];

plot1(value3,"散戶買進成本線",checkbox:=1);
plot2(value31,"散戶賣出成本線",checkbox:=1);]]></Code>
<Arg><![CDATA[<Arg seed="208d1f52-bb72-4b33-96e4-cb5cd0701683" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="8c8cf947-66a2-4e99-85ab-cd5034771188" version="1">
	<Axises>
		<Axis value="1" align="0" min="-100.000000" max="100.000000" SetMin="1" SetMax="1" mpvalue="0.000000" />
		<Axis value="2" align="0" min="-100.000000" max="100.000000" SetMin="1" SetMax="1" mpvalue="0.000000" />
	</Axises>
	<Plot name="散戶買進成本線" number="1" color="255" color2="5275903" weight="1" checkbox="1" colors="," offset="0" />

	<Plot name="散戶賣出成本線" number="2" color="65280" color2="255" weight="1" checkbox="1" colors="," offset="0" />

</Plots>]]></Plots>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="26" />
<script>
<freq support="8;11" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{&quot;0&quot;:[350],&quot;8&quot;:[350,349,353,352]},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="Vega" ID="1ce3b07fd0184e9cb1272d36febc8bfb" ReturnType="0" ExecType="1" Folder="/期權指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[plot1(GetField("Vega"),"Vega");]]></Code>
<Arg><![CDATA[<Arg seed="8a7edd21-8527-43af-9189-6d043be74367" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="59e3b8c3-a834-445b-a0b6-795e6cd80e00" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="Vega" number="1" type="0" color="5275903" color2="5275903" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="," offset="0" /></Plots>]]></Plots>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="6" />
<script>
<freq support="8;11;9;12;10;13" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{&quot;0&quot;:[155]},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="開盤委買委賣差" ID="63260bf5401e49faa7b1fcb30a73433c" ReturnType="0" ExecType="1" Folder="/大盤指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[{
指標說明
收錄於「三週學會程式交易：打造你的第一筆自動化交易」 245頁
https://www.ipci.com.tw/books_in.php?book_id=724
}

input:length(5,"天期");

value1=GetField("開盤委買", "D");
value2=GetField("開盤委賣", "D");
value3=value1-value2;
value4=average(value3,length);

plot1(value4,"開盤委買賣差之移動平均");

]]></Code>
<Arg><![CDATA[<Arg seed="b117b7b5-9b02-4a42-b58c-d9d6e7dc3a65" version="1"><Param name="天期" varname="length" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="1dfae0c8-359e-49bf-860e-a8658534c930" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="開盤委買賣差之移動平均" number="1" type="1" color="255" color2="62464" style="3" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="12" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{&quot;8&quot;:[73,74]},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="分鐘與日DMI-Osc" ID="0bc5cf6bf0634e63bf7953c311ad0052" ReturnType="0" ExecType="3" Folder="/跨頻率指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[// 跨頻率DMI-Osc指標，預設跨頻率為30分鐘
// 不支援大頻率跨小頻率，例如：
// 不支援主頻率60分鐘，跨頻率計算30分鐘DMI-Osc技術指標。
//
input:	Length(14, "天數"),
		FreqType("30", "跨頻率週期", inputkind:=dict(["1分鐘","1"],["5分鐘","5"],["10分鐘","10"],["15分鐘","15"],["30分鐘","30"],["60分鐘","60"],["日","D"],["還原日","AD"]));

variable: pdi_value(0), ndi_value(0), adx_value(0);

if barfreq <> "Tick" and barfreq <> "Min" and barfreq <> "D" and barfreq <> "AD" then raiseruntimeerror("此範例僅支援分鐘、日與還原日頻率");

xfMin_DirectionMovement(FreqType, Length, pdi_value, ndi_value, adx_value);

// 初始區波動較大, 先不繪出
//
if CurrentBar < Length then
 begin
	pdi_value = 0;
	ndi_value = 0;
	adx_value = 0;
 end;

Plot1(pdi_value - ndi_value, "分鐘與日DMI-Osc");

// 防呆，大頻率跨小頻率時，在線圖秀不支援
//
switch (FreqType)
begin
	case  "1":
		if barfreq <> "Tick" and barfreq <> "Min" then raiseruntimeerror("不支援大頻率跨小頻率：主頻率大於1分鐘");
		if barinterval <> 1 then raiseruntimeerror("不支援大頻率跨小頻率：主頻率大於1分鐘");
		setplotlabel(1, "1分DMI-Osc");

	case  "5":
		if barfreq <> "Tick" and barfreq <> "Min" then raiseruntimeerror("不支援大頻率跨小頻率：主頻率大於5分鐘");
		if barinterval <> 1 and barinterval <> 2 and barinterval <> 3 and barinterval <> 5 then raiseruntimeerror("不支援大頻率跨小頻率：主頻率大於5分鐘");
		setplotlabel(1, "5分DMI-Osc");

	case "10":
		if barfreq <> "Tick" and barfreq <> "Min" then raiseruntimeerror("不支援大頻率跨小頻率：主頻率大於10分鐘");
		if barinterval <> 1 and barinterval <> 2 and barinterval <> 3 and barinterval <> 5 and barinterval <> 10 then raiseruntimeerror("不支援大頻率跨小頻率：主頻率大於10分鐘");
		setplotlabel(1, "10分DMI-Osc");

	case "15":
		if barfreq <> "Tick" and barfreq <> "Min" then raiseruntimeerror("不支援大頻率跨小頻率：主頻率大於15分鐘");
		if barinterval <> 1 and barinterval <> 2 and barinterval <> 3 and barinterval <> 5 and barinterval <> 10 and barinterval <> 15 then raiseruntimeerror("不支援大頻率跨小頻率：主頻率大於15分鐘");
		setplotlabel(1, "15分DMI-Osc");
		
	case "30":
		if barfreq <> "Tick" and barfreq <> "Min" then raiseruntimeerror("不支援大頻率跨小頻率：主頻率大於30分鐘");
		if barinterval <> 1 and barinterval <> 2 and barinterval <> 3 and barinterval <> 5 and barinterval <> 10 and barinterval <> 15 and barinterval <> 20 and barinterval <> 30 then raiseruntimeerror("不支援大頻率跨小頻率：主頻率大於30分鐘");
		setplotlabel(1, "30分DMI-Osc");

	case "60":
		if barfreq <> "Tick" and barfreq <> "Min" then raiseruntimeerror("不支援大頻率跨小頻率：主頻率大於60分鐘");
		if barinterval <> 1 and barinterval <> 2 and barinterval <> 3 and barinterval <> 5 and barinterval <> 10 and barinterval <> 15 and barinterval <> 20 and barinterval <> 30 and barinterval <> 45 and barinterval <> 60 then raiseruntimeerror("不支援大頻率跨小頻率：主頻率大於60分鐘");
		setplotlabel(1, "60分DMI-Osc");
	
	case "D":
		if barfreq <> "Tick" and barfreq <> "Min" and barfreq <> "D" and barfreq <> "AD" then raiseruntimeerror("不支援大頻率跨小頻率：主頻率大於日");
		setplotlabel(1, "日DMI-Osc");
		
	case "AD":
		if barfreq <> "Tick" and barfreq <> "Min" and barfreq <> "D" and barfreq <> "AD" then raiseruntimeerror("不支援大頻率跨小頻率：主頻率大於還原日");
		setplotlabel(1, "還原日DMI-Osc");

end;
]]></Code>
<Arg><![CDATA[<Arg seed="a8e92255-f8f2-40db-a9f2-cd41d8387194" version="1"><Param name="天數" varname="Length" type="1" subtype="0" value="14" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="跨頻率週期" varname="FreqType" type="3" subtype="0" value="30" isSerial="0" isArray="0" isRef="0" inputkind="1" quickedit="0" keytype="3"><Pair key="1分鐘" value="1" /><Pair key="5分鐘" value="5" /><Pair key="10分鐘" value="10" /><Pair key="15分鐘" value="15" /><Pair key="30分鐘" value="30" /><Pair key="60分鐘" value="60" /><Pair key="日" value="D" /><Pair key="還原日" value="AD" /></Param></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="6dbf2cf9-5114-494c-9aff-34510aced760"><Plot name="分鐘與日DMI-Osc" number="1" type="0" color="5275903" color2="5275903" style="0" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,de5550c0989b434681e18c65fcc79915;1,8e4cc5f4d71342f9a5b6c2e5dc9a6966;1,aced678c83804b088f72d66788ddde3c;1,dc58546bafca4f169bf376e4ff00dbd4</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="20" />
<ScriptComplexity val="2" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="分時散戶買賣力" ID="d884cb1ca2754294b5c7386310c840b3" ReturnType="0" ExecType="1" Folder="/即時籌碼/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[{指標數值定義："散戶單=小單資料為分鐘統計張數"
支援商品：台(股票)}

if barfreq <> "Min" and barfreq <> "D" and barfreq <> "AD" then 
	raiseruntimeerror("僅支援分鐘與日頻率（含還原）");
	
value91 = GetField("賣出小單量");//僅提供給有權限的用戶使用

value1 = GetField("賣出小單量");
value2 = GetField("買進小單量");
value3 = value2 - value1;
plot1(value3,"散戶買賣力"); 
plot2(value2,"散戶外盤量",checkbox:=0); 
plot3(value1,"散戶內盤量",checkbox:=0); ]]></Code>
<Arg><![CDATA[<Arg seed="4450b183-4930-44e5-bee5-ce58758055ab" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="31432db2-b212-463c-9073-9ea69c6ca5da" version="1">
	<Axises>
		<Axis value="1" align="0" min="-100.000000" max="100.000000" SetMin="1" SetMax="1" mpvalue="0.000000" />
		<Axis value="2" align="1" min="-100.000000" max="100.000000" SetMin="1" SetMax="1" mpvalue="0.000000" />
	</Axises>
	<Plot name="散戶買賣力" number="1" type="1" style="3" color="255" color2="65280" axis="1" checkbox="-1" colors="," offset="0" />

	<Plot name="散戶外盤量" number="2" style="5" color="16711935" color2="255" checkbox="0" colors="," offset="0" />

	<Plot name="散戶內盤量" number="3" color="15446382" color2="65280" checkbox="0" colors="," offset="0" />

</Plots>]]></Plots>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="16" />
<script>
<freq support="8;11" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{&quot;0&quot;:[352,349]},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="大戶買賣力(金額)" ID="792bc682b58d4850b7980436fc172fb9" ReturnType="0" ExecType="1" Folder="/即時籌碼/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[{大戶買賣力(金額)是特大單金額+大單金額，資料為開盤迄今的累計
支援商品：台(股票)}

if barfreq <> "Min" and barfreq <> "D" and barfreq <> "AD" then 
	raiseruntimeerror("僅支援分鐘與日頻率（含還原）");
	
value91 = GetField("賣出特大單金額");//僅提供給有權限的用戶使用
	
value1 = GetField("賣出特大單金額","D") + GetField("賣出大單金額","D");
value2 = GetField("買進特大單金額","D") + GetField("買進大單金額","D");
value3 = value2 - value1;
plot1(value3,"大戶買賣力(金額)");
plot2(value2,"大戶外盤金額",checkbox:=0);
plot3(value1,"大戶內盤金額",checkbox:=0);]]></Code>
<Arg><![CDATA[<Arg seed="c7f2daf3-e545-4b15-9f56-fbdff2c43604" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="32a29a14-f3f0-4917-b0f3-9809c2dc29eb" version="1">
	<Axises>
		<Axis value="1" align="0" min="-100.000000" max="100.000000" SetMin="1" SetMax="1" mpvalue="0.000000" />
		<Axis value="2" align="1" min="-100.000000" max="100.000000" SetMin="1" SetMax="1" mpvalue="0.000000" />
	</Axises>
	<Plot name="大戶買賣力(金額)" number="1" type="1" style="3" color="255" color2="65280" axis="1" NumFormat="3" checkbox="-1" colors="," offset="0" />

	<Plot name="大戶外盤金額" number="2" color="16711935" color2="255" NumFormat="3" checkbox="0" colors="," offset="0" />

	<Plot name="大戶內盤金額" number="3" color="14651708" color2="65280" NumFormat="3" checkbox="0" colors="," offset="0" />

</Plots>]]></Plots>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="26" />
<script>
<freq support="8;11" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{&quot;0&quot;:[335],&quot;8&quot;:[335,341,332,338]},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="勁道指標" ID="86964cd567ca481ab64ce6217c29d5d8" ReturnType="0" ExecType="1" Folder="/技術指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[{
指標說明
https://xstrader.net/積極勁道指標/
}

input:day(13,"期數");

if barfreq = "Tick" or barfreq = "Min" then
begin
	value1=GetField("外盤量");//單位:元
	value6=GetField("內盤量");//單位:元
end else begin
	value1=GetField("外盤量","D");//單位:元
	value6=GetField("內盤量","D");//單位:元
end;
value2=volume*(close-close[1]);
value8=average(volume,day);
if value6<>0 then 
	value7=(value1/value6)*volume*(close-close[1]);
value3=value7*(close-close[1]);
value4=average(value2,day)/value8;
value5=average(value3,day)/value8;


plot1(value4,"勁道指標");
plot2(value5,"積極勁道指標");]]></Code>
<Arg><![CDATA[<Arg seed="0918cf1f-43e8-491e-889f-1983a9a86947" version="1"><Param name="期數" varname="day" type="1" subtype="0" value="13" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="96753934-9677-47b8-8917-233732c9510c" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="勁道指標" number="1" type="0" color="5275903" color2="5275903" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /><Plot name="積極勁道指標" number="2" type="0" color="65535" color2="255" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="24" />
<script>
<freq support="8;11" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{&quot;0&quot;:[21,20],&quot;8&quot;:[21,20]},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="流動大戶買賣力" ID="746d66cbf80a48bb8d610d42823fe703" ReturnType="0" ExecType="1" Folder="/即時籌碼/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[{近15分鐘累計的(買進大單量+買進特大單量)-(賣出大單量+賣出特大單量)
抓近15分鐘的目的是希望可以看到最近的買賣力。}
array:_ArrayLarge[15](0),_ArraySmall[15](0);
var:_Count(0);
if barfreq <> "Min" or barinterval <> 1 then 
	raiseruntimeerror("僅支援 1 分鐘頻率");
//初始化
if getfieldDate("Date") <> getfieldDate("Date")[1] then begin
	_Count = 0;
	Array_SetValRange(_ArrayLarge, 1, 15, 0);
	Array_SetValRange(_ArraySmall, 1, 15, 0);
	value3 = 0;
	value99 = 0;
end else begin
	_Count += 1;
end;
value99 = mod(_count,15) + 1;
_ArrayLarge[value99] = GetField("買進大單量", "1") + GetField("買進特大單量", "1");
_ArraySmall[value99] = GetField("賣出大單量", "1") + GetField("賣出特大單量", "1");
value1 = Array_Sum(_ArrayLarge, 1, 15);
value2 = Array_Sum(_ArraySmall, 1, 15);
value3 = value1 - value2;
plot1(value3,"流動大戶買賣力");]]></Code>
<Arg><![CDATA[<Arg seed="662e1442-8e3f-423c-9baa-e153f3bbc136" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="ba866135-7afb-4ba3-8f72-29bb35faae41" version="1"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="流動大戶買賣力" number="1" type="1" color="255" color2="65280" style="3" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="," offset="0" /></Plots>]]></Plots>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="21" />
<script>
<freq support="2;8;11;9;12;10;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{&quot;2&quot;:[337,331,340,334]},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="短線交易比例" ID="a469d291cbaa42c69f901024e5cd20ce" ReturnType="0" ExecType="1" Folder="/技術指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[{
指標說明
https://xstrader.net/短線過熱的指標/
}

input:p1(5,"移動平均線天期");

if barfreq = "Tick" or barfreq = "Min"
	then raiseruntimeerror("不支援此頻率");

value1=GetField("融資買進張數");
value2=GetField("現股當沖張數");
value3=GetField("資券互抵張數");

value4=value1+value2+value3;

if volume>0 then 
	value5=value4/volume;
value6=average(value5,p1);

plot1(value5,"短線交易比例");
plot2(value6,"移動平均線");

]]></Code>
<Arg><![CDATA[<Arg seed="78bcd672-c6e7-4604-8569-09c1747e37f0" version="1"><Param name="移動平均線天期" varname="p1" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="5e883533-ab45-4965-829e-b8a5ff92829b" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="短線交易比例" number="1" type="1" color="255" color2="5275903" style="0" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /><Plot name="移動平均線" number="2" type="0" color="65535" color2="255" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="17" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{&quot;0&quot;:[170,184,91]},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="麥克連震盪指標" ID="dd2e74634b6347dfabe2e19191f98ec0" ReturnType="0" ExecType="3" Folder="/大盤指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:length1(19,"短天期"),length2(39,"長天期");

if barfreq = "Tick" or barfreq = "Min" then
begin
	value1=GetField("上漲量");
	value2=getfield("下跌量");
end else begin
	value1=GetField("上漲量","D");
	value2=getfield("下跌量","D");
end;

value3=value1-value2;
value4=Xaverage(value3,length1)-Xaverage(value3,length2);
plot1(value4,"麥克連震盪指標");]]></Code>
<Arg><![CDATA[<Arg seed="1fc49953-9c42-40d8-b79d-37056fb7af5b" version="1"><Param name="短天期" varname="length1" type="1" subtype="0" value="19" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="長天期" varname="length2" type="1" subtype="0" value="39" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="478f9dff-0abf-40c4-b5cc-2fafdea00d21" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="麥克連震盪指標" number="1" type="0" color="5275903" color2="5275903" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,d02c45cba76f4163a048685f7bc4002b</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="23" />
<script>
<freq support="8;11" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{&quot;0&quot;:[71,72],&quot;8&quot;:[71,72]},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="上漲下跌角度線" ID="9b1de816b31b4055abd11c36f7ea5eab" ReturnType="0" ExecType="1" Folder="/技術指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[{
指標說明
https://xstrader.net/漲勢加速的股票怎麼寫順便介紹angle這個函數/
}

input: periods(5, "期數");
 
Value1 = Angle(Date[periods], Date);

Plot1(Value1, "角度");]]></Code>
<Arg><![CDATA[<Arg seed="a7636e6b-0333-4540-9314-7745c8ca9155" version="1"><Param name="期數" varname="periods" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="35a96d8f-1026-41a5-acc2-a111070c700a" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="角度" number="1" type="0" color="5275903" color2="5275903" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,9b53abb05bd943c58357ecbe2cc3f51f</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="2" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="六合神拳指數" ID="26975d3912d74c38b003c46d5d2f51b2" ReturnType="0" ExecType="3" Folder="/技術指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:length1(6,"短天期RSI參數");
input:length2(10,"長天期RSI參數");
input:length3(10,"MTM天期");
input:length4(10,"DMI天期");

variable:count(0);

count=0;
if RSI(Close, Length1) > RSI(Close, Length2)
and rsi(close,length1)<50 then
	count=1;
if Momentum(Close, Length3) > 0 then
	count=count+1;

variable:pdi_value(0);
variable:ndi_value(0);
variable:adx_value(0);
directionmovement(length4,pdi_value,ndi_value,adx_value);
if pdi_value > ndi_value then 
	count=count+1;
	

variable:rsv1(0),k1(0),d1(0);
stochastic(9,3,3,rsv1,k1,d1);
if k1 > d1 then 
	count=count+1;

value1=average(volume,10);
if linearregslope(value1,8)>0 then
	count=count+1;

value2=average(close,8);
if linearregslope(value2,5)>0 then
	count=count+1;
	
plot1(count,"分數");
]]></Code>
<Arg><![CDATA[<Arg seed="9347eeda-4872-467a-8df2-381d8b793659" version="1"><Param name="短天期RSI參數" varname="length1" type="1" subtype="0" value="6" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="長天期RSI參數" varname="length2" type="1" subtype="0" value="10" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="MTM天期" varname="length3" type="1" subtype="0" value="10" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="DMI天期" varname="length4" type="1" subtype="0" value="10" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="1f77e921-1514-437c-9a30-94a438e88121" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="分數" number="1" type="1" color="5275903" color2="5275903" style="0" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c;1,d64c2a71d3ea43d985ca22ef62a5a8de;1,239cb1c1f329431ea731982d8f5d94f2;1,7721dca8cc7242c09d21b782bbb59bd9;1,61c06064ad98469db9ce30287ae4a2c8;1,2bca774c6b7549c1b0b008d2a54b288e;1,f1b429ac13b2447c909302198c18ca56;1,847bcd706dda4a9caf2b783e181a8e42;1,8c2d025a23c548d3a76fba10c22527b4;1,210d0786cfe340538e34c095bc2ba049;1,626e6e5c42304bbea9809d1a07ae4e01</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="11" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="BIAS 乖離率" ID="5dba5bc536ed43e6a8f882b38f1d4e2f" ReturnType="0" ExecType="3" Folder="/XQ技術指標/" StatusMask="2">
<Desc><![CDATA[畫出乖離率指標]]></Desc>
<Code><![CDATA[// XQ 乖離率
//
input: Length1(5), Length2(10), Length3(20);

SetInputName(1, "天數一");
SetInputName(2, "天數二");
SetInputName(3, "天數三");

Plot1(Bias(Length1), "BIAS1(%)");
Plot2(Bias(Length2), "BIAS2(%)");
Plot3(Bias(Length3), "BIAS3(%)");

		]]></Code>
<Arg><![CDATA[<Arg seed="3b36df87-e2e7-49b2-9fb1-a6ddd29823ac" version="1"><Param name="天數一" varname="Length1" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="天數二" varname="Length2" type="1" subtype="0" value="10" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="天數三" varname="Length3" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="e0d2adaf-a200-4462-9e94-eb241ac0c991" version="1"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="BIAS1(%)" number="1" type="0" color="5275903" color2="0" style="0" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /><Plot name="BIAS2(%)" number="2" type="0" color="255" color2="0" style="0" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /><Plot name="BIAS3(%)" number="3" type="0" color="65280" color2="0" style="0" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c;1,aa300d6ee3de439ea5eeb2f9ff3a7ed2</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="25" />
<Maxbb val="19" />
<ScriptComplexity val="4" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="CMI市場波動指標" ID="9b016a905aa740db84b370be52c07b22" ReturnType="0" ExecType="1" Folder="/技術指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[{
指標說明
https://xstrader.net/如何判斷現在是趨勢還是盤整-一個還在研究的課/
}

input:period(10,"計算區間");
value1=(close-close[period-1])/(highest(high,period)-lowest(low,period))*100;
value2=absvalue(value1)-30;
value3=average(value2,3);
plot1(value3,"市場波動指標");]]></Code>
<Arg><![CDATA[<Arg seed="724e3f37-0472-468b-85d9-cb39816d0369" version="1"><Param name="計算區間" varname="period" type="1" subtype="0" value="10" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="bf0c1d35-d5f2-4d6d-858e-fbfb7eaf5ca2" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="市場波動指標" number="1" type="1" color="255" color2="62464" style="3" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,61c06064ad98469db9ce30287ae4a2c8;1,2bca774c6b7549c1b0b008d2a54b288e;1,f1b429ac13b2447c909302198c18ca56;1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="4" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="權益線分析" ID="9a4baa322ce448458c061fae6f19321e" ReturnType="0" ExecType="3" Folder="/主圖指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:Update(-1);

variable:hHigh(0),pC(0),iHigh(0),iLow(10000),iDate(0),ALow(0),ND(0),EP(0);
array:peak[300,5](0);


if currentbar = 1 then begin 
	iHigh =high; 
	iDate =Date; 
	value1=open; 
end;

hHigh = maxlist(high,hHigh); 
if hHigh > iHigh  then begin
	if iHigh <> iLow then begin
		peak[pc,0] = date;
		peak[pc,1] = iHigh;
		peak[pc,2] = iLow;
		peak[pc,3] = (iHigh- iLow)/iHigh*100;
		peak[pc,4] = datediff(date,iDate);
		if pc > 0  and peak[pc-1,2] <> 0 then peak[pc,5] = (iHigh/ peak[pc-1,2]-1)*100;
		pc+=1;
	end;
	iHigh =hHigh;
	iLOw = hHigh;
	iDate =Date;
end else 
	iLow =minlist(Low,iLow);

if  DateDiff(currentdate,date) > update and value1 > 0 and pc > 1 then begin
	variable: summ(0),avg(0); 
	summ=0; 
	for value2 = 1 to pc -1  
		summ += peak[value2,3]; 
	avg=summ/(pc-1);
	variable: summeans(0); 
	summeans=0;
	for value2 = 1 to pc -1 begin
		summeans += square(peak[value2,3]-avg);
	end;
	variable:stdev(0); 
	if pc-1 > 0 then 
		stdev = squareroot( summeans/(pc-1)) 
	else 
		stdev=0;
    variable:msg("Hold"),poLow(0);
	poLow = iHigh*(1- (avg+stdev)/100);
	if Close < PoLow then msg ="Sell";
end;

if date <>currentdate then ALow =Polow;
if C > alow and ALow > 0 then  plot1(Alow,"95%CF");  //95%信心水準回檔最大值
if C > iHigh*0.86 then begin
	plot3(iHigh*0.92,"N1D"); //第1減碼線
	plot4(iHigh*0.86,"N2D"); //第2減碼線
end;
plot5(Close,"現價");
plot6(V,"成交量");

ND=100*(average(H/L-1,20)+standarddev(H/L-1,20,1)*3);
if ND < 3 and trueall(ND[1]> 3,5) then  EP=h;
if ND < 5 and trueall(ND[1]> 5,5) then EP=h;
if c > EP and c[1] < EP then plot8(v,"作多點量");
if EP > 0 then plot9(EP,"關鍵價");]]></Code>
<Arg><![CDATA[<Arg seed="edffc52e-ef56-4d99-bf2e-d8616f5cc901" version="1"><Param name="Update" varname="Update" type="1" subtype="0" value="-1" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="3b8416a7-84c3-43a6-9a69-2ec874ffaf47"><Plot name="95%CF" number="1" type="0" color="5275903" color2="5275903" style="0" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /><Plot name="N1D" number="3" type="0" color="65280" color2="65280" style="0" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /><Plot name="N2D" number="4" type="0" color="14680319" color2="14680319" style="0" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /><Plot name="現價" number="5" type="0" color="65535" color2="65535" style="0" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /><Plot name="成交量" number="6" type="0" color="16776960" color2="16776960" style="0" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /><Plot name="作多點量" number="8" type="0" color="3211184" color2="3211184" style="0" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /><Plot name="關鍵價" number="9" type="0" color="8392896" color2="8392896" style="0" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c;1,8c2d025a23c548d3a76fba10c22527b4;1,9c4f476d319b4f109a8dc8557099ded4;1,c1cda70a714d44999e5171fc53c95b0a;1,93ec7a47222349e7ba8a2257d29196e4</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="21" />
<Maxbb val="20" />
<ScriptComplexity val="5" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="週RSI" ID="34b0e1a9c8724bcd91ab4316869d193c" ReturnType="0" ExecType="3" Folder="/跨頻率指標/" StatusMask="2">
<Desc><![CDATA[畫出週RSI相對強弱勢指標]]></Desc>
<Code><![CDATA[// 跨頻率週RSI指標
// 不支援大頻率跨小頻率，例如：
// 不支援主頻率週資料，跨頻率計算日RSI技術指標。
//
if barfreq <> "Tick" and barfreq <> "Min" and barfreq <> "D" and barfreq <> "W" and barfreq <> "AD" and barfreq <> "AW" then raiseruntimeerror("不支援大頻率跨小頻率");

input: Length1(6), Length2(12);

SetInputName(1, "天數一");
SetInputName(2, "天數二");

Plot1(xf_RSI("W", GetField("Close","W"), Length1), "週RSI1");
Plot2(xf_RSI("W", GetField("Close","W"), Length2), "週RSI2");        
		]]></Code>
<Arg><![CDATA[<Arg seed="6c3b994b-aadf-42ce-b60a-ad0863247e1d" version="1"><Param name="天數一" varname="Length1" type="1" subtype="0" value="6" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="天數二" varname="Length2" type="1" subtype="0" value="12" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="446616dd-1e17-4340-a3e2-0166ac2af9e2" version="0"><Axises><Axis value="1" align="2" min="0" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="週RSI1" number="1" type="0" color="5275903" color2="0" style="0" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /><Plot name="週RSI2" number="2" type="0" color="255" color2="0" style="0" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,57f222578a2c4d17b2b88b65b8f28696;1,d6c8ec6b762c4f47b2ad9bfd806fea5f;1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c;1,b6137195c4c14f4dafe5be69bd24cc9b</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="13" />
<script>
<freq support="9;8;10;11;12;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{&quot;9&quot;:[8]},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="Chaikin 蔡金波動性指標" ID="f71041a64056467490b34a40a11baa2b" ReturnType="0" ExecType="3" Folder="/技術指標/" StatusMask="2">
<Desc><![CDATA[畫出蔡金波動率指標]]></Desc>
<Code><![CDATA[// Chaikin Volatility 指標
//
input: Length(10), LengthROC(12);
variable: _chaikin(0);

SetInputName(1, "天數一");
SetInputName(2, "天數二");

Value1 = XAverage(High - Low, Length);

if CurrentBar >= LengthROC And Value1[LengthROC] <> 0 then
	_chaikin = 100 * (Value1 - Value1[LengthROC]) / Value1[LengthROC]
else
	_chaikin = 0;
	
Plot1(_chaikin, "Chaikin");

		]]></Code>
<Arg><![CDATA[<Arg seed="7a948918-c829-4198-a323-706525bbf5cc" version="1"><Param name="天數一" varname="Length" type="1" subtype="0" value="10" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="天數二" varname="LengthROC" type="1" subtype="0" value="12" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="b1d1df3d-ed90-437f-ab4a-8e4f0150203a" version="1"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="Chaikin" number="1" type="0" color="5275903" color2="0" style="0" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,d02c45cba76f4163a048685f7bc4002b</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="100" />
<Maxbb val="20" />
<ScriptComplexity val="2" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="多頭動能" ID="9bb57be62cf845b5996c14adf9099896" ReturnType="0" ExecType="1" Folder="/技術指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:period(10,"平均值天期");

value1=high-close[1]+low-low[1];
value2=average(value1,period);

plot1(value2,"多頭動能平均值");]]></Code>
<Arg><![CDATA[<Arg seed="adef92b1-a8e8-4a15-a248-6e192619136c" version="1"><Param name="平均值天期" varname="period" type="1" subtype="0" value="10" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="30dec92e-d775-4c3e-be4d-816bd3b1896d" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="多頭動能平均值" number="1" type="0" color="5275903" color2="5275903" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="2" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="逢低承接的力道" ID="70106e6b1a0e4383bfb1b99ba9bae4ac" ReturnType="0" ExecType="1" Folder="/技術指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[{
指標說明
https://xstrader.net/股性系列之五承接的力道/
收錄於「三週學會程式交易：打造你的第一筆自動化交易」 324頁
https://www.ipci.com.tw/books_in.php?book_id=724
}

input:
	short1(5,"短期平均"),
	mid1(20,"長期平均");

if truerange<>0 then begin
	if close<=open then 
		value1=(close-low)/truerange*100
	else
		value1=(open-low)/truerange*100;
end;

value2=average(value1,short1);
value3=average(value2,mid1);

plot1(value2,"短期均線");
plot2(value3,"長期均線");
]]></Code>
<Arg><![CDATA[<Arg seed="fca26b0c-cc9f-43d4-9aed-808229d92f5e" version="1"><Param name="短期平均" varname="short1" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="長期平均" varname="mid1" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="14e8d727-ccd7-4814-ba07-5ec5a6d393d4" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="短期均線" number="1" type="0" color="5275903" color2="5275903" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /><Plot name="長期均線" number="2" type="0" color="65535" color2="255" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,36d1fc033c6f48f8a136f9e1fdec110f;1,81394f9cf0c8469ea5f8832700aec8b7;1,9e03682196e24611b2fe326b6a56433d;1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="6" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="台灣50大單買進金額" ID="8ba8219786ea40a4a64ac11347d9eaf5" ReturnType="0" ExecType="1" Folder="/市場動能/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[{統計台灣50成分股，近10根K棒的買進大單金額平均值。
因為不跨日，所以開盤不足10根K棒時則依照開盤根棒數平均（跨K棒時送出前一根K棒的統計值）}

if barfreq <> "Min" then raiseruntimeerror("僅支援「分鐘」頻率");

value1 = GetSymbolField("TSE50.SJ","TW50大單買進金額");

plot1(value1,"台灣50大單買進金額（元）");]]></Code>
<Arg><![CDATA[<Arg seed="2435d878-3be6-480b-8937-6f6793158cac" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="6d558cb7-d00e-4107-a6f4-90232fb11f86" version="1">
	<Axises>
		<Axis value="1" align="0" min="0.000000" max="50.000000" SetMin="1" SetMax="1" mpvalue="0.000000" />
		<Axis value="2" align="0" min="-100.000000" max="100.000000" SetMin="1" SetMax="1" mpvalue="0.000000" />
	</Axises>
	<Plot name="台灣50大單買進金額（元）" number="1" type="1" color="255" color2="5275903" NumFormat="3" checkbox="-1" colors="," offset="0" />

</Plots>]]></Plots>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="6" />
<script>
<freq support="8;11" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{&quot;TSE50.SJ&quot;:{&quot;0&quot;:[888]}}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="隱含波動率" ID="f5cc62df1d2046f6b94ad49fbe15e8c8" ReturnType="0" ExecType="1" Folder="/期權指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input: 
	iRate100(2,"無風險利率%");

variable:vStrikePrice(0),vTTMdays(0);

if symboltype <> 5 then 
	raiseruntimeerror("僅支援選擇權");

vStrikePrice = getsymbolinfo("履約價");
vTTMdays = DateDiff(GetSymbolInfo("到期日"), Date) + 1;

value1 = ivolatility(leftstr(getsymbolinfo("買賣權"),1),getsymbolfield("Underlying","收盤價"),vStrikePrice,vTTMdays,iRate100,0,c);

plot1(value1,"隱含波動率%");
]]></Code>
<Arg><![CDATA[<Arg seed="070ae4c6-5b72-44c3-b55f-5071fe5d41fe" version="1"><Param name="無風險利率%" varname="iRate100" type="1" subtype="0" value="2" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="524869a6-aab2-42b6-8cbf-ccfd721982cd" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="隱含波動率%" number="1" type="0" color="5275903" color2="5275903" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="," offset="0" /></Plots>]]></Plots>
<RefFunc>1,8c2d025a23c548d3a76fba10c22527b4;1,9726eaec317b4b98a68524683ea2ae92;1,8462f7081ead4113ba3aef780bc1040f;1,6f695b87f1f047f5b162d222df2e7edf;1,09c46fdb219b4b7a8bdaf1279d80071b</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="7" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{&quot;UNDERLYING&quot;:{&quot;0&quot;:[8]}}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="委買委賣筆數" ID="108d162255f7494ca282ee01200c733b" ReturnType="0" ExecType="1" Folder="/期權指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[{指標數值定義：(委買)筆數 = 交易所資料(開盤到目前累計(委買)筆數)
for 大盤,  委買委賣資料不含權證, 多一個成交筆數

支援商品：大盤/期貨/選擇權}

condition994 = symbol = "TSE.TW" or symbol = "TWSE.FS" or symbol = "OTC.TW";//大盤
	
if barfreq <> "Min" and barfreq <> "D" then 
	raiseruntimeerror("僅支援分鐘與日頻率");

if condition994 then begin//大盤
	value1 = GetField("累委買筆");
	value2 = GetField("累委賣筆");
	value3 = GetField("累委買筆") - GetField("累委賣筆");
	value4 = GetField("累成交筆");
	plot1(value3,"委買委賣筆數差");
	plot2(value1,"委買筆數",checkbox:=0);
	plot3(value2,"委賣筆數",checkbox:=0);
	plot4(value4,"累成交筆");
end else begin//期貨與選擇權
	value1 = GetField("累委買筆");
	value2 = GetField("累委賣筆");
	value3 = GetField("累委買筆") - GetField("累委賣筆");
	plot1(value3,"委買委賣筆數差");
	plot2(value1,"委買筆數",checkbox:=0);
	plot3(value2,"委賣筆數",checkbox:=0);
	noplot(4);
end;
]]></Code>
<Arg><![CDATA[<Arg seed="4080146c-93aa-42b5-b976-f62a0b53fa96" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="1642ee18-9008-4cd1-98ca-17fa37700a90" version="1">
	<Axises>
		<Axis value="1" align="0" min="-100.000000" max="100.000000" SetMin="1" SetMax="1" mpvalue="0.000000" />
		<Axis value="2" align="1" min="-100.000000" max="100.000000" SetMin="1" SetMax="1" mpvalue="0.000000" />
	</Axises>
	<Plot name="委買委賣筆數差" number="1" type="1" style="3" color="255" color2="65280" axis="1" checkbox="-1" colors="," offset="0" />

	<Plot name="委買筆數" number="2" color="16711935" color2="255" checkbox="0" colors="," offset="0" />

	<Plot name="委賣筆數" number="3" color="16776960" color2="65280" checkbox="0" colors="," offset="0" />

	<Plot name="累成交筆" number="4" color="65535" color2="14680319" checkbox="-1" colors="," offset="0" />

</Plots>]]></Plots>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="46" />
<script>
<freq support="8;11;9;12;10;13" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{&quot;0&quot;:[316,317,318]},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="量比" ID="37ab2ff7739242d099e9469a58bf019e" ReturnType="0" ExecType="1" Folder="/量能指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[{量比公式 = 估計量 / 昨量
當量比 > 1時表示量是放大的, 數值越大表示越強
支援商品：台(股票)}

if barfreq <> "Min" and barfreq <> "D" then 
	raiseruntimeerror("僅支援分鐘與日頻率");

value1 = GetField("量比");

plot1(value1, "量比");
plot2(1, "基準線");]]></Code>
<Arg><![CDATA[<Arg seed="038a0f4d-efdd-453a-b94c-afb97cc588cf" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="c50f16fe-9599-4d5e-adfe-65a911e85a76" version="1">
	<Axises>
		<Axis value="1" align="1" min="-100.000000" max="100.000000" SetMin="1" SetMax="1" mpvalue="1.000000" />
		<Axis value="2" align="0" min="-100.000000" max="100.000000" SetMin="1" SetMax="1" mpvalue="0.000000" />
	</Axises>
	<Plot name="量比" number="1" color="3464447" color2="5275903" weight="2" checkbox="-1" colors="," offset="0" />

	<Plot name="基準線" number="2" color="255" color2="255" checkbox="-1" colors="," offset="0" />

</Plots>]]></Plots>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="6" />
<script>
<freq support="8;11" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{&quot;0&quot;:[314]},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="主力作多成本線" ID="5d7806d892ad422f864459a7c8efd905" ReturnType="0" ExecType="1" Folder="/籌碼指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:period(40,"期數");

if barfreq = "Tick" or barfreq = "Min"
	then raiseruntimeerror("不支援此頻率");
	
value1=GetField("主力買張");
value2=(o+h+l+c)/4;

value3=value1*value2;//做多金額
 
if summation(value1,period)<>0 then
	value4=summation(value3,period)/summation(value1,period);
 
plot1(value4,"主力作多成本線");
 
]]></Code>
<Arg><![CDATA[<Arg seed="55ded3d9-1b4a-4df9-a074-46b808b9b819" version="1"><Param name="期數" varname="period" type="1" subtype="0" value="40" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="f387b542-0989-4dbb-941f-187126ef834c" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="主力作多成本線" number="1" type="0" color="5275903" color2="5275903" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="9" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{&quot;0&quot;:[52]},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="內盤長短期累積量比值差" ID="c86c566e4b8448b5a2b563d96ada76e5" ReturnType="0" ExecType="1" Folder="/大盤指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:length1(5,"短天期"),length2(20,"長天期");

variable:ac(0),ds(0),ac1(0),ds1(0);

if barfreq = "Tick" or barfreq = "Min" then 
begin
	value1=GetField("內盤量");//單位:元
	value2=GetField("外盤量");//單位:元
end else begin
	value1=GetField("內盤量","D");//單位:元
	value2=GetField("外盤量","D");//單位:元
end;
value3=summation(value1,length1);
value4=summation(value2,length1);
value5=summation(value1,length2);
value6=summation(value2,length2);
value7=summation(volume,length1);
value8=summation(volume,length2);

ac=value4/value7*100;//外盤短期積量比值
ds=value3/value7*100;//內盤短期積量比值
ac1=value6/value8*100;//外盤長期積量比值
ds1=value5/value8*100;//內盤長期積量比值

value11=ds1-ds;
plot1(value11,"內盤長短期積量比值差");





 


]]></Code>
<Arg><![CDATA[<Arg seed="02125ffa-a5f7-4005-87c6-3e7153c7fb46" version="1"><Param name="短天期" varname="length1" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="長天期" varname="length2" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="ceaa2802-3871-49c5-b0c6-255abd761b29" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="內盤長短期積量比值差" number="1" type="0" color="5275903" color2="5275903" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="27" />
<script>
<freq support="8;11" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{&quot;0&quot;:[20,21],&quot;8&quot;:[20,21]},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="軍火商指數" ID="d9d1fa605d17491da3f4a43cc4404734" ReturnType="0" ExecType="1" Folder="/大盤指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[{
指標說明
https://xstrader.net/亂世中最佳投資組合/
}

array:ValueArray[6](0);

valuearray[1]=GetSymbolField("LMT.US","收盤價");
valuearray[2]=GetSymbolField("BA.US","收盤價");
valuearray[3]=GetSymbolField("RTN.US","收盤價");
valuearray[4]=GetSymbolField("GD.US","收盤價");
valuearray[5]=GetSymbolField("NOC.US","收盤價");
valuearray[6]=GetSymbolField("UTX.US","收盤價");

value1=array_sum(valuearray,1,6);

plot1(value1);]]></Code>
<Arg><![CDATA[<Arg seed="65ba8dd4-dad2-41fa-866c-a887ac8f14ac" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="b2276cd6-8a83-4791-8aee-7965f64080b0" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="plot1" number="1" type="0" color="5275903" color2="5275903" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="31" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{&quot;LMT.US&quot;:{&quot;0&quot;:[8]},&quot;BA.US&quot;:{&quot;0&quot;:[8]},&quot;RTN.US&quot;:{&quot;0&quot;:[8]},&quot;GD.US&quot;:{&quot;0&quot;:[8]},&quot;NOC.US&quot;:{&quot;0&quot;:[8]},&quot;UTX.US&quot;:{&quot;0&quot;:[8]}}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="台灣50KD多方家數" ID="081c44448f044465b92dfa3d69044fd5" ReturnType="0" ExecType="1" Folder="/市場動能/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[{統計台灣50成分股內, 目前K > D的家數
使用KD指標，資料期數為9，K值平滑期數為3，D值平滑期數為3。}

if barfreq <> "Min" then raiseruntimeerror("僅支援「分鐘」頻率");

value1 = GetSymbolField("TSE50.SJ","TW50KD多空家數");

plot1(value1,"台灣50KD多方家數");]]></Code>
<Arg><![CDATA[<Arg seed="492b3982-be1f-46fb-92d7-7785c099e48e" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="5dcde49d-9a89-47a4-8cfb-b29adf1f10b6" version="1"><Axises><Axis value="1" align="2" min="0" max="50" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="台灣50KD多方家數" number="1" type="1" color="255" color2="5275903" style="0" weight="0" axis="0" DecimalFormat="1" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="," offset="0" /></Plots>]]></Plots>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="6" />
<script>
<freq support="8;11" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{&quot;TSE50.SJ&quot;:{&quot;0&quot;:[885]}}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="交易活躍度指標" ID="a10fb9aebf8544089eb612179c976209" ReturnType="0" ExecType="1" Folder="/量能指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[{
指標說明
https://xstrader.net/交易異常活躍指標/
}

input:day(66,"移動平均天數");
input:ratio(10,"超出均值比率");

if barfreq = "Tick" or barfreq = "Min"
	then raiseruntimeerror("不支援此頻率");

variable:count(0);

value3=GetField("強弱指標");
value4=average(value3,day);
value5=GetField("外盤均量");
value6=average(value5,day);
value7=GetField("主動買力");
value8=average(value7,day);
value9=GetField("開盤委買");
value10=average(value9,day);

count=0;
if value3>=value4*(1+ratio/100) then
	count=count+1;
if value5>=value6*(1+ratio/100) then
	count=count+1;
if value7>=value8*(1+ratio/100) then
	count=count+1;
if value9=value10*(1+ratio/100) then
	count=count+1;

value11=average(count,5);

plot1(value11,"交易活躍度指標");
]]></Code>
<Arg><![CDATA[<Arg seed="f0d11b55-451d-4951-be7f-bdfc465327f9" version="1"><Param name="移動平均天數" varname="day" type="1" subtype="0" value="66" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="超出均值比率" varname="ratio" type="1" subtype="0" value="10" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="0599cad9-dd09-4554-a02f-399ec64c78c6" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="交易活躍度指標" number="1" type="0" color="5275903" color2="5275903" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="26" />
<script>
<freq support="8;11" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{&quot;0&quot;:[178,97,86,73]},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="三方賣盤" ID="50abea6691c24f32bfc7748a30ccb2b0" ReturnType="0" ExecType="1" Folder="/籌碼高手/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[condition999 = symbolexchange = "TW" or symbolexchange = "TE";//台股+興櫃
condition998 = condition999 = true and symboltype = 2;//個股+興櫃

if condition998 = false //個股+興櫃
	then raiseruntimeerror("不支援此商品");

if barfreq = "Tick" or barfreq = "Min"
	then raiseruntimeerror("不支援此頻率");

plot1(GetField("散戶賣張"),"散戶賣出(張)",axis:=1,ScaleLabel:=slfull,ScaleDecimal:=sd0);//單位：張
plot2(GetField("實戶賣張"),"實戶賣出(張)",axis:=1,ScaleLabel:=slfull,ScaleDecimal:=sd0);//單位：張
plot3(GetField("控盤者賣張"),"控盤者賣出(張)",axis:=1,ScaleLabel:=slfull,ScaleDecimal:=sd0);//單位：張]]></Code>
<Arg><![CDATA[<Arg seed="ecc0b91a-3173-419c-86e9-0e5dc95eef6d" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="994b9e2e-4ad6-4289-aa5c-b4fa5aaec361" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="散戶賣出(張)" number="1" type="0" color="5275903" color2="5275903" style="0" weight="0" axis="0" DecimalFormat="1" NumFormat="1" checkbox="-1" SetDecimalFormat="1" SetNumFormat="1" colors="-1,-1" offset="0" /><Plot name="實戶賣出(張)" number="2" type="0" color="255" color2="255" style="0" weight="0" axis="0" DecimalFormat="1" NumFormat="1" checkbox="-1" SetDecimalFormat="1" SetNumFormat="1" colors="-1,-1" offset="0" /><Plot name="控盤者賣出(張)" number="3" type="0" color="65280" color2="65280" style="0" weight="0" axis="0" DecimalFormat="1" NumFormat="1" checkbox="-1" SetDecimalFormat="1" SetNumFormat="1" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="16" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{&quot;0&quot;:[57,60,63]},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="上昇趨勢分數" ID="116292e52142472cbd24e17faabb6dcb" ReturnType="0" ExecType="1" Folder="/量能指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[{
指標說明
https://xstrader.net/上昇趨勢分數/
}

input:length(10,"期數");

variable: count1(0),count2(0),count3(0),count4(0),x1(0);

count1=0;
count2=0;
count3=0;
count4=0;

for x1=0 to length-1
	if h[x1]>h[x1+1] then count1=count1+1;

for x1=0 to length-1
	if o[x1]>o[x1+1] then count2=count2+1;

for x1=0 to length-1
	if low[x1]>low[x1+1] then count3=count3+1;

for x1=0 to length-1
	if close[x1]>close[x1+1] then count4=count4+1;

value1=count1+count2+count3+count4;
value2=value1-20;

plot1(value2,"趨勢分數");
]]></Code>
<Arg><![CDATA[<Arg seed="14817ee3-5642-4906-932b-c1a2a578e9ed" version="1"><Param name="期數" varname="length" type="1" subtype="0" value="10" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="554f9f4e-cd49-49fe-bdb2-251917a1fd84" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="趨勢分數" number="1" type="0" color="5275903" color2="5275903" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="1" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="委買委賣均張差額" ID="ec9bfb113b43440c85ab036f117dbd8d" ReturnType="0" ExecType="1" Folder="/大盤指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[{
指標說明
收錄於「三週學會程式交易：打造你的第一筆自動化交易」 246頁
https://www.ipci.com.tw/books_in.php?book_id=724
}

input:period(10,"天數");

if barfreq = "Tick" or barfreq = "Min" then begin
	value1=GetField("委買均");
	value2=GetField("委賣均");
end else begin
	value1=GetField("委買均","D");
	value2=GetField("委賣均","D");
end;
	
	
value3=value1-value2;
value4=average(value3,period);
 
plot1(value4,"委買賣均張差額的移動平均");
]]></Code>
<Arg><![CDATA[<Arg seed="5f88a598-f21d-4622-9b6d-f3e96f5563f5" version="1"><Param name="天數" varname="period" type="1" subtype="0" value="10" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="140a59a5-6b01-4f8d-9f05-76aa8a69e085" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="委買賣均張差額的移動平均" number="1" type="1" color="255" color2="62464" style="3" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="22" />
<script>
<freq support="8;11" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{&quot;0&quot;:[113,114],&quot;8&quot;:[113,114]},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="融券" ID="6c3b0058a4a246a0a0825a9c0af099b7" ReturnType="0" ExecType="1" Folder="/籌碼高手/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[condition996 = symbolexchange = "TW" and symboltype = 2;//個股
condition994 = symbol = "TSE.TW" or symbol = "TWSE.FS" or symbol = "OTC.TW";//大盤
condition993 = symbolexchange = "TW" and symboltype = 1;//類股
condition991 = symbolexchange = "SH" and symboltype = 2;//滬股
condition990 = symbolexchange = "SZ" and symboltype = 2;//深股

if condition994 =false and condition993 = false and condition996 = false //大盤+類股+個股
	and condition991 = false and condition990 = false //陸股
	then raiseruntimeerror("不支援此商品");

if barfreq = "Tick" or barfreq = "Min"
	then raiseruntimeerror("不支援此頻率");

if condition994 then begin
	plot1(GetField("融券餘額張數"),"融券(張)",checkbox:=1,axis:=1,ScaleLabel:=sltypewy,ScaleDecimal:=sdauto);//單位：張
	plot2(GetField("融券增減張數"),"差額(張)",checkbox:=1,axis:=2,ScaleLabel:=sltypewy,ScaleDecimal:=sdauto);//單位：張
	plot3(GetField("融券買進張數"),"買進(張)",checkbox:=0,axis:=11,ScaleLabel:=sltypewy,ScaleDecimal:=sdauto);//單位：張，可勾選畫圖選項 (參數設定) 
	plot4(GetField("融券賣出張數"),"賣出(張)",checkbox:=0,axis:=11,ScaleLabel:=sltypewy,ScaleDecimal:=sdauto);//單位：張，可勾選畫圖選項 (參數設定) 
	plot5(GetField("現券償還張數"),"券償(張)",checkbox:=0,axis:=12,ScaleLabel:=sltypewy,ScaleDecimal:=sdauto);//單位：張，可勾選畫圖選項 (參數設定) 
end else begin
	plot1(GetField("融券餘額張數"),"融券(張)",checkbox:=1,axis:=1,ScaleLabel:=slfull,ScaleDecimal:=sd0);//單位：張
	plot2(GetField("融券增減張數"),"差額(張)",checkbox:=1,axis:=2,ScaleLabel:=slfull,ScaleDecimal:=sd0);//單位：張
	if condition996 then begin
		value1 = GetField("融券買進張數");
		value2 = GetField("融券賣出張數");
		value3 = GetField("現券償還張數");
	end;
	plot3(value1,"買進(張)",checkbox:=0,axis:=11,ScaleLabel:=slfull,ScaleDecimal:=sd0);//單位：張，可勾選畫圖選項 (參數設定) 
	plot4(value2,"賣出(張)",checkbox:=0,axis:=11,ScaleLabel:=slfull,ScaleDecimal:=sd0);//單位：張，可勾選畫圖選項 (參數設定) 
	plot5(value3,"券償(張)",checkbox:=0,axis:=12,ScaleLabel:=slfull,ScaleDecimal:=sd0);//單位：張，可勾選畫圖選項 (參數設定) 
end;
if condition996 then
	plot6(GetField("融券使用率")*0.01,"使用率",axis:=13,ScaleLabel:=slpercent,ScaleDecimal:=sd2);//單位%隱藏，不畫圖，僅查價，缺欄位

]]></Code>
<Arg><![CDATA[<Arg seed="f853ffb6-5fdc-4959-bf98-c87c7793c538" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="4ea5c31c-c3c3-4c97-be09-811b39601437" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="1" min="-100" max="100" /></Axises><Plot name="融券(張)" number="1" type="0" color="5275903" color2="5275903" style="0" weight="0" axis="0" DecimalFormat="1" NumFormat="1" checkbox="1" SetDecimalFormat="1" SetNumFormat="1" colors="-1,-1" offset="0" /><Plot name="差額(張)" number="2" type="1" color="255" color2="62464" style="3" weight="0" axis="1" DecimalFormat="1" NumFormat="1" checkbox="1" SetDecimalFormat="1" SetNumFormat="1" colors="-1,-1" offset="0" /><Plot name="買進(張)" number="3" type="0" color="16711935" color2="65280" style="5" weight="0" axis="10" DecimalFormat="1" NumFormat="1" checkbox="0" SetDecimalFormat="1" SetNumFormat="1" colors="-1,-1" offset="0" /><Plot name="賣出(張)" number="4" type="0" color="65280" color2="14680319" style="5" weight="0" axis="10" DecimalFormat="1" NumFormat="1" checkbox="0" SetDecimalFormat="1" SetNumFormat="1" colors="-1,-1" offset="0" /><Plot name="券償(張)" number="5" type="0" color="65535" color2="65535" style="5" weight="0" axis="11" DecimalFormat="1" NumFormat="1" checkbox="0" SetDecimalFormat="1" SetNumFormat="1" colors="-1,-1" offset="0" /><Plot name="使用率" number="6" type="0" color="16776960" color2="16776960" style="5" weight="0" axis="12" DecimalFormat="3" NumFormat="2" checkbox="-1" SetDecimalFormat="1" SetNumFormat="1" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="56" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{&quot;0&quot;:[46,44,172,173,175,234]},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="三方買盤" ID="78776ebcd8f6439abbf74bf926891fe8" ReturnType="0" ExecType="1" Folder="/籌碼高手/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[condition999 = symbolexchange = "TW" or symbolexchange = "TE";//台股+興櫃
condition998 = condition999 = true and symboltype = 2;//個股+興櫃

if condition998 = false //個股+興櫃
	then raiseruntimeerror("不支援此商品");

if barfreq = "Tick" or barfreq = "Min"
	then raiseruntimeerror("不支援此頻率");

plot1(GetField("散戶買張"),"散戶買進(張)",axis:=1,ScaleLabel:=slfull,ScaleDecimal:=sd0);//單位：張
plot2(GetField("實戶買張"),"實戶買進(張)",axis:=1,ScaleLabel:=slfull,ScaleDecimal:=sd0);//單位：張
plot3(GetField("控盤者買張"),"控盤者買進(張)",axis:=1,ScaleLabel:=slfull,ScaleDecimal:=sd0);//單位：張]]></Code>
<Arg><![CDATA[<Arg seed="2f8cc1c5-3fce-4fa5-9659-40559c9ce05c" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="515ae6f7-de1f-42ab-a9f6-a147bfdb6e26" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="散戶買進(張)" number="1" type="0" color="5275903" color2="5275903" style="0" weight="0" axis="0" DecimalFormat="1" NumFormat="1" checkbox="-1" SetDecimalFormat="1" SetNumFormat="1" colors="-1,-1" offset="0" /><Plot name="實戶買進(張)" number="2" type="0" color="255" color2="255" style="0" weight="0" axis="0" DecimalFormat="1" NumFormat="1" checkbox="-1" SetDecimalFormat="1" SetNumFormat="1" colors="-1,-1" offset="0" /><Plot name="控盤者買進(張)" number="3" type="0" color="65280" color2="65280" style="0" weight="0" axis="0" DecimalFormat="1" NumFormat="1" checkbox="-1" SetDecimalFormat="1" SetNumFormat="1" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="16" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{&quot;0&quot;:[56,59,62]},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="噪音指標" ID="f8e712453565402da77bf205eccbdbf2" ReturnType="0" ExecType="3" Folder="/大盤指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[
input:n1(5); setinputname(1,"計算天期");  
input:n2(5); setinputname(2,"移動平均天期");
  
value1=absvalue(close-close[n1-1]);  
value2=summation(range,n1);  
if value1 <> 0 then  
begin
	value3 = value2 / value1;  
	value4 = average(value3,n2);  
end;
  
plot1(value4,"噪音指標");
  ]]></Code>
<Arg><![CDATA[<Arg seed="0fb2588e-1e1a-4254-823f-5cbd928e140a" version="1"><Param name="計算天期" varname="n1" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="移動平均天期" varname="n2" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="9c3f3241-31b7-4e6a-a777-ae770142322e" version="1"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="噪音指標" number="1" type="0" color="5275903" color2="0" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,b7522a72975a4d4bbc36f4fb684d6f77;1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="300" />
<Maxbb val="50" />
<ScriptComplexity val="4" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="資金流向" ID="7e04da7a840743d8a8c9f44756db9940" ReturnType="0" ExecType="1" Folder="/籌碼指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[{
指標說明
收錄於「三週學會程式交易：打造你的第一筆自動化交易」 327頁
https://www.ipci.com.tw/books_in.php?book_id=724
}

input:
	short1(5,"短期平均"),
	mid1(12,"長期平均");

if barfreq = "Tick" or barfreq = "Min"
	then raiseruntimeerror("不支援此頻率");
	
value1=GetField("資金流向");
value2=average(value1,20);
value3=value1-value2;
value4=average(value3,short1);
value5=average(value3,mid1);

plot1(value4,"短期均線");
plot2(value5,"長期均線");


]]></Code>
<Arg><![CDATA[<Arg seed="c76fad17-8ecb-42ad-aab5-8c16d763f19c" version="1"><Param name="短期平均" varname="short1" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="長期平均" varname="mid1" type="1" subtype="0" value="12" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="916409f7-7957-4a92-96bf-f44cdee97c7e" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="短期均線" number="1" type="0" color="5275903" color2="5275903" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /><Plot name="長期均線" number="2" type="0" color="255" color2="255" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="9" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{&quot;0&quot;:[75]},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="融券使用率" ID="bf8795a8f6cf42dcafd00bf4104c5b7a" ReturnType="0" ExecType="1" Folder="/籌碼高手/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[condition996 = symbolexchange = "TW" = true and symboltype = 2;//個股

if condition996 = false //個股
	then raiseruntimeerror("不支援此商品");

if barfreq = "Tick" or barfreq = "Min"
	then raiseruntimeerror("不支援此頻率");

plot1(0.01 * GetField("融券使用率"),"融券使用率",axis:=1,ScaleLabel:=slpercent,ScaleDecimal:=sd2);//請RD加
]]></Code>
<Arg><![CDATA[<Arg seed="118c82bb-67e8-4237-ac67-76813c98d285" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="33c58865-2e2e-46bd-9d2a-4fa3eaa4757b" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="融券使用率" number="1" type="0" color="5275903" color2="5275903" style="0" weight="0" axis="0" DecimalFormat="3" NumFormat="2" checkbox="-1" SetDecimalFormat="1" SetNumFormat="1" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="6" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{&quot;0&quot;:[234]},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="extracting the trend" ID="6cba1e14ef61413ab32f3db130d1f1c8" ReturnType="0" ExecType="3" Folder="/技術指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:
	period(20),
	delta(0.1);
	
variable: price(0),gamma(0),alpha(0),beta(0),BP(0),trend(0);
price=(h+l)/2;

beta=cosine(360/period);
gamma=1/cosine(720*delta/period);
alpha=gamma-squareroot(gamma*gamma-1);
BP=0.5*(1-alpha)*(price-price[2])+beta*(1+alpha)*BP[1]-alpha*BP[2];
trend=average(bp,2*period);

plot1(trend);
plot2(0);
 ]]></Code>
<Arg><![CDATA[<Arg seed="a23a4cf6-c121-438b-aec8-05cabc5fa1a1" version="1"><Param name="period" varname="period" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="delta" varname="delta" type="1" subtype="0" value="0.1" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="c7efb73f-0166-475d-9585-e56bfaa7928b" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="plot1" number="1" type="0" color="5275903" color2="5275903" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /><Plot name="plot2" number="2" type="0" color="255" color2="255" style="0" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="2" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="Theta" ID="6a9e65fec27f4959b9763b6b45a188fd" ReturnType="0" ExecType="1" Folder="/期權指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[plot1(GetField("Theta"),"Theta");
]]></Code>
<Arg><![CDATA[<Arg seed="0e42ba64-9430-42e4-8377-5669487db657" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="0f8c752f-d111-4b79-a67a-eb20b3e31232" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="Theta" number="1" type="0" color="5275903" color2="5275903" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="," offset="0" /></Plots>]]></Plots>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="6" />
<script>
<freq support="8;11;9;12;10;13" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{&quot;0&quot;:[154]},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="AD-Osc(聚散擺盪指標)" ID="5b578d44ae424b13b10c27895035cd26" ReturnType="0" ExecType="2" Folder="/XQ技術指標/" StatusMask="2">
<Desc><![CDATA[畫出聚散擺盪指標]]></Desc>
<Code><![CDATA[// XQ: A/D Osc 指標
// 
variable: bp(0), sp(0), ado(0);

bp = High - Open;
sp = Close - Low;
if High <> low then
	ado = (bp + sp)/(2*(High - Low))*100
else
	ado = 50;

plot1(ado, "A/D-Osc");
		]]></Code>
<Arg><![CDATA[<Arg seed="7ccda2ba-de3e-4f2c-9d53-e0601c5488e6" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="60645550-6761-4cb2-9979-485592e291f6" version="1"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="A/D-Osc" number="1" type="0" color="5275903" color2="0" style="0" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<Extra><![CDATA[<Extra>
<TotalBar val="1" />
<Maxbb val="0" />
<ScriptComplexity val="1" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="台灣50紅K家數" ID="b59778d7cb1645a5af2a83c5b7d66403" ReturnType="0" ExecType="1" Folder="/市場動能/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[{統計台灣50成分股內, 目前這根K棒是紅K棒的家數.
紅K棒的定義為，收盤價大於開盤價。}

if barfreq <> "Min" then raiseruntimeerror("僅支援「分鐘」頻率");

value1 = GetSymbolField("TSE50.SJ","TW50紅K家數");

plot1(value1,"台灣50紅K家數");]]></Code>
<Arg><![CDATA[<Arg seed="e43c2a6e-923a-45de-bf71-eaeabd0773f5" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="d2fdcd55-1f18-4236-9d13-3e37ae7c2aa1" version="1">
	<Axises>
		<Axis value="1" align="2" min="0.000000" max="50.000000" SetMin="1" SetMax="1" mpvalue="0.000000" />
		<Axis value="2" align="0" min="-100.000000" max="100.000000" SetMin="1" SetMax="1" mpvalue="0.000000" />
	</Axises>
	<Plot name="台灣50紅K家數" number="1" type="1" color="255" color2="5275903" DecimalFormat="1" checkbox="-1" colors="," offset="0" />

</Plots>]]></Plots>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="6" />
<script>
<freq support="8;11" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{&quot;TSE50.SJ&quot;:{&quot;0&quot;:[881]}}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="分鐘與日威廉指標" ID="dd271b6ac4ba419da55bf7a96cf6af91" ReturnType="0" ExecType="1" Folder="/跨頻率指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[// 跨頻率威廉指標，預設跨頻率為30分
// 不支援大頻率跨小頻率，例如：
// 不支援主頻率60分鐘，跨頻率計算30分鐘威廉技術指標。
//
input: 
	Length1(14, "天數一"), Length2(28, "天數二"), Length3(42, "天數三"),
	FreqType("30", "跨頻率週期", inputkind:=dict(["1分鐘","1"],["5分鐘","5"],["10分鐘","10"],["15分鐘","15"],["30分鐘","30"],["60分鐘","60"],["日","D"],["還原日","AD"]));

if barfreq <> "Tick" and barfreq <> "Min" and barfreq <> "D" and barfreq <> "AD" then raiseruntimeerror("此範例僅支援分鐘、日與還原日頻率");

value1 = xfMin_PercentR(FreqType, Length1) - 100;
value2 = xfMin_PercentR(FreqType, Length2) - 100;
value3 = xfMin_PercentR(FreqType, Length3) - 100;

Plot1(value1, "分鐘與日威廉指標1");
Plot2(value2, "分鐘與日威廉指標2");
Plot3(value3, "分鐘與日威廉指標3");

// 防呆，大頻率跨小頻率時，在線圖秀不支援
//
switch (FreqType)
begin
	case  "1":
		if barfreq <> "Tick" and barfreq <> "Min" then raiseruntimeerror("不支援大頻率跨小頻率：主頻率大於1分鐘");
		if barinterval <> 1 then raiseruntimeerror("不支援大頻率跨小頻率：主頻率大於1分鐘");
		setplotlabel(1, "1分威廉指標1");
		setplotlabel(2, "1分威廉指標2");
		setplotlabel(3, "1分威廉指標3");

	case  "5":
		if barfreq <> "Tick" and barfreq <> "Min" then raiseruntimeerror("不支援大頻率跨小頻率：主頻率大於5分鐘");
		if barinterval <> 1 and barinterval <> 2 and barinterval <> 3 and barinterval <> 5 then raiseruntimeerror("不支援大頻率跨小頻率：主頻率大於5分鐘");
		setplotlabel(1, "5分威廉指標1");
		setplotlabel(2, "5分威廉指標2");
		setplotlabel(3, "5分威廉指標3");

	case "10":
		if barfreq <> "Tick" and barfreq <> "Min" then raiseruntimeerror("不支援大頻率跨小頻率：主頻率大於10分鐘");
		if barinterval <> 1 and barinterval <> 2 and barinterval <> 3 and barinterval <> 5 and barinterval <> 10 then raiseruntimeerror("不支援大頻率跨小頻率：主頻率大於10分鐘");
		setplotlabel(1, "10分威廉指標1");
		setplotlabel(2, "10分威廉指標2");
		setplotlabel(3, "10分威廉指標3");

	case "15":
		if barfreq <> "Tick" and barfreq <> "Min" then raiseruntimeerror("不支援大頻率跨小頻率：主頻率大於15分鐘");
		if barinterval <> 1 and barinterval <> 2 and barinterval <> 3 and barinterval <> 5 and barinterval <> 10 and barinterval <> 15 then raiseruntimeerror("不支援大頻率跨小頻率：主頻率大於15分鐘");
		setplotlabel(1, "15分威廉指標1");
		setplotlabel(2, "15分威廉指標2");
		setplotlabel(3, "15分威廉指標3");
		
	case "30":
		if barfreq <> "Tick" and barfreq <> "Min" then raiseruntimeerror("不支援大頻率跨小頻率：主頻率大於30分鐘");
		if barinterval <> 1 and barinterval <> 2 and barinterval <> 3 and barinterval <> 5 and barinterval <> 10 and barinterval <> 15 and barinterval <> 20 and barinterval <> 30 then raiseruntimeerror("不支援大頻率跨小頻率：主頻率大於30分鐘");
		setplotlabel(1, "30分威廉指標1");
		setplotlabel(2, "30分威廉指標2");
		setplotlabel(3, "30分威廉指標3");

	case "60":
		if barfreq <> "Tick" and barfreq <> "Min" then raiseruntimeerror("不支援大頻率跨小頻率：主頻率大於60分鐘");
		if barinterval <> 1 and barinterval <> 2 and barinterval <> 3 and barinterval <> 5 and barinterval <> 10 and barinterval <> 15 and barinterval <> 20 and barinterval <> 30 and barinterval <> 45 and barinterval <> 60 then raiseruntimeerror("不支援大頻率跨小頻率：主頻率大於60分鐘");
		setplotlabel(1, "60分威廉指標1");
		setplotlabel(2, "60分威廉指標2");
		setplotlabel(3, "60分威廉指標3");
		
	case "D":
		if barfreq <> "Tick" and barfreq <> "Min" and barfreq <> "D" and barfreq <> "AD" then raiseruntimeerror("不支援大頻率跨小頻率：主頻率大於日");
		setplotlabel(1, "日威廉指標1");
		setplotlabel(2, "日威廉指標2");
		setplotlabel(3, "日威廉指標3");
		
	case "AD":
		if barfreq <> "Tick" and barfreq <> "Min" and barfreq <> "D" and barfreq <> "AD" then raiseruntimeerror("不支援大頻率跨小頻率：主頻率大於還原日");
		setplotlabel(1, "還原日威廉指標1");
		setplotlabel(2, "還原日威廉指標2");
		setplotlabel(3, "還原日威廉指標3");

end;
	]]></Code>
<Arg><![CDATA[<Arg seed="c7021560-1276-4a70-bc07-c10347d648cb" version="1"><Param name="天數一" varname="Length1" type="1" subtype="0" value="14" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="天數二" varname="Length2" type="1" subtype="0" value="28" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="天數三" varname="Length3" type="1" subtype="0" value="42" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="跨頻率週期" varname="FreqType" type="3" subtype="0" value="30" isSerial="0" isArray="0" isRef="0" inputkind="1" quickedit="0" keytype="3"><Pair key="1分鐘" value="1" /><Pair key="5分鐘" value="5" /><Pair key="10分鐘" value="10" /><Pair key="15分鐘" value="15" /><Pair key="30分鐘" value="30" /><Pair key="60分鐘" value="60" /><Pair key="日" value="D" /><Pair key="還原日" value="AD" /></Param></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="6cd571a3-291d-4a09-b63d-7618b76c62b7"><Plot name="分鐘與日威廉指標1" number="1" type="0" color="5275903" color2="5275903" style="0" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /><Plot name="分鐘與日威廉指標2" number="2" type="0" color="255" color2="255" style="0" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /><Plot name="分鐘與日威廉指標3" number="3" type="0" color="65280" color2="65280" style="0" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,356e05c9c03640b798c80a02e175aed1;1,35ecad2f46b642b58d4f6babdfd8e5a7;1,0fc11e19f4a74059b2ab92fb56ddd210</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="20" />
<ScriptComplexity val="4" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="循環指標" ID="3a33e63d4f624b08b2850ea289b46399" ReturnType="0" ExecType="3" Folder="/技術指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:period(20);
input:delta(0.5);
input:fraction(0.1);

variable:price(0);
variable:alpha(0),beta(0),gamma(0),bp(0),i(0),mean(0),peak(0),valley(0),avgpeak(0),avgvalley(0);

price=(h+l)/2;
beta=cosine(360/period);
gamma=1/cosine(720*delta/period);
alpha=gamma-squareroot(gamma*gamma-1);
bp=0.5*(1-alpha)*(price-price[2])+beta*(1+alpha)*bp[1]-alpha*bp[2];
mean=average(bp,2*period);
peak=peak[1];
valley=valley[1];
if bp[1]>bp and bp[1]>bp[2] then peak=bp[1];
if bp[1]<bp and bp[1]<bp[2] then valley=bp[1];
avgpeak=average(peak,50);
avgvalley=average(valley,50);

plot1(mean);
 ]]></Code>
<Arg><![CDATA[<Arg seed="46fa3c8a-e17f-4600-b4ac-d0c405a61fb0" version="1"><Param name="period" varname="period" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="delta" varname="delta" type="1" subtype="0" value="0.5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="fraction" varname="fraction" type="1" subtype="0" value="0.1" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="a5d27232-f96d-457a-bced-f30ef758280e" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="plot1" number="1" type="0" color="5275903" color2="5275903" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="4" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="真實波動區間指標" ID="81b8594242d04d2080c9e95eafc1dc57" ReturnType="0" ExecType="3" Folder="/技術指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[{
指標說明
https://xstrader.net/股性系列之六真實波動區間/
}

input: Length1(3, "短天數");
input: Length2(20,"長天數");

value1 = Average(TrueRange, Length1);
value2 = Average(TrueRange, Length2);

Plot1(value1, "短期ATR");
plot2(value2, "長期ATR");

]]></Code>
<Arg><![CDATA[<Arg seed="67f9d848-5fa7-4424-b06c-d43446545ea4" version="1"><Param name="短天數" varname="Length1" type="1" subtype="0" value="3" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="長天數" varname="Length2" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="433f8970-b505-483e-9120-9079454474a1" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="短期ATR" number="1" type="0" color="5275903" color2="5275903" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /><Plot name="長期ATR" number="2" type="0" color="65535" color2="255" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,36d1fc033c6f48f8a136f9e1fdec110f;1,81394f9cf0c8469ea5f8832700aec8b7;1,9e03682196e24611b2fe326b6a56433d;1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="5" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="肯特納通道" ID="2f8e3802a94248339b621cfe99f7d66d" ReturnType="0" ExecType="3" Folder="/主圖指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[Input: Length(20); setinputname(1, "天期");
Input: UpperBand(2); SetInputName(2, "上通道寬度");
Input: LowerBand(2); SetInputName(3, "下通道寬度");

variable : hband(0),lband(0),midline(0); 

midline = XAverage(close, Length);
hband = midline + ATR(Length) * UpperBand;
lband = midline - ATR(Length) * LowerBand;

Plot1(hband, "UB");
Plot2(midline, "KeltnerMA");
Plot3(lband, "LB");

 ]]></Code>
<Arg><![CDATA[<Arg seed="6430dd94-e461-4c71-aaa7-69e9109a2636" version="1"><Param name="天期" varname="Length" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="上通道寬度" varname="UpperBand" type="1" subtype="0" value="2" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="下通道寬度" varname="LowerBand" type="1" subtype="0" value="2" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="c82e7553-df5b-4212-8efa-3bec7c136439" version="0"><Axises><Axis value="1" align="3" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="UB" number="1" type="0" color="3368652" color2="0" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /><Plot name="KeltnerMA" number="2" type="0" color="65535" color2="0" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /><Plot name="LB" number="3" type="0" color="16711884" color2="0" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,d02c45cba76f4163a048685f7bc4002b;1,36d1fc033c6f48f8a136f9e1fdec110f;1,81394f9cf0c8469ea5f8832700aec8b7;1,9e03682196e24611b2fe326b6a56433d;1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c;1,e8e5ac3753db447abac5b44618fa7dc8</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="300" />
<Maxbb val="50" />
<ScriptComplexity val="4" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="多空判斷分數" ID="2b09877978ef4c28a06670de206aff44" ReturnType="0" ExecType="3" Folder="/技術指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[
value1 = techscore;

plot1(value1, "多空指標");
plot2(3, "低點");
plot3(11, "高點");
]]></Code>
<Arg><![CDATA[<Arg seed="9a11b712-d0ae-4999-946f-da86cda4eb11" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="70651cc6-e490-4650-b968-587447f995e6" version="1"><Plot name="多空指標" number="1" type="0" color="5275903" color2="0" style="0" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /><Plot name="低點" number="2" type="0" color="255" color2="0" style="0" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /><Plot name="高點" number="3" type="0" color="65280" color2="0" style="0" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,f2404d9ffb2f49b3a38c431fcfc254b5;1,de75aec76c414cb0b78812a623b506e8;1,6bbc72256c3d4dbd9c7b3abd21a0be15;1,8c2d025a23c548d3a76fba10c22527b4;1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c;1,9c4f476d319b4f109a8dc8557099ded4;1,c1cda70a714d44999e5171fc53c95b0a;1,36d1fc033c6f48f8a136f9e1fdec110f;1,81394f9cf0c8469ea5f8832700aec8b7;1,9e03682196e24611b2fe326b6a56433d;1,210d0786cfe340538e34c095bc2ba049;1,626e6e5c42304bbea9809d1a07ae4e01;1,d64c2a71d3ea43d985ca22ef62a5a8de;1,d02c45cba76f4163a048685f7bc4002b;1,8216021f4b11489b8faca5f2af7d0750;1,239cb1c1f329431ea731982d8f5d94f2;1,607a9823aec54a91ab43847239ccd4dd;1,61c06064ad98469db9ce30287ae4a2c8;1,2bca774c6b7549c1b0b008d2a54b288e;1,f1b429ac13b2447c909302198c18ca56;1,847bcd706dda4a9caf2b783e181a8e42;1,7721dca8cc7242c09d21b782bbb59bd9;1,d21d5975992d4975839416bad676689d;1,162ffb45c75346a596029f2fea1df8c2;1,31df812470ed4d30af3a7592649c9054;1,1ac64461c4f341bc8e1d3ac1998fd29e;1,ddfa7b29d6b7403597861b78e9f6aad7</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="300" />
<Maxbb val="50" />
<ScriptComplexity val="2" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="綜合前十大券商" ID="8129c6fe44a34c2ea4bb5f578293d52e" ReturnType="0" ExecType="1" Folder="/籌碼高手/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[condition999 = symbolexchange = "TW" or symbolexchange = "TE";//台股+興櫃
condition998 = condition999 = true and (symboltype = 2 or symboltype = 1);//個股+興櫃+類股
condition994 = symbol = "TSE.TW" or symbol = "TWSE.FS" or symbol = "OTC.TW";//大盤


if condition994 =false and condition998 = false //大盤+個股+興櫃+類股
	then raiseruntimeerror("不支援此商品");
//if condition994 = false //大盤
	//then raiseruntimeerror("不支援此商品");

if barfreq <> "D" and barfreq <> "AD"
	then raiseruntimeerror("不支援此頻率");

if condition994 then begin
	value1 = GetField("綜合前十大券商買進金額");
	value2 = GetField("綜合前十大券商賣出金額");
	value3 = value1 - value2;
	value4 = GetField("綜合前十大券商累計買賣超金額");
	plot1(value3,"買賣超",checkbox:=1,axis:=2,ScaleLabel:=sltypewy,ScaleDecimal:=sdauto); //bar，axis2
	plot2(value4,"綜合前十大券商累計買賣超",checkbox:=1,axis:=1,ScaleLabel:=sltypewy,ScaleDecimal:=sdauto); //line，axis1
	plot3(value1,"買進",checkbox:=0,axis:=11,ScaleLabel:=sltypewy,ScaleDecimal:=sdauto); //line，axis2
	plot4(value2,"賣出",checkbox:=0,axis:=11,ScaleLabel:=sltypewy,ScaleDecimal:=sdauto); //line，axis2
end else begin
	value3 = GetField("綜合前十大券商買賣超張數");
	value4 = value4 + value3;
	plot1(value3,"買賣超",checkbox:=1,axis:=2,ScaleLabel:=sltypewy,ScaleDecimal:=sd0); //bar，axis2
	plot2(value4,"綜合前十大券商累計買賣超",checkbox:=1,axis:=1,ScaleLabel:=sltypewy,ScaleDecimal:=sd0); //line，axis1
end;]]></Code>
<Arg><![CDATA[<Arg seed="b3245135-d868-403f-b70f-f94cd5438824" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="58b3eb79-f81c-46ae-8b45-a9d959564013" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="1" min="-100" max="100" /></Axises><Plot name="買賣超" number="1" type="1" color="255" color2="62464" style="3" weight="0" axis="1" DecimalFormat="1" NumFormat="3" checkbox="1" SetDecimalFormat="1" SetNumFormat="1" colors="-1,-1" offset="0" /><Plot name="綜合前十大券商累計買賣超" number="2" type="0" color="255" color2="62464" style="0" weight="0" axis="0" DecimalFormat="1" NumFormat="3" checkbox="1" SetDecimalFormat="1" SetNumFormat="1" colors="-1,-1" offset="0" /><Plot name="買進" number="3" type="0" color="65280" color2="65280" style="0" weight="0" axis="10" DecimalFormat="0" NumFormat="3" checkbox="0" SetDecimalFormat="0" SetNumFormat="1" colors="-1,-1" offset="0" /><Plot name="賣出" number="4" type="0" color="16711935" color2="14680319" style="0" weight="0" axis="10" DecimalFormat="0" NumFormat="3" checkbox="0" SetDecimalFormat="0" SetNumFormat="1" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="21" />
<script>
<freq support="8;11" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{&quot;0&quot;:[227,228,229,272]},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="分鐘與日KD" ID="15498b745fa349a6af74ac563b49ffd1" ReturnType="0" ExecType="3" Folder="/跨頻率指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[// 跨頻率KD指標，預設跨頻率為30分
// 不支援大頻率跨小頻率，例如：
// 不支援主頻率60分鐘，跨頻率計算30分鐘KD技術指標。
//
input:	Length(9, "天數"), RSVt(3, "RSVt權數"), Kt(3, "Kt權數"),
		FreqType("30", "跨頻率週期", inputkind:=dict(["1分鐘","1"],["5分鐘","5"],["10分鐘","10"],["15分鐘","15"],["30分鐘","30"],["60分鐘","60"],["日","D"],["還原日","AD"]));
variable: rsv(0), k(0), _d(0);

if barfreq <> "Tick" and barfreq <> "Min" and barfreq <> "D" and barfreq <> "AD" then raiseruntimeerror("此範例僅支援分鐘、日與還原日頻率");

xfMin_stochastic(FreqType, Length, RSVt, Kt, rsv, k, _d);

Plot1(k, "分鐘與日K(%)");
Plot2(_d, "分鐘與日D(%)");

// 防呆，大頻率跨小頻率時，在線圖秀不支援
//
switch (FreqType)
begin
	case  "1":
		if barfreq <> "Tick" and barfreq <> "Min" then raiseruntimeerror("不支援大頻率跨小頻率：主頻率大於1分鐘");
		if barinterval <> 1 then raiseruntimeerror("不支援大頻率跨小頻率：主頻率大於1分鐘");
		setplotlabel(1, "1分K(%)");
		setplotlabel(2, "1分D(%)");

	case  "5":
		if barfreq <> "Tick" and barfreq <> "Min" then raiseruntimeerror("不支援大頻率跨小頻率：主頻率大於5分鐘");
		if barinterval <> 1 and barinterval <> 2 and barinterval <> 3 and barinterval <> 5 then raiseruntimeerror("不支援大頻率跨小頻率：主頻率大於5分鐘");
		setplotlabel(1, "5分K(%)");
		setplotlabel(2, "5分D(%)");

	case "10":
		if barfreq <> "Tick" and barfreq <> "Min" then raiseruntimeerror("不支援大頻率跨小頻率：主頻率大於10分鐘");
		if barinterval <> 1 and barinterval <> 2 and barinterval <> 3 and barinterval <> 5 and barinterval <> 10 then raiseruntimeerror("不支援大頻率跨小頻率：主頻率大於10分鐘");
		setplotlabel(1, "10分K(%)");
		setplotlabel(2, "10分D(%)");

	case "15":
		if barfreq <> "Tick" and barfreq <> "Min" then raiseruntimeerror("不支援大頻率跨小頻率：主頻率大於15分鐘");
		if barinterval <> 1 and barinterval <> 2 and barinterval <> 3 and barinterval <> 5 and barinterval <> 10 and barinterval <> 15 then raiseruntimeerror("不支援大頻率跨小頻率：主頻率大於15分鐘");
		setplotlabel(1, "15分K(%)");
		setplotlabel(2, "15分D(%)");
		
	case "30":
		if barfreq <> "Tick" and barfreq <> "Min" then raiseruntimeerror("不支援大頻率跨小頻率：主頻率大於30分鐘");
		if barinterval <> 1 and barinterval <> 2 and barinterval <> 3 and barinterval <> 5 and barinterval <> 10 and barinterval <> 15 and barinterval <> 20 and barinterval <> 30 then raiseruntimeerror("不支援大頻率跨小頻率：主頻率大於30分鐘");
		setplotlabel(1, "30分K(%)");
		setplotlabel(2, "30分D(%)");

	case "60":
		if barfreq <> "Tick" and barfreq <> "Min" then raiseruntimeerror("不支援大頻率跨小頻率：主頻率大於60分鐘");
		if barinterval <> 1 and barinterval <> 2 and barinterval <> 3 and barinterval <> 5 and barinterval <> 10 and barinterval <> 15 and barinterval <> 20 and barinterval <> 30 and barinterval <> 45 and barinterval <> 60 then raiseruntimeerror("不支援大頻率跨小頻率：主頻率大於60分鐘");
		setplotlabel(1, "60分K(%)");
		setplotlabel(2, "60分D(%)");
	
	case "D":
		if barfreq <> "Tick" and barfreq <> "Min" and barfreq <> "D" and barfreq <> "AD" then raiseruntimeerror("不支援大頻率跨小頻率：主頻率大於日");
		setplotlabel(1, "日K(%)");
		setplotlabel(2, "日D(%)");

	case "AD":
		if barfreq <> "Tick" and barfreq <> "Min" and barfreq <> "D" and barfreq <> "AD" then raiseruntimeerror("不支援大頻率跨小頻率：主頻率大於還原日");
		setplotlabel(1, "還原日K(%)");
		setplotlabel(2, "還原日D(%)");		

end;

]]></Code>
<Arg><![CDATA[<Arg seed="7ca9ec09-7a4a-4e92-b8f1-47c75a4a7d36" version="1"><Param name="天數" varname="Length" type="1" subtype="0" value="9" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="RSVt權數" varname="RSVt" type="1" subtype="0" value="3" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="Kt權數" varname="Kt" type="1" subtype="0" value="3" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="跨頻率週期" varname="FreqType" type="3" subtype="0" value="30" isSerial="0" isArray="0" isRef="0" inputkind="1" quickedit="0" keytype="3"><Pair key="1分鐘" value="1" /><Pair key="5分鐘" value="5" /><Pair key="10分鐘" value="10" /><Pair key="15分鐘" value="15" /><Pair key="30分鐘" value="30" /><Pair key="60分鐘" value="60" /><Pair key="日" value="D" /><Pair key="還原日" value="AD" /></Param></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="21333b3c-e892-427d-ab15-e5920dfb323f"><Plot name="分鐘與日K(%)" number="1" type="0" color="5275903" color2="5275903" style="0" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /><Plot name="分鐘與日D(%)" number="2" type="0" color="255" color2="255" style="0" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,de5550c0989b434681e18c65fcc79915;1,8e4cc5f4d71342f9a5b6c2e5dc9a6966;1,356e05c9c03640b798c80a02e175aed1;1,35ecad2f46b642b58d4f6babdfd8e5a7;1,7bc1bae90d2a40d49fd2ed009329e614</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="20" />
<ScriptComplexity val="2" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="多空點數指標" ID="13d557a81a8548d0860a9525b92e644e" ReturnType="0" ExecType="1" Folder="/大盤指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[{
指標說明
https://xstrader.net/多空點數指標/
}

variable:i(0),Lscore(0),Sscore(0);

Lscore=0;
Sscore=0;

for i = 1 to 100 begin
	if C> H[i] then 
		Lscore += 1 
	else if C < L[i] then 
		Sscore += 1;
end;
PLOT1(LSCORE-SSCORE,"多空點數");
]]></Code>
<Arg><![CDATA[<Arg seed="d4a2e798-82ce-47eb-8d85-8ec04109050a" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="7391b420-0c87-43b2-90aa-2971c030185d" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="多空點數" number="1" type="1" color="255" color2="62464" style="3" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="1" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="委買委賣張數" ID="18f92b3fee3a4590903ca9bbb3e28348" ReturnType="0" ExecType="1" Folder="/期權指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[{指標數值定義："口數差 = 委買口數 - 委賣口數"
支援商品：大盤/期貨/選擇權}

condition994 = symbol = "TSE.TW" or symbol = "TWSE.FS" or symbol = "OTC.TW";//大盤

if barfreq <> "Min" and barfreq <> "D" then 
	raiseruntimeerror("僅支援分鐘與日頻率");

if condition994 then begin//大盤
	value1 = GetField("累計委買");
	value2 = GetField("累計委賣");
	value3 = GetField("累計委買") - GetField("累計委賣");
	plot1(value3,"委買委賣口數差");
	plot2(value1,"委買口數",checkbox:=0);
	plot3(value2,"委賣口數",checkbox:=0);
	setplotlabel(1,"委買委賣張數差");
	setplotlabel(2,"委買張數");
	setplotlabel(3,"委賣張數");
end else begin//期貨與選擇權
	value1 = GetField("累計委買");
	value2 = GetField("累計委賣");
	value3 = GetField("累計委買") - GetField("累計委賣");
	plot1(value3,"委買委賣口數差");
	plot2(value1,"委買口數",checkbox:=0);
	plot3(value2,"委賣口數",checkbox:=0);
	setplotlabel(1,"委買委賣口數差");
	setplotlabel(2,"委買口數");
	setplotlabel(3,"委賣口數");
end;
]]></Code>
<Arg><![CDATA[<Arg seed="b7a0edc4-7e75-460a-b378-6e9688ad9d94" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="18a57fb0-a75b-420b-9c8e-005e7bd4c9b6" version="1">
	<Axises>
		<Axis value="1" align="0" min="-100.000000" max="100.000000" SetMin="1" SetMax="1" mpvalue="0.000000" />
		<Axis value="2" align="1" min="-100.000000" max="100.000000" SetMin="1" SetMax="1" mpvalue="0.000000" />
	</Axises>
	<Plot name="委買委賣口數差" number="1" type="1" style="3" color="255" color2="65280" axis="1" checkbox="-1" colors="," offset="0" />

	<Plot name="委買口數" number="2" style="5" color="16711935" color2="255" checkbox="0" colors="," offset="0" />

	<Plot name="委賣口數" number="3" style="5" color="16776960" color2="65280" checkbox="0" colors="," offset="0" />

</Plots>]]></Plots>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="41" />
<script>
<freq support="8;11" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{&quot;0&quot;:[76,77]},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="散戶買賣力(金額)" ID="ad38b4e11acf440486a90f93f0a62ebc" ReturnType="0" ExecType="1" Folder="/即時籌碼/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[{散戶買賣力(金額)是小單金額，資料為開盤迄今的累計
支援商品：台(股票)}

if barfreq <> "Min" and barfreq <> "D" and barfreq <> "AD" then 
	raiseruntimeerror("僅支援分鐘與日頻率（含還原）");

value91 = GetField("賣出小單金額");//僅提供給有權限的用戶使用

value1 = GetField("賣出小單金額","D");
value2 = GetField("買進小單金額","D");
value3 = value2 - value1;
plot1(value3,"散戶買賣力(金額)"); //bar，axis2
plot2(value2,"散戶外盤金額",checkbox:=0); //line，axis11
plot3(value1,"散戶內盤金額",checkbox:=0); //line，axis11]]></Code>
<Arg><![CDATA[<Arg seed="717b5a12-a04f-44c3-9811-6fad193e64ef" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="07c776be-0021-4992-a514-01b8848339f5" version="1">
	<Axises>
		<Axis value="1" align="0" min="-100.000000" max="100.000000" SetMin="1" SetMax="1" mpvalue="0.000000" />
		<Axis value="2" align="1" min="-100.000000" max="100.000000" SetMin="1" SetMax="1" mpvalue="0.000000" />
	</Axises>
	<Plot name="散戶買賣力(金額)" number="1" type="1" style="3" color="255" color2="65280" axis="1" NumFormat="3" checkbox="-1" colors="," offset="0" />

	<Plot name="散戶外盤金額" number="2" color="16711935" color2="255" NumFormat="3" checkbox="0" colors="," offset="0" />

	<Plot name="散戶內盤金額" number="3" color="14651708" color2="65280" NumFormat="3" checkbox="0" colors="," offset="0" />

</Plots>]]></Plots>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="16" />
<script>
<freq support="8;11" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{&quot;0&quot;:[353],&quot;8&quot;:[353,350]},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="借券賣出" ID="75bb1bcc393d4c088ddb029c2b24ea19" ReturnType="0" ExecType="1" Folder="/籌碼高手/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[condition996 = symbolexchange = "TW" = true and symboltype = 2;//個股
condition994 = symbol = "TSE.TW" or symbol = "TWSE.FS" or symbol = "OTC.TW";//大盤

if condition994 = false and condition996 = false //大盤+個股
	then raiseruntimeerror("不支援此商品");

if barfreq = "Tick" or barfreq = "Min"
	then raiseruntimeerror("不支援此頻率");

if symboltype = 1 then begin
	plot1(GetField("借券賣出餘額張數"),"借券賣出餘額(張)",checkbox:=1,axis:=1,ScaleLabel:=sltypewy,ScaleDecimal:=sdauto);//單位：張
	plot2(GetField("借券賣出張數")+GetField("借券賣出庫存異動張數"),"差額(張)",checkbox:=1,axis:=2);//增減bar，請RD加"借券還券"與"借券調整"
	plot3(GetField("借券賣出張數"),"賣出(張)",checkbox:=0,axis:=11,ScaleLabel:=sltypewy,ScaleDecimal:=sdauto);//單位：張，新增查價顯示 (繪圖形式->隱藏, 不畫圖)
	plot4(GetField("借券賣出庫存異動張數"),"還券(張)",checkbox:=0,axis:=11,ScaleLabel:=sltypewy,ScaleDecimal:=sdauto);//請RD加
end else begin
	plot1(GetField("借券賣出餘額張數"),"借券賣出餘額(張)",checkbox:=1,axis:=1,ScaleLabel:=slfull,ScaleDecimal:=sd0);//單位：張
	plot2(GetField("借券賣出張數")+GetField("借券賣出庫存異動張數"),"差額(張)",checkbox:=1,axis:=2,ScaleLabel:=slfull,ScaleDecimal:=sd0);//增減bar，請RD加"借券還券"與"借券調整"
	plot3(GetField("借券賣出張數"),"賣出(張)",checkbox:=0,axis:=11,ScaleLabel:=slfull,ScaleDecimal:=sd0);//單位：張，新增查價顯示 (繪圖形式->隱藏, 不畫圖)
	plot4(GetField("借券賣出庫存異動張數"),"還券(張)",checkbox:=0,axis:=11,ScaleLabel:=slfull,ScaleDecimal:=sd0);//請RD加
end;
]]></Code>
<Arg><![CDATA[<Arg seed="843a2344-e53a-434f-83a5-293cce7afb44" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="062c1c02-0eeb-41aa-abd4-7829557a8249" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="1" min="-100" max="100" /></Axises><Plot name="借券賣出餘額(張)" number="1" type="0" color="5275903" color2="5275903" style="0" weight="0" axis="0" DecimalFormat="1" NumFormat="1" checkbox="1" SetDecimalFormat="1" SetNumFormat="1" colors="-1,-1" offset="0" /><Plot name="差額(張)" number="2" type="1" color="255" color2="62464" style="3" weight="0" axis="1" DecimalFormat="1" NumFormat="1" checkbox="1" SetDecimalFormat="1" SetNumFormat="1" colors="-1,-1" offset="0" /><Plot name="賣出(張)" number="3" type="0" color="65280" color2="65280" style="5" weight="0" axis="10" DecimalFormat="1" NumFormat="1" checkbox="0" SetDecimalFormat="1" SetNumFormat="1" colors="-1,-1" offset="0" /><Plot name="還券(張)" number="4" type="0" color="14680319" color2="14680319" style="5" weight="0" axis="10" DecimalFormat="1" NumFormat="1" checkbox="0" SetDecimalFormat="1" SetNumFormat="1" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="51" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{&quot;0&quot;:[93,94,95]},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="外資均價線" ID="a2901a2d2d504a808528601cc90835e1" ReturnType="0" ExecType="3" Folder="/主圖指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[Input: period(20);	setinputname(1, "期間(天)");

if barfreq = "Tick" or barfreq = "Min"
	then raiseruntimeerror("不支援此頻率");

variable: avg_b(0), avg_s(0);
if GetField("Volume") > 0 then 
begin
	Value5 = GetField("外資買張")*GetField("成交金額")/(GetField("Volume")*1000);
	Value6 = GetField("外資賣張")*GetField("成交金額")/(GetField("Volume")*1000);
end else begin
	Value5 = 0;
	Value6 = 0;
end;

Value1 = summation(Value5, period);
Value2 = summation(GetField("外資買張"), period);
Value3 = summation(Value6, period);
Value4 = summation(GetField("外資賣張"), period);
 
if Value2 > 0 and Value2 <> Value2[1] then avg_b = Value1 / Value2;
if Value4 > 0 and Value4 <> Value4[1]  then avg_s = Value3 / Value4;

Plot1(avg_b, "外資買進均價");
Plot2(avg_s, "外資賣出均價");


]]></Code>
<Arg><![CDATA[<Arg seed="47924172-5d18-477b-8b42-62ddfbec4ae4" version="1"><Param name="期間(天)" varname="period" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="f50eacf0-d85e-4de5-b329-3c7687d3d4bc" version="0"><Axises><Axis value="1" align="3" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="外資買進均價" number="1" type="0" color="255" color2="5275903" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /><Plot name="外資賣出均價" number="2" type="0" color="65280" color2="255" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="50" />
<script>
<freq support="8;11;9;12;10;13" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{&quot;0&quot;:[9,27,19,28]},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="ADI (累積分配指標)" ID="a5f95e28c0004141ab8c58c431b40b66" ReturnType="0" ExecType="3" Folder="/XQ技術指標/" StatusMask="2">
<Desc><![CDATA[畫出累積分配指標]]></Desc>
<Code><![CDATA[// XQ: A/DI 指標
//
variable: adi(0);

if Close > Close[1] then
	adi = adi[1] + (Close - minlist(low, close[1])) 
else
  begin
	if Close < Close[1] then
		adi = adi[1] - (maxlist(high, close[1]) - close)
	else
		adi = adi[1];
  end;

Plot1(adi, "A/DI");
		]]></Code>
<Arg><![CDATA[<Arg seed="67a0cbb7-eecd-4678-ace7-ab48835f9094" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="26e614dc-e774-4b69-a8bb-4d9dc8882d3e" version="1"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="A/DI" number="1" type="0" color="5275903" color2="0" style="0" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<Extra><![CDATA[<Extra>
<TotalBar val="10" />
<Maxbb val="2" />
<ScriptComplexity val="1" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="RSV 指標" ID="b8da5fc094684f74afe8f6f50abae064" ReturnType="0" ExecType="3" Folder="/XQ技術指標/" StatusMask="2">
<Desc><![CDATA[畫出未成熟隨機值]]></Desc>
<Code><![CDATA[// XQ: RSV指標
//
input: Length(9);
variable: RSVt(3), Kt(3), rsv(0), k(0), _d(0);

SetInputName(1, "天數");

Stochastic(Length, RSVt, Kt, rsv, k, _d);

Plot1(rsv, "RSV(%)");
		]]></Code>
<Arg><![CDATA[<Arg seed="58abc09e-ae1a-48c0-a3bd-c82368585a17" version="1"><Param name="天數" varname="Length" type="1" subtype="0" value="9" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="2c4f2deb-d88a-4b01-8013-d7779d29f5d4" version="1"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="RSV(%)" number="1" type="0" color="5275903" color2="0" style="0" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,61c06064ad98469db9ce30287ae4a2c8;1,2bca774c6b7549c1b0b008d2a54b288e;1,f1b429ac13b2447c909302198c18ca56;1,847bcd706dda4a9caf2b783e181a8e42</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="20" />
<Maxbb val="18" />
<ScriptComplexity val="2" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="累積量" ID="f48bfd480373464daf4de8fcc51cd8e9" ReturnType="0" ExecType="3" Folder="/量能指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[variable:tv(0);//當日累積量

if date<>date[1] then
	tv=volume
else
	tv=tv[1]+volume;

plot1(tv,"累積量");]]></Code>
<Arg><![CDATA[<Arg seed="f4e37668-e550-479d-ba3d-87f876333d93" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="9fb5e687-38cd-4e41-875c-0e96def828b1" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="累積量" number="1" type="1" color="5275903" color2="5275903" style="0" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="1" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="上漲天數指標" ID="9ec804a756064c62a42eddd0148aff65" ReturnType="0" ExecType="1" Folder="/技術指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:count1(20);
input:count2(10);

value1=countif(close>close[1],count1);
value2=countif(close>close[1],count2);
value3=value1-value2;

plot1(value1);
plot2(value2);
plot3(value3);]]></Code>
<Arg><![CDATA[<Arg seed="d35b9b75-aece-49a0-b4a8-3e1b48f26393" version="1"><Param name="count1" varname="count1" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="count2" varname="count2" type="1" subtype="0" value="10" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="872e5148-e20c-4bb3-8ae8-3fe6fbe32c7f" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="plot1" number="1" type="0" color="5275903" color2="5275903" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /><Plot name="plot2" number="2" type="0" color="255" color2="255" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /><Plot name="plot3" number="3" type="0" color="65280" color2="65280" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,d80cf92ddfcc42e0a6c53ec47edebd49</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="3" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="樂活五線譜" ID="5797c0f786b6433e9afe45318a28d1e2" ReturnType="0" ExecType="1" Folder="/主圖指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:period(720,"計算期間");
array: line_diff[](0);
var: diff_avg(0), _sum(0);

Array_SetMaxIndex(line_diff, period);
linearreg(close,period,0,value2,value3,value4,value5);

{計算(收盤-迴歸)標準差}
//先計算區間內的 收盤 - 迴歸 值
_sum = 0;
for value1 = 1 to period begin
    line_diff[value1] = close[period - value1] - (value2 * value1 + value4);
	_sum += close[period - value1] - (value2 * value1 + value4);
	end;
// 收盤-迴歸的平均	
diff_avg = _sum / period;

//計算標準差
_sum = 0;
for value1 = 1 to period begin
    _sum += power((line_diff[value1] - diff_avg), 2);
	end;
value6 = squareroot(_sum / period);

value7=value5+value6;
value8=value5+2*value6;
value9=value5-value6;
value10=value5-2*value6;
plot1(value8,"+2SD");
plot2(value7,"+1SD");
plot3(value5,"TL");
plot4(value9,"-1SD");
plot5(value10,"-2SD");]]></Code>
<Arg><![CDATA[<Arg seed="41898932-d590-4f63-929a-ee40a86f6aec" version="1"><Param name="計算期間" varname="period" type="1" subtype="0" value="720" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="e06a83ef-36aa-465d-9e0e-9ca6f52d8198" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="+2SD" number="1" type="0" color="255" color2="5275903" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /><Plot name="+1SD" number="2" type="0" color="14535673" color2="255" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /><Plot name="TL" number="3" type="0" color="65535" color2="65280" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /><Plot name="-1SD" number="4" type="0" color="13955036" color2="14680319" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /><Plot name="-2SD" number="5" type="0" color="65280" color2="65535" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,8c2d025a23c548d3a76fba10c22527b4;1,210d0786cfe340538e34c095bc2ba049</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="2" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="官股券商" ID="443335895dc0422f94fa9f02516b3cdc" ReturnType="0" ExecType="1" Folder="/籌碼高手/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[condition999 = symbolexchange = "TW" or symbolexchange = "TE";//台股+興櫃
condition998 = condition999 = true and (symboltype = 2 or symboltype = 1);//個股+興櫃+類股
condition994 = symbol = "TSE.TW" or symbol = "TWSE.FS" or symbol = "OTC.TW";//大盤

if condition994 =false and condition998 = false //大盤+個股+興櫃+類股
	then raiseruntimeerror("不支援此商品");

if barfreq <> "D" and barfreq <> "AD"
	then raiseruntimeerror("不支援此頻率");

if condition994 then begin
	value1 = GetField("官股券商買進金額");
	value2 = GetField("官股券商賣出金額");
	value3 = value1 - value2;
	value4 = GetField("官股券商累計買賣超金額");
	plot1(value3,"買賣超",checkbox:=1,axis:=2,ScaleLabel:=sltypewy,ScaleDecimal:=sdauto); //bar，axis2
	plot2(value4,"官股券商累計買賣超",checkbox:=1,axis:=1,ScaleLabel:=sltypewy,ScaleDecimal:=sdauto); //line，axis1
	plot3(value1,"買進",checkbox:=0,axis:=11,ScaleLabel:=sltypewy,ScaleDecimal:=sdauto); //line，axis2
	plot4(value2,"賣出",checkbox:=0,axis:=11,ScaleLabel:=sltypewy,ScaleDecimal:=sdauto); //line，axis2
end else begin
	value3 = GetField("官股券商買賣超張數");
	value4 = value4 + value3;
	plot1(value3,"買賣超",checkbox:=1,axis:=2,ScaleLabel:=sltypewy,ScaleDecimal:=sd0); //bar，axis2
	plot2(value4,"官股券商累計買賣超",checkbox:=1,axis:=1,ScaleLabel:=sltypewy,ScaleDecimal:=sd0); //line，axis1
end;
]]></Code>
<Arg><![CDATA[<Arg seed="5e2b642f-c698-414c-b354-59cabbc427bd" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="c59c00bc-b3e0-48ef-855c-62fae2f07e7e" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="1" min="-100" max="100" /></Axises><Plot name="買賣超" number="1" type="1" color="255" color2="62464" style="3" weight="0" axis="1" DecimalFormat="1" NumFormat="3" checkbox="1" SetDecimalFormat="1" SetNumFormat="1" colors="-1,-1" offset="0" /><Plot name="官股券商累計買賣超" number="2" type="0" color="255" color2="255" style="0" weight="0" axis="0" DecimalFormat="1" NumFormat="3" checkbox="1" SetDecimalFormat="1" SetNumFormat="1" colors="-1,-1" offset="0" /><Plot name="買進" number="3" type="0" color="65280" color2="65280" style="0" weight="0" axis="10" DecimalFormat="0" NumFormat="3" checkbox="0" SetDecimalFormat="0" SetNumFormat="1" colors="-1,-1" offset="0" /><Plot name="賣出" number="4" type="0" color="14680319" color2="14680319" style="0" weight="0" axis="10" DecimalFormat="0" NumFormat="3" checkbox="0" SetDecimalFormat="0" SetNumFormat="1" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="21" />
<script>
<freq support="8;11" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{&quot;0&quot;:[224,225,226,271]},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="週威廉指標" ID="f4799299c7774b67a320a34db17adaba" ReturnType="0" ExecType="3" Folder="/跨頻率指標/" StatusMask="2">
<Desc><![CDATA[畫出週威廉指標]]></Desc>
<Code><![CDATA[// 跨頻率週威廉指標
// 不支援大頻率跨小頻率，例如：
// 不支援主頻率週資料，跨頻率計算日威廉技術指標。
//
if barfreq <> "Tick" and barfreq <> "Min" and barfreq <> "D" and barfreq <> "W" and barfreq <> "AD" and barfreq <> "AW" then raiseruntimeerror("不支援大頻率跨小頻率");

input: 
	Length1(14, "天數一"), 
	Length2(28, "天數二"), 
	Length3(42, "天數三");

value1 = xf_PercentR("W", Length1) - 100;
value2 = xf_PercentR("W", Length2) - 100;
value3 = xf_PercentR("W", Length3) - 100;

Plot1(value1, "週威廉指標1");
Plot2(value2, "週威廉指標2");
Plot3(value3, "週威廉指標3");
		]]></Code>
<Arg><![CDATA[<Arg seed="dcc51f6f-76dd-4225-a554-30c8fd429fe8" version="1"><Param name="天數一" varname="Length1" type="1" subtype="0" value="14" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="天數二" varname="Length2" type="1" subtype="0" value="28" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="天數三" varname="Length3" type="1" subtype="0" value="42" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="ecd49df5-ae4c-4a43-840c-6fae94ea32e9" version="0"><Axises><Axis value="1" align="2" min="-100" max="0" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="週威廉指標1" number="1" type="0" color="5275903" color2="5275903" style="0" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /><Plot name="週威廉指標2" number="2" type="0" color="255" color2="255" style="0" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /><Plot name="週威廉指標3" number="3" type="0" color="65280" color2="65280" style="0" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,61c06064ad98469db9ce30287ae4a2c8;1,2bca774c6b7549c1b0b008d2a54b288e;1,f1b429ac13b2447c909302198c18ca56;1,b2a836d953c74cf586cf3ae81cdaff5a</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="4" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="K棒衍生指標" ID="089eb2b082434f0787fdfd72e6701900" ReturnType="0" ExecType="1" Folder="/技術指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[{
指標說明
https://xstrader.net/雙k棒可以延伸的多空趨勢指標/
}

array:k[22](0);
if close<>0 then begin
	//最近一日與前一日的多空力道總差額
	k[1]=(open-open[1])/close;
	k[2]=(high-high[1])/close;
	k[3]=(low-low[1])/close;
	k[4]=(close-close[1])/close;
	//當日
	k[5]=(high-low)/close;
	k[6]=(high-close)/close;
	k[7]=(high-open)/close;
	k[8]=(open-low)/close;
	k[9]=(close-open)/close;
	k[10]=(close-low)/close;
	k[11]=(open-high[1])/close;
	k[12]=(open-low[1])/close;
	k[13]=(open-close[1])/close;
	k[14]=(high-open[1])/close;
	k[15]=(high-low[1])/close;
	k[16]=(high-close[1])/close;
	k[17]=(low-open[1])/close;
	k[18]=(low-high[1])/close;
	k[19]=(low-close[1])/close;
	k[20]=(close-open[1])/close;
	k[21]=(close-high[1])/close;
	k[22]=(close-low[1])/close;
end;

array: v1[8](0);
v1[1]=k[1]+k[11]+k[12]+k[13];//隔日開盤多空總力道
v1[2]=k[1]+k[2]+k[3]+k[4];//隔日多空總力道
v1[3]=k[20]+k[21]+k[22];//隔日收盤多空結果
v1[4]=k[9]+k[10]-k[6];//當日收盤多空結果
v1[5]=k[14]+k[15]+k[16];//多頭最大力量
v1[6]=(k[17]+k[18]+k[19])*-1;//空頭最大力量
v1[7]=k[7]+k[9]+k[10];//當日多頭最大力量
v1[8]=k[6]+k[8]-k[10];//當日空頭最大力量

value1=v1[1]+v1[2]+v1[3]+v1[4];
value2=v1[5]+v1[7];
value3=v1[6]+v1[8];
plot1(average(value1,5),"多空淨力");
plot2(average(value2,5),"多頭總力");
plot3(average(value3,5),"空頭總力");

]]></Code>
<Arg><![CDATA[<Arg seed="bb0755c5-0afe-4146-8bc9-9e06cb0a3610" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="fe9e9c7e-04b6-4c33-95a5-ef62bab7520e" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="多空淨力" number="1" type="1" color="39423" color2="62464" style="0" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /><Plot name="多頭總力" number="2" type="0" color="255" color2="255" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /><Plot name="空頭總力" number="3" type="0" color="65280" color2="65280" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="4" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="週轉率" ID="4fcc4cdef06a46b3a978c636730fd03d" ReturnType="0" ExecType="1" Folder="/量能指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[if barfreq = "Tick" or barfreq = "Min"
	then raiseruntimeerror("不支援此頻率");

if GetField("發行張數(張)") <> 0 then begin
	value1 = volume / GetField("發行張數(張)") * 100;
	plot1(value1,"週轉率(%)");
end else 
	noplot(1);]]></Code>
<Arg><![CDATA[<Arg seed="66cbfed1-4fd4-4129-b91c-ba8a81b0a54c" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="66012be8-9718-4a48-9ae3-9c57382cc229" version="1"><Plot name="週轉率(%)" number="1" type="0" color="5275903" color2="5275903" style="0" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="20" />
<ScriptComplexity val="11" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{&quot;0&quot;:[260]},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="四大力道線" ID="b4530e697bcc4ad7b6240774f5b9f152" ReturnType="0" ExecType="1" Folder="/量能指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[{
指標說明
https://xstrader.net/改良版的移動平均線四大力道線/
}

input:period(10,"天期參數");

value1=summation(high-close,period);//上檔賣壓
value2=summation(close-open,period); //多空實績
value3=summation(close-low,period);//下檔支撐
value4=summation(open-close[1],period);//隔夜力道
if close<>0 then
	value5=(value2+value3+value4-value1)/close;

plot1(value5,"四大力道線");

]]></Code>
<Arg><![CDATA[<Arg seed="82a530bb-ac80-462d-9055-bfb2a6cb134f" version="1"><Param name="天期參數" varname="period" type="1" subtype="0" value="10" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="cd405d39-9c6f-4c6a-836a-744fb6feb20f" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="四大力道線" number="1" type="0" color="5275903" color2="5275903" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="5" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="MF錢流指標" ID="87dbe85c64f94f16be7d9fce557940c4" ReturnType="0" ExecType="3" Folder="/技術指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[INPUT:N(10,"期數");

variable: AP(0),tv(0),UTV(0),DTV(0),MF(0),UP(0),DN(0);

ap=(high+low+close)/3;
tv=ap*volume;
if ap>ap[1] then begin
	utv=tv;
	dtv=0;
end else begin
	utv=0;
	dtv=tv;
end;
up=UP[1]+(UTV-UP[1])/N;
DN=DN[1]+(DTV-DN[1])/N;
IF DN<>0 THEN 
	MF=100-(100/(1+UP/DN))
else
	MF=MF[1];
	
PLOT1(MF,"MF");]]></Code>
<Arg><![CDATA[<Arg seed="d1bcdbfa-3a68-4ac1-85bd-c4755468f6f8" version="1"><Param name="期數" varname="N" type="1" subtype="0" value="10" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="8db3320e-e89f-476f-9ac5-8f3cfcafd05f" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="MF" number="1" type="0" color="5275903" color2="5275903" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="1" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="MI(質量指標)" ID="d050d61b5097421fbf92b41f2e4fbbd2" ReturnType="0" ExecType="3" Folder="/XQ技術指標/" StatusMask="2">
<Desc><![CDATA[畫出質量指標]]></Desc>
<Code><![CDATA[// XQ: MI指標
//
input: Length(9), SumLength(25);
variable: ema1(0), ema2(0), divSeries(0), mi(0);

SetInputName(1, "天數一");
SetInputName(2, "天數二");

ema1 = XAverage(High - Low, length);
ema2 = XAverage(ema1, length);

if ema2 <> 0 then
	divSeries = ema1 / ema2
else
	divSeries = 0;

if CurrentBar >= sumLength then
	mi = Summation(divSeries, sumLength)
else
	mi = 0;
	
Plot1(mi, "MI");

        
		]]></Code>
<Arg><![CDATA[<Arg seed="56794614-03df-41dd-8a8f-d2b7c83d1fc6" version="1"><Param name="天數一" varname="Length" type="1" subtype="0" value="9" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="天數二" varname="SumLength" type="1" subtype="0" value="25" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="dc04f9ea-eb81-42ec-b5f8-d2fc7879afc1" version="1"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="MI" number="1" type="0" color="5275903" color2="0" style="0" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,d02c45cba76f4163a048685f7bc4002b;1,c122bd6485c544f2bce8f374b5c7440d</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="100" />
<Maxbb val="50" />
<ScriptComplexity val="4" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="TAPI(每點成交值指標)" ID="2d8ff0dd9bbf4544a68b7c8c07011af1" ReturnType="0" ExecType="2" Folder="/XQ量能指標/" StatusMask="2">
<Desc><![CDATA[畫出每點成交值指標]]></Desc>
<Code><![CDATA[// XQ: TAPI指標
//

Plot1(Volume / Close, "TAPI");
		]]></Code>
<Arg><![CDATA[<Arg seed="8a5139ce-544d-45b7-bccc-ef2023bea1c2" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="df2b80d2-8d07-4fa0-ac51-763b502ac4ee" version="1"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="TAPI" number="1" type="0" color="5275903" color2="0" style="0" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<Extra><![CDATA[<Extra>
<TotalBar val="100" />
<Maxbb val="0" />
<ScriptComplexity val="1" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="PVT(價量趨勢指標)" ID="0032169593b14e6e94601badc14cdb0a" ReturnType="0" ExecType="3" Folder="/XQ量能指標/" StatusMask="2">
<Desc><![CDATA[畫出價量趨勢指標]]></Desc>
<Code><![CDATA[// XQ: PVT指標
//
variable: _pvt(0);

If CurrentBar = 1 then
	_pvt = 0
else	
	_pvt = _pvt[1] + (close - close[1])/close[1] * Volume;

Plot1(_pvt, "PVT");
		]]></Code>
<Arg><![CDATA[<Arg seed="e8ad94ff-7682-4397-8f11-e5e021f4fad7" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="0b17fb1e-12d6-4f9c-923b-9e16be2b5345" version="1"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="PVT" number="1" type="0" color="5275903" color2="0" style="0" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<Extra><![CDATA[<Extra>
<TotalBar val="100" />
<Maxbb val="2" />
<ScriptComplexity val="1" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="DMI-Osc(趨向擺盪線)" ID="2cdf5c2c26dc478cb58876ba85634c95" ReturnType="0" ExecType="3" Folder="/XQ技術指標/" StatusMask="2">
<Desc><![CDATA[畫出趨向擺盪線]]></Desc>
<Code><![CDATA[// XQ: DMI-Osc指標
//
input: Length( 14 );
variable: pdi_value(0), ndi_value(0), adx_value(0);

SetInputName(1, "天數");

DirectionMovement(Length, pdi_value, ndi_value, adx_value);

// 初始區波動較大, 先不繪出
//
if CurrentBar < Length then
 begin
	pdi_value = 0;
	ndi_value = 0;
	adx_value = 0;
 end;

Plot1(pdi_value - ndi_value, "DMI-Osc");

		]]></Code>
<Arg><![CDATA[<Arg seed="ccde1a15-437a-4c2c-a761-f8ff36222cde" version="1"><Param name="天數" varname="Length" type="1" subtype="0" value="14" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="1269fae6-2732-4495-80a5-57893ba8b161" version="1"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="DMI-Osc" number="1" type="0" color="5275903" color2="0" style="0" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,7721dca8cc7242c09d21b782bbb59bd9</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="20" />
<ScriptComplexity val="2" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="台股指數近月自營商未平倉" ID="f457162b6b754f0f9546327ace47bb2b" ReturnType="0" ExecType="1" Folder="/期權指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[value1 = getsymbolfield("FITX*1.TF","自營商買方未平倉口數");
value2 = getsymbolfield("FITX*1.TF","自營商賣方未平倉口數");
value3 = value1 - value2;
plot1(value1,"自營商未平倉買口");
plot2(value2,"自營商未平倉賣口");
plot3(value3,"自營商未平倉淨口");

]]></Code>
<Arg><![CDATA[<Arg seed="a0ef6c44-758c-47b2-a6f7-eaf91290e64b" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="5f2c3454-7d72-47f1-964c-54690ba331e7" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="自營商未平倉買口" number="1" type="0" color="5275903" color2="0" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /><Plot name="自營商未平倉賣口" number="2" type="0" color="6750207" color2="0" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /><Plot name="自營商未平倉淨口" number="3" type="1" color="13311" color2="0" style="0" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<Extra><![CDATA[<Extra>
<TotalBar val="0" />
<Maxbb val="0" />
<ScriptComplexity val="11" />
<script>
<freq support="8;11" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{&quot;FITX*1.TF&quot;:{&quot;0&quot;:[148,149]}}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="終極擺盪指標" ID="dcd9b850aa354c40a9e3ee0ba6a269ee" ReturnType="0" ExecType="3" Folder="/技術指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[
input:length1(7);		setinputname(1, "天期一");
input:length2(14);		setinputname(2, "天期二");
input:length3(28);   	setinputname(3, "天期三");

variable : ruo(0),uo(0),bp(0);  

bp = close-truelow;
   
Value1=summation(bp,length1);   
Value2=summation(bp,length2);   
Value3=summation(bp,length3);   

Value4=summation(truerange,length1);   
Value5=summation(truerange,length2);   
Value6=summation(truerange,length3);
   
ruo = (value1/value4)*4+(value2/value5)*2+(value3/value6);   

uo= ruo / 7 * 100;   

plot1(uo, "UO");  

]]></Code>
<Arg><![CDATA[<Arg seed="06af8b54-e40f-4502-8312-ea8e1fc8c280" version="1"><Param name="天期一" varname="length1" type="1" subtype="0" value="7" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="天期二" varname="length2" type="1" subtype="0" value="14" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="天期三" varname="length3" type="1" subtype="0" value="28" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="a7d1940c-c462-464e-bd83-da9877aa335b" version="1"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="UO" number="1" type="0" color="5275903" color2="0" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,81394f9cf0c8469ea5f8832700aec8b7;1,c122bd6485c544f2bce8f374b5c7440d;1,36d1fc033c6f48f8a136f9e1fdec110f;1,9e03682196e24611b2fe326b6a56433d</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="50" />
<Maxbb val="30" />
<ScriptComplexity val="11" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="分公司淨買賣金額家數" ID="381a9f1edbd9493d854b12d3c1ad82da" ReturnType="0" ExecType="1" Folder="/籌碼高手/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[condition999 = symbolexchange = "TW" or symbolexchange = "TE";//台股+興櫃
condition997 = condition999 and (symboltype = 2 or symboltype = 4 or symbolType = 1);//個股+權證+興櫃+類股

if condition997 = false //個股+權證+興櫃+類股
	then raiseruntimeerror("不支援此商品");


if barfreq <> "D" and barfreq <> "AD" 
	then raiseruntimeerror("不支援此頻率");

plot1(GetField("分公司淨賣超金額家數")-GetField("分公司淨買超金額家數"),"分公司淨買賣超金額家數差",checkbox:=1,axis:=2,ScaleLabel:=slfull,ScaleDecimal:=sd0);//單位：家
plot2(GetField("分公司淨買超金額家數"),"分公司淨買超金額家數",checkbox:=0,axis:=1,ScaleLabel:=slfull,ScaleDecimal:=sd0);//單位：家，可勾選畫圖選項 (參數設定) 
plot3(GetField("分公司淨賣超金額家數"),"分公司淨賣超金額家數",checkbox:=0,axis:=1,ScaleLabel:=slfull,ScaleDecimal:=sd0);//單位：家，可勾選畫圖選項 (參數設定) ]]></Code>
<Arg><![CDATA[<Arg seed="4f10f611-19c2-4b06-aaca-648cf7a7daf3" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="cce2e8a1-b49d-4477-94fb-a35581245441" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="1" min="-100" max="100" /></Axises><Plot name="分公司淨買賣超金額家數差" number="1" type="1" color="255" color2="62464" style="3" weight="0" axis="1" DecimalFormat="1" NumFormat="1" checkbox="1" SetDecimalFormat="1" SetNumFormat="1" colors="-1,-1" offset="0" /><Plot name="分公司淨買超金額家數" number="2" type="0" color="16711935" color2="255" style="5" weight="0" axis="0" DecimalFormat="1" NumFormat="1" checkbox="0" SetDecimalFormat="1" SetNumFormat="1" colors="-1,-1" offset="0" /><Plot name="分公司淨賣超金額家數" number="3" type="0" color="65280" color2="65280" style="5" weight="0" axis="0" DecimalFormat="1" NumFormat="1" checkbox="0" SetDecimalFormat="1" SetNumFormat="1" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="21" />
<script>
<freq support="8;11" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{&quot;0&quot;:[163,162]},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="VR(成交量比率指標)" ID="447a4c58ae7b4eee8da5a53010a7d2ea" ReturnType="0" ExecType="2" Folder="/XQ量能指標/" StatusMask="2">
<Desc><![CDATA[畫出成交量比率指標]]></Desc>
<Code><![CDATA[// XQ: VR指標
//
input: Length(26);
variable: _index(0), qu(0), qd(0), qf(0), _vr(0);

SetInputName(1, "天數");

qf = 0;
qu = 0;
qd = 0;
for _index = 1 to length
  begin
	if close[(_index - 1)] > close[_index] then
		qu = qu + Volume[(_index - 1)]
	else
	  begin
		if close[(_index - 1)] < close[_index] then
			qd = qd + Volume[(_index - 1)]
		else { close[(_index - 1)] = close[_index] }
			qf = qf + Volume[(_index - 1)];
	  end;
  end;

if (qd + qf/2) <> 0 then
  _vr = 100 * (qu + qf/2) /(qd + qf/2)
else
  _vr = 1000;

Plot1(_vr, "VR");
		]]></Code>
<Arg><![CDATA[<Arg seed="c50e1892-b41e-4056-b477-500f537eb848" version="1"><Param name="天數" varname="Length" type="1" subtype="0" value="26" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="78666439-f255-4269-8de4-946a4ea5cc53" version="1"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="VR" number="1" type="0" color="5275903" color2="0" style="0" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<Extra><![CDATA[<Extra>
<TotalBar val="50" />
<Maxbb val="26" />
<ScriptComplexity val="1" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="大戶散戶籌碼流向" ID="d0b68c07efe04140b1fd7fcf1272babc" ReturnType="0" ExecType="1" Folder="/即時籌碼/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[{指標數值定義："大戶=特大單+大單, 散戶=小單 
資料為大戶/散戶從開盤累計到現在的(外盤-內盤)張數"

支援商品：台(股票)}

if barfreq <> "Min" and barfreq <> "D" and barfreq <> "AD" then 
	raiseruntimeerror("僅支援分鐘與日頻率（含還原）");
	
value91 = GetField("賣出特大單量");//僅提供給有權限的用戶使用

value1 = GetField("賣出特大單量","D") + GetField("賣出大單量","D");
value2 = GetField("買進特大單量","D") + GetField("買進大單量","D");
value3 = value2 - value1;
value11 = GetField("賣出小單量","D");
value21 = GetField("買進小單量","D");
value31 = value21 - value11;
plot1(value3,"大戶買賣力");
plot2(value31,"散戶買賣力");]]></Code>
<Arg><![CDATA[<Arg seed="3df0301b-322a-4552-a58d-af2c6d125528" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="9e18ea2d-ef18-4360-86de-5ed614042b75" version="1">
	<Axises>
		<Axis value="1" align="0" min="-100.000000" max="100.000000" SetMin="1" SetMax="1" mpvalue="0.000000" />
		<Axis value="2" align="0" min="-100.000000" max="100.000000" SetMin="1" SetMax="1" mpvalue="0.000000" />
	</Axises>
	<Plot name="大戶買賣力" number="1" color="255" color2="5275903" weight="2" checkbox="-1" colors="," offset="0" />

	<Plot name="散戶買賣力" number="2" color="65280" color2="255" weight="2" checkbox="-1" colors="," offset="0" />

</Plots>]]></Plots>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="36" />
<script>
<freq support="8;11" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{&quot;0&quot;:[334],&quot;8&quot;:[334,340,331,337,352,349]},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="CPC指標" ID="8d26abd5ce574ecd813fdd753e587914" ReturnType="0" ExecType="1" Folder="/技術指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[{
指標說明
https://xstrader.net/自訂指標的撰寫技巧以q指標為例/
收錄於「三週學會程式交易：打造你的第一筆自動化交易」 317頁
https://www.ipci.com.tw/books_in.php?book_id=724
}

input:t1(10,"計算累積價格變動的bar數");
input:t2(5,"短期平均天期");
input:t3(20,"長期平均天期");

value1=close-close[1];//價格變化
value2=summation(value1,t1);//累積價格變化
value3=average(value2,t2);//短期平均
value4=average(value2,t3);//長期平均

plot1(value3,"短期累積價格變化平均");
plot2(value4,"長期累積價格變化平均");


]]></Code>
<Arg><![CDATA[<Arg seed="36638578-b01c-49b1-84c6-3f08556d2a85" version="1"><Param name="計算累積價格變動的bar數" varname="t1" type="1" subtype="0" value="10" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="短期平均天期" varname="t2" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="長期平均天期" varname="t3" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="7813583a-e25e-4ada-a2dd-de2f09e9e940" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="短期累積價格變化平均" number="1" type="0" color="255" color2="5275903" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /><Plot name="長期累積價格變化平均" number="2" type="0" color="16711833" color2="255" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="4" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="外資期權動態" ID="335803ceee014540b9b6119a9f1a7d2a" ReturnType="0" ExecType="1" Folder="/期權指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:length(3,"期數");

if barfreq = "Tick" or barfreq = "Min"
	then raiseruntimeerror("不支援此頻率");

value1=GetField("外資交易買口");
value2=GetField("外資交易賣口");
value3=GetField("外資買方未平倉口數");
value4=GetField("外資賣方未平倉口數");
value5=value1-value2;//外資今日淨買賣口數
plot1(value5,"外資今日淨買賣口數");
plot2(average(value5,length),"移動平均");
]]></Code>
<Arg><![CDATA[<Arg seed="6550a884-ffca-46e6-8c2f-7551eea982f3" version="1"><Param name="期數" varname="length" type="1" subtype="0" value="3" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="ec0ef6e8-a481-4584-b3c0-4a064cc3f504" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="外資今日淨買賣口數" number="1" type="1" color="255" color2="62464" style="3" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /><Plot name="移動平均" number="2" type="0" color="65535" color2="255" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="22" />
<script>
<freq support="8;11" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{&quot;0&quot;:[138,139,140,141]},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="外資" ID="4712b10fbb82481b813ef11368a12229" ReturnType="0" ExecType="1" Folder="/籌碼高手/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[condition999 = symbolexchange = "TW" or symbolexchange = "TE";//台股+興櫃
condition994 = symbol = "TSE.TW" or symbol = "TWSE.FS" or symbol = "OTC.TW";//大盤
condition993 = symbolexchange = "TW" and symboltype = 1;//類股

if condition999 = false and condition994 = false//大盤, 個股, 權證, 興櫃, 類股指數
	then raiseruntimeerror("不支援此商品");


if barfreq = "Tick" or barfreq = "Min"
	then raiseruntimeerror("不支援此頻率");

if condition994 then begin
	value1 = GetField("外資買進金額");
	value2 = GetField("外資賣出金額");
	value3 = GetField("外資買賣超金額");
	value4 = value4 + GetField("外資買賣超金額");
	plot2(value4,"外資累計買賣超",checkbox:=1,axis:=2,ScaleLabel:=sltypewy,ScaleDecimal:=sdauto); //line，axis1
	setplotlabel(1,"買賣超(元)");
	setplotlabel(2,"外資累計買賣超(元)");
	setplotlabel(3,"買進(元)");
	setplotlabel(4,"賣出(元)");
	plot1(value3,"買賣超",checkbox:=1,axis:=2,ScaleLabel:=sltypewy,ScaleDecimal:=sdauto); //bar，axis2
	plot3(value1,"買進",checkbox:=0,axis:=11,ScaleLabel:=sltypewy,ScaleDecimal:=sdauto); //line，axis2
	plot4(value2,"賣出",checkbox:=0,axis:=11,ScaleLabel:=sltypewy,ScaleDecimal:=sdauto); //line，axis2
end else begin
	if symbolexchange <> "TE" and condition993 = false then begin
		value1 = GetField("外資買張");
		value2 = GetField("外資賣張");
	end;
	value3 = GetField("外資買賣超張數");
	plot2(GetField("外資持股"),"外資持股",checkbox:=1,axis:=2,ScaleLabel:=slfull,ScaleDecimal:=sd0); //line，axis1
	setplotlabel(1,"買賣超(張)");
	setplotlabel(2,"外資持股(張)");
	setplotlabel(3,"買進(張)");
	setplotlabel(4,"賣出(張)");
	if condition993 = false then begin
		plot5(0.01*GetField("外資持股比例"),"外資持股比例",axis:=12,ScaleLabel:=slpercent,ScaleDecimal:=sd2);
	end;
	plot1(value3,"買賣超",checkbox:=1,axis:=1,ScaleLabel:=slfull,ScaleDecimal:=sd0); //bar，axis2
	if symbolexchange <> "TE" and condition993 = false then begin
		plot3(value1,"買進",checkbox:=0,axis:=11,ScaleLabel:=slfull,ScaleDecimal:=sd0); //line，axis2
		plot4(value2,"賣出",checkbox:=0,axis:=11,ScaleLabel:=slfull,ScaleDecimal:=sd0); //line，axis2
	end;
end;

]]></Code>
<Arg><![CDATA[<Arg seed="6184c7d9-1d82-48a0-9cb2-8e140ec2ea36" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="15b824e6-d249-46dd-be28-3399dea01eae" version="0"><Axises><Axis value="1" align="1" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="買賣超" number="1" type="1" color="255" color2="62464" style="3" weight="0" axis="0" DecimalFormat="1" NumFormat="1" checkbox="1" SetDecimalFormat="1" SetNumFormat="1" colors="," offset="0" /><Plot name="外資持股" number="2" type="0" color="39423" color2="62464" style="0" weight="0" axis="1" DecimalFormat="1" NumFormat="1" checkbox="1" SetDecimalFormat="1" SetNumFormat="1" colors="," offset="0" /><Plot name="買進" number="3" type="0" color="16711935" color2="65280" style="5" weight="0" axis="10" DecimalFormat="1" NumFormat="1" checkbox="0" SetDecimalFormat="1" SetNumFormat="1" colors="," offset="0" /><Plot name="賣出" number="4" type="0" color="65280" color2="14680319" style="5" weight="0" axis="10" DecimalFormat="1" NumFormat="1" checkbox="0" SetDecimalFormat="1" SetNumFormat="1" colors="," offset="0" /><Plot name="外資持股比例" number="5" type="0" color="65535" color2="65535" style="5" weight="0" axis="11" DecimalFormat="3" NumFormat="2" checkbox="-1" SetDecimalFormat="1" SetNumFormat="1" colors="," offset="0" /></Plots>]]></Plots>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="46" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{&quot;0&quot;:[105,106,104,27,28,186,30,31]},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="上影線佔實體比例五日平均" ID="2a61a990d39a493bb54f93e3ad016b28" ReturnType="0" ExecType="1" Folder="/技術指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[value1=average(upshadow,5);

plot1(value1,"五日平均上影線佔實體比例");

]]></Code>
<Arg><![CDATA[<Arg seed="ed6427f2-54e3-425e-8750-6c6af45db1b3" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="dedeea59-8169-4de5-926e-2e29698d4f1f" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="五日平均上影線佔實體比例" number="1" type="0" color="5275903" color2="5275903" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,b7522a72975a4d4bbc36f4fb684d6f77;1,8bf9f9ddd97f4beab44e64d47f7cd4fe;1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="3" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="券資比" ID="307d55046ce04aa289806de527b6e96f" ReturnType="0" ExecType="1" Folder="/籌碼高手/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[condition996 = symbolexchange = "TW" and symboltype = 2;//個股
condition994 = symbol = "TSE.TW" or symbol = "TWSE.FS" or symbol = "OTC.TW";//大盤
condition993 = symbolexchange = "TW" and symboltype = 1;//類股

if condition994 =false and condition993 = false and condition996 = false //大盤+類股+個股
	then raiseruntimeerror("不支援此商品");

if barfreq = "Tick" or barfreq = "Min"
	then raiseruntimeerror("不支援此頻率");

if symboltype = 1 then begin
	plot1(0.01 * GetField("券資比"),"券資比",axis:=1,ScaleLabel:=slpercent,ScaleDecimal:=sd2);//單位：
	plot2(GetField("融券餘額張數"),"融券餘額",axis:=11,ScaleLabel:=sltypewy,ScaleDecimal:=sdauto);//單位：張，新增查價顯示 (繪圖形式->隱藏, 不畫圖)
	plot3(GetField("融資餘額"),"融資餘額",axis:=12,ScaleLabel:=sltypewy,ScaleDecimal:=sdauto);//單位：張，新增查價顯示 (繪圖形式->隱藏, 不畫圖)
end else begin
	plot1(0.01 * GetField("券資比"),"券資比",axis:=1,ScaleLabel:=slpercent,ScaleDecimal:=sd2);//單位：
	plot2(GetField("融券餘額張數"),"融券餘額",axis:=11,ScaleLabel:=slfull,ScaleDecimal:=sd0);//單位：張，新增查價顯示 (繪圖形式->隱藏, 不畫圖)
	plot3(GetField("融資餘額"),"融資餘額",axis:=12,ScaleLabel:=slfull,ScaleDecimal:=sd0);//單位：張，新增查價顯示 (繪圖形式->隱藏, 不畫圖)
end;]]></Code>
<Arg><![CDATA[<Arg seed="50d92c7b-777f-4a2b-a8f5-f116c4bd3ab6" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="8193b86f-e6fb-49da-9b89-2417cbc16431" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="券資比" number="1" type="0" color="5275903" color2="5275903" style="0" weight="0" axis="0" DecimalFormat="3" NumFormat="2" checkbox="-1" SetDecimalFormat="1" SetNumFormat="1" colors="-1,-1" offset="0" /><Plot name="融券餘額" number="2" type="0" color="65280" color2="255" style="5" weight="0" axis="10" DecimalFormat="1" NumFormat="1" checkbox="-1" SetDecimalFormat="1" SetNumFormat="1" colors="-1,-1" offset="0" /><Plot name="融資餘額" number="3" type="0" color="16711935" color2="65280" style="5" weight="0" axis="11" DecimalFormat="1" NumFormat="1" checkbox="-1" SetDecimalFormat="1" SetNumFormat="1" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="31" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{&quot;0&quot;:[89,46,205]},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="價量齊揚天數" ID="8777e88a9afe4eb19a3fd128d229e78b" ReturnType="0" ExecType="3" Folder="/技術指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[{
指標說明
https://xstrader.net/從相對的角度尋找真正價量齊揚的股票-2/
}

input:sp(10,"短計算區間");

if barfreq = "Tick" or barfreq = "Min"
	then raiseruntimeerror("不支援此頻率");

variable:count1(0) ;

value1=GetField("資金流向");
value2=GetField("強弱指標");
count1=countif(value2>0and value1>value1[1],sp);
value3=average(count1,5);

plot1(value3/SP*100,"短期價量齊揚天數");]]></Code>
<Arg><![CDATA[<Arg seed="c6350ea3-a085-4e4e-a2f8-1988f53af608" version="1"><Param name="短計算區間" varname="sp" type="1" subtype="0" value="10" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="de1cfc0f-a69f-4650-85c3-f17c6b9b48dd" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="短期價量齊揚天數" number="1" type="0" color="5275903" color2="5275903" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,d80cf92ddfcc42e0a6c53ec47edebd49;1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="13" />
<script>
<freq support="8;11" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{&quot;0&quot;:[75,178]},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="DKX多空線" ID="498483ff92a445f29c296ebfd415fb13" ReturnType="0" ExecType="1" Folder="/量能指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[{
指標說明
https://xstrader.net/dkx多空線/
}

input:length(10,"MA期數");

variable:MID(0),midsum(0),DKX(0),DKXMA(0),r1(0);

MID=(close*3+open+high+low)/6;

DKX=WMA(MID,20);
dkxma=average(dkx,length);

plot1(close,"收盤價");
plot2(dkxma,"多空線的移動平均線");






]]></Code>
<Arg><![CDATA[<Arg seed="e1d915ee-8630-464a-ae47-17c8b0a1a26f" version="1"><Param name="MA期數" varname="length" type="1" subtype="0" value="10" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="a9edf51f-044f-4c73-a327-3c731cee85e3" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="收盤價" number="1" type="0" color="5275903" color2="5275903" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /><Plot name="多空線的移動平均線" number="2" type="0" color="255" color2="255" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,966999ee1cff467f9ff0315ccb773eff;1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="3" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="大盤六度空間切割法" ID="4d4a4b509cdc4b0c87ed75fe03cc8329" ReturnType="0" ExecType="1" Folder="/大盤指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[{
指標說明
https://xstrader.net/多空六大階段指標/
收錄於「三週學會程式交易：打造你的第一筆自動化交易」 259頁
https://www.ipci.com.tw/books_in.php?book_id=724
}

var:m50(0),m200(0);
m50=average(close,50);
m200=average(close,200);
if close > m50 and c< m200 and m50<m200
then value1=10
else value1=0;
if close > m50 and c> m200 and m50<m200
then value2=20
else value2=0;
if close > m50 and c> m200 and m50 > m200
then value3=30
else value3=0;
if close < m50 and c>m200 and m50>m200
then value4=-10
else value4=0;
if close < m50 and c <m200
then value5=-20
else value5=0;
if close < m50 and c <m200 then value6=-30
else value6=0;
plot1(value1,"復甦期");
plot2(value2,"收集期");
plot3(value3,"多頭");
plot4(value4,"警示期");
plot5(value5,"發散期");
plot6(value6,"空頭");]]></Code>
<Arg><![CDATA[<Arg seed="49bc7b7e-96cf-4c67-a470-822e2f2a3da9" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="248fd5e3-6a0f-4c39-88e5-32c199394190" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="復甦期" number="1" type="1" color="16711833" color2="5275903" style="0" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /><Plot name="收集期" number="2" type="1" color="39423" color2="255" style="0" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /><Plot name="多頭" number="3" type="1" color="255" color2="65280" style="0" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /><Plot name="警示期" number="4" type="1" color="16711935" color2="14680319" style="0" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /><Plot name="發散期" number="5" type="1" color="65280" color2="65535" style="0" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /><Plot name="空頭" number="6" type="1" color="1470258" color2="16776960" style="0" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="3" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="大盤法人比重" ID="d65894dd5d4047adbdc5f91a47079951" ReturnType="0" ExecType="1" Folder="/籌碼高手/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[condition994 = symbol = "TSE.TW" or symbol = "TWSE.FS" or symbol = "OTC.TW";//大盤

if condition994 = false //大盤
	then raiseruntimeerror("不支援此商品");

if barfreq <> "D" and barfreq <> "AD" and
	barfreq <> "W" and barfreq <> "AW" and
	barfreq <> "M" and barfreq <> "AM"
	then raiseruntimeerror("不支援此頻率");
	
plot1(0.005*(GetField("法人買進比重")+GetField("法人賣出比重")),"交易比重",checkbox:=1,axis:=1,ScaleLabel:=slpercent,ScaleDecimal:=sd2);
plot2(0.01*GetField("法人買進比重"),"買進比重",checkbox:=0,axis:=1,ScaleLabel:=slpercent,ScaleDecimal:=sd2);
plot3(0.01*GetField("法人賣出比重"),"賣出比重",checkbox:=0,axis:=1,ScaleLabel:=slpercent,ScaleDecimal:=sd2);]]></Code>
<Arg><![CDATA[<Arg seed="2267713d-588a-4b9a-af97-959e55585a26" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="3798c346-cd0c-4b6b-bc72-6f9518f14c7a" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="交易比重" number="1" type="0" color="5275903" color2="5275903" style="0" weight="0" axis="0" DecimalFormat="3" NumFormat="2" checkbox="1" SetDecimalFormat="1" SetNumFormat="1" colors="-1,-1" offset="0" /><Plot name="買進比重" number="2" type="0" color="16711935" color2="255" style="0" weight="0" axis="0" DecimalFormat="3" NumFormat="2" checkbox="0" SetDecimalFormat="1" SetNumFormat="1" colors="-1,-1" offset="0" /><Plot name="賣出比重" number="3" type="0" color="65280" color2="65280" style="0" weight="0" axis="0" DecimalFormat="3" NumFormat="2" checkbox="0" SetDecimalFormat="1" SetNumFormat="1" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="21" />
<script>
<freq support="8;11;9;12;10;13" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{&quot;0&quot;:[102,103]},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="進攻力道線" ID="aa14886c86cd437db20ac11f6022216e" ReturnType="0" ExecType="1" Folder="/技術指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:period(5,"期別");
value1=summationif(close>close[1],high-close[1],period);
plot1(value1,"進攻力道線");

]]></Code>
<Arg><![CDATA[<Arg seed="d3d13084-99ef-4d1f-9cb4-e5b78d1103c1" version="1"><Param name="期別" varname="period" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="85baa9b3-5861-4880-8731-c1f98e67b0de" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="進攻力道線" number="1" type="0" color="5275903" color2="5275903" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,95a5e49d2f6f4d369865c6de85a56469</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="2" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="AR 指標" ID="2c13bfea4f9d4190938d0d605b5e1877" ReturnType="0" ExecType="3" Folder="/XQ技術指標/" StatusMask="2">
<Desc><![CDATA[畫出AR指標]]></Desc>
<Code><![CDATA[// XQ: AR指標
// 
input: Length(26);
variable: sum(0), ar(0);

SetInputName(1, "天數");

sum = Summation((Open - Low), Length);
if sum <> 0 then
	ar = 100 * Summation((High - Open), length) / sum
else
	ar = ar[1];

Plot1(ar, "AR(%)");

		]]></Code>
<Arg><![CDATA[<Arg seed="2ecfb855-260f-4392-86f7-5e8a64d4aa2b" version="1"><Param name="天數" varname="Length" type="1" subtype="0" value="26" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="1e3cdb74-44e3-4838-ab5d-b862daccd76c" version="1"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="AR(%)" number="1" type="0" color="5275903" color2="0" style="0" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="50" />
<Maxbb val="28" />
<ScriptComplexity val="3" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="上漲佔比" ID="6fd5827607b74045aadbad725b56ef1c" ReturnType="0" ExecType="2" Folder="/大盤指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[value1=GetField("上漲家數");
value2=GetField("下跌家數");
value3=value1+value2;
if value3 = 0 then value4 = 0 else value4=value1/value3*100;

plot1(value4,"上漲佔比");

]]></Code>
<Arg><![CDATA[<Arg seed="a6f1c00b-24f9-4193-9c1e-8cc2525341ff" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="96b5f2d3-5557-4334-8288-e137d59c5142" version="1"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="上漲佔比" number="1" type="0" color="5275903" color2="0" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<Extra><![CDATA[<Extra>
<TotalBar val="10" />
<Maxbb val="3" />
<ScriptComplexity val="11" />
<script>
<freq support="8;11" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{&quot;0&quot;:[79,80]},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="散戶買賣盤" ID="f8b2b7af16314bac90a8b7bc6cd0c426" ReturnType="0" ExecType="1" Folder="/籌碼高手/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[condition999 = symbolexchange = "TW" or symbolexchange = "TE";//台股+興櫃
condition998 = condition999 = true and symboltype = 2;//個股+興櫃

if condition998 = false //個股+興櫃
	then raiseruntimeerror("不支援此商品");

if barfreq = "Tick" or barfreq = "Min"
	then raiseruntimeerror("不支援此頻率");

value1 = GetField("散戶買賣超張數")+value1;
plot1(value1,"累計買賣超(張)",checkbox:=1,axis:=1,ScaleLabel:=slfull,ScaleDecimal:=sd0);//單位:張
plot2(GetField("散戶買賣超張數"),"散戶買賣超(張)",checkbox:=1,axis:=2,ScaleLabel:=slfull,ScaleDecimal:=sd0);//單位:張]]></Code>
<Arg><![CDATA[<Arg seed="5f94d9b2-d3a3-4503-8def-76d06fbf5d00" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="d6610ae1-8f3a-4538-8f42-5a8ae9e15a03" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="1" min="-100" max="100" /></Axises><Plot name="累計買賣超(張)" number="1" type="0" color="5275903" color2="5275903" style="0" weight="0" axis="0" DecimalFormat="1" NumFormat="1" checkbox="1" SetDecimalFormat="1" SetNumFormat="1" colors="-1,-1" offset="0" /><Plot name="散戶買賣超(張)" number="2" type="1" color="255" color2="62464" style="3" weight="0" axis="1" DecimalFormat="1" NumFormat="1" checkbox="1" SetDecimalFormat="1" SetNumFormat="1" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="11" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{&quot;0&quot;:[58]},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="TRIX(三重指數平滑移動平均指標)" ID="d738132b1fff4be4b883407bb28d1168" ReturnType="0" ExecType="3" Folder="/XQ技術指標/" StatusMask="2">
<Desc><![CDATA[畫出三重指數平滑移動平均指標]]></Desc>
<Code><![CDATA[// XQ: TRIX指標
//
input: Length1(9), Length2(15);

SetInputName(1, "天數一");
SetInputName(2, "天數二");

Value1 = TRIX(Close, Length1) * 100;
Value2 = TRIX(Close, Length2) * 100;

Plot1(Value1, "TRIX1");
Plot2(Value2, "TRIX2");
		]]></Code>
<Arg><![CDATA[<Arg seed="d6e1688a-f217-4b70-b921-dc7320dcb141" version="1"><Param name="天數一" varname="Length1" type="1" subtype="0" value="9" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="天數二" varname="Length2" type="1" subtype="0" value="15" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="4261c2bc-755e-4ee5-b5d3-195d89596d98" version="1"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="TRIX1" number="1" type="0" color="5275903" color2="0" style="0" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /><Plot name="TRIX2" number="2" type="0" color="255" color2="0" style="0" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,d02c45cba76f4163a048685f7bc4002b;1,31df812470ed4d30af3a7592649c9054</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="100" />
<Maxbb val="20" />
<ScriptComplexity val="3" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="ACC (加速量指標)" ID="2d837802ffa84755a7a43b54bb5ecd1b" ReturnType="0" ExecType="3" Folder="/XQ技術指標/" StatusMask="2">
<Desc><![CDATA[畫出加速量指標]]></Desc>
<Code><![CDATA[// XQ: ACC指標
//
input: Length(10);

SetInputName(1, "天數");

value1 = Momentum(Close, Length); 
value2 = Momentum(value1, Length);

Plot1(value2, "ACC");]]></Code>
<Arg><![CDATA[<Arg seed="515c6e76-7687-4110-bfd9-2b4c9806ce8f" version="1"><Param name="天數" varname="Length" type="1" subtype="0" value="10" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="34ce5bc1-3cb4-4d1d-b3cf-9a9581be0224" version="1"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="ACC" number="1" type="0" color="5275903" color2="0" style="0" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,239cb1c1f329431ea731982d8f5d94f2</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="50" />
<Maxbb val="20" />
<ScriptComplexity val="3" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="MTM(動量指標)" ID="36e64b0960204fdfa7f72b3ab920d8fb" ReturnType="0" ExecType="3" Folder="/XQ技術指標/" StatusMask="2">
<Desc><![CDATA[畫出動量指標]]></Desc>
<Code><![CDATA[// XQ: MTM指標
//
input: Length(10);

SetInputName(1, "天數");

value1 = Momentum(Close, Length); 
if CurrentBar >= Length then
	Value2 = Average(Value1, Length)
else
	Value2 = Value1;
	
Plot1(value1, "MTM");
Plot2(value2, "MA");

        
		]]></Code>
<Arg><![CDATA[<Arg seed="112e9cd3-386b-481c-8a53-cfcf8f00997d" version="1"><Param name="天數" varname="Length" type="1" subtype="0" value="10" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="422b5aad-4458-495c-9006-329491980d36" version="1"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="MTM" number="1" type="0" color="5275903" color2="0" style="0" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /><Plot name="MA" number="2" type="0" color="255" color2="0" style="0" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,239cb1c1f329431ea731982d8f5d94f2;1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="50" />
<Maxbb val="12" />
<ScriptComplexity val="3" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="Gamma" ID="8cc6a4f12c0f44339266a3cee5110aec" ReturnType="0" ExecType="1" Folder="/期權指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[plot1(GetField("Gamma"),"Gamma");]]></Code>
<Arg><![CDATA[<Arg seed="3a0c5fb9-6ddc-4c47-b547-e6c78288b132" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="5981f902-63ef-4478-83a8-0e56b72e172a" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="Gamma" number="1" type="0" color="5275903" color2="5275903" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="," offset="0" /></Plots>]]></Plots>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="6" />
<script>
<freq support="8;11;9;12;10;13" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{&quot;0&quot;:[153]},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="自營商均價線" ID="fd1fcbf155cd42fa9d982e4e1561bb27" ReturnType="0" ExecType="3" Folder="/主圖指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[Input: period(20);	setinputname(1, "期間(天)");

if barfreq = "Tick" or barfreq = "Min"
	then raiseruntimeerror("不支援此頻率");
	
variable: avg_b(0), avg_s(0);

if GetField("Volume") > 0 then 
begin
	Value5 = GetField("自營商買張")*GetField("成交金額")/(GetField("Volume")*1000);
	Value6 = GetField("自營商賣張")*GetField("成交金額")/(GetField("Volume")*1000);
end else begin
	Value5 = 0;
	Value6 = 0;
end;
	
Value1 = summation(Value5, period);
Value2 = summation(GetField("自營商買張"), period);
Value3 = summation(Value6, period);
Value4 = summation(GetField("自營商賣張"), period);
 
if Value2 > 0 and Value2 <> Value2[1] then avg_b = Value1 / Value2;
if Value4 > 0 and Value4 <> Value4[1]  then avg_s = Value3 / Value4;

Plot1(avg_b, "自營商買進均價");
Plot2(avg_s, "自營商賣出均價");


]]></Code>
<Arg><![CDATA[<Arg seed="2c6bcca6-65e1-433b-b0a5-43d7c7e6be1f" version="1"><Param name="期間(天)" varname="period" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="c9c952ee-3216-490f-a56d-92ef22a1b427" version="0"><Axises><Axis value="1" align="3" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="自營商買進均價" number="1" type="0" color="255" color2="0" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /><Plot name="自營商賣出均價" number="2" type="0" color="65280" color2="255" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="50" />
<script>
<freq support="8;11;9;12;10;13" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{&quot;0&quot;:[9,37,19,38]},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="漲跌停家數" ID="0737c35cc72f4b79ae8e7e2b50af7332" ReturnType="0" ExecType="1" Folder="/大盤指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[value1=GetField("漲停家數");
value2=GetField("跌停家數");
plot1(value1,"漲停家數");
plot2(value2,"跌停家數");]]></Code>
<Arg><![CDATA[<Arg seed="b0e83b72-da07-41b2-938e-f4adbef11725" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="e104c7b3-f568-4c9a-8181-8ffd68ab3761" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="漲停家數" number="1" type="0" color="255" color2="5275903" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /><Plot name="跌停家數" number="2" type="0" color="65280" color2="255" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="11" />
<script>
<freq support="8;11" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{&quot;0&quot;:[81,82]},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="EMA-SMA" ID="7fc1b00ba7d34f5580976fa05e3c49ec" ReturnType="0" ExecType="3" Folder="/技術指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:period(20,"計算期間");

value1=EMA(close,period);
value2=average(close,period);
if close<>0 then 
	value3=(value1-value2)/close*100;

plot1(value3,"EMA-SMA");]]></Code>
<Arg><![CDATA[<Arg seed="c87cde7b-d6b6-466e-9fa4-5672298cd0b6" version="1"><Param name="計算期間" varname="period" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="0818a334-9d67-4756-a6f8-22962d8f7d1e" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="EMA-SMA" number="1" type="0" color="5275903" color2="5275903" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,acd8e9a292d64600bec9591361584e6f;1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="3" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="尼古斯指標" ID="8175c49f36de4358b6ce19fc1bffac0d" ReturnType="0" ExecType="3" Folder="/大盤指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input: length(30);		setinputname(1, "天期");

value1=GetField("上漲家數");
value2=GetField("下跌家數");
value3=average(value1,length);
value4=average(value2,length);
if value4 <> 0 then value5=value3/value4;

plot1(value5, "尼古斯指標");]]></Code>
<Arg><![CDATA[<Arg seed="d4eab45c-8686-4afb-afca-dda807d4acc8" version="1"><Param name="天期" varname="length" type="1" subtype="0" value="30" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="51216d1d-7633-4d6b-aa90-5a5379eb54b0" version="1"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="尼古斯指標" number="1" type="0" color="5275903" color2="0" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="50" />
<Maxbb val="30" />
<ScriptComplexity val="13" />
<script>
<freq support="8;11" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{&quot;0&quot;:[79,80]},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="Delta" ID="0aaaefec33234ec9a4080722d88fb96b" ReturnType="0" ExecType="1" Folder="/期權指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[plot1(GetField("Delta"),"Delta");
]]></Code>
<Arg><![CDATA[<Arg seed="cc0622e2-998c-4099-912c-3252dbd87926" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="0b830531-5b5a-4b9e-a635-2997d00d05ce" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="Delta" number="1" type="0" color="5275903" color2="5275903" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="," offset="0" /></Plots>]]></Plots>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="6" />
<script>
<freq support="8;11;9;12;10;13" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{&quot;0&quot;:[152]},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="IMI日內動能指標" ID="70dd2e611cc34d629989f584b6950b9b" ReturnType="0" ExecType="3" Folder="/技術指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:length(10);		setinputname(1, "天期");
   
variable:up(0),dn(0),upi(0),dni(0),imi(0);   

if close > open then   
  up = close-open   
else   
  up = 0;   

if close < open then   
  dn = open-close   
else   
  dn = 0;   

upi = summation(up,length);   
dni = summation(dn,length);   
if upi+dni = 0 then imi = 0 else imi = upi/(upi+dni)*100;   

plot1(imi, "IMI");  
]]></Code>
<Arg><![CDATA[<Arg seed="68089e13-9d93-43ed-bd25-27ffe7cb3428" version="1"><Param name="天期" varname="length" type="1" subtype="0" value="10" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="c3f9a6e7-3045-463b-a624-451a270a6902" version="1"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="IMI" number="1" type="0" color="5275903" color2="0" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="50" />
<Maxbb val="20" />
<ScriptComplexity val="3" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="分時散戶買賣力(金額)" ID="cffe1ea38fa04b7d95fde47248c7bcd7" ReturnType="0" ExecType="1" Folder="/即時籌碼/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[{指標數值定義："散戶單=小單資料為分鐘統計金額"
支援商品：台(股票)}

if barfreq <> "Min" and barfreq <> "D" and barfreq <> "AD" then 
	raiseruntimeerror("僅支援分鐘與日頻率（含還原）");
	
value91 = GetField("賣出小單金額");//僅提供給有權限的用戶使用

value1 = GetField("賣出小單金額");
value2 = GetField("買進小單金額");
value3 = value2 - value1;
plot1(value3,"散戶買賣力(金額)");
plot2(value2,"散戶外盤量(金額)",checkbox:=0);
plot3(value1,"散戶內盤量(金額)",checkbox:=0);]]></Code>
<Arg><![CDATA[<Arg seed="7a54f460-edb4-43fd-b09f-7b5f6ad9c488" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="e64b3d66-5c96-4729-981e-4a2204d12cae" version="1">
	<Axises>
		<Axis value="1" align="0" min="-100.000000" max="100.000000" SetMin="1" SetMax="1" mpvalue="0.000000" />
		<Axis value="2" align="1" min="-100.000000" max="100.000000" SetMin="1" SetMax="1" mpvalue="0.000000" />
	</Axises>
	<Plot name="散戶買賣力(金額)" number="1" type="1" style="3" color="255" color2="65280" axis="1" checkbox="-1" colors="," offset="0" />

	<Plot name="散戶外盤量(金額)" number="2" color="16711935" color2="255" checkbox="0" colors="," offset="0" />

	<Plot name="散戶內盤量(金額)" number="3" color="15446382" color2="65280" checkbox="0" colors="," offset="0" />

</Plots>]]></Plots>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="16" />
<script>
<freq support="8;11" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{&quot;0&quot;:[353,350]},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="BBand軌道線" ID="8acbba3991644075bebffc8becd7ca14" ReturnType="0" ExecType="3" Folder="/主圖指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input: 
	Length(20, "MA的天數"), 
	UpperBand(2, "上通道標準差倍數"), 
	LowerBand(2, "下通道標準差倍數");
variable: mid(0), up(0), down(0);

up = bollingerband(Close, Length, UpperBand);
mid = average(close, Length);
down = bollingerband(Close, Length, -1 * LowerBand);

plot1(up, "UB");
plot2(mid, "BBandMA");
plot3(down, "LB");
]]></Code>
<Arg><![CDATA[<Arg seed="77796efd-e527-4c9a-80b5-68b27772bb1c" version="1"><Param name="MA的天數" varname="Length" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="上通道標準差倍數" varname="UpperBand" type="1" subtype="0" value="2" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="下通道標準差倍數" varname="LowerBand" type="1" subtype="0" value="2" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="4d63c146-27c6-4a3e-9f5b-b193022ef351" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="UB" number="1" type="0" color="6723891" color2="0" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /><Plot name="BBandMA" number="2" type="0" color="255" color2="0" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /><Plot name="LB" number="3" type="0" color="6723891" color2="0" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c;1,8c2d025a23c548d3a76fba10c22527b4;1,9c4f476d319b4f109a8dc8557099ded4;1,c1cda70a714d44999e5171fc53c95b0a;1,5f76de57dba441808c8c784d8fa54994</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="300" />
<Maxbb val="50" />
<ScriptComplexity val="4" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="借券" ID="c0b7451788f948fca34252c325c17eae" ReturnType="0" ExecType="1" Folder="/籌碼高手/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[//借券餘額市值公式參考：
//http://www.twse.com.tw/ch/trading/SBL/TWT72U/TWT72U.php

condition996 = symbolexchange = "TW" = true and symboltype = 2;//個股
condition994 = symbol = "TSE.TW" or symbol = "TWSE.FS" or symbol = "OTC.TW";//大盤

if condition994 = false and condition996 = false //大盤+個股
	then raiseruntimeerror("不支援此商品");

if barfreq = "Tick" or barfreq = "Min"
	then raiseruntimeerror("不支援此頻率");

if symboltype = 1 then begin
	plot1(GetField("借券賣出餘額張數"),"借券賣出餘額(張)",axis:=1,ScaleLabel:=sltypewy,ScaleDecimal:=sdauto);			//單位：張
	plot2(GetField("借券餘額張數"),"借券餘額(張)",axis:=2,ScaleLabel:=sltypewy,ScaleDecimal:=sdauto);				//單位：張
	//plot3(GetField("借券餘額張數")*1000*close,"借券餘額市值(元)",axis:=11,ScaleLabel:=sltypewy,ScaleDecimal:=sdauto);	//單位：元，新增查價顯示 (繪圖形式->隱藏, 不畫圖)
end else begin
	plot1(GetField("借券賣出餘額張數"),"借券賣出餘額(張)",axis:=1,ScaleLabel:=slfull,ScaleDecimal:=sd0);			//單位：張
	plot2(GetField("借券餘額張數"),"借券餘額(張)",axis:=2,ScaleLabel:=slfull,ScaleDecimal:=sd0);				//單位：張
	plot3(GetField("借券餘額張數")*1000*close,"借券餘額市值(元)",axis:=11,ScaleLabel:=sltypewy,ScaleDecimal:=sdauto);	//單位：元，新增查價顯示 (繪圖形式->隱藏, 不畫圖)
end;]]></Code>
<Arg><![CDATA[<Arg seed="38947e74-8b29-4cf3-9254-f7bcb56284d3" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="4e29c68e-5d98-47ea-8804-92e0f60bbb06" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="借券賣出餘額(張)" number="1" type="1" color="5275903" color2="5275903" style="0" weight="0" axis="0" DecimalFormat="1" NumFormat="1" checkbox="-1" SetDecimalFormat="1" SetNumFormat="1" colors="-1,-1" offset="0" /><Plot name="借券餘額(張)" number="2" type="0" color="255" color2="255" style="0" weight="0" axis="1" DecimalFormat="1" NumFormat="1" checkbox="-1" SetDecimalFormat="1" SetNumFormat="1" colors="-1,-1" offset="0" /><Plot name="借券餘額市值(元)" number="3" type="0" color="65280" color2="65280" style="5" weight="0" axis="10" DecimalFormat="0" NumFormat="3" checkbox="-1" SetDecimalFormat="0" SetNumFormat="1" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="26" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{&quot;0&quot;:[93,67]},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="隨機漫步指標" ID="ff97b83867b0470d80466a0ee30b4fee" ReturnType="0" ExecType="3" Folder="/技術指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[
input:length(10);		setinputname(1, "天期");   

variable:RWIH(0),RWIL(0);   

value1 = standarddev(close,length,1);   
value2 = average(truerange,length);   
RWIH = (high-low[length-1])/value2*value1;   
RWIL = (high[length-1]-low)/value2*value1;   

plot1(RWIH - RWIL, "RWI");
  ]]></Code>
<Arg><![CDATA[<Arg seed="de834257-a4d7-4fe2-bff5-d2d87546d529" version="1"><Param name="天期" varname="length" type="1" subtype="0" value="10" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="bc54a44e-8b74-4015-8b6d-c025662e8064" version="1"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="RWI" number="1" type="1" color="5275903" color2="0" style="0" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,8c2d025a23c548d3a76fba10c22527b4;1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c;1,9c4f476d319b4f109a8dc8557099ded4;1,c1cda70a714d44999e5171fc53c95b0a;1,36d1fc033c6f48f8a136f9e1fdec110f;1,81394f9cf0c8469ea5f8832700aec8b7;1,9e03682196e24611b2fe326b6a56433d</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="50" />
<Maxbb val="20" />
<ScriptComplexity val="4" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="VHF(垂直水平過濾指標)" ID="757877813d954941b35cbe9da2f6b088" ReturnType="0" ExecType="3" Folder="/XQ技術指標/" StatusMask="2">
<Desc><![CDATA[畫出垂直水平過濾指標]]></Desc>
<Code><![CDATA[// XQ: VHF指標
//
input: Length(42);
Variable: hp(0), lp(0), numerator(0), denominator(0), _vhf(0);

SetInputName(1, "天數");

hp = highest(Close, Length);
lp = lowest(Close, Length);

numerator = hp - lp;
denominator = Summation(absvalue((Close - Close[1])), Length);

if denominator <> 0 then
	_vhf = numerator / denominator
else
	_vhf = 0;

Plot1(_vhf, "VHF");

        
		]]></Code>
<Arg><![CDATA[<Arg seed="f4bd140e-d543-4235-8072-27bac2710e8e" version="1"><Param name="天數" varname="Length" type="1" subtype="0" value="42" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="a5f6b54d-2f4b-443a-be7a-e9f8c01d9dbe" version="1"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="VHF" number="1" type="0" color="5275903" color2="0" style="0" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,61c06064ad98469db9ce30287ae4a2c8;1,2bca774c6b7549c1b0b008d2a54b288e;1,f1b429ac13b2447c909302198c18ca56;1,c122bd6485c544f2bce8f374b5c7440d</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="50" />
<Maxbb val="42" />
<ScriptComplexity val="4" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="分鐘與日RSI" ID="d5e0baf86b6349a2bb9db194df3f8237" ReturnType="0" ExecType="3" Folder="/跨頻率指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[// 跨頻率RSI指標，預設跨頻率為30分
// 不支援大頻率跨小頻率，例如：
// 不支援主頻率60分鐘，跨頻率計算30分鐘RSI技術指標。
//
input: 	Length1(6, "天數一"), Length2(12, "天數二"),
		FreqType("30", "跨頻率週期", inputkind:=dict(["1分鐘","1"],["5分鐘","5"],["10分鐘","10"],["15分鐘","15"],["30分鐘","30"],["60分鐘","60"],["日","D"],["還原日","AD"]));

if barfreq <> "Tick" and barfreq <> "Min" and barfreq <> "D" and barfreq <> "AD" then raiseruntimeerror("此範例僅支援分鐘、日與還原日頻率");

// 因 Getfield 第二個參數不支援動態變數字串，故使用以下語法表達跨分鐘頻率的RSI
// 防呆，大頻率跨小頻率時，在線圖秀不支援
//
switch (FreqType)
begin
	case  "1":
		if barfreq <> "Tick" and barfreq <> "Min" then raiseruntimeerror("不支援大頻率跨小頻率：主頻率大於1分鐘");
		if barinterval <> 1 then raiseruntimeerror("不支援大頻率跨小頻率：主頻率大於1分鐘");
		value1 = xfMin_RSI("1", GetField("Close","1"), Length1);
		value2 = xfMin_RSI("1", GetField("Close","1"), Length2);
		Plot1(value1, "分鐘與日RSI1");
		Plot2(value2, "分鐘與日RSI2");
		setplotlabel(1, "1分RSI");
		setplotlabel(2, "1分RSI");

	case  "5":
		if barfreq <> "Tick" and barfreq <> "Min" then raiseruntimeerror("不支援大頻率跨小頻率：主頻率大於5分鐘");
		if barinterval <> 1 and barinterval <> 2 and barinterval <> 3 and barinterval <> 5 then raiseruntimeerror("不支援大頻率跨小頻率：主頻率大於5分鐘");
		value1 = xfMin_RSI("5", GetField("Close","5"), Length1);
		value2 = xfMin_RSI("5", GetField("Close","5"), Length2);
		Plot1(value1, "分鐘與日RSI1");
		Plot2(value2, "分鐘與日RSI2");
		setplotlabel(1, "5分RSI");
		setplotlabel(2, "5分RSI");

	case "10":
		if barfreq <> "Tick" and barfreq <> "Min" then raiseruntimeerror("不支援大頻率跨小頻率：主頻率大於10分鐘");
		if barinterval <> 1 and barinterval <> 2 and barinterval <> 3 and barinterval <> 5 and barinterval <> 10 then raiseruntimeerror("不支援大頻率跨小頻率：主頻率大於10分鐘");
		value1 = xfMin_RSI("10", GetField("Close","10"), Length1);
		value2 = xfMin_RSI("10", GetField("Close","10"), Length2);
		Plot1(value1, "分鐘與日RSI1");
		Plot2(value2, "分鐘與日RSI2");
		setplotlabel(1, "10分RSI");
		setplotlabel(2, "10分RSI");

	case "15":
		if barfreq <> "Tick" and barfreq <> "Min" then raiseruntimeerror("不支援大頻率跨小頻率：主頻率大於15分鐘");
		if barinterval <> 1 and barinterval <> 2 and barinterval <> 3 and barinterval <> 5 and barinterval <> 10 and barinterval <> 15 then raiseruntimeerror("不支援大頻率跨小頻率：主頻率大於15分鐘");
		value1 = xfMin_RSI("15", GetField("Close","15"), Length1);
		value2 = xfMin_RSI("15", GetField("Close","15"), Length2);
		Plot1(value1, "分鐘與日RSI1");
		Plot2(value2, "分鐘與日RSI2");
		setplotlabel(1, "15分RSI");
		setplotlabel(2, "15分RSI");
		
	case "30":
		if barfreq <> "Tick" and barfreq <> "Min" then raiseruntimeerror("不支援大頻率跨小頻率：主頻率大於30分鐘");
		if barinterval <> 1 and barinterval <> 2 and barinterval <> 3 and barinterval <> 5 and barinterval <> 10 and barinterval <> 15 and barinterval <> 20 and barinterval <> 30 then raiseruntimeerror("不支援大頻率跨小頻率：主頻率大於30分鐘");
		value1 = xfMin_RSI("30", GetField("Close","30"), Length1);
		value2 = xfMin_RSI("30", GetField("Close","30"), Length2);
		Plot1(value1, "分鐘與日RSI1");
		Plot2(value2, "分鐘與日RSI2");
		setplotlabel(1, "30分RSI");
		setplotlabel(2, "30分RSI");

	case "60":
		if barfreq <> "Tick" and barfreq <> "Min" then raiseruntimeerror("不支援大頻率跨小頻率：主頻率大於60分鐘");
		if barinterval <> 1 and barinterval <> 2 and barinterval <> 3 and barinterval <> 5 and barinterval <> 10 and barinterval <> 15 and barinterval <> 20 and barinterval <> 30 and barinterval <> 45 and barinterval <> 60 then raiseruntimeerror("不支援大頻率跨小頻率：主頻率大於60分鐘");
		value1 = xfMin_RSI("60", GetField("Close","60"), Length1);
		value2 = xfMin_RSI("60", GetField("Close","60"), Length2);
		Plot1(value1, "分鐘與日RSI1");
		Plot2(value2, "分鐘與日RSI2");
		setplotlabel(1, "60分RSI");
		setplotlabel(2, "60分RSI");

	case "D":
		if barfreq <> "Tick" and barfreq <> "Min" and barfreq <> "D" and barfreq <> "AD" then raiseruntimeerror("不支援大頻率跨小頻率：主頻率大於日");
		value1 = xfMin_RSI("D", GetField("Close","D"), Length1);
		value2 = xfMin_RSI("D", GetField("Close","D"), Length2);
		Plot1(value1, "分鐘與日RSI1");
		Plot2(value2, "分鐘與日RSI2");
		setplotlabel(1, "日RSI");
		setplotlabel(2, "日RSI");
		
	case "AD":
		if barfreq <> "Tick" and barfreq <> "Min" and barfreq <> "D" and barfreq <> "AD" then raiseruntimeerror("不支援大頻率跨小頻率：主頻率大於還原日");
		value1 = xfMin_RSI("AD", GetField("Close","AD"), Length1);
		value2 = xfMin_RSI("AD", GetField("Close","AD"), Length2);
		Plot1(value1, "分鐘與日RSI1");
		Plot2(value2, "分鐘與日RSI2");
		setplotlabel(1, "還原日RSI");
		setplotlabel(2, "還原日RSI");
	
end;
]]></Code>
<Arg><![CDATA[<Arg seed="309b1982-5876-4103-9d01-052ab970f73a" version="1"><Param name="天數一" varname="Length1" type="1" subtype="0" value="6" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="天數二" varname="Length2" type="1" subtype="0" value="12" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="跨頻率週期" varname="FreqType" type="3" subtype="0" value="30" isSerial="0" isArray="0" isRef="0" inputkind="1" quickedit="0" keytype="3"><Pair key="1分鐘" value="1" /><Pair key="5分鐘" value="5" /><Pair key="10分鐘" value="10" /><Pair key="15分鐘" value="15" /><Pair key="30分鐘" value="30" /><Pair key="60分鐘" value="60" /><Pair key="日" value="D" /><Pair key="還原日" value="AD" /></Param></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="0de4fab8-f317-40d4-bb34-eda0e44d91eb"><Plot name="分鐘與日RSI1" number="1" type="0" color="5275903" color2="5275903" style="0" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /><Plot name="分鐘與日RSI2" number="2" type="0" color="255" color2="255" style="0" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,de5550c0989b434681e18c65fcc79915;1,8e4cc5f4d71342f9a5b6c2e5dc9a6966;1,aced678c83804b088f72d66788ddde3c;1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c;1,35fa7414b11748dab81393027c742be7</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="20" />
<ScriptComplexity val="97" />
<script>
<freq support="2;8;9;10;11;12;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{&quot;2&quot;:[8],&quot;3&quot;:[8],&quot;4&quot;:[8],&quot;5&quot;:[8],&quot;6&quot;:[8],&quot;7&quot;:[8],&quot;8&quot;:[8],&quot;11&quot;:[8]},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="put call ratio" ID="cfc5c32bb0ce45da8f57d0abba816075" ReturnType="0" ExecType="1" Folder="/技術指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[value1=GetField("買賣權未平倉量比率");
plot1(value1,"put call ratio");]]></Code>
<Arg><![CDATA[<Arg seed="0e817877-da8a-4c69-a26a-bbfe84ac0414" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="4c073b13-17d9-4a5f-9433-68f0149fedac" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="put call ratio" number="1" type="0" color="5275903" color2="5275903" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="6" />
<script>
<freq support="8;11;9;12;10;13" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{&quot;0&quot;:[159]},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="自營商累計買賣超" ID="46b3ffb658594a8db360f331489188d5" ReturnType="0" ExecType="3" Folder="/籌碼指標/" StatusMask="2">
<Desc><![CDATA[計算一段時間的自營商累計買賣超張數以及占成交的比重]]></Desc>
<Code><![CDATA[input: Length(5); setinputname(1,"計算天數");
input:TXT("僅適用日線以上"); setinputname(2,"使用限制");

if barfreq = "Tick" or barfreq = "Min"
	then raiseruntimeerror("不支援此頻率");
	
variable: _buyTotal(0), volTotal(0);

_buyTotal = summation(GetField("自營商買賣超"), Length);
volTotal = summation(Volume, Length);

Plot1(_buyTotal, "累計買賣超");
Plot2(_buyTotal * 100 / volTotal, "比例%");
]]></Code>
<Arg><![CDATA[<Arg seed="276dde91-e099-4aba-8060-1a561f5bbbe6" version="1"><Param name="計算天數" varname="Length" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="使用限制" varname="TXT" type="3" subtype="0" value="僅適用日線以上" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="e56df969-fd6f-4569-bc2e-bf697bf138bc" version="1"><Axises><Axis value="1" align="1" min="-100" max="100" /><Axis value="2" align="1" min="-100" max="100" /></Axises><Plot name="累計買賣超" number="1" type="1" color="5275903" color2="0" style="0" weight="0" axis="1" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /><Plot name="比例%" number="2" type="0" color="255" color2="0" style="0" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="30" />
<Maxbb val="20" />
<ScriptComplexity val="8" />
<script>
<freq support="8;11;9;12;10;13;14;15" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{&quot;0&quot;:[41]},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="融資" ID="e77791d930694ff0af3eaeb0462b8218" ReturnType="0" ExecType="1" Folder="/籌碼高手/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input: _input1(1,"大盤融資單位",inputkind:= Dict(["金額",1],["張數",2]));//1=金額、2=張數

condition996 = symbolexchange = "TW" and symboltype = 2;//個股
condition994 = symbol = "TSE.TW" or symbol = "TWSE.FS" or symbol = "OTC.TW";//大盤
condition993 = symbolexchange = "TW" and symboltype = 1;//類股
condition991 = symbolexchange = "SH" and symboltype = 2;//滬股
condition990 = symbolexchange = "SZ" and symboltype = 2;//深股

if condition994 =false and condition993 = false and condition996 = false //大盤+類股+個股
	and condition991 = false and condition990 = false //陸股
	then raiseruntimeerror("不支援此商品");

if barfreq = "Tick" or barfreq = "Min"
	then raiseruntimeerror("不支援此頻率");

if condition994 and _input1 = 1 then begin
	plot1(GetField("融資餘額金額"),"融資(元)",checkbox:=1,axis:=1,ScaleLabel:=sltypewy,ScaleDecimal:=sdauto);//單位：張
	plot2(GetField("融資增減金額"),"差額(元)",checkbox:=1,axis:=2,ScaleLabel:=sltypewy,ScaleDecimal:=sdauto);//單位：張
	plot3(GetField("融資買進金額"),"買進(元)",checkbox:=0,axis:=11,ScaleLabel:=sltypewy,ScaleDecimal:=sdauto);//可勾選畫圖選項 (參數設定) 
	plot4(GetField("融資賣出金額"),"賣出(元)",checkbox:=0,axis:=11,ScaleLabel:=sltypewy,ScaleDecimal:=sdauto);//可勾選畫圖選項 (參數設定) 
	plot5(GetField("現金償還張數"),"現償(張)",checkbox:=0,axis:=12,ScaleLabel:=sltypewy,ScaleDecimal:=sdauto);//可勾選畫圖選項 (參數設定) 
	setplotlabel(1,"融資(元)");
	setplotlabel(2,"差額(元)");
	setplotlabel(3,"買進(元)");
	setplotlabel(4,"賣出(元)");
end else begin
	plot1(GetField("融資餘額張數"),"融資(張)",checkbox:=1,axis:=1,ScaleLabel:=slfull,ScaleDecimal:=sd0);//單位：張
	plot2(GetField("融資增減張數"),"差額(張)",checkbox:=1,axis:=2,ScaleLabel:=slfull,ScaleDecimal:=sd0);//單位：張
	if condition996 then begin
		value1 = GetField("融資買進張數");
		value2 = GetField("融資賣出張數");
		value3 = GetField("現金償還張數");
	end;
	plot3(value1,"買進(張)",checkbox:=0,axis:=11,ScaleLabel:=slfull,ScaleDecimal:=sd0);//可勾選畫圖選項 (參數設定) 
	plot4(value2,"賣出(張)",checkbox:=0,axis:=11,ScaleLabel:=slfull,ScaleDecimal:=sd0);//可勾選畫圖選項 (參數設定) 
	plot5(value3,"現償(張)",checkbox:=0,axis:=12,ScaleLabel:=slfull,ScaleDecimal:=sd0);//可勾選畫圖選項 (參數設定) 
	setplotlabel(1,"融資(張)");
	setplotlabel(2,"差額(張)");
	setplotlabel(3,"買進(張)");
	setplotlabel(4,"賣出(張)");
end;
if condition996 then
	plot6(GetField("融資使用率")*0.01,"使用率",axis:=13,ScaleLabel:=slpercent,ScaleDecimal:=sd2);//單位%，隱藏，不畫圖，僅查價

]]></Code>
<Arg><![CDATA[<Arg seed="d9696c29-2c54-4c88-8580-97961b1db9de" version="1"><Param name="大盤融資單位" varname="_input1" type="1" subtype="0" value="1" isSerial="0" isArray="0" isRef="0" inputkind="1" quickedit="0" keytype="3"><Pair key="金額" value="1" /><Pair key="張數" value="2" /></Param></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="9d397dc1-262b-4e0f-9405-0e04eef8548c" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="1" min="-100" max="100" /></Axises><Plot name="融資(張)" number="1" type="0" color="5275903" color2="5275903" style="0" weight="0" axis="0" DecimalFormat="1" NumFormat="1" checkbox="1" SetDecimalFormat="1" SetNumFormat="1" colors="-1,-1" offset="0" /><Plot name="差額(張)" number="2" type="1" color="255" color2="62464" style="3" weight="0" axis="1" DecimalFormat="1" NumFormat="1" checkbox="1" SetDecimalFormat="1" SetNumFormat="1" colors="-1,-1" offset="0" /><Plot name="買進(張)" number="3" type="0" color="16711935" color2="65280" style="5" weight="0" axis="10" DecimalFormat="1" NumFormat="1" checkbox="0" SetDecimalFormat="1" SetNumFormat="1" colors="-1,-1" offset="0" /><Plot name="賣出(張)" number="4" type="0" color="65280" color2="14680319" style="5" weight="0" axis="10" DecimalFormat="1" NumFormat="1" checkbox="0" SetDecimalFormat="1" SetNumFormat="1" colors="-1,-1" offset="0" /><Plot name="現償(張)" number="5" type="0" color="65535" color2="65535" style="5" weight="0" axis="11" DecimalFormat="1" NumFormat="1" checkbox="0" SetDecimalFormat="1" SetNumFormat="1" colors="-1,-1" offset="0" /><Plot name="使用率" number="6" type="0" color="16776960" color2="16776960" style="5" weight="0" axis="12" DecimalFormat="3" NumFormat="2" checkbox="-1" SetDecimalFormat="1" SetNumFormat="1" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="56" />
<script>
<freq support="8;11" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{&quot;0&quot;:[201,199,195,197,174,45,43,170,171,42]},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="比大盤強的天數趨勢斜率" ID="9eadb7cde1d44ca69f60424a355b1c62" ReturnType="0" ExecType="1" Folder="/技術指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:period(10,"計算天期");

if barfreq <> "D" then raiseruntimeerror("不支援此頻率");

value1=GetField("強弱指標");
value2=countif(value1>1,period);
value3=average(value2,period);
linearreg(value3,period,0,value4,value5,value6,value7);

plot1(value4,"強度斜率");
 
 

]]></Code>
<Arg><![CDATA[<Arg seed="fa69ccf5-9a67-4a60-9c8a-aa19326389e2" version="1"><Param name="計算天期" varname="period" type="1" subtype="0" value="10" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="07924633-7283-4244-aaf6-00e932f18142" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="強度斜率" number="1" type="0" color="5275903" color2="5275903" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,d80cf92ddfcc42e0a6c53ec47edebd49;1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c;1,8c2d025a23c548d3a76fba10c22527b4;1,210d0786cfe340538e34c095bc2ba049</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="9" />
<script>
<freq support="8;11" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{&quot;0&quot;:[178]},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="散戶指標(量)" ID="66a8ca6f3d814c099df17c258731444b" ReturnType="0" ExecType="1" Folder="/籌碼高手/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[condition996 = symbolexchange = "TW" and symboltype = 2;//個股
condition994 = symbol = "TSE.TW" or symbol = "TWSE.FS" or symbol = "OTC.TW";//大盤
condition993 = symbolexchange = "TW" and symboltype = 1;//類股

//原始spec要求支援類股，6.30暫不支援，等DB補資料
//if condition994 =false and condition993 = false and condition996 = false //大盤+類股+個股
if condition994 =false and condition996 = false //大盤+個股
	then raiseruntimeerror("不支援此商品");

if barfreq <> "D" and barfreq <> "AD"
	then raiseruntimeerror("不支援此頻率");

if condition994 then
	value1 =  GetField("累計成交") - (GetField("資券互抵張數") + GetField("現股當沖張數"))
else
	value1 = volume - (GetField("資券互抵張數") + GetField("現股當沖張數"));
value2 = GetField("融資買進張數") + GetField("融券買進張數");
value3 = GetField("融資賣出張數") + GetField("融券賣出張數");
if value1 <> 0 then begin
	value4 = value2 / value1;
	value5 = value3 / value1;
end else begin
	value4 = 0;
	value5 = 0;
end;

plot1(value4 - value5,"買賣差值",checkbox:=1,axis:=2,ScaleLabel:=slpercent,ScaleDecimal:=sd2);//單位：張
plot2(value4,"買進",checkbox:=0,axis:=1,ScaleLabel:=slpercent,ScaleDecimal:=sd2);//單位：張
plot3(value5,"賣出",checkbox:=0,axis:=1,ScaleLabel:=slpercent,ScaleDecimal:=sd2);//單位：張
]]></Code>
<Arg><![CDATA[<Arg seed="ff07e4cf-8dcf-48eb-82d0-a5edb1aff674" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="6e3909af-68d0-48d8-bd95-3eff2f2382d3" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="買賣差值" number="1" type="1" color="255" color2="62464" style="3" weight="0" axis="1" DecimalFormat="3" NumFormat="2" checkbox="1" SetDecimalFormat="1" SetNumFormat="1" colors="-1,-1" offset="0" /><Plot name="買進" number="2" type="0" color="16711935" color2="255" style="0" weight="0" axis="0" DecimalFormat="3" NumFormat="2" checkbox="0" SetDecimalFormat="1" SetNumFormat="1" colors="-1,-1" offset="0" /><Plot name="賣出" number="3" type="0" color="65280" color2="65280" style="0" weight="0" axis="0" DecimalFormat="3" NumFormat="2" checkbox="0" SetDecimalFormat="1" SetNumFormat="1" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="46" />
<script>
<freq support="8;11" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{&quot;0&quot;:[78,91,184,170,172,171,173]},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="法人買進賣出比重指標" ID="fcba4a767a8e422da6a19cfe51cc1b22" ReturnType="0" ExecType="1" Folder="/大盤指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:period(5,"期數");

if barfreq = "Tick" or barfreq = "Min"
	then raiseruntimeerror("不支援此頻率");
	
value1=GetField("法人買進比重");
value2=GetField("法人賣出比重");
value3=value1-value2;
value4=average(value3,period);
plot1(value4,"法人買賣比重差額的移動平均");]]></Code>
<Arg><![CDATA[<Arg seed="20e7c4fa-c8ff-4169-af2c-de529e08e467" version="1"><Param name="期數" varname="period" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="415f1997-e0ac-4fdb-b2ba-5bc51ebe5f78" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="法人買賣比重差額的移動平均" number="1" type="0" color="5275903" color2="5275903" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="12" />
<script>
<freq support="8;11;9;12;10;13" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{&quot;0&quot;:[102,103]},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="當沖" ID="5f9aaaf53a104cd4883c344c74e4e6fc" ReturnType="0" ExecType="1" Folder="/籌碼高手/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input: _input1(1,"計算方式",inputkind:= Dict(["全部",1],["資券互抵",2],["現股當沖",3]),quickedit:=true);//1=全部（預設）、2=資券互抵、3=現股當沖

variable: dtVolume(0);

condition996 = symbolexchange = "TW" and symboltype = 2;//個股
condition994 = symbol = "TSE.TW" or symbol = "TWSE.FS" or symbol = "OTC.TW";//大盤
condition993 = symbolexchange = "TW" and symboltype = 1;//類股

if condition994 =false and condition993 = false and condition996 = false //大盤+類股+個股
	then raiseruntimeerror("不支援此商品");

if barfreq = "Tick" or barfreq = "Min"
	then raiseruntimeerror("不支援此頻率");

switch (_input1)
begin
	case 2:
		dtVolume = GetField("資券互抵張數");

	case 3:
		dtVolume = GetField("現股當沖張數");

	default:
		dtVolume = GetField("資券互抵張數") + GetField("現股當沖張數");
end;

if condition993 and not condition994 then
	begin
		switch (barfreq)
		begin
			case "W","AW":
				value1 = summation(GetField("內盤量","D") + GetField("外盤量","D"),dayofweek(getfielddate("內盤量","D")));
			case "M","AM":
				value1 = summation(GetField("內盤量","D") + GetField("外盤量","D"),ceiling(dayofmonth(getfielddate("內盤量","D"))*5/7));
			case "Q":
				value1 = summation(GetField("內盤量","D") + GetField("外盤量","D"),mod(month(getfielddate("內盤量","D"))+2,3)*22 + ceiling(dayofmonth(getfielddate("內盤量","D"))*5/7));
			case "H":
				value1 = summation(GetField("內盤量","D") + GetField("外盤量","D"),mod(month(getfielddate("內盤量","D"))+5,6)*22 + dayofmonth(getfielddate("內盤量","D"))*5/7);
			case "Y":
				value1 = summation(GetField("內盤量","D") + GetField("外盤量","D"),mod(month(getfielddate("內盤量","D"))+11,12)*22 + dayofmonth(getfielddate("內盤量","D"))*5/7);
			default:
				value1 = GetField("內盤量","D") + GetField("外盤量","D");
		end;
	end
else if condition994 then
	begin
		switch (barfreq)
		begin
			case "W","AW":
				value1 = summation(GetField("累計成交","D"),dayofweek(getfielddate("累計成交","D")));
			case "M","AM":
				value1 = summation(GetField("累計成交","D"),ceiling(dayofmonth(getfielddate("累計成交","D"))*5/7));
			case "Q":
				value1 = summation(GetField("累計成交","D"),mod(month(getfielddate("累計成交","D"))+2,3)*22 + ceiling(dayofmonth(getfielddate("累計成交","D"))*5/7));
			case "H":
				value1 = summation(GetField("累計成交","D"),mod(month(getfielddate("累計成交","D"))+5,6)*22 + ceiling(dayofmonth(getfielddate("累計成交","D"))*5/7));
			case "Y":
				value1 = summation(GetField("累計成交","D"),mod(month(getfielddate("累計成交","D"))+11,12)*22 + ceiling(dayofmonth(getfielddate("累計成交","D"))*5/7));
			default:
				value1 = GetField("累計成交","D");
		end;
	end
else 
	value1 = volume;

if value1 <> 0 then
	value2 = dtVolume/value1
else
	value2 = 0;


if symboltype = 1 then begin
	plot1(dtVolume,"當沖張數",axis:=1,ScaleLabel:=sltypewy,ScaleDecimal:=sdauto);	//單位：張
	plot2(value2,"當沖率",axis:=2,ScaleLabel:=slpercent,ScaleDecimal:=sd2);
	plot3(GetField("資券互抵張數"),"資券互抵(張)",ScaleLabel:=sltypewy,ScaleDecimal:=sdauto);
	plot4(GetField("現股當沖張數"),"現股當沖(張)",ScaleLabel:=sltypewy,ScaleDecimal:=sdauto);
end else begin
	plot1(dtVolume,"當沖張數",axis:=1,ScaleLabel:=slfull,ScaleDecimal:=sd0);	//單位：張
	plot2(value2,"當沖率",axis:=2,ScaleLabel:=slpercent,ScaleDecimal:=sd2);
	plot3(GetField("資券互抵張數"),"資券互抵(張)",ScaleLabel:=slfull,ScaleDecimal:=sd0);
	plot4(GetField("現股當沖張數"),"現股當沖(張)",ScaleLabel:=slfull,ScaleDecimal:=sd0);
end;]]></Code>
<Arg><![CDATA[<Arg seed="6e5140c1-e997-426d-b632-f02750a84edf" version="1"><Param name="計算方式" varname="_input1" type="1" subtype="0" value="1" isSerial="0" isArray="0" isRef="0" inputkind="1" quickedit="1" keytype="3"><Pair key="全部" value="1" /><Pair key="資券互抵" value="2" /><Pair key="現股當沖" value="3" /></Param></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="8e3402e4-b07d-4929-95ee-9e60e97003f6" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="當沖張數" number="1" type="1" color="5275903" color2="5275903" style="0" weight="0" axis="0" DecimalFormat="1" NumFormat="1" checkbox="-1" SetDecimalFormat="1" SetNumFormat="1" colors="-1,-1" offset="0" /><Plot name="當沖率" number="2" type="0" color="255" color2="255" style="0" weight="0" axis="1" DecimalFormat="3" NumFormat="2" checkbox="-1" SetDecimalFormat="1" SetNumFormat="1" colors="-1,-1" offset="0" /><Plot name="資券互抵(張)" number="3" type="0" color="65280" color2="65280" style="5" weight="0" axis="0" DecimalFormat="1" NumFormat="1" checkbox="-1" SetDecimalFormat="1" SetNumFormat="1" colors="-1,-1" offset="0" /><Plot name="現股當沖(張)" number="4" type="0" color="14680319" color2="14680319" style="5" weight="0" axis="0" DecimalFormat="1" NumFormat="1" checkbox="-1" SetDecimalFormat="1" SetNumFormat="1" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="141" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{&quot;0&quot;:[91,184],&quot;8&quot;:[20,21,78]},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="實質買賣盤比指標" ID="75639582699849318f33ff097e0816e6" ReturnType="0" ExecType="1" Folder="/大盤指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:length(5,"期數");

if barfreq = "Tick" or barfreq = "Min"
	then raiseruntimeerror("不支援此頻率");
	
value1=GetField("實質買盤比");
value2=GetField("實質賣盤比");
value3=average(value1,length)-80;
plot1(value3,"實質買賣盤比");
 


]]></Code>
<Arg><![CDATA[<Arg seed="8ab197e0-6cf0-4d7c-bf6e-191ac1c2deda" version="1"><Param name="期數" varname="length" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="e8974f14-7122-4ea9-ace2-9d5663108597" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="實質買賣盤比" number="1" type="0" color="5275903" color2="5275903" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="12" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{&quot;0&quot;:[98,99]},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="外資累計買賣超" ID="e6cb8f36976144479da7f12affcd2a9b" ReturnType="0" ExecType="3" Folder="/籌碼指標/" StatusMask="2">
<Desc><![CDATA[計算一段時間的外資累計買賣超張數以及占成交的比重]]></Desc>
<Code><![CDATA[input: Length(5); setinputname(1,"計算天數");
input:TXT("僅適用日線以上"); setinputname(2,"使用限制");

if barfreq = "Tick" or barfreq = "Min"
	then raiseruntimeerror("不支援此頻率");
	
variable: _buyTotal(0), volTotal(0), _Ratio(0);

_buyTotal = summation(GetField("外資買賣超"), Length);
volTotal = summation(Volume, Length);

if volTotal <> 0 then
	_Ratio = _buyTotal * 100 / volTotal
else
	_Ratio = 0;

Plot1(_buyTotal, "累計買賣超");
Plot2(_Ratio, "比例%");
]]></Code>
<Arg><![CDATA[<Arg seed="8072bed2-017b-49d6-a45f-5b69298656d9" version="1"><Param name="計算天數" varname="Length" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="使用限制" varname="TXT" type="3" subtype="0" value="僅適用日線以上" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="41a35a8a-5ad5-4a4c-96f9-b4b7c206134b" version="1"><Axises><Axis value="1" align="1" min="-100" max="100" /><Axis value="2" align="1" min="-100" max="100" /></Axises><Plot name="累計買賣超" number="1" type="1" color="5275903" color2="0" style="0" weight="0" axis="1" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /><Plot name="比例%" number="2" type="0" color="255" color2="0" style="0" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="30" />
<Maxbb val="20" />
<ScriptComplexity val="8" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{&quot;0&quot;:[29]},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="台灣50上昇趨勢家數" ID="5e80c43ca0744942ad4fe7fbe8cbea50" ReturnType="0" ExecType="1" Folder="/市場動能/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[{統計台灣50成分股, 趨勢向上的家數.
趨勢向上的定義是計算近6根K棒(含當前這一根K棒)的線性回歸線是否向上}

if barfreq <> "Min" then raiseruntimeerror("僅支援「分鐘」頻率");

value1 = GetSymbolField("TSE50.SJ","TW50上昇趨勢家數");

plot1(value1,"台灣50上昇趨勢家數");]]></Code>
<Arg><![CDATA[<Arg seed="0001e346-d351-487e-a383-b06b759cf00e" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="c1f4c24e-683d-4e2f-a08f-00735eb7a478" version="1">
	<Axises>
		<Axis value="1" align="2" min="0.000000" max="50.000000" SetMin="1" SetMax="1" mpvalue="0.000000" />
		<Axis value="2" align="0" min="-100.000000" max="100.000000" SetMin="1" SetMax="1" mpvalue="0.000000" />
	</Axises>
	<Plot name="台灣50上昇趨勢家數" number="1" type="1" color="255" color2="5275903" DecimalFormat="1" checkbox="-1" colors="," offset="0" />

</Plots>]]></Plots>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="6" />
<script>
<freq support="8;11" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{&quot;TSE50.SJ&quot;:{&quot;0&quot;:[880]}}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="Stoller平均波幅通道" ID="cd75962754dc4df593726fe475bfb21c" ReturnType="0" ExecType="3" Folder="/技術指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:
	avlength(5,"均線期數"),
	atrlength(15,"ATR平均期數"),
	k(1.35,"常數");
variable:hband(0),lband(0);

hband=average(close,avlength)+average(truerange,atrlength)*k;
lband=average(close,avlength)-average(truerange,atrlength)*k;

plot1(hband,"通道上限");
plot2(close,"收盤價");
plot3(lband,"通道下限");
]]></Code>
<Arg><![CDATA[<Arg seed="61ac467a-afce-4cfe-b78e-461318a8f17a" version="1"><Param name="均線期數" varname="avlength" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="ATR平均期數" varname="atrlength" type="1" subtype="0" value="15" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="常數" varname="k" type="1" subtype="0" value="1.35" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="a0760a96-4df8-4a5f-b527-7602051aa30d" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="通道上限" number="1" type="0" color="5275903" color2="5275903" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /><Plot name="收盤價" number="2" type="0" color="255" color2="255" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /><Plot name="通道下限" number="3" type="0" color="65280" color2="65280" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c;1,36d1fc033c6f48f8a136f9e1fdec110f;1,81394f9cf0c8469ea5f8832700aec8b7;1,9e03682196e24611b2fe326b6a56433d</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="7" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="內盤成本線" ID="8d65e11622b641b5b89a8633004d6b5e" ReturnType="0" ExecType="3" Folder="/主圖指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[{內盤成本線 = 累計當日賣出金額(元) / 累計當日賣出量*1000, 就是特大+大+中+小, 不分大小單
支援商品：台股}

value91 = GetField("買進特大單金額");//僅提供給有權限的用戶使用

if barfreq <> "Min" and barfreq <> "D" then 
	raiseruntimeerror("僅支援分鐘與日頻率");

value1 = GetField("賣出特大單金額","D") + GetField("賣出大單金額","D") + GetField("賣出中單金額","D") + GetField("賣出小單金額","D");
value2 = GetField("賣出特大單量","D") + GetField("賣出大單量","D") + GetField("賣出中單量","D") + GetField("賣出小單量","D");
if value2 <> 0 then
	value3 = value1 / (value2 * 1000)
else
	value3 = value3[1];
	
plot1(value3,"內盤成本線");]]></Code>
<Arg><![CDATA[<Arg seed="7274501f-3338-4475-96c8-8686bb1e6b63" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="eb757979-fe8d-4188-8103-92bf3888f1c8" version="1">
	<Axises>
		<Axis value="1" align="0" min="-100.000000" max="100.000000" SetMin="1" SetMax="1" mpvalue="0.000000" />
		<Axis value="2" align="0" min="-100.000000" max="100.000000" SetMin="1" SetMax="1" mpvalue="0.000000" />
	</Axises>
	<Plot name="內盤成本線" number="1" color="65280" color2="5275903" weight="2" checkbox="-1" colors="," offset="0" />

</Plots>]]></Plots>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="46" />
<script>
<freq support="8;11" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{&quot;0&quot;:[332],&quot;8&quot;:[335,341,347,353,334,340,346,352]},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="投信持股比例" ID="2e12dfbe4e794ace8dbeac7bf486f265" ReturnType="0" ExecType="1" Folder="/籌碼高手/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[condition999 = symbolexchange = "TW" or symbolexchange = "TE";//台股+興櫃
condition998 = condition999 = true and symboltype = 2;//個股+興櫃

if condition998 = false //個股+興櫃
	then raiseruntimeerror("不支援此商品");



if barfreq = "Tick" or barfreq = "Min"
	then raiseruntimeerror("不支援此頻率");

plot1(0.01*GetField("投信持股比例"),"投信持股比例",axis:=1,ScaleLabel:=slpercent,ScaleDecimal:=sd2);]]></Code>
<Arg><![CDATA[<Arg seed="de8b9cab-cce8-43a1-8379-636b15c72d09" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="22d8a68a-ce58-4f36-a578-a46c8f461c3d" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="投信持股比例" number="1" type="0" color="5275903" color2="5275903" style="0" weight="0" axis="0" DecimalFormat="3" NumFormat="2" checkbox="-1" SetDecimalFormat="1" SetNumFormat="1" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="6" />
<script>
<freq support="8;9;10;11;12;13;14;15" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{&quot;0&quot;:[35]},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="DMI (趨向指標)" ID="c9a294ef73c640eba3e1eed6ae5f8575" ReturnType="0" ExecType="3" Folder="/XQ技術指標/" StatusMask="2">
<Desc><![CDATA[畫出趨向指標]]></Desc>
<Code><![CDATA[// XQ: DMI指標
//
input: Length(14);
variable: pdi_value(0), ndi_value(0), adx_value(0);

SetInputName(1, "天數");

DirectionMovement(Length, pdi_value, ndi_value, adx_value);

// 初始區波動較大, 先不繪出
//
if CurrentBar < Length then
 begin
	pdi_value = 0;
	ndi_value = 0;
	adx_value = 0;
 end;
 
Plot1(pdi_value, "+DI");
Plot2(ndi_value, "-DI");
Plot3(adx_value, "ADX");


		]]></Code>
<Arg><![CDATA[<Arg seed="75d3a622-b449-4c50-9220-e7366e752941" version="1"><Param name="天數" varname="Length" type="1" subtype="0" value="14" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="690fc30e-0267-40e1-be38-496236dd4bb0" version="1"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="+DI" number="1" type="0" color="5275903" color2="0" style="0" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /><Plot name="-DI" number="2" type="0" color="255" color2="0" style="0" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /><Plot name="ADX" number="3" type="0" color="65280" color2="0" style="0" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,7721dca8cc7242c09d21b782bbb59bd9</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="20" />
<ScriptComplexity val="2" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="分時大戶買賣力(金額)" ID="3b4d95d2906f488f962f2a9cb8dca88c" ReturnType="0" ExecType="1" Folder="/即時籌碼/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[{指標數值定義："大戶單=特大單+大單資料為分鐘統計金額"
支援商品：台(股票)}

if barfreq <> "Min" and barfreq <> "D" and barfreq <> "AD" then 
	raiseruntimeerror("僅支援分鐘與日頻率（含還原）");
	
value91 = GetField("賣出特大單金額");//僅提供給有權限的用戶使用

value1 = GetField("賣出特大單金額") + GetField("賣出大單金額");
value2 = GetField("買進特大單金額") + GetField("買進大單金額");
value3 = value2 - value1;
plot1(value3,"大戶買賣力(金額)");
plot2(value2,"大戶外盤量(金額)",checkbox:=0);
plot3(value1,"大戶內盤量(金額)",checkbox:=0);]]></Code>
<Arg><![CDATA[<Arg seed="92d33d29-eb47-4455-9657-d57612ea8a84" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="ab838022-f689-470d-8af6-547b482f44ec" version="1">
	<Axises>
		<Axis value="1" align="0" min="-100.000000" max="100.000000" SetMin="1" SetMax="1" mpvalue="0.000000" />
		<Axis value="2" align="1" min="-100.000000" max="100.000000" SetMin="1" SetMax="1" mpvalue="0.000000" />
	</Axises>
	<Plot name="大戶買賣力(金額)" number="1" type="1" style="3" color="255" color2="65280" axis="1" checkbox="-1" colors="," offset="0" />

	<Plot name="大戶外盤量(金額)" number="2" style="5" color="16711935" color2="255" checkbox="0" colors="," offset="0" />

	<Plot name="大戶內盤量(金額)" number="3" style="5" color="15446382" color2="65280" checkbox="0" colors="," offset="0" />

</Plots>]]></Plots>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="26" />
<script>
<freq support="8;11" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{&quot;0&quot;:[335,341,332,338]},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="選擇權理論價" ID="b55560a44d8649bda2b4790cca069ceb" ReturnType="0" ExecType="1" Folder="/期權指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input: 
	iRate100(2,"無風險利率%"),
	iHV(20,"標的歷史波動率計算期間");

variable:vStrikePrice(0),vVolity100(0),vTTMdays(0);

if symboltype <> 5 then 
	raiseruntimeerror("僅支援選擇權");

if iHV > 0 then 
	vVolity100 = HVolatility(getsymbolfield("Underlying","收盤價","D"),iHV)
else 
	vVolity100 = 20;

vStrikePrice = getsymbolinfo("履約價");
vTTMdays = DateDiff(GetSymbolInfo("到期日"), Date) + 1;

value1 = bsprice(leftstr(getsymbolinfo("買賣權"),1),getsymbolfield("Underlying","收盤價"),vStrikePrice,vTTMdays,iRate100,0,vVolity100);

plot1(value1,"理論價");
]]></Code>
<Arg><![CDATA[<Arg seed="7902a1a9-9517-4dd8-8268-eb9a36cf1b8a" version="1"><Param name="無風險利率%" varname="iRate100" type="1" subtype="0" value="2" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="標的歷史波動率計算期間" varname="iHV" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="a56f6b7f-a209-411e-8185-ae2e6b031f89" version="0"><Axises><Axis value="1" align="3" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="理論價" number="1" type="0" color="5275903" color2="5275903" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="," offset="0" /></Plots>]]></Plots>
<RefFunc>1,8c2d025a23c548d3a76fba10c22527b4;1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c;1,9c4f476d319b4f109a8dc8557099ded4;1,c1cda70a714d44999e5171fc53c95b0a;1,52ede3e3fd6241998947a34920400c95;1,9726eaec317b4b98a68524683ea2ae92;1,8462f7081ead4113ba3aef780bc1040f;1,6f695b87f1f047f5b162d222df2e7edf</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="13" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{&quot;UNDERLYING&quot;:{&quot;0&quot;:[8]}}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="台指選倉P／C" ID="30c4a49e5ee64369969e1ca38b24dc4d" ReturnType="0" ExecType="1" Folder="/大盤指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[value1=getsymbolfield("txo00.tf","買賣權未平倉量比率");
plot1(value1,"台指選倉P／C");]]></Code>
<Arg><![CDATA[<Arg seed="c7423202-fd9f-49e5-a129-5de08c82b70e" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="7d0a303b-6c81-4f82-8458-133d8cb37c45" version="1"><Plot name="台指選倉P／C" number="1" type="0" color="5275903" color2="5275903" style="0" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="20" />
<ScriptComplexity val="6" />
<script>
<freq support="8;11;9;12;10;13" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{&quot;TXO00.TF&quot;:{&quot;0&quot;:[159]}}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="N日來漲幅較大天數" ID="f5373100bbaa447bafb39f8638b4053f" ReturnType="0" ExecType="1" Folder="/技術指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[{
指標說明
收錄於「三週學會程式交易：打造你的第一筆自動化交易」 327頁
https://www.ipci.com.tw/books_in.php?book_id=724
}

input:ratio(2,"列入計算之漲幅下限");
input:period(20,"計算區間");
input:period1(10,"移動平均天數");

if close[1]<>0 then
	value1=(close-close[1])/close[1]*100;
value2=countif(value1>=ratio,period);

plot1(value2,"漲幅大的天數");
plot2(average(value2,period1),"移動平均");]]></Code>
<Arg><![CDATA[<Arg seed="25072850-0c5a-4fda-83b1-d97d3908d6d4" version="1"><Param name="列入計算之漲幅下限" varname="ratio" type="1" subtype="0" value="2" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="計算區間" varname="period" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="移動平均天數" varname="period1" type="1" subtype="0" value="10" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="3a81966e-4d92-466e-b690-c3b9a0ef4f84" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="漲幅大的天數" number="1" type="1" color="5275903" color2="5275903" style="0" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /><Plot name="移動平均" number="2" type="0" color="255" color2="255" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,d80cf92ddfcc42e0a6c53ec47edebd49;1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="3" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="ADTM動態買賣氣指標" ID="e06fa82c48fe4213936cb153d22ca3a6" ReturnType="0" ExecType="3" Folder="/技術指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input: length(23);		setinputname(1, "天期");
input: period(8);		setinputname(2, "平均");

variable:DTM(0),DBM(0),STM(0),SBM(0),ADTM(0),ADTMMA(0);

if open > open[1] then 
	DTM = maxlist(high-open,open-open[1])
else
	DTM = 0;
   
if open < open[1] then 
	DBM = open-low
else 
    DBM = 0;

STM = Summation(DTM,length);
SBM = Summation(DBM,length);

if STM > SBM then 
	ADTM = (STM-SBM)/STM
else
  if STM < SBM then 
	ADTM = (STM-SBM)/SBM
  else 
    ADTM = 0;

ADTMMA = average(ADTM,period);

plot1(ADTM, "ADTM");
plot2(ADTMMA, "ADTM移動平均");
]]></Code>
<Arg><![CDATA[<Arg seed="57040fb4-1705-4874-a08a-7d22d9f0198c" version="1"><Param name="天期" varname="length" type="1" subtype="0" value="23" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="平均" varname="period" type="1" subtype="0" value="8" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="afb9c337-287e-440d-b34c-06c6a96ae619" version="1"><Plot name="ADTM" number="1" type="0" color="5275903" color2="0" style="0" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /><Plot name="ADTM移動平均" number="2" type="0" color="255" color2="0" style="0" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="50" />
<Maxbb val="25" />
<ScriptComplexity val="4" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="法人" ID="752b618f046c4365b1ad96e4c96a4fdc" ReturnType="0" ExecType="1" Folder="/籌碼高手/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[condition999 = symbolexchange = "TW" or symbolexchange = "TE";//台股+興櫃
condition994 = symbol = "TSE.TW" or symbol = "TWSE.FS" or symbol = "OTC.TW";//大盤
condition997 = condition999 and (symboltype = 2 or symboltype = 4);//個股+權證+興櫃

if condition999 = false and condition994 = false//大盤, 個股, 權證, 興櫃, 類股指數
	then raiseruntimeerror("不支援此商品");

if barfreq = "Tick" or barfreq = "Min"
	then raiseruntimeerror("不支援此頻率");

if condition994 then begin
	value1 = GetField("法人買進金額");
	value2 = GetField("法人賣出金額");
	value3 = GetField("法人買賣超金額");
	value4 = value4 + GetField("法人買賣超金額");
	plot2(value4,"法人累計買賣超",checkbox:=1,axis:=1,ScaleLabel:=sltypewy,ScaleDecimal:=sdauto); //line，axis1
	setplotlabel(1,"買賣超(元)");
	setplotlabel(2,"法人累計買賣超(元)");
	setplotlabel(3,"買進(元)");
	setplotlabel(4,"賣出(元)");
	plot1(value3,"買賣超",checkbox:=1,axis:=2,ScaleLabel:=sltypewy,ScaleDecimal:=sdauto); //bar，axis2
	plot3(value1,"買進",checkbox:=0,axis:=11,ScaleLabel:=sltypewy,ScaleDecimal:=sdauto); //line，axis2
	plot4(value2,"賣出",checkbox:=0,axis:=11,ScaleLabel:=sltypewy,ScaleDecimal:=sdauto); //line，axis2
end else begin
	if symbolexchange <> "TE" and symboltype <> 1 then begin
		value1 = GetField("法人買張");
		value2 = GetField("法人賣張");
	end;
	value3 = GetField("法人買賣超張數");
	plot2(GetField("法人持股"),"法人持股",checkbox:=1,axis:=1,ScaleLabel:=slfull,ScaleDecimal:=sd0); //line，axis1
	setplotlabel(1,"買賣超(張)");
	setplotlabel(2,"法人持股(張)");
	setplotlabel(3,"買進(張)");
	setplotlabel(4,"賣出(張)");
	if symboltype <> 1 then 
		value5 = 0.01*GetField("法人持股比例");
	plot5(value5,"法人持股比例",axis:=12,ScaleLabel:=slpercent,ScaleDecimal:=sd2);
	plot1(value3,"買賣超",checkbox:=1,axis:=2,ScaleLabel:=slfull,ScaleDecimal:=sd0); //bar，axis2
	if symbolexchange <> "TE" and symboltype <> 1 then begin
		plot3(value1,"買進",checkbox:=0,axis:=11,ScaleLabel:=slfull,ScaleDecimal:=sd0); //line，axis2
		plot4(value2,"賣出",checkbox:=0,axis:=11,ScaleLabel:=slfull,ScaleDecimal:=sd0); //line，axis2
	end;
end;


]]></Code>
<Arg><![CDATA[<Arg seed="625a5d8d-92a7-4376-bcf9-fb25166aec83" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="edff2ff7-e608-4a68-b69a-1dbef53cd85a" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="1" min="-100" max="100" /></Axises><Plot name="買賣超" number="1" type="1" color="255" color2="62464" style="3" weight="0" axis="1" DecimalFormat="1" NumFormat="1" checkbox="1" SetDecimalFormat="1" SetNumFormat="1" colors="-1,-1" offset="0" /><Plot name="法人持股" number="2" type="0" color="39423" color2="62464" style="0" weight="0" axis="0" DecimalFormat="1" NumFormat="1" checkbox="1" SetDecimalFormat="1" SetNumFormat="1" colors="-1,-1" offset="0" /><Plot name="買進" number="3" type="0" color="16711935" color2="65280" style="5" weight="0" axis="10" DecimalFormat="1" NumFormat="1" checkbox="0" SetDecimalFormat="1" SetNumFormat="1" colors="-1,-1" offset="0" /><Plot name="賣出" number="4" type="0" color="65280" color2="14680319" style="5" weight="0" axis="10" DecimalFormat="1" NumFormat="1" checkbox="0" SetDecimalFormat="1" SetNumFormat="1" colors="-1,-1" offset="0" /><Plot name="法人持股比例" number="5" type="0" color="65535" color2="65535" style="5" weight="0" axis="11" DecimalFormat="3" NumFormat="2" checkbox="-1" SetDecimalFormat="1" SetNumFormat="1" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="46" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{&quot;0&quot;:[167,168,92,48,49,50,51,182]},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="實戶買賣盤" ID="3599a1ef88d44bd1883841455142d45c" ReturnType="0" ExecType="1" Folder="/籌碼高手/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[condition999 = symbolexchange = "TW" or symbolexchange = "TE";//台股+興櫃
condition998 = condition999 = true and symboltype = 2;//個股+興櫃

if condition998 = false //個股+興櫃
	then raiseruntimeerror("不支援此商品");

if barfreq = "Tick" or barfreq = "Min"
	then raiseruntimeerror("不支援此頻率");

value1 = GetField("實戶買賣超張數")+value1;
plot1(value1,"累計買賣超(張)",checkbox:=1,axis:=1,ScaleLabel:=slfull,ScaleDecimal:=sd0);//單位:張
plot2(GetField("實戶買賣超張數"),"實戶買賣超(張)",checkbox:=1,axis:=2,ScaleLabel:=slfull,ScaleDecimal:=sd0);//單位:張]]></Code>
<Arg><![CDATA[<Arg seed="edd77edf-5f64-4d02-a0b5-d373f0a22ff2" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="63be8279-b7e0-4a5b-b987-6131b37c7762" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="1" min="-100" max="100" /></Axises><Plot name="累計買賣超(張)" number="1" type="0" color="5275903" color2="5275903" style="0" weight="0" axis="0" DecimalFormat="1" NumFormat="1" checkbox="1" SetDecimalFormat="1" SetNumFormat="1" colors="-1,-1" offset="0" /><Plot name="實戶買賣超(張)" number="2" type="1" color="255" color2="62464" style="3" weight="0" axis="1" DecimalFormat="1" NumFormat="1" checkbox="1" SetDecimalFormat="1" SetNumFormat="1" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="11" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{&quot;0&quot;:[61]},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="唐奇安通道" ID="e27cdafa02a84df4b529a3f139faec41" ReturnType="0" ExecType="3" Folder="/主圖指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[{
指標說明
https://xstrader.net/唐奇安通道/
}

input:Period(13,"天數");

value1 = Highest(H, period);
value2 = Lowest(L, period);

plot1(value1[1],"通道上緣");
plot2((value1+value2)/2,"通道中線");
plot3(value2[1],"通道下緣" );
]]></Code>
<Arg><![CDATA[<Arg seed="58a05e3d-d232-4d93-a61a-80c2180f6f07" version="1"><Param name="天數" varname="Period" type="1" subtype="0" value="13" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="916090bd-e27b-4f64-9f4a-6a2bce1a6b37" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="通道上緣" number="1" type="0" color="5275903" color2="5275903" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /><Plot name="通道中線" number="2" type="0" color="255" color2="255" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /><Plot name="通道下緣" number="3" type="0" color="65280" color2="65280" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,61c06064ad98469db9ce30287ae4a2c8;1,2bca774c6b7549c1b0b008d2a54b288e;1,f1b429ac13b2447c909302198c18ca56</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="3" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="地緣券商買賣超" ID="12e612ce6ea6432c9f2375ae870fbd9f" ReturnType="0" ExecType="1" Folder="/籌碼高手/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[condition999 = symbolexchange = "TW";//台股

if condition999 = false //個股
	then raiseruntimeerror("不支援此商品");

if barfreq <> "D" and barfreq <> "AD"
	then raiseruntimeerror("不支援此頻率");

value1 = GetField("地緣券商買賣超張數");
value2 += value1;
plot1(value1,"買賣超",checkbox:=1,axis:=2,ScaleLabel:=sltypewy,ScaleDecimal:=sd0); //bar，axis2
plot2(value2,"地緣券商累計買賣超",checkbox:=1,axis:=1,ScaleLabel:=sltypewy,ScaleDecimal:=sd0); //line，axis1

]]></Code>
<Arg><![CDATA[<Arg seed="35d8e971-1b77-41de-aa59-73b22f942c89" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="8e7eddbf-a83b-4ac2-ba44-e0ce5a8238bc" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="買賣超" number="1" type="1" color="255" color2="65280" style="3" weight="0" axis="1" DecimalFormat="1" NumFormat="3" checkbox="1" SetDecimalFormat="1" SetNumFormat="1" colors="," offset="0" /><Plot name="地緣券商累計買賣超" number="2" type="0" color="65535" color2="255" style="0" weight="0" axis="0" DecimalFormat="1" NumFormat="3" checkbox="1" SetDecimalFormat="1" SetNumFormat="1" colors="," offset="0" /></Plots>]]></Plots>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="6" />
<script>
<freq support="8;11" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{&quot;0&quot;:[270]},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="週DMI-Osc" ID="d81ae297f5c44ee0b2afc7c27245d21d" ReturnType="0" ExecType="3" Folder="/跨頻率指標/" StatusMask="2">
<Desc><![CDATA[畫出週趨向擺盪線]]></Desc>
<Code><![CDATA[// 跨頻率週DMI-Osc指標
// 不支援大頻率跨小頻率，例如：
// 不支援主頻率週資料，跨頻率計算日DMI-Osc技術指標。
//
if barfreq <> "Tick" and barfreq <> "Min" and barfreq <> "D" and barfreq <> "W" and barfreq <> "AD" and barfreq <> "AW" then raiseruntimeerror("不支援大頻率跨小頻率");

input: Length( 14 );
variable: pdi_value(0), ndi_value(0), adx_value(0);

SetInputName(1, "天數");

xf_DirectionMovement("W", Length, pdi_value, ndi_value, adx_value);

// 初始區波動較大, 先不繪出
//
if CurrentBar < Length then
 begin
	pdi_value = 0;
	ndi_value = 0;
	adx_value = 0;
 end;

Plot1(pdi_value - ndi_value, "週DMI-Osc");

		]]></Code>
<Arg><![CDATA[<Arg seed="2dfaec85-f4f8-489f-923b-86d41489959a" version="1"><Param name="天數" varname="Length" type="1" subtype="0" value="14" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="cbd571ce-7e19-480f-9087-dac66a3526b8"><Plot name="週DMI-Osc" number="1" type="0" color="5275903" color2="0" style="0" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,57f222578a2c4d17b2b88b65b8f28696;1,d6c8ec6b762c4f47b2ad9bfd806fea5f;1,a46fc11bfc3a4c45abfb6011b2be5b5a</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="20" />
<ScriptComplexity val="2" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="台灣50均線多方家數" ID="a463112c1d734ff2aeb014f9af8a2c43" ReturnType="0" ExecType="1" Folder="/市場動能/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[{統計台灣50成分股內, 目前股價大於10期簡單移動均線之上的家數。}

if barfreq <> "Min" then raiseruntimeerror("僅支援「分鐘」頻率");

value1 = GetSymbolField("TSE50.SJ","TW50均線多空家數");

plot1(value1,"台灣50均線多方家數");]]></Code>
<Arg><![CDATA[<Arg seed="529b04f4-d70c-413b-8284-f9b9b5be82e9" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="9a87d59d-d6a0-4f28-bb56-f5d559392d94" version="1">
	<Axises>
		<Axis value="1" align="2" min="0.000000" max="50.000000" SetMin="1" SetMax="1" mpvalue="0.000000" />
		<Axis value="2" align="0" min="-100.000000" max="100.000000" SetMin="1" SetMax="1" mpvalue="0.000000" />
	</Axises>
	<Plot name="台灣50均線多方家數" number="1" type="1" color="255" color2="5275903" DecimalFormat="1" checkbox="-1" colors="," offset="0" />

</Plots>]]></Plots>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="6" />
<script>
<freq support="8;11" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{&quot;TSE50.SJ&quot;:{&quot;0&quot;:[886]}}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="變異數指標" ID="543df8c82ab142898f89b3881de8eaea" ReturnType="0" ExecType="1" Folder="/技術指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:length1(10,"短天期期別");
input:length2(20,"長天期期別");

value1=varianceps(close,length1,1);
value2=varianceps(close,length2,1);

plot1(value1,"短天期變異數");
plot2(value2,"長天期變異數");
]]></Code>
<Arg><![CDATA[<Arg seed="c1adb824-8ca5-492d-a7dc-f78ae4c856cb" version="1"><Param name="短天期期別" varname="length1" type="1" subtype="0" value="10" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="長天期期別" varname="length2" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="436110b9-fd56-4cca-a17e-5aa23588a4b8" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="短天期變異數" number="1" type="0" color="5275903" color2="5275903" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /><Plot name="長天期變異數" number="2" type="0" color="65535" color2="255" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,8c2d025a23c548d3a76fba10c22527b4;1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c;1,9c4f476d319b4f109a8dc8557099ded4</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="3" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="個股儀表板" ID="4f528e3cf02345348e233fa7d698e97a" ReturnType="0" ExecType="3" Folder="/主圖指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[{
指標說明
https://xstrader.net/個股儀表板演化的交易策略/
收錄於「三週學會程式交易：打造你的第一筆自動化交易」 330頁
https://www.ipci.com.tw/books_in.php?book_id=724
}

if barfreq <> "D" then raiseruntimeerror("不支援此頻率");

condition1=false;
condition2=false;
condition3=false;
condition4=false;
condition5=false;
condition6=false;
condition7=false;
condition8=false;
condition9=false;
condition10=false;

switch(close)
begin
	case >150: value5=low*0.9;
	case <50 : value5=low*0.98;
	default: value5=low*0.95;
end;

//==========日KD黃金交叉================
input: _TEXT1("===============","KD參數");
input: Length_D(9,"日KD期間");

variable:rsv_d(0),kk_d(0),dd_d(0),c5(0);

stochastic(Length_D, 3, 3, rsv_d, kk_d, dd_d);
c5=barslast(kk_d crosses over dd_d);
if c5=0 and c5[1]>20 then 
	condition1=true;
if condition1 then
	plot1(value5,"月KD高檔鈍化且日KD黃金交叉");

//============內外盤量比差====================
variable:c3(0);
value6=GetField("內盤量");//單位:元
value7=GetField("外盤量");//單位:元
if volume<>0 then begin
	value8=value7/volume*100;//外盤量比
	value9=value6/volume*100;//內盤量比
end;
value10=average(value8,5);
value11=average(value9,5);
value7=value10-value11+5;
c3=barslast(value7 crosses over 0);
if c3=0 and c3[1]>20 then
	condition2=true;
if condition2 then
	plot2(value5*0.99,"內外盤量比差");

//===========淨力指標==============
input: _TEXT2("===============","淨力指標參數");
input:period2(10,"長期參數");

variable:c4(0);

value12=summation(high-close,period2);//上檔賣壓
value13=summation(close-open,period2); //多空實績
value14=summation(close-low,period2);//下檔支撐
value15=summation(open-close[1],period2);//隔夜力道
if close<>0 then
	value16=(value13+value14+value15-value12)/close*100;
c4=barslast(value16 crosses over -4);
if c4=0 and c4[1]>20 then
	condition3=true;
if condition3 then
	plot3(value5*0.98,"淨力指標");

//===========多頭起漲前的籌碼收集================
variable:c2(0);
value1=GetField("分公司買進家數");
value2=GetField("分公司賣出家數");
value3=value2-value1;
value4=countif(value3>20,10);
c2=barslast(value4>6);
if c2=0 and c2[1]>20 then
	condition4=true;
if condition4=true then
	plot4(value5*0.97,"籌碼收集");

//===========法人同步買超====================
variable: v1(0),v2(0),v3(0),c1(0);
v1=GetField("外資買賣超");
v2=GetField("投信買賣超");
v3=GetField("自營商買賣超");
c1= barslast(maxlist2(v1,v2,v3)>100);
if c1=0 and c1[1]>20 then
	condition5=true;
if condition5=true then
	plot5(value5*0.96,"法人同步買超");

//========DIF-MACD 翻正=============
input: _TEXT3("===============","MACD參數");
input: FastLength(12,"DIF短天數"), SlowLength(26, "DIF長天數"), MACDLength(9, "MACD天數");
variable: difValue(0), macdValue(0), oscValue(0);
MACD(weightedclose(), FastLength, SlowLength,MACDLength, difValue, macdValue, oscValue);
variable:c6(0);
c6=barslast(oscValue Crosses Above 0);
if c6=0 and c6[1]>20 then
	condition6=true;
if condition6 then
	plot6(value5*0.95,"DIF-MACD 翻正");

//========資金流向======================
variable: m1(0),ma1(0),c7(0);
m1=GetField("資金流向");
ma1=average(m1,20)*1.5;
c7=barslast(m1 crosses over ma1 and close>close[1]);
if c7=0 and c7[1]>20 then
	condition7=true;
if condition7 then
	plot7(value5*0.94,"資金流向");
	
//=========總成交次數================
variable: t1(0),mat1(0),c8(0);
t1=GetField("總成交次數","D");
mat1=average(t1,20)*1.5;
c8=barslast(t1 crosses over mat1 and close>close[1]);
if c8=0 and c8[1]>20 then
	condition8=true;
if condition8 then 
	plot8(value5*0.93,"成交次數");
	
//=========強弱指標==================
variable:s1(0),c9(0);
s1=GetField("強弱指標","D");
c9=barslast(trueall(s1>0,3));
if c9=0 and c9[1]>20 then
	condition9=true;
if condition9 then
	plot9(value5*0.92,"強弱指標");
	
//============開盤委買================
variable:b1(0),mab1(0),c10(0);
b1=GetField("主力買張");
mab1=average(b1,10);
c10=barslast(b1 crosses over mab1);
if c10=0 and c10[1]>10 then
	condition10=true;
if condition10 then 
	plot10(value5*0.91,"主力買張");]]></Code>
<Arg><![CDATA[<Arg seed="b69718f5-4871-4880-9413-34a20a3a9491" version="1"><Param name="KD參數" varname="_TEXT1" type="3" subtype="0" value="===============" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="日KD期間" varname="Length_D" type="1" subtype="0" value="9" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="淨力指標參數" varname="_TEXT2" type="3" subtype="0" value="===============" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="長期參數" varname="period2" type="1" subtype="0" value="10" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="MACD參數" varname="_TEXT3" type="3" subtype="0" value="===============" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="DIF短天數" varname="FastLength" type="1" subtype="0" value="12" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="DIF長天數" varname="SlowLength" type="1" subtype="0" value="26" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="MACD天數" varname="MACDLength" type="1" subtype="0" value="9" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="ba93748d-69e3-439e-8ebf-676be53e68d9" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="月KD高檔鈍化且日KD黃金交叉" number="1" type="2" color="5275903" color2="5275903" style="2" weight="1" axis="10002" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /><Plot name="內外盤量比差" number="2" type="2" color="255" color2="255" style="2" weight="1" axis="10002" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /><Plot name="淨力指標" number="3" type="2" color="65280" color2="65280" style="2" weight="1" axis="10002" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /><Plot name="籌碼收集" number="4" type="2" color="14680319" color2="14680319" style="2" weight="1" axis="10002" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /><Plot name="法人同步買超" number="5" type="2" color="65535" color2="65535" style="2" weight="1" axis="10002" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /><Plot name="DIF-MACD 翻正" number="6" type="2" color="16776960" color2="16776960" style="2" weight="1" axis="10002" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /><Plot name="資金流向" number="7" type="2" color="32896" color2="32896" style="2" weight="1" axis="10002" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /><Plot name="成交次數" number="8" type="2" color="3211184" color2="3211184" style="2" weight="1" axis="10002" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /><Plot name="強弱指標" number="9" type="2" color="8392896" color2="8392896" style="2" weight="1" axis="10002" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /><Plot name="主力買張" number="10" type="2" color="14706752" color2="14706752" style="2" weight="1" axis="10002" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,61c06064ad98469db9ce30287ae4a2c8;1,2bca774c6b7549c1b0b008d2a54b288e;1,f1b429ac13b2447c909302198c18ca56;1,847bcd706dda4a9caf2b783e181a8e42;1,6850ead727a842bf883a1501d030ba98;1,80fa4d5b31cc46ff93f8c9a1551b0529;1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c;1,d80cf92ddfcc42e0a6c53ec47edebd49;1,2549534038c6445884c25787277c86db;1,d02c45cba76f4163a048685f7bc4002b;1,8216021f4b11489b8faca5f2af7d0750;1,93ec7a47222349e7ba8a2257d29196e4</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="87" />
<script>
<freq support="8;11" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{&quot;0&quot;:[20,21,176,177,29,36,41,75,52],&quot;8&quot;:[183,178]},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="週KD" ID="b737c85bcc594351bead8f7febf2befc" ReturnType="0" ExecType="3" Folder="/跨頻率指標/" StatusMask="2">
<Desc><![CDATA[畫出週KD指標]]></Desc>
<Code><![CDATA[// 跨頻率週KD指標
// 不支援大頻率跨小頻率，例如：
// 不支援主頻率週資料，跨頻率計算日KD技術指標。
//
if barfreq <> "Tick" and barfreq <> "Min" and barfreq <> "D" and barfreq <> "W" and barfreq <> "AD" and barfreq <> "AW" then raiseruntimeerror("不支援大頻率跨小頻率");

input: Length(5), RSVt(3), Kt(3);
variable: rsv(0), k(0), _d(0);

SetInputName(1, "天數");
SetInputName(2, "RSVt權數");
SetInputName(3, "Kt權數");

xf_stochastic("W", Length, RSVt, Kt, rsv, k, _d);

Plot1(k, "週K(%)");
Plot2(_d, "週D(%)");
]]></Code>
<Arg><![CDATA[<Arg seed="2056e486-5826-4911-8762-2fb2ab80511a" version="1"><Param name="天數" varname="Length" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="RSVt權數" varname="RSVt" type="1" subtype="0" value="3" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="Kt權數" varname="Kt" type="1" subtype="0" value="3" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="a5626e69-ff2a-4b06-a039-ee4b025f0830" version="0"><Axises><Axis value="1" align="2" min="0" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="週K(%)" number="1" type="0" color="5275903" color2="0" style="0" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /><Plot name="週D(%)" number="2" type="0" color="255" color2="0" style="0" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,57f222578a2c4d17b2b88b65b8f28696;1,61c06064ad98469db9ce30287ae4a2c8;1,2bca774c6b7549c1b0b008d2a54b288e;1,f1b429ac13b2447c909302198c18ca56;1,bdf6d4140e2c4954b316120de89f2d59</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="2" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="台灣50創新低家數" ID="f6a85ca8e7c74e609013194bce598f9c" ReturnType="0" ExecType="1" Folder="/市場動能/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[{統計台灣50成分股, 最低價創近20期新低的家數。}

if barfreq <> "Min" then raiseruntimeerror("僅支援「分鐘」頻率");

value1 = GetSymbolField("TSE50.SJ","TW50創新低家數");

plot1(value1,"台灣50創新低家數");]]></Code>
<Arg><![CDATA[<Arg seed="190528e6-c530-40de-b1db-c06750a0775e" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="ba0c1751-175f-4f1c-8221-eaa6049d90fd" version="1">
	<Axises>
		<Axis value="1" align="2" min="0.000000" max="50.000000" SetMin="1" SetMax="1" mpvalue="0.000000" />
		<Axis value="2" align="0" min="-100.000000" max="100.000000" SetMin="1" SetMax="1" mpvalue="0.000000" />
	</Axises>
	<Plot name="台灣50創新低家數" number="1" type="1" color="65280" color2="5275903" DecimalFormat="1" checkbox="-1" colors="," offset="0" />

</Plots>]]></Plots>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="6" />
<script>
<freq support="8;11" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{&quot;TSE50.SJ&quot;:{&quot;0&quot;:[883]}}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="平均波幅通道" ID="8cb5ce7a83ad4416abe1a65741371ef2" ReturnType="0" ExecType="3" Folder="/主圖指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input : length(5);			setinputname(1, "天期");
input : atrlength(15);		setinputname(2, "ATR天期");
input : k(1.35);			setinputname(3, "通道常數");
  
variable : hband(0),lband(0);  
       
hband = average(close,length)+average(truerange,atrlength)*k;  
lband = average(close,length)-average(truerange,atrlength)*k;  
       
plot1(hband, "通道上限");  
plot2(lband, "通道下限");   

]]></Code>
<Arg><![CDATA[<Arg seed="d6c96e58-eb3e-4dba-9a64-c08024d2aa5c" version="1"><Param name="天期" varname="length" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="ATR天期" varname="atrlength" type="1" subtype="0" value="15" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="通道常數" varname="k" type="1" subtype="0" value="1.35" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="70633a11-73f1-4a6d-9d7d-0f7f6e75dce7" version="1"><Axises><Axis value="1" align="3" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="通道上限" number="1" type="0" color="13311" color2="0" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /><Plot name="通道下限" number="2" type="0" color="65280" color2="0" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c;1,36d1fc033c6f48f8a136f9e1fdec110f;1,81394f9cf0c8469ea5f8832700aec8b7;1,9e03682196e24611b2fe326b6a56433d</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="50" />
<Maxbb val="20" />
<ScriptComplexity val="7" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="當日成交總筆數" ID="c9ef029cd09b423ebb7b149b4ce85b39" ReturnType="0" ExecType="1" Folder="/量能指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:p1(5,"短天期");
input:p2(20,"長天期");

value1=GetField("總成交次數");
value2=average(value1,p1);
value3=average(value2,p2);

plot1(value2,"成交筆數短期均線");
plot2(value3,"成交筆數長期均線");







]]></Code>
<Arg><![CDATA[<Arg seed="1e6a3533-1f65-41ce-9e63-341010ccbf60" version="1"><Param name="短天期" varname="p1" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="長天期" varname="p2" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="51cd4ecb-370b-4a9b-b4b4-0520c8fd84af" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="成交筆數短期均線" number="1" type="0" color="5275903" color2="5275903" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /><Plot name="成交筆數長期均線" number="2" type="0" color="255" color2="255" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="8" />
<script>
<freq support="8;11" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{&quot;0&quot;:[183]},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="申報轉讓" ID="ec58c7b9eb6344d59aff3b89da0d579b" ReturnType="0" ExecType="1" Folder="/籌碼高手/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[condition994 = symbol = "TSE.TW" or symbol = "TWSE.FS" or symbol = "OTC.TW";//大盤
condition993 = symbolexchange = "TW" and symboltype = 1;//類股

if condition994 =false and condition993 = false //大盤+類股
	then raiseruntimeerror("不支援此商品");

if barfreq <> "D" and barfreq <> "AD" and
	barfreq <> "W" and barfreq <> "AW" and
	barfreq <> "M" and barfreq <> "AM"
	then raiseruntimeerror("不支援此頻率");


plot1(Getfield("申報總市值"),"申報總市值",axis:=1,ScaleLabel:=sltypewy,ScaleDecimal:=sdauto);
plot2(Getfield("申報家數"),"申報家數",checkbox:=0,axis:=2,ScaleLabel:=sltypewy,ScaleDecimal:=sdauto);
plot3(Getfield("申報人數"),"申報人數",checkbox:=0,axis:=2,ScaleLabel:=sltypewy,ScaleDecimal:=sdauto);
]]></Code>
<Arg><![CDATA[<Arg seed="80d06e89-f179-4e67-85c5-83846e87321f" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="e0a7ee89-d5f9-4a59-8dcc-7d35d725e330" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="申報總市值" number="1" type="1" color="255" color2="62464" style="4" weight="0" axis="0" DecimalFormat="0" NumFormat="3" checkbox="-1" SetDecimalFormat="0" SetNumFormat="1" colors="-1,-1" offset="0" /><Plot name="申報家數" number="2" type="0" color="16711935" color2="255" style="5" weight="0" axis="1" DecimalFormat="0" NumFormat="3" checkbox="0" SetDecimalFormat="0" SetNumFormat="1" colors="-1,-1" offset="0" /><Plot name="申報人數" number="3" type="0" color="65280" color2="65280" style="5" weight="0" axis="1" DecimalFormat="0" NumFormat="3" checkbox="0" SetDecimalFormat="0" SetNumFormat="1" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="16" />
<script>
<freq support="8;11;9;12;10;13" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{&quot;0&quot;:[215,216,217]},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="波動區間指標" ID="ca9f8549394748cfb2d7cc56b7c89d9a" ReturnType="0" ExecType="1" Folder="/技術指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:
	short1(3,"短期平均"),
	mid1(20,"長期平均");

value1=highest(high,5);
value2=lowest(low,5);
if value2 <> 0 then
	value3=(value1-value2)/value2*100;
value4=average(value3,short1);
value5=average(value3,mid1);

plot1(value4,"短期平均區間");
plot2(value5,"長期平均區間");
]]></Code>
<Arg><![CDATA[<Arg seed="11f557ea-c590-4aba-a238-00ca04feccc6" version="1"><Param name="短期平均" varname="short1" type="1" subtype="0" value="3" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="長期平均" varname="mid1" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="a7475c94-fd20-4005-81f0-fdf142a15d51" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="短期平均區間" number="1" type="0" color="5275903" color2="5275903" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /><Plot name="長期平均區間" number="2" type="0" color="65535" color2="255" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,61c06064ad98469db9ce30287ae4a2c8;1,2bca774c6b7549c1b0b008d2a54b288e;1,f1b429ac13b2447c909302198c18ca56;1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="5" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="VSTD成交量標準差" ID="c5c57261729a44bba9a061e52b1b5aaa" ReturnType="0" ExecType="1" Folder="/量能指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:Period(22,"期數");

variable:VSTD(0);
VSTD=standarddev(VOLUME,Period,1);

PLOT1(VSTD,"VSTD");
]]></Code>
<Arg><![CDATA[<Arg seed="07c94581-7d28-4a97-ba87-27a582f16b2c" version="1"><Param name="期數" varname="Period" type="1" subtype="0" value="22" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="4be7b819-6a9f-4d91-83f9-5d90627a0998" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="VSTD" number="1" type="0" color="5275903" color2="5275903" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,8c2d025a23c548d3a76fba10c22527b4;1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c;1,9c4f476d319b4f109a8dc8557099ded4;1,c1cda70a714d44999e5171fc53c95b0a</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="2" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="大戶買張比例" ID="493d9d678bbd478bbd3ba047e5d4d3c2" ReturnType="0" ExecType="1" Folder="/籌碼指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:period1(5,"短移動平均線天期");
input:period2(20,"長移動平均線天期");

if barfreq = "Tick" or barfreq = "Min"
	then raiseruntimeerror("不支援此頻率");
	
value1=GetField("主力買張");
value2=GetField("實戶買張");
value3=GetField("散戶買張");
value4=GetField("控盤者買張");
value5=GetField("法人買張");
value6=value1+value2+value3+value4+value5;
//合計的買張數當分母，這有可能超出成交量
value7=value1+value4+value5;
//主力+法人+控盤者的買張合計作為大戶的買張
if value6<>0 then
	value8=value7/value6*100;
//計算大戶買張佔各方勢力買張的比例
value9=average(value8,period1)-average(value8,period2);
plot1(value9,"大戶買張比例");
]]></Code>
<Arg><![CDATA[<Arg seed="446a464a-fc7d-4c94-9b3a-b0143b4e826f" version="1"><Param name="短移動平均線天期" varname="period1" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="長移動平均線天期" varname="period2" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="61d5f5a9-7357-49af-9915-baa2a3c86422" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="大戶買張比例" number="1" type="0" color="5275903" color2="5275903" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="28" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{&quot;0&quot;:[52,59,56,62,48]},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="VA(成交量累積散佈指標)" ID="9487eadbc6fc4cbfb7ffb37a9a27e8f6" ReturnType="0" ExecType="3" Folder="/XQ量能指標/" StatusMask="2">
<Desc><![CDATA[畫出數量累積散佈指標]]></Desc>
<Code><![CDATA[// XQ: VA指標
//
Variable: _va(0);

if High <> Low then
	Value1 = ((Close - Low) - (High - Close))/(High - Low) * Volume
else
	Value1 = 0;

If CurrentBar = 1 then
	_va = Value1
else	
	_va = Value1 + _va[1];

Plot1(_va, "VA");
		]]></Code>
<Arg><![CDATA[<Arg seed="a8069ebc-12aa-4693-a1cc-fc35bda131ab" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="f2c7e6ce-d60d-4f6b-acbe-0db175b0a72c" version="1"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="VA" number="1" type="0" color="5275903" color2="0" style="0" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<Extra><![CDATA[<Extra>
<TotalBar val="100" />
<Maxbb val="0" />
<ScriptComplexity val="1" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="CV(積量指標)" ID="80031d01d6fb434a97dc9b9c2ce7fd01" ReturnType="0" ExecType="3" Folder="/XQ量能指標/" StatusMask="2">
<Desc><![CDATA[畫出積量指標]]></Desc>
<Code><![CDATA[// XQ: CV指標
//
Variable: _cv(0);

If CurrentBar = 1 then
	_cv = Close * Volume
else	
	_cv = _cv[1] + (Close - Close[1]) * Volume;

Plot1(_cv, "CV");
		]]></Code>
<Arg><![CDATA[<Arg seed="c112c075-26eb-47f4-85f1-2d141fb0fa9b" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="9cceabd1-9e1c-4202-9bcc-0822d45c5867" version="1"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="CV" number="1" type="0" color="5275903" color2="0" style="0" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<Extra><![CDATA[<Extra>
<TotalBar val="100" />
<Maxbb val="1" />
<ScriptComplexity val="1" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="多空淨力場" ID="24a5eb91743240548376026fde0a5d68" ReturnType="0" ExecType="1" Folder="/籌碼指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[{
指標說明
https://xstrader.net/自訂指標step-by-step/
}

input:sd(5,"短天期");
input:ld(20,"長天期");

variable:H1(0),L1(0),C1(0),NF(0),SNF(0),LNF(0),dd(0);

H1=HIGH-HIGH[1];
L1=LOW-LOW[1];
C1=CLOSE-CLOSE[1];

if truerange<>0 then begin
	NF=(H1+L1)/truerange;
	SNF=average(NF,sd);
	LNF=average(NF,ld);
	dd=SNF-LNF;
end;

plot1(dd,"多空淨力");
]]></Code>
<Arg><![CDATA[<Arg seed="1564fbf8-1652-47ad-9071-6be8924944b6" version="1"><Param name="短天期" varname="sd" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="長天期" varname="ld" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="0445979b-4157-4f41-a7ee-c5606a449755" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="多空淨力" number="1" type="1" color="5275903" color2="5275903" style="0" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,36d1fc033c6f48f8a136f9e1fdec110f;1,81394f9cf0c8469ea5f8832700aec8b7;1,9e03682196e24611b2fe326b6a56433d;1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="5" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="分鐘與日MACD" ID="0d2ec29a19cd45c689037aa49163ffc6" ReturnType="0" ExecType="1" Folder="/跨頻率指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[// 跨頻率MACD指標，預設跨頻率為30分
// 不支援大頻率跨小頻率，例如：
// 不支援主頻率60分鐘，跨頻率計算30分鐘MACD技術指標。
//
input:	FastLength(12, "DIF短天數"), SlowLength(26, "DIF長天數"), MACDLength(9, "MACD天數"),
		FreqType("30", "跨頻率週期", inputkind:=dict(["1分鐘","1"],["5分鐘","5"],["10分鐘","10"],["15分鐘","15"],["30分鐘","30"],["60分鐘","60"],["日","D"],["還原日","AD"]));

if barfreq <> "Tick" and barfreq <> "Min" and barfreq <> "D" and barfreq <> "AD" then raiseruntimeerror("此範例僅支援分鐘、日與還原日頻率");

xfMin_macd(FreqType,xfMin_weightedclose(FreqType),FastLength,SlowLength,MACDLength,value1,value2,value3);

// 前面區段資料變動較大, 先不繪出
//
if CurrentBar <= SlowLength then
begin
	Value1 = 0;
	Value2 = 0;
	Value3 = 0;
end;

Plot1(Value1, "分鐘與日DIF");
Plot2(Value2, "分鐘與日MACD");
Plot3(Value3, "分鐘與日Osc");

// 防呆，大頻率跨小頻率時，在線圖秀不支援
//
switch (FreqType)
begin
	case  "1":
		if barfreq <> "Tick" and barfreq <> "Min" then raiseruntimeerror("不支援大頻率跨小頻率：主頻率大於1分鐘");
		if barinterval <> 1 then raiseruntimeerror("不支援大頻率跨小頻率：主頻率大於1分鐘");
		setplotlabel(1, "1分DIF");
		setplotlabel(2, "1分MACD");
		setplotlabel(3, "1分Osc");

	case  "5":
		if barfreq <> "Tick" and barfreq <> "Min" then raiseruntimeerror("不支援大頻率跨小頻率：主頻率大於5分鐘");
		if barinterval <> 1 and barinterval <> 2 and barinterval <> 3 and barinterval <> 5 then raiseruntimeerror("不支援大頻率跨小頻率：主頻率大於5分鐘");
		setplotlabel(1, "5分DIF");
		setplotlabel(2, "5分MACD");
		setplotlabel(3, "5分Osc");

	case "10":
		if barfreq <> "Tick" and barfreq <> "Min" then raiseruntimeerror("不支援大頻率跨小頻率：主頻率大於10分鐘");
		if barinterval <> 1 and barinterval <> 2 and barinterval <> 3 and barinterval <> 5 and barinterval <> 10 then raiseruntimeerror("不支援大頻率跨小頻率：主頻率大於10分鐘");
		setplotlabel(1, "10分DIF");
		setplotlabel(2, "10分MACD");
		setplotlabel(3, "10分Osc");

	case "15":
		if barfreq <> "Tick" and barfreq <> "Min" then raiseruntimeerror("不支援大頻率跨小頻率：主頻率大於15分鐘");
		if barinterval <> 1 and barinterval <> 2 and barinterval <> 3 and barinterval <> 5 and barinterval <> 10 and barinterval <> 15 then raiseruntimeerror("不支援大頻率跨小頻率：主頻率大於15分鐘");
		setplotlabel(1, "15分DIF");
		setplotlabel(2, "15分MACD");
		setplotlabel(3, "15分Osc");
		
	case "30":
		if barfreq <> "Tick" and barfreq <> "Min" then raiseruntimeerror("不支援大頻率跨小頻率：主頻率大於30分鐘");
		if barinterval <> 1 and barinterval <> 2 and barinterval <> 3 and barinterval <> 5 and barinterval <> 10 and barinterval <> 15 and barinterval <> 20 and barinterval <> 30 then raiseruntimeerror("不支援大頻率跨小頻率：主頻率大於30分鐘");
		setplotlabel(1, "30分DIF");
		setplotlabel(2, "30分MACD");
		setplotlabel(3, "30分Osc");

	case "60":
		if barfreq <> "Tick" and barfreq <> "Min" then raiseruntimeerror("不支援大頻率跨小頻率：主頻率大於60分鐘");
		if barinterval <> 1 and barinterval <> 2 and barinterval <> 3 and barinterval <> 5 and barinterval <> 10 and barinterval <> 15 and barinterval <> 20 and barinterval <> 30 and barinterval <> 45 and barinterval <> 60 then raiseruntimeerror("不支援大頻率跨小頻率：主頻率大於60分鐘");
		setplotlabel(1, "60分DIF");
		setplotlabel(2, "60分MACD");
		setplotlabel(3, "60分Osc");

	case "D":
		if barfreq <> "Tick" and barfreq <> "Min" and barfreq <> "D" and barfreq <> "AD" then raiseruntimeerror("不支援大頻率跨小頻率：主頻率大於日");
		setplotlabel(1, "日DIF");
		setplotlabel(2, "日MACD");
		setplotlabel(3, "日Osc");
		
	case "AD":
		if barfreq <> "Tick" and barfreq <> "Min" and barfreq <> "D" and barfreq <> "AD" then raiseruntimeerror("不支援大頻率跨小頻率：主頻率大於還原日");
		setplotlabel(1, "還原日DIF");
		setplotlabel(2, "還原日MACD");
		setplotlabel(3, "還原日Osc");

end;]]></Code>
<Arg><![CDATA[<Arg seed="4d94f78d-5b1a-4625-ab77-bbebcc462741" version="1"><Param name="DIF短天數" varname="FastLength" type="1" subtype="0" value="12" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="DIF長天數" varname="SlowLength" type="1" subtype="0" value="26" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="MACD天數" varname="MACDLength" type="1" subtype="0" value="9" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="跨頻率週期" varname="FreqType" type="3" subtype="0" value="30" isSerial="0" isArray="0" isRef="0" inputkind="1" quickedit="0" keytype="3"><Pair key="1分鐘" value="1" /><Pair key="5分鐘" value="5" /><Pair key="10分鐘" value="10" /><Pair key="15分鐘" value="15" /><Pair key="30分鐘" value="30" /><Pair key="60分鐘" value="60" /><Pair key="日" value="D" /><Pair key="還原日" value="AD" /></Param></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="e772c20f-fa55-42f1-81fd-4e2c81ca6a6f" version="0">
	<Axises>
		<Axis value="1" align="0" min="-100.000000" max="100.000000" SetMin="1" SetMax="1" mpvalue="0.000000" />
		<Axis value="2" align="0" min="-100.000000" max="100.000000" SetMin="1" SetMax="1" mpvalue="0.000000" />
	</Axises>
	<Plot name="分鐘與日DIF" number="1" color="5275903" color2="5275903" axis="1" checkbox="-1" colors="," offset="0" />

	<Plot name="分鐘與日MACD" number="2" color="65535" color2="255" axis="1" checkbox="-1" colors="," offset="0" />

	<Plot name="分鐘與日Osc" number="3" type="1" style="3" color="255" color2="65280" checkbox="-1" colors="," offset="0" />

</Plots>]]></Plots>
<RefFunc>1,2f8ed4e98bf740a88ac2c3dee2afec24;1,de5550c0989b434681e18c65fcc79915;1,8e4cc5f4d71342f9a5b6c2e5dc9a6966;1,aced678c83804b088f72d66788ddde3c;1,d5dc0dcf2b6a43ea9145511423952db3;1,3ad4a7800de14e669b2e727f7309514f</RefFunc>
<Extra><![CDATA[<Extra>
	<TotalBar val="200" />
	<Maxbb val="0" />
	<IsScriptSetTB val="0" />
	<IsScriptSetBB val="0" />
</Extra>]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="2" Name="MACD 指標" ID="5f6ed4877bd5453bb71796b0b5cbb3cd" ReturnType="0" ExecType="3" Folder="/XQ技術指標/" StatusMask="2">
<Desc><![CDATA[畫出MACD指標]]></Desc>
<Code><![CDATA[// XQ: MACD指標
//
input: FastLength(12), SlowLength(26), MACDLength(9);
variable: price(0);

SetInputName(1, "DIF短天數");
SetInputName(2, "DIF長天數");
SetInputName(3, "MACD天數");

price = WeightedClose();

Value1 = XAverage(price, FastLength) - XAverage(price, SlowLength);
Value2 = XAverage(Value1, MACDLength) ;
Value3 = Value1 - Value2 ;

// 前面區段資料變動較大, 先不繪出
//
if CurrentBar <= SlowLength then
begin
	Value1 = 0;
	Value2 = 0;
	Value3 = 0;
end;

Plot1(Value1, "DIF");
Plot2(Value2, "MACD");
Plot3(Value3, "Osc");
		]]></Code>
<Arg><![CDATA[<Arg seed="1e9944a3-a47f-439c-a4b7-9ded7f19c55e" version="1"><Param name="DIF短天數" varname="FastLength" type="1" subtype="0" value="12" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="DIF長天數" varname="SlowLength" type="1" subtype="0" value="26" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="MACD天數" varname="MACDLength" type="1" subtype="0" value="9" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="9ebf70c3-138a-4043-a26c-a666d7cc8a24" version="1">
	<Axises>
		<Axis value="1" align="1" min="-100.000000" max="100.000000" SetMin="1" SetMax="1" mpvalue="0.000000" />
		<Axis value="2" align="1" min="-100.000000" max="100.000000" SetMin="1" SetMax="1" mpvalue="0.000000" />
	</Axises>
	<Plot name="DIF" number="1" color="5275903" color2="0" axis="1" checkbox="-1" colors="," offset="0" />

	<Plot name="MACD" number="2" color="65535" color2="0" axis="1" checkbox="-1" colors="," offset="0" />

	<Plot name="Osc" number="3" type="1" style="3" color="255" color2="65280" checkbox="-1" colors="," offset="0" />

</Plots>]]></Plots>
<RefFunc>1,2549534038c6445884c25787277c86db;1,d02c45cba76f4163a048685f7bc4002b</RefFunc>
<Extra><![CDATA[<Extra>
	<TotalBar val="200" />
	<Maxbb val="0" />
	<IsScriptSetTB val="0" />
	<IsScriptSetBB val="0" />
</Extra>]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="2" Name="ATR (平均真實區域)" ID="6a50a1323833494f9d19a30673549db6" ReturnType="0" ExecType="3" Folder="/XQ技術指標/" StatusMask="2">
<Desc><![CDATA[畫出平均真實區域]]></Desc>
<Code><![CDATA[// XQ: ATR指標
//
input: Length(14);

SetInputName(1, "天數");

value1 = Average(TrueRange, Length);
Plot1(value1, "ATR");
		]]></Code>
<Arg><![CDATA[<Arg seed="42751cd1-18f3-41e4-9c67-44e9c3acef65" version="1"><Param name="天數" varname="Length" type="1" subtype="0" value="14" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="5026027e-2c50-41b2-9a1f-664e71fbd9b6" version="1"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="ATR" number="1" type="0" color="5275903" color2="0" style="0" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,36d1fc033c6f48f8a136f9e1fdec110f;1,81394f9cf0c8469ea5f8832700aec8b7;1,9e03682196e24611b2fe326b6a56433d;1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="50" />
<Maxbb val="14" />
<ScriptComplexity val="3" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="主力累計買賣超" ID="13829f5c8b09411f8cddb480ec512d61" ReturnType="0" ExecType="3" Folder="/籌碼指標/" StatusMask="2">
<Desc><![CDATA[計算一段時間的外資累計買賣超張數以及占成交的比重]]></Desc>
<Code><![CDATA[input: Length(5); setinputname(1,"計算天數");
input:TXT("僅適用日線以上"); setinputname(2,"使用限制");

if barfreq = "Tick" or barfreq = "Min"
	then raiseruntimeerror("不支援此頻率");
	
variable: _buyTotal(0), volTotal(0), _Ratio(0);

_buyTotal = summation(GetField("主力買賣超張數"), Length);
volTotal = summation(Volume, Length);

if volTotal <> 0 then
	_Ratio = _buyTotal * 100 / volTotal
else
	_Ratio = 0;

Plot1(_buyTotal, "累計買賣超");
Plot2(_Ratio, "比例%");

]]></Code>
<Arg><![CDATA[<Arg seed="7c89a2d2-727a-4588-8e19-23c41ea344a7" version="1"><Param name="計算天數" varname="Length" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="使用限制" varname="TXT" type="3" subtype="0" value="僅適用日線以上" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="811bddac-8a7a-4c25-af1a-306d04ba834b" version="1"><Axises><Axis value="1" align="1" min="-100" max="100" /><Axis value="2" align="1" min="-100" max="100" /></Axises><Plot name="累計買賣超" number="1" type="1" color="5275903" color2="0" style="0" weight="0" axis="1" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /><Plot name="比例%" number="2" type="0" color="255" color2="0" style="0" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="30" />
<Maxbb val="20" />
<ScriptComplexity val="8" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{&quot;0&quot;:[54]},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="大盤多空指標" ID="787f2ea84d9f483a90590760c9ae6259" ReturnType="0" ExecType="1" Folder="/大盤指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[{
指標說明
https://xstrader.net/打造自己的大盤多空函數/
}

input:Length(7,"計算天數");
input:LowLimit(5,"外資買超天數");

plot1(tselsindex(Length,LowLimit));]]></Code>
<Arg><![CDATA[<Arg seed="501e89c1-00fd-45b8-86a9-03ec4ab3c1bb" version="1"><Param name="計算天數" varname="Length" type="1" subtype="0" value="7" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="外資買超天數" varname="LowLimit" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="d41a38d1-93cd-4ed5-975d-5ddda5014662" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="plot1" number="1" type="1" color="5275903" color2="5275903" style="0" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,d80cf92ddfcc42e0a6c53ec47edebd49;1,b1f1a25bdc014e109dc92d7f9b6ef207</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="2" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="BBand width (布林通道寬度指標)" ID="94d53db3043742bcb890318a27b58367" ReturnType="0" ExecType="3" Folder="/XQ技術指標/" StatusMask="2">
<Desc><![CDATA[畫出布林通道寬度指標]]></Desc>
<Code><![CDATA[// XQ: BBandWidth指標
//
input: Length(20), UpperBand(2), LowerBand(2), EMALength(3);
variable: up(0), down(0), mid(0), bbandwidth(0), ema(0);

SetInputName(1, "天數");
SetInputName(2, "上");
SetInputName(3, "下");
SetInputName(4, "EMA");

up = bollingerband(Close, Length, UpperBand);
down = bollingerband(Close, Length, -1 * LowerBand);
mid = (up + down) / 2;

bbandwidth = 100 * (up - down) / mid;
ema = XAverage(bbandwidth, EMALength);

Plot1(bbandwidth , "BBand width(%)");
Plot2(ema, "Band% EMA");



        
		]]></Code>
<Arg><![CDATA[<Arg seed="f01fed27-48f2-4a4d-9bb7-0015e2ff13dd" version="1"><Param name="天數" varname="Length" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="上" varname="UpperBand" type="1" subtype="0" value="2" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="下" varname="LowerBand" type="1" subtype="0" value="2" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="EMA" varname="EMALength" type="1" subtype="0" value="3" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="ece659a5-b12e-4b75-9ee2-7efb77d12905" version="1"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="BBand width(%)" number="1" type="0" color="5275903" color2="0" style="0" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /><Plot name="Band% EMA" number="2" type="0" color="255" color2="0" style="0" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c;1,8c2d025a23c548d3a76fba10c22527b4;1,9c4f476d319b4f109a8dc8557099ded4;1,c1cda70a714d44999e5171fc53c95b0a;1,5f76de57dba441808c8c784d8fa54994;1,d02c45cba76f4163a048685f7bc4002b</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="50" />
<Maxbb val="21" />
<ScriptComplexity val="4" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="EMV(簡易波動指標)" ID="2574edb4682b4c45a099c9b0575fef3f" ReturnType="0" ExecType="3" Folder="/XQ量能指標/" StatusMask="2">
<Desc><![CDATA[畫出簡易波動指標]]></Desc>
<Code><![CDATA[// XQ: EMV指標
//
Input: Length(14);
variable: _emv(0), factor(10000), avg(0);

SetInputName(1, "天數");

if Volume = 0 then
	_emv = 0
else
	_emv = factor * (((High + Low) / 2 - (High[1] + Low[1]) / 2) * (High - Low)) / Volume;

Plot1(_emv, "EMV");


If CurrentBar >= Length Then
	avg = Average(_emv, Length)
else
	avg = _emv;	

Plot2(avg, "EMVA");
 

		]]></Code>
<Arg><![CDATA[<Arg seed="374b4ab0-00e5-4c8a-8779-269b0cce6063" version="1"><Param name="天數" varname="Length" type="1" subtype="0" value="14" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="d1c7e332-1855-40c1-8fcf-342db551f1d0" version="1"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="EMV" number="1" type="0" color="5275903" color2="0" style="0" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /><Plot name="EMVA" number="2" type="0" color="255" color2="0" style="0" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="100" />
<Maxbb val="15" />
<ScriptComplexity val="2" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="上漲下跌量差" ID="7bc2807637d34b6588cc30a3aa787cce" ReturnType="0" ExecType="1" Folder="/大盤指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[{
指標說明
https://xstrader.net/進場點一目了然的大盤儀表板/
收錄於「三週學會程式交易：打造你的第一筆自動化交易」 244頁
https://www.ipci.com.tw/books_in.php?book_id=724
}

input:period1(3,"短天期");
input:period2(5,"長天期");

if barfreq = "Tick" or barfreq = "Min" then
begin
	value1=GetField("上漲量");
	value2=getfield("下跌量");
end else begin
	value1=GetField("上漲量","D");
	value2=getfield("下跌量","D");
end;
value3=average(value1,period1);
value4=average(value2,period1);
value5=value3-value4;//上漲量與下跌量比例
value6=average(value5,period2);
 
plot1(value6,"上漲下跌量差");
 ]]></Code>
<Arg><![CDATA[<Arg seed="a95a2abf-1542-4139-9195-eb57b97bbd58" version="1"><Param name="短天期" varname="period1" type="1" subtype="0" value="3" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="長天期" varname="period2" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="d41e699b-ad72-4a29-b14a-83c3b341ef99" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="上漲下跌量差" number="1" type="1" color="255" color2="62464" style="3" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="24" />
<script>
<freq support="8;11" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{&quot;0&quot;:[71,72],&quot;8&quot;:[71,72]},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="KO能量潮指標" ID="c60da60f96e14200b266254ac0ddf08e" ReturnType="0" ExecType="3" Folder="/技術指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[variable: kovolume(0);

value1=(close+high+low)/3;
if CurrentBar = 1 then
	kovolume = 0
else begin	
	if value1 > value1[1] then
		kovolume = kovolume[1] + volume
	else begin
		if value1 < value1[1] then
			kovolume = kovolume[1] - volume
		else
			kovolume = kovolume[1];
	end;		
end;
  
Plot1(kovolume, "KO能量潮指標");
		]]></Code>
<Arg><![CDATA[<Arg seed="349d2f76-9884-4deb-accf-2c633490dc87" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="b3ffcede-adce-4325-a0cc-95a82bc3deea"><Plot name="KO能量潮指標" number="1" type="0" color="5275903" color2="5275903" style="0" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<Extra><![CDATA[<Extra>
<TotalBar val="300" />
<Maxbb val="50" />
<ScriptComplexity val="1" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="上漲家數佔比指標" ID="ba8a77dbeee94040b00de90691cd4c4b" ReturnType="0" ExecType="1" Folder="/大盤指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[{
指標說明
https://xstrader.net/top1/
收錄於「三週學會程式交易：打造你的第一筆自動化交易」 254頁
https://www.ipci.com.tw/books_in.php?book_id=724
}

input:period1(5,"短天期");
input:period2(20,"長天期");
value1=GetField("上漲家數");
value2=GetField("下跌家數");
value3=value1+value2;
if value3 = 0 then 
	value4 = 0 
else
	value4=value1/value3*100;
value5=average(value4,period1);
value6=average(value4,period2);

plot1(value5,"上漲佔比短期平均");
plot2(value6,"上漲佔比長期平均");
plot3(value5-value6,"長短天期差");
]]></Code>
<Arg><![CDATA[<Arg seed="077272b4-7428-49ff-9c95-4444527bb53a" version="1"><Param name="短天期" varname="period1" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="長天期" varname="period2" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="75333a27-92a9-42a9-860e-f16d77f3d54f" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="上漲佔比短期平均" number="1" type="0" color="5275903" color2="5275903" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /><Plot name="上漲佔比長期平均" number="2" type="0" color="65535" color2="255" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /><Plot name="長短天期差" number="3" type="1" color="16711833" color2="65280" style="0" weight="0" axis="1" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="13" />
<script>
<freq support="8;11" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{&quot;0&quot;:[79,80]},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="MO(運動量擺盪指標)" ID="85959a36be5d439b913c1384fbd2d243" ReturnType="0" ExecType="2" Folder="/XQ技術指標/" StatusMask="2">
<Desc><![CDATA[畫出運動量震盪指標]]></Desc>
<Code><![CDATA[// XQ: MO指標
//
input: Length(10);
variable: mo(0);

SetInputName(1, "天數");

mo = 100 * Close / Close[Length];

Plot1(mo, "MO");
		]]></Code>
<Arg><![CDATA[<Arg seed="33863956-4c6e-47f1-b93e-be104d5bd602" version="1"><Param name="天數" varname="Length" type="1" subtype="0" value="10" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="85fc5388-143f-4757-a796-47f6b470c19e" version="1"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="MO" number="1" type="0" color="5275903" color2="0" style="0" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<Extra><![CDATA[<Extra>
<TotalBar val="20" />
<Maxbb val="12" />
<ScriptComplexity val="1" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="本土天王平均" ID="364c78cce1d04a4eb5aa9b6da296b962" ReturnType="0" ExecType="1" Folder="/大盤指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[{
指標說明
https://xstrader.net/亂世中最佳投資組合/
}

array:ValueArray[12](0);

valuearray[1]=GetSymbolField("1216.tw","收盤價");
valuearray[2]=GetSymbolField("2201.tw","收盤價");
valuearray[3]=GetSymbolField("2412.tw","收盤價");
valuearray[4]=GetSymbolField("1707.tw","收盤價");
valuearray[5]=GetSymbolField("2207.tw","收盤價");
valuearray[6]=GetSymbolField("2905.tw","收盤價");
valuearray[7]=GetSymbolField("2912.tw","收盤價");
valuearray[8]=GetSymbolField("5530.tw","收盤價");
valuearray[9]=GetSymbolField("8454.tw","收盤價");
valuearray[10]=GetSymbolField("1507.tw","收盤價");
valuearray[11]=GetSymbolField("9933.tw","收盤價");
valuearray[12]=GetSymbolField("9941.tw","收盤價");
value1=array_sum(valuearray,1,12);

plot1(value1);]]></Code>
<Arg><![CDATA[<Arg seed="9dbbdff5-abba-40e3-b5fa-e54322c80033" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="670b084a-0f2d-4364-8133-34cfc37d5288" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="plot1" number="1" type="0" color="5275903" color2="5275903" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="61" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{&quot;1216.TW&quot;:{&quot;0&quot;:[8]},&quot;2201.TW&quot;:{&quot;0&quot;:[8]},&quot;2412.TW&quot;:{&quot;0&quot;:[8]},&quot;1707.TW&quot;:{&quot;0&quot;:[8]},&quot;2207.TW&quot;:{&quot;0&quot;:[8]},&quot;2905.TW&quot;:{&quot;0&quot;:[8]},&quot;2912.TW&quot;:{&quot;0&quot;:[8]},&quot;5530.TW&quot;:{&quot;0&quot;:[8]},&quot;8454.TW&quot;:{&quot;0&quot;:[8]},&quot;1507.TW&quot;:{&quot;0&quot;:[8]},&quot;9933.TW&quot;:{&quot;0&quot;:[8]},&quot;9941.TW&quot;:{&quot;0&quot;:[8]}}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="ALF亞歷山大過濾指標" ID="83709681df144ae4803b4fbc2bb3bf0c" ReturnType="0" ExecType="2" Folder="/大盤指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input: length(10);		setinputname(1, "天期");

Value1 = close / close[length-1];
plot1(Value1, "亞歷山大過濾指標");

]]></Code>
<Arg><![CDATA[<Arg seed="48e7fe77-a671-413c-8deb-2840cd0e0499" version="1"><Param name="天期" varname="length" type="1" subtype="0" value="10" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="0d778ddd-1f89-4b67-8f7c-415b8618b339" version="1"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="亞歷山大過濾指標" number="1" type="0" color="5275903" color2="0" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<Extra><![CDATA[<Extra>
<TotalBar val="20" />
<Maxbb val="10" />
<ScriptComplexity val="1" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="大戶持股" ID="ae71ce921bf34f5da9f1edf2bdf85c51" ReturnType="0" ExecType="1" Folder="/籌碼高手/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input: _input1(400,"大戶標準",inputkind:= Dict(["10",10],["50",50],["100",100],["200",200],["400",400],["600",600],["800",800],["1000",1000]),quickedit:=true);

condition999 = symbolexchange = "TW" or symbolexchange = "TE";//台股+興櫃
condition998 = condition999 = true and (symboltype = 2 or symbolType = 1);//個股+興櫃+類股

if condition998 = false //個股+興櫃+類股
	then raiseruntimeerror("不支援此商品");

if barfreq = "Tick" or barfreq = "Min"
	then raiseruntimeerror("不支援此頻率");
	
switch (_input1)
begin
	case 10:
		if barFreq = "D" then begin
			value1 = Getfield("大戶持股比例","W",param:=10);
			value2 = Getfield("大戶持股張數","W",param:=10);
			value3 = Getfield("大戶持股人數","W",param:=10);
		end else begin
			value1 = Getfield("大戶持股比例",param:=10);
			value2 = Getfield("大戶持股張數",param:=10);
			value3 = Getfield("大戶持股人數",param:=10);
		end;	
		plot1(0.01*value1,"大戶持股比例",checkbox:=1,axis:=1,ScaleLabel:=slpercent,ScaleDecimal:=sd2);//請RD加，Getfield("大戶持股比例",param:=10)
		plot2(value2,"持股張數",checkbox:=0,axis:=2,ScaleLabel:=sltypewy,ScaleDecimal:=sdauto);
		plot3(value3,"持股人數",checkbox:=0,axis:=11,ScaleLabel:=slfull,ScaleDecimal:=sd0);//請RD加
		
	case 50:
		if barFreq = "D" then begin
			value1 = Getfield("大戶持股比例","W",param:=50);
			value2 = Getfield("大戶持股張數","W",param:=50);
			value3 = Getfield("大戶持股人數","W",param:=50);
		end else begin
			value1 = Getfield("大戶持股比例",param:=50);
			value2 = Getfield("大戶持股張數",param:=50);
			value3 = Getfield("大戶持股人數",param:=50);
		end;
		plot1(0.01*value1,"大戶持股比例",checkbox:=1,axis:=1,ScaleLabel:=slpercent,ScaleDecimal:=sd2);//請RD加，Getfield("大戶持股比例",param:=50)
		plot2(value2,"持股張數",checkbox:=0,axis:=2,ScaleLabel:=sltypewy,ScaleDecimal:=sdauto);
		plot3(value3,"持股人數",checkbox:=0,axis:=11,ScaleLabel:=slfull,ScaleDecimal:=sd0);//請RD加

	case 100:
		if barFreq = "D" then begin
			value1 = Getfield("大戶持股比例","W",param:=100);
			value2 = Getfield("大戶持股張數","W",param:=100);
			value3 = Getfield("大戶持股人數","W",param:=100);
		end else begin
			value1 = Getfield("大戶持股比例",param:=100);
			value2 = Getfield("大戶持股張數",param:=100);
			value3 = Getfield("大戶持股人數",param:=100);
		end;
		plot1(0.01*value1,"大戶持股比例",checkbox:=1,axis:=1,ScaleLabel:=slpercent,ScaleDecimal:=sd2);//請RD加，新增參數設定選擇：[400/600/800/1000] 張以上
		plot2(value2,"持股張數",checkbox:=0,axis:=2,ScaleLabel:=sltypewy,ScaleDecimal:=sdauto);
		plot3(value3,"持股人數",checkbox:=0,axis:=11,ScaleLabel:=slfull,ScaleDecimal:=sd0);//請RD加
		
	case 200:
		if barFreq = "D" then begin
			value1 = Getfield("大戶持股比例","W",param:=200);
			value2 = Getfield("大戶持股張數","W",param:=200);
			value3 = Getfield("大戶持股人數","W",param:=200);
		end else begin
			value1 = Getfield("大戶持股比例",param:=200);
			value2 = Getfield("大戶持股張數",param:=200);
			value3 = Getfield("大戶持股人數",param:=200);
		end;
		plot1(0.01*value1,"大戶持股比例",checkbox:=1,axis:=1,ScaleLabel:=slpercent,ScaleDecimal:=sd2);//請RD加，新增參數設定選擇：[400/600/800/1000] 張以上
		plot2(value2,"持股張數",checkbox:=0,axis:=2,ScaleLabel:=sltypewy,ScaleDecimal:=sdauto);
		plot3(value3,"持股人數",checkbox:=0,axis:=11,ScaleLabel:=slfull,ScaleDecimal:=sd0);//請RD加
	
	case 600:
		if barFreq = "D" then begin
			value1 = Getfield("大戶持股比例","W",param:=600);
			value2 = Getfield("大戶持股張數","W",param:=600);
			value3 = Getfield("大戶持股人數","W",param:=600);
		end else begin
			value1 = Getfield("大戶持股比例",param:=600);
			value2 = Getfield("大戶持股張數",param:=600);
			value3 = Getfield("大戶持股人數",param:=600);
		end;
		plot1(0.01*value1,"大戶持股比例",checkbox:=1,axis:=1,ScaleLabel:=slpercent,ScaleDecimal:=sd2);//請RD加，新增參數設定選擇：[400/600/800/1000] 張以上
		plot2(value2,"持股張數",checkbox:=0,axis:=2,ScaleLabel:=sltypewy,ScaleDecimal:=sdauto);
		plot3(value3,"持股人數",checkbox:=0,axis:=11,ScaleLabel:=slfull,ScaleDecimal:=sd0);//請RD加
		
	case 800:
		if barFreq = "D" then begin
			value1 = Getfield("大戶持股比例","W",param:=800);
			value2 = Getfield("大戶持股張數","W",param:=800);
			value3 = Getfield("大戶持股人數","W",param:=800);
		end else begin
			value1 = Getfield("大戶持股比例",param:=800);
			value2 = Getfield("大戶持股張數",param:=800);
			value3 = Getfield("大戶持股人數",param:=800);
		end;
		plot1(0.01*value1,"大戶持股比例",checkbox:=1,axis:=1,ScaleLabel:=slpercent,ScaleDecimal:=sd2);//請RD加，新增參數設定選擇：[400/600/800/1000] 張以上
		plot2(value2,"持股張數",checkbox:=0,axis:=2,ScaleLabel:=sltypewy,ScaleDecimal:=sdauto);
		plot3(value3,"持股人數",checkbox:=0,axis:=11,ScaleLabel:=slfull,ScaleDecimal:=sd0);//請RD加
	
	case 1000:
		if barFreq = "D" then begin
			value1 = Getfield("大戶持股比例","W",param:=1000);
			value2 = Getfield("大戶持股張數","W",param:=1000);
			value3 = Getfield("大戶持股人數","W",param:=1000);
		end else begin
			value1 = Getfield("大戶持股比例",param:=1000);
			value2 = Getfield("大戶持股張數",param:=1000);
			value3 = Getfield("大戶持股人數",param:=1000);
		end;
		plot1(0.01*value1,"大戶持股比例",checkbox:=1,axis:=1,ScaleLabel:=slpercent,ScaleDecimal:=sd2);//請RD加，新增參數設定選擇：[400/600/800/1000] 張以上
		plot2(value2,"持股張數",checkbox:=0,axis:=2,ScaleLabel:=sltypewy,ScaleDecimal:=sdauto);
		plot3(value3,"持股人數",checkbox:=0,axis:=11,ScaleLabel:=slfull,ScaleDecimal:=sd0);//請RD加

	default:
		if barFreq = "D" then begin
			value1 = Getfield("大戶持股比例","W",param:=400);
			value2 = Getfield("大戶持股張數","W",param:=400);
			value3 = Getfield("大戶持股人數","W",param:=400);
		end else begin
			value1 = Getfield("大戶持股比例",param:=400);
			value2 = Getfield("大戶持股張數",param:=400);
			value3 = Getfield("大戶持股人數",param:=400);
		end;
		plot1(0.01*value1,"大戶持股比例",checkbox:=1,axis:=1,ScaleLabel:=slpercent,ScaleDecimal:=sd2);//請RD加，新增參數設定選擇：[400/600/800/1000] 張以上
		plot2(value2,"持股張數",checkbox:=0,axis:=2,ScaleLabel:=sltypewy,ScaleDecimal:=sdauto);
		plot3(value3,"持股人數",checkbox:=0,axis:=11,ScaleLabel:=slfull,ScaleDecimal:=sd0);//請RD加

end;]]></Code>
<Arg><![CDATA[<Arg seed="7543b9ad-b144-4d15-a1a5-ce2faf3c834e" version="1"><Param name="大戶標準" varname="_input1" type="1" subtype="0" value="400" isSerial="0" isArray="0" isRef="0" inputkind="1" quickedit="1" keytype="3"><Pair key="10" value="10" /><Pair key="50" value="50" /><Pair key="100" value="100" /><Pair key="200" value="200" /><Pair key="400" value="400" /><Pair key="600" value="600" /><Pair key="800" value="800" /><Pair key="1000" value="1000" /></Param></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="f5743407-ca90-46fb-a0c7-3771bb3370f1" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="大戶持股比例" number="1" type="1" color="255" color2="62464" style="4" weight="0" axis="0" DecimalFormat="3" NumFormat="2" checkbox="1" SetDecimalFormat="1" SetNumFormat="1" colors="-1,-1" offset="0" /><Plot name="持股張數" number="2" type="0" color="16711935" color2="255" style="5" weight="0" axis="1" DecimalFormat="0" NumFormat="3" checkbox="0" SetDecimalFormat="0" SetNumFormat="1" colors="-1,-1" offset="0" /><Plot name="持股人數" number="3" type="0" color="65280" color2="65280" style="5" weight="0" axis="10" DecimalFormat="1" NumFormat="1" checkbox="0" SetDecimalFormat="1" SetNumFormat="1" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="241" />
<script>
<freq support="9;12;10;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{&quot;9&quot;:[237,219,220],&quot;0&quot;:[237,219,220]},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="控盤者主動買賣力" ID="31f47d809bda4a97a864484c5c95a460" ReturnType="0" ExecType="1" Folder="/籌碼高手/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[condition999 = symbolexchange = "TW" or symbolexchange = "TE";//台股+興櫃
condition998 = condition999 = true and symboltype = 2;//個股+興櫃

if condition998 = false //個股+興櫃
	then raiseruntimeerror("不支援此商品");

if barfreq = "Tick" or barfreq = "Min"
	then raiseruntimeerror("不支援此頻率");

plot1(GetField("主動性交易比重"),"交易比重",checkbox:=1,axis:=1,ScaleLabel:=slfull,ScaleDecimal:=sd2);
plot2(GetField("主動買力"),"主動買力",checkbox:=0,axis:=1,ScaleLabel:=slfull,ScaleDecimal:=sd2);
plot3(GetField("主動賣力"),"主動賣力",checkbox:=0,axis:=1,ScaleLabel:=slfull,ScaleDecimal:=sd2);]]></Code>
<Arg><![CDATA[<Arg seed="31221b71-846f-448b-8090-331a59793dff" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="56c94d58-8d27-4231-b5ec-ab3166ec911e" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="交易比重" number="1" type="0" color="5275903" color2="5275903" style="0" weight="0" axis="0" DecimalFormat="3" NumFormat="1" checkbox="1" SetDecimalFormat="1" SetNumFormat="1" colors="-1,-1" offset="0" /><Plot name="主動買力" number="2" type="0" color="16711935" color2="255" style="5" weight="0" axis="0" DecimalFormat="3" NumFormat="1" checkbox="0" SetDecimalFormat="1" SetNumFormat="1" colors="-1,-1" offset="0" /><Plot name="主動賣力" number="3" type="0" color="65280" color2="65280" style="5" weight="0" axis="0" DecimalFormat="3" NumFormat="1" checkbox="0" SetDecimalFormat="1" SetNumFormat="1" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="16" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{&quot;0&quot;:[88,86,87]},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="OTC佔大盤成交量比" ID="f101d18f43344db78c19f4bf428e340b" ReturnType="0" ExecType="1" Folder="/大盤指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[{
指標說明
https://xstrader.net/otc跟上市成交量比值是股市多空指標/
}

input: Period(5,"期數");

value1=GetSymbolField("tse.tw","成交量");
value2=GetSymbolField("otc.tw","成交量");
value3=value2/value1*100;
value4=average(value3,Period);

plot1(value4,"OTC/TSE(%)");
Plot2(value2,"OTC成交量");
]]></Code>
<Arg><![CDATA[<Arg seed="cdb9badc-ba26-4701-96eb-172fb653e1cc" version="1"><Param name="期數" varname="Period" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="ec307b68-efa4-4c7d-abba-ee758a929eae" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="OTC/TSE(%)" number="1" type="0" color="5275903" color2="5275903" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /><Plot name="OTC成交量" number="2" type="1" color="255" color2="255" style="0" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="12" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{&quot;TSE.TW&quot;:{&quot;0&quot;:[9]},&quot;OTC.TW&quot;:{&quot;0&quot;:[9]}}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="NVI(負量指標)" ID="c8a4cbe3dd1b4610a542cb686fd092c6" ReturnType="0" ExecType="3" Folder="/XQ量能指標/" StatusMask="2">
<Desc><![CDATA[畫出負量指標]]></Desc>
<Code><![CDATA[// XQ: NVI指標
//
Variable: _nvi(1);

if CurrentBar = 1 then
	_nvi = 1
else
  begin	
	if Volume < Volume[1] then
		_nvi = _nvi[1] + (Close - Close[1]) / Close[1]
	else
		_nvi = _nvi[1];
  end;
  
Plot1(_nvi, "NVI");

		]]></Code>
<Arg><![CDATA[<Arg seed="742a2c82-bfbd-4fc7-997c-040a4dd2c275" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="5b447a45-f7a6-4c65-96c3-a83b5eeb5958" version="1"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="NVI" number="1" type="0" color="5275903" color2="0" style="0" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<Extra><![CDATA[<Extra>
<TotalBar val="50" />
<Maxbb val="1" />
<ScriptComplexity val="1" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="向上拉動與向下殺盤力道指標" ID="7c5b2fecc561441d8836d24b50527757" ReturnType="0" ExecType="3" Folder="/技術指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:period(5,"加權移動平均線天期");

//當日向上拉動的力量
value1=(high-open)+(close-low);
//當日向下殺盤的力量
value2=(open-low)+(high-close);
if close<>0 then begin
	//上拉力道
	value3=average(value1,period)/close*100;
	//下殺力道
	value4=xaverage(value2,period)/close*100;
end;
value5=value3-value4;
plot1(value5,"上拉下殺淨力道");
 
]]></Code>
<Arg><![CDATA[<Arg seed="4e068605-f230-4986-ab5c-9eac39451d97" version="1"><Param name="加權移動平均線天期" varname="period" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="f54e0df1-269d-4c2e-a37b-6063d8c3b1fa" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="上拉下殺淨力道" number="1" type="0" color="5275903" color2="5275903" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c;1,d02c45cba76f4163a048685f7bc4002b</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="3" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="MA-Osc (移動平均線擺盪指標)" ID="27fe327167114fb687b2c4d860b3d0f9" ReturnType="0" ExecType="3" Folder="/XQ技術指標/" StatusMask="2">
<Desc><![CDATA[畫出移動平均線擺盪指標]]></Desc>
<Code><![CDATA[// XQ: MA-Osc
//
input: Length1(5), Length2(10);

SetInputName(1, "天數一");
SetInputName(2, "天數二");

value1 = Average(close, Length1);
value2 = Average(close, Length2);
value3 = (value1 - value2);

Plot1(value3, "MA-Osc");
		]]></Code>
<Arg><![CDATA[<Arg seed="2c5c67c1-ecaf-469d-ae29-15be3294b22a" version="1"><Param name="天數一" varname="Length1" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="天數二" varname="Length2" type="1" subtype="0" value="10" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="3fcb2bc0-d451-4d03-b726-0f81a26b825e" version="1"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="MA-Osc" number="1" type="0" color="5275903" color2="0" style="0" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="20" />
<Maxbb val="9" />
<ScriptComplexity val="3" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="內部人持股" ID="8725d261f52c4bb1af50f96309ba3d99" ReturnType="0" ExecType="1" Folder="/籌碼高手/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[condition999 = symbolexchange = "TW" or symbolexchange = "TE";//台股+興櫃
condition998 = condition999 = true and symboltype = 2;//個股+興櫃

if condition998 = false //個股+興櫃+類股
	then raiseruntimeerror("不支援此商品");


if barfreq = "Tick" or barfreq = "Min"
	then raiseruntimeerror("不支援此頻率");

plot1(0.01*Getfield("內部人持股比例","M"),"內部人持股比例",axis:=1,ScaleLabel:=slpercent,ScaleDecimal:=sd2);//請RD加
plot2(Getfield("內部人持股張數","M"),"持股張數",checkbox:=0,axis:=2,ScaleLabel:=sltypewy,ScaleDecimal:=sdauto);]]></Code>
<Arg><![CDATA[<Arg seed="537a7643-9cf7-4400-b1ed-fbbd8e34d59d" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="2c304e81-7e6c-4bd4-a7d5-44af5a957773" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="內部人持股比例" number="1" type="1" color="255" color2="62464" style="4" weight="0" axis="0" DecimalFormat="3" NumFormat="2" checkbox="-1" SetDecimalFormat="1" SetNumFormat="1" colors="-1,-1" offset="0" /><Plot name="持股張數" number="2" type="0" color="16711935" color2="255" style="0" weight="0" axis="1" DecimalFormat="0" NumFormat="3" checkbox="0" SetDecimalFormat="0" SetNumFormat="1" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="11" />
<script>
<freq support="10;8;9;11;12;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{&quot;10&quot;:[239,223]},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="主動買力" ID="6fe17121dc374fe3bfcb50b6f26724a3" ReturnType="0" ExecType="1" Folder="/技術指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:p1(5,"短天期");
input:p2(20,"長天期");

if barfreq = "Tick" or barfreq = "Min"
	then raiseruntimeerror("不支援此頻率");

value1=GetField("主動買力");
value2=average(value1,p1);
value3=average(value1,p2);

plot1(value2,"主動買力短天期MA");
plot2(value3,"主動買力長天期MA");


]]></Code>
<Arg><![CDATA[<Arg seed="462bf8f9-63cc-45b5-a7c9-f24751ca7df7" version="1"><Param name="短天期" varname="p1" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="長天期" varname="p2" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="3a5ccc33-2f04-4164-9a1b-06cd53718d17" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="主動買力短天期MA" number="1" type="0" color="5275903" color2="5275903" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /><Plot name="主動買力長天期MA" number="2" type="0" color="65535" color2="255" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="8" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{&quot;0&quot;:[86]},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="N日內上漲天數" ID="6af8d6671a6d4038aa2adfc72d91f085" ReturnType="0" ExecType="1" Folder="/技術指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:length(20,"期數");

variable:count(0);
variable:x1(0);

count=countif(close>close[1],length);

plot1(count,"上漲天數");]]></Code>
<Arg><![CDATA[<Arg seed="ccc73867-00f6-4906-808e-f271b29c7ba6" version="1"><Param name="期數" varname="length" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="8bce99d0-5552-4c68-bb6a-de90cb176dcb" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="上漲天數" number="1" type="0" color="5275903" color2="5275903" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,d80cf92ddfcc42e0a6c53ec47edebd49</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="2" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="價格震盪指標" ID="3da2e31f1d4443d58956e07e2fd7020b" ReturnType="0" ExecType="3" Folder="/技術指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input: length1(5);	setinputname(1, "短天期");
input: length2(20);	setinputname(2, "長天期");

value1 = average(close, length1);
value2 = average(close, length2);

if value1 = 0 then value3 = 0 else value3 = 100 * (value1 - value2) / value1;

plot1(value3, "OSCP");


]]></Code>
<Arg><![CDATA[<Arg seed="5bc13b92-ef56-4eb9-ac8a-dbdf7c16c620" version="1"><Param name="短天期" varname="length1" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="長天期" varname="length2" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="d17ba006-e7aa-45d3-b97c-b9bfbb9b22d5" version="1"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="OSCP" number="1" type="1" color="5275903" color2="0" style="0" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="50" />
<Maxbb val="20" />
<ScriptComplexity val="3" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="HL-Osc (高低價擺盪指標)" ID="a9e672f187a64f28a761851e4ccabdab" ReturnType="0" ExecType="3" Folder="/XQ技術指標/" StatusMask="2">
<Desc><![CDATA[畫出高低擺盪指標]]></Desc>
<Code><![CDATA[// XQ: HL-Osc 指標
//
variable: tr(0), hlo(0);

tr = TrueRange;
if tr <> 0 then
	hlo = 100 * (H - C[1]) / tr
else
	hlo = 0;

plot1(hlo, "HL-Osc");

		]]></Code>
<Arg><![CDATA[<Arg seed="e59bc29c-bcc6-4f2a-b596-e53bdbb08dec" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="c64c61db-7ff7-4e39-942d-e5b9fe9974a2" version="1"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="HL-Osc" number="1" type="0" color="5275903" color2="0" style="0" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,36d1fc033c6f48f8a136f9e1fdec110f;1,81394f9cf0c8469ea5f8832700aec8b7;1,9e03682196e24611b2fe326b6a56433d</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="10" />
<Maxbb val="1" />
<ScriptComplexity val="2" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="Elder 多頭力道指標" ID="8c80b8caf0c544a98e6484a688902642" ReturnType="0" ExecType="3" Folder="/技術指標/" StatusMask="2">
<Desc><![CDATA[畫出艾達買進力道指標]]></Desc>
<Code><![CDATA[// Elder 多頭力道指標
//
input: Length(13);

SetInputName(1, "天數");
Value1 = High - XAverage(Close, Length);

Plot1(Value1, "多頭");

        
		]]></Code>
<Arg><![CDATA[<Arg seed="f51e526b-0f89-4b64-9156-56bc2e43f657" version="1"><Param name="天數" varname="Length" type="1" subtype="0" value="13" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="6373028c-ea22-4559-bfd5-2a4d27f4791a" version="1"><Axises><Axis value="1" align="1" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="多頭" number="1" type="1" color="5275903" color2="0" style="0" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="-1,-1" offset="0" /></Plots>]]></Plots>
<RefFunc>1,d02c45cba76f4163a048685f7bc4002b</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="100" />
<Maxbb val="20" />
<ScriptComplexity val="2" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="價內外" ID="11da3ff5f71549bf86a84ca0a7bc1800" ReturnType="0" ExecType="1" Folder="/期權指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[variable:vRatio(0);

if symboltype <> 5 then 
	raiseruntimeerror("僅支援選擇權");

vRatio = iff(leftstr(getsymbolinfo("買賣權"),1)="C",1,-1)*(100*getsymbolfield("Underlying","收盤價")/getsymbolinfo("履約價")-100);

plot1(vRatio,"價內外%");]]></Code>
<Arg><![CDATA[<Arg seed="e1ea881e-68c1-4db1-8d94-43f1e72152bc" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="c2cf5be9-7d24-48c5-858e-0a78519b500e" version="0"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="0" min="-100" max="100" /></Axises><Plot name="價內外%" number="1" type="0" color="5275903" color2="5275903" style="0" weight="1" axis="0" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="," offset="0" /></Plots>]]></Plots>
<RefFunc>1,8c2d025a23c548d3a76fba10c22527b4</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="7" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{&quot;UNDERLYING&quot;:{&quot;0&quot;:[8]}}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="2" Name="分時買賣力" ID="96de4bbd77574d178e5fc8cb75454c3f" ReturnType="0" ExecType="1" Folder="/即時籌碼/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[{支援商品：台股/期貨/選擇權}

if symbolexchange <> "TW" and symbolexchange <> "TF" then raiseruntimeerror("不支援此商品");
if SymbolType <> 2 and SymbolType <> 3 and SymbolType <> 5 then raiseruntimeerror("不支援此商品");

if barfreq <> "Min" and barfreq <> "D" and barfreq <> "AD" then 
	raiseruntimeerror("僅支援分鐘與日頻率（含還原）");

value1 = GetField("外盤量");
value2 = GetField("內盤量");
value3 = value1 - value2;
plot1(value3,"買賣力");
plot2(value1,"外盤量",checkbox:=0);
plot3(value2,"內盤量",checkbox:=0);]]></Code>
<Arg><![CDATA[<Arg seed="3f1591ae-3b47-4d86-9343-c851530a5248" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="c39b431e-4523-4e35-8714-3d513f589a5d" version="1"><Axises><Axis value="1" align="0" min="-100" max="100" /><Axis value="2" align="1" min="-100" max="100" /></Axises><Plot name="買賣力" number="1" type="1" color="255" color2="65280" style="3" weight="0" axis="1" DecimalFormat="0" NumFormat="0" checkbox="-1" SetDecimalFormat="0" SetNumFormat="0" colors="," offset="0" /><Plot name="外盤量" number="2" type="0" color="16711935" color2="255" style="5" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="0" SetDecimalFormat="0" SetNumFormat="0" colors="," offset="0" /><Plot name="內盤量" number="3" type="0" color="15446382" color2="65280" style="5" weight="0" axis="0" DecimalFormat="0" NumFormat="0" checkbox="0" SetDecimalFormat="0" SetNumFormat="0" colors="," offset="0" /></Plots>]]></Plots>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="0" />
<ScriptComplexity val="11" />
<script>
<freq support="8;11" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{&quot;0&quot;:[21,20]},&quot;symbol_freq_field&quot;:{}}" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
</Scripts>
