<Scripts Version="3" AppID="DAQ" UserID="JUSTB-1008" Lang="TW" StatusMask="2">
<Script Type="3" Name="蜻蜓十字" ID="3920a4e1c2ef4e2b81572038d664f305" ReturnType="0" ExecType="1" Folder="/酒田戰法/" StatusMask="2">
<Desc><![CDATA[T形線]]></Desc>
<Code><![CDATA[{																						
[檔名:]	蜻蜓十字			[資料夾:]	酒田戰法	[適用方向]	空															
[說明:]	T形線																					
}																						
settotalbar(5);							
{判斷狀況}								
	condition1=	close>=open and open>=high					;//狀況1:	開收高同價
	condition2=	(high-low)> close *0.01					;//狀況2:	波動大於1%
{結果判斷}		
IF		
		condition1
	and	condition2
THEN	RET=1;	]]></Code>
<Arg><![CDATA[<Arg seed="eb7b129e-4f89-439f-9024-7d75d31efff8" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="742454cd-9a00-4d09-b05f-8fed80ced0c5" version="1" />]]></Plots>
<Extra><![CDATA[<Extra>
<Maxbb val="5" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="5" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="大盤MFI多頭" ID="d2f382c8a28d4861bca04972aa69ca1e" ReturnType="0" ExecType="3" Folder="/ETF策略/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[if TSEMFI=1
then ret=1;]]></Code>
<Arg><![CDATA[<Arg seed="749bbf0b-4763-4fb0-abe9-33d8400452e4" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="7915be0c-071d-411f-b5c6-d2571dd97bb8" version="1" />]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c;1,af635b0bb6c542cba712fa703b529cdf</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<FirstBarDate val="0" />
<Maxbb val="20" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="股價轉趨活躍" ID="315ea0f7cd9f46e2b8e1d7b1b8c13a9e" ReturnType="0" ExecType="3" Folder="/技術分析/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[//小型股

input:day(66);
input:ratio(10);
variable:count(0);
 
setinputname(1,"移動平均天數");
setinputname(2,"超出均值比率");

//透過Z的時間安排來決定現在用的是那一根Bar的資料 
variable: Z(0);
if GetFieldDate("主力買賣超張數") <> 0 then
	Z=0 
else 
	Z=1;
	
value1=GetField("總成交次數");
value2=average(value1,day);
value3=GetField("強弱指標")[Z];
value4=average(value3,day);
value5=GetField("外盤均量")[Z];
value6=average(value5,day);
value7=GetField("主動買力")[Z];
value8=average(value7,day);
value9=GetField("開盤委買");
value10=average(value9,day);
count=0;
if value1>=value2*(1+ratio/100)
then count=count+1;
if value3>=value4*(1+ratio/100)
then count=count+1;
if value5>=value6*(1+ratio/100)
then count=count+1;
if value7>=value8*(1+ratio/100)
then count=count+1;
if value9=value10*(1+ratio/100)
then count=count+1;
 
value11=average(count,5);
value12=average(count,20);
if value11 crosses over value12
and value12<2.2
and highest(close,20)<lowest(close,20)*1.1
and tselsindex(10,8)[Z]=1
and GetField("主力買賣超張數")[Z]>100
then ret=1;]]></Code>
<Arg><![CDATA[<Arg seed="f51aadf9-8ac8-4104-a441-bf300b7f8034" version="1"><Param name="移動平均天數" varname="day" type="1" subtype="0" value="66" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="超出均值比率" varname="ratio" type="1" subtype="0" value="10" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="11d169e9-1f29-4e38-b74f-ba6753817178" version="1" />]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c;1,6850ead727a842bf883a1501d030ba98;1,61c06064ad98469db9ce30287ae4a2c8;1,2bca774c6b7549c1b0b008d2a54b288e;1,f1b429ac13b2447c909302198c18ca56;1,d80cf92ddfcc42e0a6c53ec47edebd49;1,b1f1a25bdc014e109dc92d7f9b6ef207</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<FirstBarDate val="0" />
<Maxbb val="20" />
<script>
<freq support="8;11" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="帶量跌破均線" ID="16884a9a4cd444b7812454d5ee6f3a69" ReturnType="0" ExecType="1" Folder="/技術分析/" StatusMask="2">
<Desc><![CDATA[當K棒收盤價小於設定均線時觸發提示
附帶條件: 
1.需為實體黑K 
2.需帶量]]></Desc>
<Code><![CDATA[// 帶量跌破均線
//
input: Length(10), VolFactor(2);

settotalbar(3);
setbarback(Length);

SetInputName(1, "期數");
SetInputName(2, "成交量放大倍數");

if close < Average(close, Length) and  close[1] >  Average(close, Length) and
   volume > Average(volume, Length) * VolFactor 
then ret=1;  



        ]]></Code>
<Arg><![CDATA[<Arg seed="f23ae7a8-b0c2-47cd-9fda-1ce832dfc22b" version="1"><Param name="期數" varname="Length" type="1" subtype="0" value="10" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="成交量放大倍數" varname="VolFactor" type="1" subtype="0" value="2" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="599b5a3e-3ffe-4599-af92-935616a012bf" version="1" />]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c</RefFunc>
<Extra><![CDATA[<Extra>
<Maxbb val="10" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
<IsScriptSetBB val="1" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="60分鐘線九連陽" ID="573ce9613af2442596e362273fe1b61d" ReturnType="0" ExecType="1" Folder="/波段操作型/" StatusMask="2">
<Desc><![CDATA[60分鐘線連九紅上漲]]></Desc>
<Code><![CDATA[input:TXT("僅適用60分鐘線"); setinputname(1,"使用限制");

settotalbar(10);

if barfreq<> "Min" or barinterval <> 60 then return;

if TrueAll(Close > Close[1] and Close > Open ,9) then Ret=1;
]]></Code>
<Arg><![CDATA[<Arg seed="53b11ed8-a791-45a6-91f4-a30bf15d6a55" version="1"><Param name="使用限制" varname="TXT" type="3" subtype="0" value="僅適用60分鐘線" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="3198fa13-a046-4896-b18f-6ab8314b7149" version="1" />]]></Plots>
<RefFunc>1,93ec7a47222349e7ba8a2257d29196e4</RefFunc>
<Extra><![CDATA[<Extra>
<Maxbb val="10" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="10" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="當日跌幅預警" ID="834e302f3f97478fae7e674854ae8f97" ReturnType="0" ExecType="1" Folder="/價量指標/" StatusMask="2">
<Desc><![CDATA[當日跌幅大於設定幅度時觸發

        ]]></Desc>
<Code><![CDATA[input:AlertChangeRatio(3); setinputname(1,"預警幅度%");
settotalbar(3);
If q_PriceChangeRatio < AlertChangeRatio*-1 Then ret = 1;
        
        ]]></Code>
<Arg><![CDATA[<Arg seed="013d86bb-ea5e-4efb-b263-bc95cfc74c7b" version="1"><Param name="預警幅度%" varname="AlertChangeRatio" type="1" subtype="0" value="3" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="864d7bfb-a549-4e83-9201-eccfaaf31e92" version="1" />]]></Plots>
<Extra><![CDATA[<Extra>
<Maxbb val="3" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="投信外資都賣超" ID="20a7d6d8df424fdf96aa1e0dca436f61" ReturnType="0" ExecType="1" Folder="/3.出場常用警示/" StatusMask="2">
<Desc><![CDATA[昨日外資投信賣超今日開低收低]]></Desc>
<Code><![CDATA[input:TXT("僅適用日線"); setinputname(1,"使用限制");

settotalbar(3);

if Barfreq <> "D" then return;

if Open < Close[1] and  Close < Close[1] and
   GetField("外資買賣超")[1]<0 and GetField("投信買賣超")[1]<0
then ret=1;

]]></Code>
<Arg><![CDATA[<Arg seed="e05f55d7-86dc-4beb-8d66-751debd3b9b7" version="1"><Param name="使用限制" varname="TXT" type="3" subtype="0" value="僅適用日線" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="b80cb3e1-db9b-4aee-97a2-ebcfc52bb574" version="1" />]]></Plots>
<Extra><![CDATA[<Extra>
<Maxbb val="1" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="基金投資大跌後的止跌訊號" ID="54f1a2ab8e40477181537d16cde3c9ec" ReturnType="0" ExecType="3" Folder="/ETF策略/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[if (open[2] - close[2] ) > (high[2] -low[2]) * 0.75
//前前期出黑K棒
and close[2] < close[3]-(high[3]-low[3])
//跌勢擴大
and ( close - open ) > (high -low) * 0.75
//當期收紅K棒
and close> close[2]					
//收復黑棒收盤價
and close[1] <= close[2] and close[1] < open
//前低收盤為三期低點
and close[40] > close[1]*1.05
//近四十日跌幅超過5%
then ret=1;

]]></Code>
<Arg><![CDATA[<Arg seed="d2885cf1-26bc-44d2-94c3-1df7e6c259b1" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="739e07de-c009-4ec1-b572-093adaacacbc" version="1" />]]></Plots>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<FirstBarDate val="0" />
<Maxbb val="20" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="MACD死亡交叉" ID="94f03c96b30140a9b89174a79b3402cd" ReturnType="0" ExecType="1" Folder="/技術分析/" StatusMask="2">
<Desc><![CDATA[MACD死亡交叉]]></Desc>
<Code><![CDATA[// MACD 死亡交叉 (dif向下穿越macd)
//
input: FastLength(12), SlowLength(26), MACDLength(9);
variable: difValue(0), macdValue(0), oscValue(0);

SetTotalBar((maxlist(FastLength,SlowLength,6) + MACDLength) * 3 + 8);

SetInputName(1, "DIF短期期數");
SetInputName(2, "DIF長期期數");
SetInputName(3, "MACD期數");

MACD(weightedclose(), FastLength, SlowLength, MACDLength, difValue, macdValue, oscValue);

Ret = difValue Crosses Below macdValue;



]]></Code>
<Arg><![CDATA[<Arg seed="db496ba8-a9d9-48e9-a8e0-235165964754" version="1"><Param name="DIF短期期數" varname="FastLength" type="1" subtype="0" value="12" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="DIF長期期數" varname="SlowLength" type="1" subtype="0" value="26" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="MACD期數" varname="MACDLength" type="1" subtype="0" value="9" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="cac044ab-9c0b-4c7b-a5ae-c364be0111e1" version="1" />]]></Plots>
<RefFunc>1,2549534038c6445884c25787277c86db;1,d02c45cba76f4163a048685f7bc4002b;1,8216021f4b11489b8faca5f2af7d0750;1,9dc3f19597ba44fa91524e91ca67aebd</RefFunc>
<Extra><![CDATA[<Extra>
<Maxbb val="2" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="-1" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="自營商增持收新高" ID="7c5b9f58674b488b9e44f53f02fbab0c" ReturnType="0" ExecType="1" Folder="/1.籌碼監控/" StatusMask="2">
<Desc><![CDATA[自營商近期總買超金額超過X萬後收盤創近期新高.
 需選用日線及逐筆洗價.]]></Desc>
<Code><![CDATA[input: pastDays(3); setinputname(1,"近期天數");
input: _buyAmount(3000); setinputname(2,"累積金額(萬)");
input:TXT("僅適用日線"); setinputname(3,"使用限制");

variable: SumForce(0);

if BarFreq <> "D" then return;

if close > highest(high[1],pastDays) then 
begin
	SumForce = Summation((AvgPrice * GetField("自營商買賣超")/10)[1], pastDays);

	if SumForce > _buyAmount   then ret =1;
end;


        ]]></Code>
<Arg><![CDATA[<Arg seed="2487d181-0003-4afd-9b02-24bb4170cb2e" version="1"><Param name="近期天數" varname="pastDays" type="1" subtype="0" value="3" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="累積金額(萬)" varname="_buyAmount" type="1" subtype="0" value="3000" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="使用限制" varname="TXT" type="3" subtype="0" value="僅適用日線" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="5febda27-e3d4-4f00-9551-f5139ec2922a" version="1" />]]></Plots>
<RefFunc>1,61c06064ad98469db9ce30287ae4a2c8;1,2bca774c6b7549c1b0b008d2a54b288e;1,388033a24d7843e0b867cdc134206623;1,c122bd6485c544f2bce8f374b5c7440d</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="50" />
<Maxbb val="30" />
<script>
<freq support="8;9;10;11;12;13;14;15" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="投信初介入" ID="600e49df07434be38abdce38875d2ec4" ReturnType="0" ExecType="3" Folder="/短線操作型/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input: day(30, "投信交易期間");

if GetSymbolField("TSE.TW","收盤價") > average(GetSymbolField("TSE.TW","收盤價"),10)
and Average(Volume[1], 100) >= 1000
then begin

	value1 = summation(GetField("投信買賣超")[1], day); 
	value2 = summation(volume[2], day);


	condition1 = value1 < value2 * 0.02;
	//先前投信不怎麼買這檔股票

	if getfielddate("投信買賣超") <> date then
		value99 = GetField("投信買賣超")[1]
	else
		value99 = GetField("投信買賣超");

	condition2 = value99>= volume[1] * 0.15;
	//投信開始較大買超

	condition3 = H > H[1];
	//買了股價有往上攻

	condition4 = C > C[1];
	//今天收盤有往上走

	condition5=close<close[10]*1.05;

	condition6=GetSymbolField("TSE.TW","收盤價") > average(GetSymbolField("TSE.TW","收盤價"),10);
	
	if condition1 
	and condition2 
	and condition3 
	and condition4
	and condition5 
	and condition6
	then ret=1;
 
end;


]]></Code>
<Arg><![CDATA[<Arg seed="62b8b83b-3b97-4b8d-9587-927686d9a1a0" version="1"><Param name="投信交易期間" varname="day" type="1" subtype="0" value="30" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="368dfc9b-eaaa-4f54-b641-319fb60d2dad" version="1" />]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<FirstBarDate val="0" />
<Maxbb val="20" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="平均量黃金交叉" ID="1fe89c90f2044b23b6221220be6cbd6f" ReturnType="0" ExecType="1" Folder="/波段操作型/" StatusMask="2">
<Desc><![CDATA[短期成交量穿越長期成交量]]></Desc>
<Code><![CDATA[input: shortlength(5); setinputname(1,"短均量期數");
input: Longlength(22); setinputname(2,"長均量期數");

settotalbar(8);
setbarback(maxlist(shortlength,Longlength));

variable: Longaverage(0);
variable: shortaverage(0);

Longaverage = Average(volume,Longlength);
shortaverage=Average(volume,shortlength) ;

if shortaverage crosses over  Longaverage then ret=1;  
        ]]></Code>
<Arg><![CDATA[<Arg seed="495f74b3-5a41-40d9-b364-386337e370cd" version="1"><Param name="短均量期數" varname="shortlength" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="長均量期數" varname="Longlength" type="1" subtype="0" value="22" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="f10f7a82-c46c-4d2a-8761-3c297bf47509" version="1" />]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c;1,6850ead727a842bf883a1501d030ba98</RefFunc>
<Extra><![CDATA[<Extra>
<Maxbb val="25" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="8" />
<IsScriptSetBB val="1" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="大跌後的價量背離" ID="e92cb69549db4f8a98d8ba54c538f100" ReturnType="0" ExecType="3" Folder="/ETF策略/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:period(10,"計算天數");
input:times(5,"背離次數");

if close[1]*1.2<close[40] //大跌
and countif(c>c[1] xor v>v[1],period) >= times //價漲量縮、價跌量增
and close=highest(close,period) //收近期最高
then ret=1;]]></Code>
<Arg><![CDATA[<Arg seed="31f1b2e9-ab67-4291-8ada-6cfcde70995a" version="1"><Param name="計算天數" varname="period" type="1" subtype="0" value="10" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="背離次數" varname="times" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="3836108e-c27a-44fb-8338-4acb6de0658b" version="1" />]]></Plots>
<RefFunc>1,d80cf92ddfcc42e0a6c53ec47edebd49;1,61c06064ad98469db9ce30287ae4a2c8;1,2bca774c6b7549c1b0b008d2a54b288e</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<FirstBarDate val="0" />
<Maxbb val="20" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="DMI賣出訊號" ID="c51047bd2b39428fa6aa56a57542e4d0" ReturnType="0" ExecType="3" Folder="/3.出場常用警示/" StatusMask="2">
<Desc><![CDATA[負DI穿越正DI ]]></Desc>
<Code><![CDATA[input:Length(14); setinputname(1,"計算期數");
variable: pdi(0), ndi(0), adx_value(0);

settotalbar(maxlist(Length,6) * 13 + 8);

DirectionMovement(Length, pdi, ndi, adx_value);

if pdi<pdi[1] and ndi>ndi[1] and ndi crosses over pdi
then ret=1;]]></Code>
<Arg><![CDATA[<Arg seed="4d2ace33-aae4-4ee4-9a70-ad229330513d" version="1"><Param name="計算期數" varname="Length" type="1" subtype="0" value="14" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="bf22ef4d-0a4e-49ce-92ff-23622975a5dc" version="1" />]]></Plots>
<RefFunc>1,7721dca8cc7242c09d21b782bbb59bd9;1,6850ead727a842bf883a1501d030ba98</RefFunc>
<Extra><![CDATA[<Extra>
<Maxbb val="20" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="-1" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="找起漲點的策略" ID="d06fafa021684685959293fca2b70e59" ReturnType="0" ExecType="3" Folder="/技術分析/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[Input: Length(20, "期數");
input: UpperBand(2, "通道上緣");
input: lowerband(-2,"通道下緣");
variable:Kprice(0);

//透過Z的時間安排來決定現在用的是那一根Bar的資料 
variable: Z(0);
if currenttime > 180000 
or currenttime < 083000 then 
	Z =0 
else 
	Z=1;
	
value1= bollingerband(Close, Length, UpperBand);
value2= bollingerband(Close, Length, lowerBand);
value3=value1-value2;
value4=average(close,20);
if linearregslope(value4,5)>0
and value3>average(value3,20)*1.3
and close[1]crosses over value1
and close>value1
and tselsindex(10,6)[Z]=1
then ret=1;
]]></Code>
<Arg><![CDATA[<Arg seed="e03cf3c8-0c53-4257-909c-0fe44d50ce85" version="1"><Param name="期數" varname="Length" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="通道上緣" varname="UpperBand" type="1" subtype="0" value="2" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="通道下緣" varname="lowerband" type="1" subtype="0" value="-2" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="7884e664-2ca3-45e6-8420-b579fa1ad206" version="1" />]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c;1,8c2d025a23c548d3a76fba10c22527b4;1,9c4f476d319b4f109a8dc8557099ded4;1,c1cda70a714d44999e5171fc53c95b0a;1,5f76de57dba441808c8c784d8fa54994;1,210d0786cfe340538e34c095bc2ba049;1,626e6e5c42304bbea9809d1a07ae4e01;1,6850ead727a842bf883a1501d030ba98;1,d80cf92ddfcc42e0a6c53ec47edebd49;1,b1f1a25bdc014e109dc92d7f9b6ef207</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<FirstBarDate val="0" />
<Maxbb val="20" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="一黑破n紅" ID="f1434d1c69aa4e65a2b218d28f70c529" ReturnType="0" ExecType="1" Folder="/3.出場常用警示/" StatusMask="2">
<Desc><![CDATA[ 盤中創N期新高收盤卻破N期低]]></Desc>
<Code><![CDATA[input:Length(3); setinputname(1,"計算期數");

settotalbar(Length + 3);

if high=highest(high[1],Length) and close<lowest(low[1],Length) 
then ret=1;]]></Code>
<Arg><![CDATA[<Arg seed="a37e65ed-e692-4d03-9c10-5a614274adc2" version="1"><Param name="計算期數" varname="Length" type="1" subtype="0" value="3" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="a74ae39b-884e-4a58-b912-7db0ffb16cd0" version="1" />]]></Plots>
<RefFunc>1,61c06064ad98469db9ce30287ae4a2c8;1,2bca774c6b7549c1b0b008d2a54b288e;1,f1b429ac13b2447c909302198c18ca56</RefFunc>
<Extra><![CDATA[<Extra>
<Maxbb val="5" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="-1" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="投信天天買  股價天天小漲" ID="474ca279f99d4421a9e0d3e2b6427362" ReturnType="0" ExecType="3" Folder="/技術分析/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[//中小型股  持有二十天

//透過Z的時間安排來決定現在用的是那一根Bar的資料 
variable: Z(0);
if GetFieldDate("主力買賣超張數") <> 0 then
	Z=0 
else 
	Z=1;
	
value1=GetField("投信買賣超")[Z];
value2=GetField("主力買賣超張數")[Z];
input:day(8);
if countif(value1>0,day)>=7
//八天裡至少七天投信買超
and countif(close>close[1],day)>=5
//八天裡至少五天上漲
and average(volume,10)<2000
and trueall(value2>0,3)
and tselsindex(10,8)[Z]=1

then ret=1;]]></Code>
<Arg><![CDATA[<Arg seed="3e9b92ca-5179-4156-9ec1-e014816f8d0c" version="1"><Param name="day" varname="day" type="1" subtype="0" value="8" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="497722a9-2dd7-4bd0-b306-dd2f7c971352" version="1" />]]></Plots>
<RefFunc>1,d80cf92ddfcc42e0a6c53ec47edebd49;1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c;1,93ec7a47222349e7ba8a2257d29196e4;1,b1f1a25bdc014e109dc92d7f9b6ef207</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<FirstBarDate val="0" />
<Maxbb val="20" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="翻黑" ID="9e3b20c894b0459dbf4ddae67136ab2d" ReturnType="0" ExecType="1" Folder="/2.市場常用語/" StatusMask="2">
<Desc><![CDATA[股價較前期下跌]]></Desc>
<Code><![CDATA[settotalbar(7);
if close crosses under close[1]
then ret=1;]]></Code>
<Arg><![CDATA[<Arg seed="786fcc45-fd7a-440f-b565-fe78fcc776d1" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="1e4912c7-6c5c-458e-a9c6-925b20856510" version="1" />]]></Plots>
<RefFunc>1,9dc3f19597ba44fa91524e91ca67aebd</RefFunc>
<Extra><![CDATA[<Extra>
<FirstBarDate val="0" />
<Maxbb val="6" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="7" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="低PB股的逆襲" ID="109a715f504c4d07825757071aba0112" ReturnType="0" ExecType="3" Folder="/波段操作型/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[if GetSymbolField("tse.tw","收盤價") > average(GetSymbolField("tse.tw","收盤價"),10)
then begin
	if close<12
	and H = highest(H,20)
	and close<lowest(low,20)*1.07
	and highest(h,40)>close*1.1
	then ret=1;
end;
]]></Code>
<Arg><![CDATA[<Arg seed="7b1c4b87-5cd0-4a76-be3c-bef5d7d710b1" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="bf7ddbe1-ce8f-4e56-8a28-b11ee816fe0f" version="1" />]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c;1,61c06064ad98469db9ce30287ae4a2c8;1,2bca774c6b7549c1b0b008d2a54b288e;1,f1b429ac13b2447c909302198c18ca56</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<FirstBarDate val="0" />
<Maxbb val="20" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="池塘底" ID="f37cb1bf9c414d218fdb915b19c5ce4d" ReturnType="0" ExecType="1" Folder="/A股用語/" StatusMask="2">
<Desc><![CDATA[股價在水平面之後橫向震盪，宛如崎嶇不平的池塘底部。]]></Desc>
<Code><![CDATA[input:Length(40); setinputname(1,"計算期數");
input:inter(10); setinputname(2,"選擇過去某一期");

settotalbar(8);
setbarback(maxlist(Length,inter));

value1=absvalue(close-close[inter]);
value2=value1/close;
value3=average(value2,length);//本日收盤價與前第inter日之收盤價之差的移動平均
value4=average(volume,20);

condition1 = value3<0.01;
condition2 =  close crosses above highest(high[1],length) ;
condition3 =  volume/value4>1.2;

if condition1 and condition2 and condition3 then ret=1;
]]></Code>
<Arg><![CDATA[<Arg seed="cbb1aa6a-8fd4-42c1-ad3f-d99b85c4e7e8" version="1"><Param name="計算期數" varname="Length" type="1" subtype="0" value="40" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="選擇過去某一期" varname="inter" type="1" subtype="0" value="10" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="72c79007-df45-497c-967d-e16665660e35" version="1" />]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c;1,61c06064ad98469db9ce30287ae4a2c8;1,2bca774c6b7549c1b0b008d2a54b288e;1,6850ead727a842bf883a1501d030ba98</RefFunc>
<Extra><![CDATA[<Extra>
<Maxbb val="50" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="8" />
<IsScriptSetBB val="1" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="盤整後噴出" ID="76e2dc90e798462b8f16509627f1d0e5" ReturnType="0" ExecType="1" Folder="/波段操作型/" StatusMask="2">
<Desc><![CDATA[盤整後突破區間高點]]></Desc>
<Code><![CDATA[input:Length(30); setinputname(1, "計算期間");
input:percent(2.5); setinputname(2, "設定盤整區間%");

settotalbar(9);
setbarback(Length);

value1=highest(high[1],Length);
value2=lowest(low[1],Length);

if close crosses above value1
and value1 < value2 *( 1 + percent * 0.01) //最近幾根bar的收盤價高點與低點差不到N%
then ret=1;]]></Code>
<Arg><![CDATA[<Arg seed="8104b67e-6563-45a4-b9ef-a1f04af02e8f" version="1"><Param name="計算期間" varname="Length" type="1" subtype="0" value="30" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="設定盤整區間%" varname="percent" type="1" subtype="0" value="2.5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="eb642620-6f1f-4724-b195-fcfa48355312" version="1" />]]></Plots>
<RefFunc>1,61c06064ad98469db9ce30287ae4a2c8;1,2bca774c6b7549c1b0b008d2a54b288e;1,f1b429ac13b2447c909302198c18ca56;1,6850ead727a842bf883a1501d030ba98</RefFunc>
<Extra><![CDATA[<Extra>
<Maxbb val="31" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="9" />
<IsScriptSetBB val="1" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="殺跌波型" ID="0a6d0833c6e74a569b9508e820ce77f2" ReturnType="0" ExecType="1" Folder="/A股用語/" StatusMask="2">
<Desc><![CDATA[一分鐘線黑三兵]]></Desc>
<Code><![CDATA[//黑三兵
input:TXT("請使用1分鐘線"); setinputname(1,"使用方法");

settotalbar(5);

if    ( open - close ) > (high -low) * 0.75 and 
      ( open[1] - close[1] ) > (high[1] -low[1]) * 0.75 and
      ( open[2] - close[2] ) > (high[2] -low[2]) * 0.75 and
      close < close[1] and close[1] < close[2] 
then ret=1;  ]]></Code>
<Arg><![CDATA[<Arg seed="7060a293-f994-446e-a203-ba67f7d3218b" version="1"><Param name="使用方法" varname="TXT" type="3" subtype="0" value="請使用1分鐘線" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="26c98584-5d80-4c54-ab77-82e879215806" version="1" />]]></Plots>
<Extra><![CDATA[<Extra>
<Maxbb val="3" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="5" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="法人爭下車" ID="8ad0224c35c245c28c4f563761c496b8" ReturnType="0" ExecType="3" Folder="/波段操作型/" StatusMask="2">
<Desc><![CDATA[法人賣出股]]></Desc>
<Code><![CDATA[input: ForceType(1); setinputname(1,"法人：0=合計 1=外資 2=投信 3=自營商");
input: Periods(20); setinputname(2,"計算期間");
input: Percent(5); setinputname(3,"持股減少幅度%");
input: Type(1); setinputname(4,"使用資料：0=今日、1=昨日");
input: TXT("僅適用日線逐筆洗價"); setinputname(5,"盤中使用限制");
input: TXT2("盤中無當日即時法人買賣資料"); setinputname(6,"建議使用單次洗價模式");
variable: ForcePush(0);

settotalbar(Periods + 3);

if BarFreq <> "D" or absvalue(Type) > 1 then return;

    Switch ( ForceType ) 
    Begin 
        Case 1: 
            ForcePush = Getfield("外資持股")[Type];
        Case 2: 
            ForcePush = Getfield("投信持股")[Type]; 
        Case 3: 
            ForcePush = Getfield("自營商持股")[Type]; 
        default: 
            ForcePush = Getfield("外資持股")[Type]+Getfield("投信持股")[Type]+Getfield("自營商持股")[Type];
    End; 

if currentbar <= Periods then return;

if Close < Close[1] and
   ForcePush[Type] < ForcePush[Periods+Type] * (1 - Percent * 0.01) 
then 
   ret = 1;

]]></Code>
<Arg><![CDATA[<Arg seed="194349fc-41f9-491e-8106-d65d586fa597" version="1"><Param name="法人：0=合計 1=外資 2=投信 3=自營商" varname="ForceType" type="1" subtype="0" value="1" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="計算期間" varname="Periods" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="持股減少幅度%" varname="Percent" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="使用資料：0=今日、1=昨日" varname="Type" type="1" subtype="0" value="1" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="盤中使用限制" varname="TXT" type="3" subtype="0" value="僅適用日線逐筆洗價" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="建議使用單次洗價模式" varname="TXT2" type="3" subtype="0" value="盤中無當日即時法人買賣資料" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="0fbebb4f-da01-4cb2-89bc-6c59d09e38ab" version="1" />]]></Plots>
<Extra><![CDATA[<Extra>
<Maxbb val="5" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="-1" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="外盤買氣轉強" ID="722f9328498f42ccaa9c3a8a4d340696" ReturnType="0" ExecType="3" Folder="/波段操作型/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:short1(5,"短期平均"),mid1(20,"長期平均");

//透過Z的時間安排來決定現在用的是那一根Bar的資料 
variable: Z(0);
if currenttime > 180000 
or currenttime < 083000 then 
	Z =0 
else 
	Z=1;
	
value1=GetField("內盤量");//內盤量
value2=GetField("外盤量");//外盤量
value3=value1+value2;

if value3<>0 then value4=value2/value3*100;
//外盤比重

value5=average(value4,short1);
value6=average(value4,mid1);

if close*1.4<close[90]
and value5 crosses above value6 
and value4>60
and average(volume,100)>1000
and tselsindex(10,6)[Z]=1
then ret=1;]]></Code>
<Arg><![CDATA[<Arg seed="6f57845f-11ff-4f1f-ba6d-bbbda2ae8df2" version="1"><Param name="短期平均" varname="short1" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="長期平均" varname="mid1" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="d9577c1b-68d5-4842-b8ec-ae80c55f3e66" version="1" />]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c;1,6850ead727a842bf883a1501d030ba98;1,d80cf92ddfcc42e0a6c53ec47edebd49;1,b1f1a25bdc014e109dc92d7f9b6ef207</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="300" />
<Maxbb val="50" />
<script>
<freq support="8;11" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="開盤五分鐘K線三連陽" ID="72338614d7274a51b4893728176e535a" ReturnType="0" ExecType="1" Folder="/當沖交易型/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:TXT1("僅適用5分鐘線"); setinputname(1,"使用限制");
input:TXT2("開盤前3根K棒"); setinputname(2,"使用說明:判斷規則");
settotalbar(5);
if barfreq<> "Min" or barinterval <> 5 then return;

variable:KBarOfDay(0); KBarOfDay+=1; if date<>date[1] then  KBarOfDay=1; 

if Date = CurrentDate   and
   (time[2] = 90000 or time[2] = 84500) and
   KBarOfDay = 3 and
   Close[2] > Open[2] and 
   TrueAll(Close > Open and Close > Close[1] ,2)  then Ret=1;]]></Code>
<Arg><![CDATA[<Arg seed="10a2343f-52c6-4c3a-8415-bf2957aa0d78" version="1"><Param name="使用限制" varname="TXT1" type="3" subtype="0" value="僅適用5分鐘線" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="使用說明:判斷規則" varname="TXT2" type="3" subtype="0" value="開盤前3根K棒" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="900faaa9-b2bb-4ffa-b9aa-1d40a065bfda" version="1" />]]></Plots>
<RefFunc>1,93ec7a47222349e7ba8a2257d29196e4</RefFunc>
<Extra><![CDATA[<Extra>
<Maxbb val="3" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="5" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="價值股創近年新高" ID="df99aacd27de40159dee931daee84597" ReturnType="0" ExecType="1" Folder="/技術分析/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[if close crosses over  highest(close[1],220)
then ret=1;]]></Code>
<Arg><![CDATA[<Arg seed="2860de4b-1d53-4fd9-a10f-bbd87b98254f" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="89109ca8-93a0-4107-9db9-b8cb142d213d" version="1" />]]></Plots>
<RefFunc>1,61c06064ad98469db9ce30287ae4a2c8;1,2bca774c6b7549c1b0b008d2a54b288e;1,6850ead727a842bf883a1501d030ba98</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<FirstBarDate val="0" />
<Maxbb val="20" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="BBand翻多" ID="bdca2b88b23a4fba9b16f256b147d866" ReturnType="0" ExecType="3" Folder="/ETF策略/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:Length(20,"天數");
input:Up(1,"上");
input:Down(1,"下");
input:Threshold(1,"觸發標準");

variable:up1(0),down1(0),mid1(0),bbandwidth(0);

up1 = bollingerband(Close, Length, absvalue(Up));
down1 = bollingerband(Close, Length, -1 * absvalue(Down));
mid1 = (up1 + down1) / 2;

bbandwidth = 100 * (up1 - down1) / mid1;

if bbandwidth crosses above Threshold then ret = 1;

 ]]></Code>
<Arg><![CDATA[<Arg seed="44895960-2c18-4560-ae02-a03c93215608" version="1"><Param name="天數" varname="Length" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="上" varname="Up" type="1" subtype="0" value="1" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="下" varname="Down" type="1" subtype="0" value="1" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="觸發標準" varname="Threshold" type="1" subtype="0" value="1" isSerial="1" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="205dd013-7524-4892-9003-f5e6a62aa0a5" version="1" />]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c;1,8c2d025a23c548d3a76fba10c22527b4;1,9c4f476d319b4f109a8dc8557099ded4;1,c1cda70a714d44999e5171fc53c95b0a;1,5f76de57dba441808c8c784d8fa54994;1,6850ead727a842bf883a1501d030ba98</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<FirstBarDate val="0" />
<Maxbb val="20" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="月線連兩個月收紅的小型股" ID="17821bca2bf3490bb81307aeaf50e040" ReturnType="0" ExecType="3" Folder="/波段操作型/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:TXT("僅適用日線","使用限制");

settotalbar(120);

if  GetField("總市值","D")<2000000000 //單位是元
and close<40
and getfield("close","M")[1]>getfield("close","M")[2] 
and getfield("close","M")[2]>getfield("close","M")[3]
then ret=1;
]]></Code>
<Arg><![CDATA[<Arg seed="0d6f9731-2efb-41f2-baca-d845c69422ba" version="1"><Param name="使用限制" varname="TXT" type="3" subtype="0" value="僅適用日線" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="ba6c268b-df61-4110-bfdf-7680f0f1c4f9" version="1" />]]></Plots>
<Extra><![CDATA[<Extra>
<FirstBarDate val="0" />
<Maxbb val="20" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="120" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="外資增持收新高" ID="3a0986130d5f422ea4cdde96468d4058" ReturnType="0" ExecType="1" Folder="/1.籌碼監控/" StatusMask="2">
<Desc><![CDATA[外資近期總買超金額超過X萬後收盤創近期新高.	
需選用日線及逐筆洗價.
        ]]></Desc>
<Code><![CDATA[input: pastDays(3); setinputname(1,"近期天數");
input: _buyAmount(3000); setinputname(2,"累積金額(萬)");
input:TXT("僅適用日線"); setinputname(3,"使用限制");

variable: SumForce(0);

settotalbar(pastdays + 3);

if BarFreq <> "D" then return;

if close > highest(high[1],pastDays) then 
begin
	// 過去N日外資買超金額
    //	
    SumForce = Summation((AvgPrice * GetField("外資買賣超")/10)[1], pastDays);

	if SumForce > _buyAmount   then ret =1;
end;
        ]]></Code>
<Arg><![CDATA[<Arg seed="1a9dd40c-6ef7-4165-966a-d314a29f17cd" version="1"><Param name="近期天數" varname="pastDays" type="1" subtype="0" value="3" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="累積金額(萬)" varname="_buyAmount" type="1" subtype="0" value="3000" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="使用限制" varname="TXT" type="3" subtype="0" value="僅適用日線" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="60dfb28f-4831-43cb-9d79-b6a531764b0a" version="1" />]]></Plots>
<RefFunc>1,61c06064ad98469db9ce30287ae4a2c8;1,2bca774c6b7549c1b0b008d2a54b288e;1,388033a24d7843e0b867cdc134206623;1,c122bd6485c544f2bce8f374b5c7440d</RefFunc>
<Extra><![CDATA[<Extra>
<Maxbb val="25" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="-1" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="主力收集完開始拉" ID="e4f25db8c30f4cd9a3f1c0aa537fbeab" ReturnType="0" ExecType="3" Folder="/技術分析/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[//中小型股，持股20天
//漲幅3%以上
//爆大量，且一般而言會是月均量1倍以上
//主力近1日買超要相對過去的買超有成長。
//買進家數小於賣出家數

//透過Z的時間安排來決定現在用的是那一根Bar的資料 
variable: Z(0);
if GetFieldDate("主力買賣超張數") <> 0 then
	Z=0 
else 
	Z=1;
	
value1=GetField("分公司買進家數","D")[Z];
value2=GetField("分公司賣出家數","D")[Z];
value3=GetField("主力買賣超張數")[Z];
if close>close[1]*1.03
and value3>average(value3,20)
and value1<value2
and volume >2*average(volume,20)
and tselsindex(10,8)[Z]=1
then ret=1;]]></Code>
<Arg><![CDATA[<Arg seed="9effa521-0b34-4e66-884e-c1072b853996" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="7f09d0d1-88b5-4a19-8db2-5a7db4bb7e8d" version="1" />]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c;1,d80cf92ddfcc42e0a6c53ec47edebd49;1,b1f1a25bdc014e109dc92d7f9b6ef207</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<FirstBarDate val="0" />
<Maxbb val="20" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="大跌後均線糾結後上漲" ID="d884483155b04da79a21ca50b43ca3c8" ReturnType="0" ExecType="3" Folder="/抄底策略/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input: s1(5,"短期均線期數");
input: s2(10,"中期均線期數");
input: s3(20,"長期均線期數");
input: Percent(2,"均線糾結區間%");
input: Volpercent(25,"放量幅度%");//帶量突破的量是超過最長期的均量多少%

variable: Shortaverage(0);
variable: Midaverage(0);
variable: Longaverage(0);

if volume > average(volume,s3) * (1 + volpercent * 0.01)
//放量25%
and lowest(volume,s3)<1000
//區間最低量小於一千張
and volume>2000
//今日成交量突破2000張
then begin
	Shortaverage = average(close,s1);
	Midaverage = average(close,s2);
	Longaverage = average(close,s3);
	value1= maxlist(Shortaverage,Midaverage,Longaverage) - minlist(Shortaverage,Midaverage,Longaverage);
	
	if  value1*100 < Percent*Close
	and linearregangle(value1,5)<10
	//均線糾結在一起
	and close*1.3<close[40]
	//最近四十個交易日跌了超過三成
	then ret=1; 
end;]]></Code>
<Arg><![CDATA[<Arg seed="c556e4e8-9774-4aa1-b377-548fc244d6cd" version="1"><Param name="短期均線期數" varname="s1" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="中期均線期數" varname="s2" type="1" subtype="0" value="10" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="長期均線期數" varname="s3" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="均線糾結區間%" varname="Percent" type="1" subtype="0" value="2" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="放量幅度%" varname="Volpercent" type="1" subtype="0" value="25" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="fd7f745b-912a-42ef-b71d-f858a8212d1f" version="1" />]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c;1,61c06064ad98469db9ce30287ae4a2c8;1,f1b429ac13b2447c909302198c18ca56;1,8c2d025a23c548d3a76fba10c22527b4;1,210d0786cfe340538e34c095bc2ba049;1,7b6d505467f34b67aff3816cf394d90c</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<FirstBarDate val="0" />
<Maxbb val="20" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="陣列例子" ID="04f5f416dd8e483e87c85a410a328dbf" ReturnType="0" ExecType="1" Folder="/!語法範例/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[//陣列可以用來存放多個相同屬性的變數值，而不需重複宣告

//2.宣告變數，利用variable
variable: i(0); //用來做迴圈的
//宣告陣列，名稱ValueArray，內含100個元素，索引值從0到99，初始值為0
array:ValueArray[99](0);

//利用迴圈將陣列的每個元素填入對應的值，
//例如：把過去1~99的High指到ValueArray裡
//使得 ValueArray[1] =High[1] ,ValueArray[2] =High[2],
//     ValueArray[3] =High[3] ... ValueArray[99] =High[99]
for  i = 1 to 99
begin
	ValueArray[i] = High[i] ;
end;

//陣列可以透過內建函數做運算
//如果要全部加總
value1 = Array_Sum(ValueArray,1,99);
//或是從第 7個加到第20個
value1 = Array_Sum(ValueArray,7,20);

//6.設定警示條件：if.. then ret=1;
if value1 >= close * 14
then ret=1;
]]></Code>
<Arg><![CDATA[<Arg seed="2dd4b24e-183b-48f0-b2e6-020544dc6445" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="c5fc4763-02bd-4bf3-bc4e-3627b444ca0d" version="1" />]]></Plots>
<Extra><![CDATA[<Extra>
<TotalBar val="300" />
<Maxbb val="150" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="法人作多股" ID="e44c6d2fd6f94cc186ea09b4bd70b865" ReturnType="0" ExecType="1" Folder="/波段操作型/" StatusMask="2">
<Desc><![CDATA[法人作多股]]></Desc>
<Code><![CDATA[input: ForceType(1); setinputname(1,"1:外資 2:投信 3:自營");
input: Atleast(1000); setinputname(2,"最少買超張數");
input:TXT("須逐筆洗價"); setinputname(3,"使用限制:日線");

settotalbar(3);

if barfreq <> "D" then return;

variable: ForcePush(0);
Switch ( ForceType ) 
Begin 
Case 1: ForcePush =Getfield("外資買賣超")[1];
Case 2: ForcePush =Getfield("投信買賣超")[1];
Case 3: ForcePush =Getfield("自營商買賣超")[1]; 
End; 

if  volume > volume[1] then 
begin
      condition1 = ( close[1]-open[1]  > 0.75 *high[1]-low[1] )  and //長紅棒
                   (high[1] -low[1]) > 2 *( high[2]-low[2]);      

      if condition1 and q_Ask > highest(high[1],3) and ForcePush >Atleast then ret=1;
end;

]]></Code>
<Arg><![CDATA[<Arg seed="c3473031-271b-49d1-b2d1-6815224d11dd" version="1"><Param name="1:外資 2:投信 3:自營" varname="ForceType" type="1" subtype="0" value="1" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="最少買超張數" varname="Atleast" type="1" subtype="0" value="1000" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="使用限制:日線" varname="TXT" type="3" subtype="0" value="須逐筆洗價" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="1a2db3b6-5235-412b-aec9-51f00c2c6858" version="1" />]]></Plots>
<RefFunc>1,61c06064ad98469db9ce30287ae4a2c8;1,2bca774c6b7549c1b0b008d2a54b288e</RefFunc>
<Extra><![CDATA[<Extra>
<Maxbb val="5" />
<script>
<freq support="8;11;9;12;10;13;14;15" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="開高後不拉回" ID="df0cd2f4fe7a4eca8a3330c7a42d12bb" ReturnType="0" ExecType="1" Folder="/當沖交易型/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:Ratio(2.5); setinputname(1,"開高幅度%");
input:aRatio(1); setinputname(2,"拉回度%上限");
input:TXT("僅適用於15分鐘以內"); setinputname(3,"使用限制");
settotalbar(3);
if barfreq ="Min" and barinterval <=15 and time <= 091500 and
   GetField("Open", "D") > GetField("RefPrice", "D") *(1+Ratio/100) and 
   Close > GetField("High", "D")* (1- aRatio/100) 
then ret=1;



]]></Code>
<Arg><![CDATA[<Arg seed="aae4a94d-6414-4649-b51f-aaf5ed8a4891" version="1"><Param name="開高幅度%" varname="Ratio" type="1" subtype="0" value="2.5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="拉回度%上限" varname="aRatio" type="1" subtype="0" value="1" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="使用限制" varname="TXT" type="3" subtype="0" value="僅適用於15分鐘以內" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="7c6d5c18-ff6a-494f-aa76-4d8ef37f7600" version="1" />]]></Plots>
<Extra><![CDATA[<Extra>
<Maxbb val="2" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="當日開盤跳空開高" ID="aedfb58fc66d438a891146d6f1936a05" ReturnType="0" ExecType="1" Folder="/價量指標/" StatusMask="2">
<Desc><![CDATA[開盤跳空開高幅度警示]]></Desc>
<Code><![CDATA[input: UseQuote(True); setinputname(1,"使用即時價欄位");
input: Gap(1.5); setinputname(2,"跳空百分比(%)");
settotalbar(3);
if UseQuote then 
	Ret = IFF(100*(GetField("Open", "D") -GetField("RefPrice", "D")) > GetField("RefPrice", "D")*Gap, 1, 0)
else 
	Ret = IFF(date <> date[1] and 100*(open - close[1]) > close[1]*Gap, 1, 0);




        ]]></Code>
<Arg><![CDATA[<Arg seed="3d789325-68f3-423e-a0b9-a3d25550abc3" version="1"><Param name="使用即時價欄位" varname="UseQuote" type="2" subtype="0" value="1" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="跳空百分比(%)" varname="Gap" type="1" subtype="0" value="1.5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="da2a3829-cb3a-44de-95bb-ebb38572de3a" version="1" />]]></Plots>
<RefFunc>1,8c2d025a23c548d3a76fba10c22527b4</RefFunc>
<Extra><![CDATA[<Extra>
<Maxbb val="3" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="海龜出場法則" ID="94c34257fa1d4a08ba06e39d4ce95d2b" ReturnType="0" ExecType="1" Folder="/3.出場常用警示/" StatusMask="2">
<Desc><![CDATA[收盤價跌破近N周低點時觸發出場
]]></Desc>
<Code><![CDATA[input:Length(10); setinputname(1,"近N週期數");
input:TXT("僅適用日線"); setinputname(2,"使用限制");

settotalbar((Length + 3)*5);

if barfreq <> "D" and barfreq <> "AD" then Return;

if close < lowest(getfield("low","W")[1],Length)//近n週最低價
then ret=1;]]></Code>
<Arg><![CDATA[<Arg seed="baccf05d-4e3a-47ba-81c3-cc89314a2285" version="1"><Param name="近N週期數" varname="Length" type="1" subtype="0" value="10" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="使用限制" varname="TXT" type="3" subtype="0" value="僅適用日線" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="4fa4db0a-434f-4034-bdab-1ea3e0507ea3" version="1" />]]></Plots>
<RefFunc>1,61c06064ad98469db9ce30287ae4a2c8;1,f1b429ac13b2447c909302198c18ca56</RefFunc>
<Extra><![CDATA[<Extra>
<Maxbb val="10" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="-1" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="開低不反彈再創新低" ID="6d7c71dd525d4cf08880d77f3ec2c336" ReturnType="0" ExecType="1" Folder="/當沖交易型/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[if barfreq <>"Min" or barinterval<> 1 then raiseruntimeerror("本腳本只適用於1分鐘線");

variable:count(0);

if date<>date[1] then count=0;
count=count+1;
  
if GetField("開盤價","D")*1.025< GetField("收盤價","D")[1] 
and count>10
and lowest(low[1],count-1)*1.015>highest(high[1],count-1)
and close =lowest(low,count)
then ret=1;]]></Code>
<Arg><![CDATA[<Arg seed="cbffb5f6-3db3-49c8-a933-d9ea78cb6366" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="bc36a3dd-636e-4010-9420-be48a98c8b0e" version="1" />]]></Plots>
<RefFunc>1,61c06064ad98469db9ce30287ae4a2c8;1,f1b429ac13b2447c909302198c18ca56;1,2bca774c6b7549c1b0b008d2a54b288e</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<FirstBarDate val="0" />
<Maxbb val="20" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="竭盡缺口" ID="c827ccb01bd445f88061bd0fa5cb86be" ReturnType="0" ExecType="1" Folder="/3.出場常用警示/" StatusMask="2">
<Desc><![CDATA[累積上漲幅度到一定程度後,連續跳空再跳空]]></Desc>
<Code><![CDATA[input:Length(50); setinputname(1,"計算漲幅的區間");
input:Ratio(30); setinputname(2,"區間累計上漲幅度%");
input:OpenGapRatio(2); setinputname(3,"今日跳空上漲幅度%");
input:TXT("建議使用日線"); setinputname(4,"使用說明");

settotalbar(Length + 3);

if close / lowest(close,Length) >= 1+Ratio/100//區間漲幅夠大
and open[1]>close[2] //前一日已跳空
and open/close[1] >= 1+OpenGapRatio/100    //今天又跳空
then ret=1;]]></Code>
<Arg><![CDATA[<Arg seed="67b53c43-9f3d-4a1a-97d4-f569f8cd72d6" version="1"><Param name="計算漲幅的區間" varname="Length" type="1" subtype="0" value="50" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="區間累計上漲幅度%" varname="Ratio" type="1" subtype="0" value="30" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="今日跳空上漲幅度%" varname="OpenGapRatio" type="1" subtype="0" value="2" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="使用說明" varname="TXT" type="3" subtype="0" value="建議使用日線" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="4f85bf47-d328-4975-9a23-b805e0365c38" version="1" />]]></Plots>
<RefFunc>1,61c06064ad98469db9ce30287ae4a2c8;1,f1b429ac13b2447c909302198c18ca56</RefFunc>
<Extra><![CDATA[<Extra>
<Maxbb val="50" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="-1" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="N期內創新高次數" ID="60405b564cab40dabb7c08ff59f03e81" ReturnType="0" ExecType="1" Folder="/2.市場常用語/" StatusMask="2">
<Desc><![CDATA[N期內創M次以上新高,當期再創高]]></Desc>
<Code><![CDATA[input:Length(10); setinputname(1,"N期內");
input:mNewHighTimes(3); setinputname(2,"創M次以上新高");
 
variable: la(Length-1); //日數與參數調整
variable: QHigh(0); Qhigh=high[la]; //含當根K棒 最左邊第一筆資料起算
variable: _outputdays(0);　　_outputdays=0; //每跟K要歸0
variable: i(0); //迴圈用數

settotalbar(Length + 3);
 
for i = 1 to la begin  
     if ( high[la-i]  > QHigh ) then
      begin
        _outputdays+=1;　　
      　QHigh = high[la-i];
     end; 
end;

if high = QHigh and _outputdays >= mNewHighTimes then ret=1;]]></Code>
<Arg><![CDATA[<Arg seed="4c12e1b0-8c76-44e9-b6d1-225843b36ee3" version="1"><Param name="N期內" varname="Length" type="1" subtype="0" value="10" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="創M次以上新高" varname="mNewHighTimes" type="1" subtype="0" value="3" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="b6629ff8-cdc9-4989-a44b-2c3f7ef7decf" version="1" />]]></Plots>
<Extra><![CDATA[<Extra>
<Maxbb val="20" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="-1" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="三根長下影線" ID="7e5d2343eeb0438ba3cf8ea1674b546b" ReturnType="0" ExecType="1" Folder="/短線操作型/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input: Percent(1.5); setinputname(1,"下影線佔股價絕對百分比");

settotalbar(5);

condition1 = (minlist(open,close)-low) > absvalue(open-close)*3; 
condition2 = minlist(open,close) > low * (100 + Percent)/100;

if trueall( condition1 and condition2, 3) then ret=1;
]]></Code>
<Arg><![CDATA[<Arg seed="edabe440-4f28-41c2-b642-76e41e3caa61" version="1"><Param name="下影線佔股價絕對百分比" varname="Percent" type="1" subtype="0" value="1.5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="4bc2703c-a310-441a-a8d6-50b7b68d5f8b" version="1" />]]></Plots>
<RefFunc>1,93ec7a47222349e7ba8a2257d29196e4</RefFunc>
<Extra><![CDATA[<Extra>
<Maxbb val="4" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="5" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="U型底" ID="f205e735642042b09353f9dc29d8da2f" ReturnType="0" ExecType="3" Folder="/技術分析/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:in1(20,"底部期數下限"),in2(0.5,"標準差放寬倍數"),in3(20,"連續下降趨勢天數");
variable:KP(0),HSV(0);
value1=standarddev(weightedclose,10,2);//計算一定期數標準差
value2=average(value1,250)*in2;//計算一年標準差
value3=average(C,5);//MA5
value4=average(C,10);//MA10
value5=average(C,20);//MA20
if value1 crosses over value2 //若標準差向上跨越一年平均標準差
then begin
	KP=0;
	HSV=0;
end;
if value1>=value2//在連續變動趨勢中
then begin
	if value1>HSV then HSV=value1;//尋找標準差最大點
	if HSV<>HSV[1] then KP=C;//將標準差最大的點之收盤價視為關鍵價
end;
condition2=value1<value2;//標準差小於年均標準差
condition3=trueall(condition2,in1);//連續20期
condition4=value4<value4[1];//MA10為下降趨勢
condition5=trueall(condition4,in3);//連續下降20期
condition7=trueall(not condition4,in3);//連續20期不下降
if not condition5 and condition5[1] then condition6=true;//若連續下降
if C crosses over KP and condition3 and trueall(condition6,round(in3/2,0))
//若收盤價突破關鍵價且期間內標準差小於年均且下降趨勢結束一段時間
then begin
	condition6=false;
	ret=1;//買進
end;


]]></Code>
<Arg><![CDATA[<Arg seed="7aefd660-af5a-4076-9661-e37bf026774f" version="1"><Param name="底部期數下限" varname="in1" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="標準差放寬倍數" varname="in2" type="1" subtype="0" value="0.5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="連續下降趨勢天數" varname="in3" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="694c4cdd-d007-42f0-b44e-f2b1225b78dc" version="1" />]]></Plots>
<RefFunc>1,2549534038c6445884c25787277c86db;1,8c2d025a23c548d3a76fba10c22527b4;1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c;1,9c4f476d319b4f109a8dc8557099ded4;1,c1cda70a714d44999e5171fc53c95b0a;1,6850ead727a842bf883a1501d030ba98;1,93ec7a47222349e7ba8a2257d29196e4</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<FirstBarDate val="0" />
<Maxbb val="20" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="天價留上影線後未開高" ID="8f0638fb532343c18f1a74264f1f64b3" ReturnType="0" ExecType="1" Folder="/3.出場常用警示/" StatusMask="2">
<Desc><![CDATA[昨日創波段新高後留上影線,今日未開足夠高處以收復]]></Desc>
<Code><![CDATA[input:Length(20); setinputname(1,"設定波段天數");
input:P1(2); setinputname(2,"設定高檔壓回百分比");
input:P2(0.5); setinputname(3,"當日開高基準百分比");
input:P3(0.5); setinputname(4,"上影線佔價格幅度%");
input:TXT("建議使用日線"); setinputname(5,"使用說明");

settotalbar(3);
setbarback(Length);

if  open - close[1] <P2/100*close[1]  and
    high[1]=highest(high,Length)  and 
	(high[1]-close[1])>= P1/100 *close[1] and
	high[1] > maxlist(open[1], close[1]) *(1+P3/100)
then  ret=1;
]]></Code>
<Arg><![CDATA[<Arg seed="3f5183c8-5741-4ad6-9748-db89d06b26d5" version="1"><Param name="設定波段天數" varname="Length" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="設定高檔壓回百分比" varname="P1" type="1" subtype="0" value="2" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="當日開高基準百分比" varname="P2" type="1" subtype="0" value="0.5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="上影線佔價格幅度%" varname="P3" type="1" subtype="0" value="0.5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="使用說明" varname="TXT" type="3" subtype="0" value="建議使用日線" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="90bd134f-c272-4019-ac86-edf9fc4764b6" version="1" />]]></Plots>
<RefFunc>1,61c06064ad98469db9ce30287ae4a2c8;1,2bca774c6b7549c1b0b008d2a54b288e</RefFunc>
<Extra><![CDATA[<Extra>
<Maxbb val="20" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
<IsScriptSetBB val="1" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="空頭母子" ID="7c72846f55c64c059774a3bddc75efff" ReturnType="0" ExecType="1" Folder="/酒田戰法/" StatusMask="2">
<Desc><![CDATA[長紅棒後 內包短黑K]]></Desc>
<Code><![CDATA[{																						
[檔名:]	空頭母子			[資料夾:]	酒田戰法	[適用方向]	空															
[說明:]	長紅棒後 內包短黑K																																									
}																													
settotalbar(5);	
{判斷狀況}								
	condition1=	( close[1] - open[1] ) > (high[1] -low[1]) * 0.8					;//狀況1:	前期實體紅棒
	condition2=	close[1]> close[2] + high[2]-low[2]					;//狀況2:	前期波動向上放大
	condition3=	( open - close )>(high -low) * 0.5					;//狀況3:	當期黑K棒
	condition4=	high[1] > high and low[1] < Low 					;//狀況4:	高不過高 低不過低 內包K棒
{結果判斷}		
IF		
		condition1
	and	condition2
	and	condition3
	and	condition4
THEN	RET=1;	]]></Code>
<Arg><![CDATA[<Arg seed="adeaba6c-d204-4f7d-bbcb-9a5f4271c628" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="b1922f35-b4ca-49e5-a2d7-e19452497c3c" version="1" />]]></Plots>
<Extra><![CDATA[<Extra>
<Maxbb val="5" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="5" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="大碗底" ID="1c9c1276dfa04cd6a3c782b4804d93c5" ReturnType="0" ExecType="3" Folder="/ETF策略/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[value1=lowestbar(low,100);
value2=lowest(low,100);
value3=highestbar(high,100);
value4=highest(high,100);
 
if value4>value2*1.15
and value3-value1>15
then begin
	if value1>15
	and value2*1.05>close[1]
	and close>close[1]*1.01
	and volume>average(volume[1],15)*1.2
	then ret=1;
end;
]]></Code>
<Arg><![CDATA[<Arg seed="fc700c3b-c689-4c2a-a281-b1e155037921" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="22c1cdfd-3d7a-4c34-b982-63641917d8bc" version="1" />]]></Plots>
<RefFunc>1,61c06064ad98469db9ce30287ae4a2c8;1,68349c444a9c43f09b19def4bddc206e;1,f1b429ac13b2447c909302198c18ca56;1,328818c303ce4aa6a307cee4c60046b3;1,2bca774c6b7549c1b0b008d2a54b288e;1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<FirstBarDate val="0" />
<Maxbb val="20" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="9.1switch...case" ID="0144e8c93bc445589fa72e42be7d8366" ReturnType="0" ExecType="3" Folder="/!語法範例/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[//透過switch..case的語法，可以在一個變數的數值不一樣時，往不同的流程進行
//例如要計算外資過去十天買超超過七天時，可以運用以下的語法來寫腳本 

//==============================範例：外資近日買超天數比例======================

//1.宣告參數：利用input宣告輸入的參數。
input:day(10);//過去幾天 
input:ratio(0.7);//外資買超的天數佔多少比例

//2.宣告變數，利用variable
value1=GetField("Fdifference");//外資買賣超
variable:count(0);
variable:xi(0);

for xi= 1 to day
begin
	//============================================
	switch(value1[xi])
	begin
		case >0:
			count=count+1;
		case <0:
			count=count;
		case 0:
			count=count;
	end;//所有case都表達完之後，最後必須加end;來表示各種數值選項已結束
	//============================================
end;

//6.設定警示條件：if.. then ret=1;
if day<>0 and count/day>=ratio
then ret=1;
]]></Code>
<Arg><![CDATA[<Arg seed="ae7aaf68-ed9c-4dc0-9bcb-a15d234555ef" version="1"><Param name="day" varname="day" type="1" subtype="0" value="10" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="ratio" varname="ratio" type="1" subtype="0" value="0.7" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="972102be-c511-4d0b-b29a-8c33b4acc298" version="1" />]]></Plots>
<Extra><![CDATA[<Extra>
<TotalBar val="20" />
<Maxbb val="10" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="帶量倒狀鎚子" ID="75ea61c4f2c14a5c8ecbf4d9c4944819" ReturnType="0" ExecType="1" Folder="/酒田戰法/" StatusMask="2">
<Desc><![CDATA[前期收長黑K棒 今期開低試圖上攻後收上影線短紅棒]]></Desc>
<Code><![CDATA[{								
[檔名:]	倒狀鎚子			[資料夾:]	酒田戰法	[適用方向]	多	
[說明:]	前期收長黑K棒 今期開低試圖上攻後收上影線短紅棒												
}														
settotalbar(5);	
{判斷狀況}								
	condition1=	( open[1] - close[1] ) >(high[1] -low[1]) * 0.75		;//狀況1:	前期出長黑K棒
	condition2=	 close[1] < close[2] - (high[2]-low[2])					;//狀況2:	前期呈波動放大下跌
	condition3=	close > open and (high -close)> (close-open) *2			;//狀況3:	收紅上影線	
	condition4 = Volume > Volume[1];									;//狀況4:	帶量
{結果判斷}		
IF		
		condition1
	and	condition2
	and	condition3
	and condition4
THEN	RET=1;	]]></Code>
<Arg><![CDATA[<Arg seed="8c9728b9-4e88-4c4b-9c0a-b3a82c554207" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="3b43be55-a6d7-4663-ac1e-0949acbd21e7" version="1" />]]></Plots>
<Extra><![CDATA[<Extra>
<Maxbb val="5" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="5" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="帶量下影線" ID="17c0e14cb98a4bbf8cdc321bbc354b6d" ReturnType="0" ExecType="1" Folder="/價量指標/" StatusMask="2">
<Desc><![CDATA[帶量下影線
        ]]></Desc>
<Code><![CDATA[settotalbar(5);
if minlist(open,close) - low > absvalue(open-close)*2 and
    Volume > Maxlist(volume[1],volume[2],volume[3]) then ret=1;
	


]]></Code>
<Arg><![CDATA[<Arg seed="27d533b8-9eac-4a41-a1d8-3c5d956c745d" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="660eb485-5a07-4035-b9cd-da007142537e" version="1" />]]></Plots>
<Extra><![CDATA[<Extra>
<Maxbb val="3" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="5" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="投信存股連拉升" ID="a527cc17339c449fa352839d69407207" ReturnType="0" ExecType="1" Folder="/1.籌碼監控/" StatusMask="2">
<Desc><![CDATA[投信持股比例創月高,股價連三漲.

需選用日線及逐筆洗價.]]></Desc>
<Code><![CDATA[input: HoldRatio(50); setinputname(1,"投信持股比例下限(%)");
input: Length(25); setinputname(2, "持股檢查區間");
input:TXT("僅適用日線"); setinputname(3,"使用限制");

settotalbar(Length + 3);

if BarFreq <> "D" then return;

if  GetField("投信持股比例")[1]> holdratio and
    GetField("投信持股比例")[1]=highest(GetField("投信持股比例")[1], Length) and
    close > close[1] and close[1] > close[2] and close[2] > close[3]
    
    then ret =1;
   
        ]]></Code>
<Arg><![CDATA[<Arg seed="436ed61b-8a18-4666-bcc1-7346a8ad1112" version="1"><Param name="投信持股比例下限(%)" varname="HoldRatio" type="1" subtype="0" value="50" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="持股檢查區間" varname="Length" type="1" subtype="0" value="25" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="使用限制" varname="TXT" type="3" subtype="0" value="僅適用日線" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="972946af-70e8-4e08-8436-230ce1885712" version="1" />]]></Plots>
<RefFunc>1,61c06064ad98469db9ce30287ae4a2c8;1,2bca774c6b7549c1b0b008d2a54b288e</RefFunc>
<Extra><![CDATA[<Extra>
<Maxbb val="25" />
<script>
<freq support="8;9;10;11;12;13;14;15" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="-1" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="分鐘暴量n%" ID="35729f536bbe49e3b3f7a73ec01e55a0" ReturnType="0" ExecType="1" Folder="/2.市場常用語/" StatusMask="2">
<Desc><![CDATA[分鐘線爆量]]></Desc>
<Code><![CDATA[input:percent(100);  setinputname(1,"量增比例%");
input:Length(200);  setinputname(2,"均量期數");
input:XLimit(True);  setinputname(3,"限制最低觸發門檻");
input:atVolume(500);  setinputname(4,"最低觸發張數");
input:TXT("建議使用分鐘線"); setinputname(5,"使用說明");

variable: AvgVolume(0);

settotalbar(Length + 3);

AvgVolume=Average(volume,Length);
if XLimit then 
begin
  if Volume > atVolume  and  volume > AvgVolume *(1+ percent/100)  then ret=1;
end
else
begin
  if Volume > Volume[1]  and  volume > AvgVolume *(1+ percent/100)  then ret=1;
end;
]]></Code>
<Arg><![CDATA[<Arg seed="e2a0489f-98b4-4c9d-9d2d-4b6af5be6290" version="1"><Param name="量增比例%" varname="percent" type="1" subtype="0" value="100" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="均量期數" varname="Length" type="1" subtype="0" value="200" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="限制最低觸發門檻" varname="XLimit" type="2" subtype="0" value="1" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="最低觸發張數" varname="atVolume" type="1" subtype="0" value="500" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="使用說明" varname="TXT" type="3" subtype="0" value="建議使用分鐘線" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="791f242a-3044-4f74-8b6e-2cf8b108c1f9" version="1" />]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c</RefFunc>
<Extra><![CDATA[<Extra>
<Maxbb val="200" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="-1" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="反常必有妖" ID="90b69952cb0e415db6b4c6c1fd583fe2" ReturnType="0" ExecType="3" Folder="/波段操作型/" StatusMask="2">
<Desc><![CDATA[波動縮小後突放大]]></Desc>
<Code><![CDATA[input:TXT("僅適用60分鐘"); setinputname(1,"使用限制");

settotalbar(30);

if barinterval <> 60  or barfreq<> "Min" then return;

if Close > close[1] * 1.02  then
begin
	value2=average(truerange,30);
	value3=average(truerange,3);
	if truerange>value3 and value3>value2 then ret=1;
end;]]></Code>
<Arg><![CDATA[<Arg seed="d332c821-a985-4876-93e5-d55dc369cd57" version="1"><Param name="使用限制" varname="TXT" type="3" subtype="0" value="僅適用60分鐘" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="bf8381a9-8376-4c2f-8b0c-977541dccd01" version="1" />]]></Plots>
<RefFunc>1,36d1fc033c6f48f8a136f9e1fdec110f;1,81394f9cf0c8469ea5f8832700aec8b7;1,9e03682196e24611b2fe326b6a56433d;1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c</RefFunc>
<Extra><![CDATA[<Extra>
<Maxbb val="30" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="30" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="emprical指標賣出訊號" ID="c4e587f8a52f43528a343db7626e45d1" ReturnType="0" ExecType="3" Folder="/出場訊號/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:period(20),delta(0.1),fraction(0.1);
variable: price(0),gamma(0),alpha(0),beta(0),BP(0),mean(0),peak(0),valley(0)
,avgpeak(0),avgvalley(0);

price=(h+l)/2;

//透過Z的時間安排來決定現在用的是那一根Bar的資料 
variable: Z(0);
if GetFieldDate("主力買賣超張數") <> 0 then
	Z=0 
else 
	Z=1;
beta=cosine(360/period);
gamma=1/cosine(720*delta/period);
alpha=gamma-squareroot(gamma*gamma-1);
BP=0.5*(1-alpha)*(price-price[2])
+beta*(1+alpha)*BP[1]-alpha*BP[2];
mean=average(bp,2*period);
peak=peak[1];
valley=valley[1];
if bp[1]>bp and bp[1]>bp[2] then peak=bp[1];
if bp[1]<bp and bp[1]<bp[2] then valley=bp[1];
avgpeak=average(peak,50);
avgvalley=average(valley,50);
value1=GetField("主力買賣超張數")[Z];
if mean crosses under avgpeak 
and trueall(value1<0,3)
then ret=1;]]></Code>
<Arg><![CDATA[<Arg seed="a7f7dee9-2740-435c-bcf3-21a9e76c4098" version="1"><Param name="period" varname="period" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="delta" varname="delta" type="1" subtype="0" value="0.1" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="fraction" varname="fraction" type="1" subtype="0" value="0.1" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="84d5cfd6-4ad3-420c-8105-8da15686dcd1" version="1" />]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c;1,9dc3f19597ba44fa91524e91ca67aebd;1,93ec7a47222349e7ba8a2257d29196e4</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<FirstBarDate val="0" />
<Maxbb val="20" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="主動性買盤大增" ID="8adbf234304e49de8740c8b3e80ed76a" ReturnType="0" ExecType="1" Folder="/當沖交易型/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:Length(20); setinputname(1,"調整型外盤均量計算期數");
input:Ratio(50); setinputname(2,"外盤量增幅度%");
input:TXT("僅適用60分鐘線"); setinputname(3,"使用限制");

settotalbar(3);
setbarback(Length);

if barfreq<> "Min" or barinterval <> 60 then return;

variable: AvgOutSideVol(0),DayOSV(0);

DayOSV = GetQuote("當日外盤量");
  
AvgOutSideVol =  averageIF( close > close[1] ,volume,Length);

switch(time)
begin
	case 90000: 
	    if C>O and DayOSV > AvgOutSideVol *(1+ Ratio/100) then ret=1;
	case 100000:
		if C>O and DayOSV/2 > AvgOutSideVol *(1+ Ratio/100) then ret=1;
	case 110000:
		if C>O and DayOSV/3 > AvgOutSideVol *(1+ Ratio/100) then ret=1;
	case 120000:
		if C>O and DayOSV/4 > AvgOutSideVol *(1+ Ratio/100) then ret=1;
end;]]></Code>
<Arg><![CDATA[<Arg seed="be238674-e0d8-4305-8afd-01c244ea32c1" version="1"><Param name="調整型外盤均量計算期數" varname="Length" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="外盤量增幅度%" varname="Ratio" type="1" subtype="0" value="50" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="使用限制" varname="TXT" type="3" subtype="0" value="僅適用60分鐘線" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="75715578-6a2a-4b1f-a7c3-1fbb4589735f" version="1" />]]></Plots>
<RefFunc>1,89f2091af8c84f7bbe02544e9b39138d</RefFunc>
<Extra><![CDATA[<Extra>
<Maxbb val="25" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
<IsScriptSetBB val="1" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="2.getfield" ID="42f5d01a861f4d2c99e18901c6a892b7" ReturnType="0" ExecType="3" Folder="/!語法範例/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[//除了一般K線的開高低收量之外，還可以透過getfield這樣的指令取得其他商品相關資訊
//例如可以讓使用者把台股特有的外資買賣超的資料拿來語法中運算
//只要在編輯器上打getfield就會列出可以使用的資料供user點選
//一樣可以透過[n]的方式來回傳前第n根的數值

//===========範例：外資連續多日買超超過1億元的語法==============================

//1.宣告參數：利用input宣告輸入的參數。
input:periods(3);//連續買超天數，預設是最近三天
input:last(10000);//單日最低買超金額，單位是萬元

//2.宣告變數，利用variable
variable:xi(1);
variable:count(0);

//4.運用函數
//利用getfield取得外資買賣超資料
value1=Getfield("外資買賣超");//取得今日外資買賣超的值，單位是張數
value1=Getfield("外資買賣超")[1];//取得昨日外資買賣超的值，單位是張數
value2=close*value1/10;//收盤價*張數為買超金額，再將單位調整成萬元
//今日盤中時,交易所並不會即時公告融資融券外資買賣超等籌碼資料
//須等到交易所公告資後後才能正確取得今日籌碼詳細資訊
//逐日計算是否滿足最低單日買超金額
for xi=1 to periods
begin
	if value2[xi]>last//單日外資買超超過最低要求數值
	then count=count+1;
end;

//6.設定警示條件：if.. then ret=1;
if count=periods and close/close[1]<1.01//count=periods代表連續n日無一日不符合條件
then ret=1;]]></Code>
<Arg><![CDATA[<Arg seed="c684683f-4047-4315-8a32-e9d92527ba57" version="1"><Param name="periods" varname="periods" type="1" subtype="0" value="3" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="last" varname="last" type="1" subtype="0" value="10000" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="827ea3e2-a358-4f98-bf94-6d0de275be8b" version="1" />]]></Plots>
<Extra><![CDATA[<Extra>
<TotalBar val="10" />
<Maxbb val="5" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="當日漲幅預警" ID="a095724efdb040d6a29fdd1f37393043" ReturnType="0" ExecType="1" Folder="/價量指標/" StatusMask="2">
<Desc><![CDATA[當日漲幅大於設定幅度時觸發

        ]]></Desc>
<Code><![CDATA[input:AlertChangeRatio(3); setinputname(1,"預警幅度%");
settotalbar(3);
If q_PriceChangeRatio > AlertChangeRatio Then ret = 1;
        
        ]]></Code>
<Arg><![CDATA[<Arg seed="f877a2c0-4e13-49cb-a4fc-5ab05b73d577" version="1"><Param name="預警幅度%" varname="AlertChangeRatio" type="1" subtype="0" value="3" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="2102cce6-bcef-47e6-b863-860161641c5b" version="1" />]]></Plots>
<Extra><![CDATA[<Extra>
<FirstBarDate val="0" />
<Maxbb val="3" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="多次到頂而突破" ID="c476f59feb7b4f8f9921e14ccce58c1d" ReturnType="0" ExecType="3" Folder="/波段操作型/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:HitTimes(3,"設定觸頂次數");
input:RangeRatio(1,"設定頭部區範圍寬度%");
input:Length(20,"計算期數");

settotalbar(300);
setbarback(100);

variable: theHigh(0); 
variable: HighLowerBound(0);  
variable: TouchRangeTimes(0);

//透過Z的時間安排來決定現在用的是那一根Bar的資料 
variable: Z(0);
if currenttime > 180000 
or currenttime < 083000 then 
	Z =0 
else 
	Z=1;
theHigh = Highest(High[1],Length);  //找到過去區間的最高點
HighLowerBound = theHigh *(100-RangeRatio)/100;  // 設為瓶頸區間上界

//回算在此區間中 進去瓶頸區的次數 
TouchRangeTimes = CountIF(High[1] > HighLowerBound, Length);
 
if  TouchRangeTimes >= HitTimes   
and close > theHigh 
and close[50]*1.2 < close[20]
and tselsindex(10,6)[Z]=1
then ret=1;

 ]]></Code>
<Arg><![CDATA[<Arg seed="0bebec9c-28ef-458f-9a0b-ed778f6156d0" version="1"><Param name="設定觸頂次數" varname="HitTimes" type="1" subtype="0" value="3" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="設定頭部區範圍寬度%" varname="RangeRatio" type="1" subtype="0" value="1" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="計算期數" varname="Length" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="efc59cc9-6883-4ed3-a4ab-986bda13e89a" version="1" />]]></Plots>
<RefFunc>1,61c06064ad98469db9ce30287ae4a2c8;1,2bca774c6b7549c1b0b008d2a54b288e;1,d80cf92ddfcc42e0a6c53ec47edebd49;1,b1f1a25bdc014e109dc92d7f9b6ef207</RefFunc>
<Extra><![CDATA[<Extra>
<Maxbb val="50" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="300" />
<IsScriptSetBB val="1" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="中長線均線糾結後突破" ID="fa24e5fc27d54f49b5907519a8c9d07d" ReturnType="0" ExecType="3" Folder="/ETF策略/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input: Shortlength(10,"短期均線期數");
input: Midlength(20,"中期均線期數");
input: Longlength(40,"長期均線期數");
input: Percent(2,"均線糾結區間%");
input: Volpercent(20,"放量幅度%");//帶量突破的量是超過最長期的均量多少%

variable: shortaverage(0);
variable: midaverage(0);
variable: Longaverage(0);

if volume > average(volume,Longlength) * (1 + volpercent * 0.01) and volume > 1000 then
begin
	shortaverage = average(close,Shortlength);
	midaverage = average(close,Midlength);
	Longaverage = average(close,Longlength);
	
	value2=  maxlist(shortaverage,midaverage,Longaverage );
	value3=  minlist(shortaverage,midaverage,Longaverage );
	
	if close crosses over value2
	and (value2-value3)*100 < Percent*close 
	then ret=1;
end;

 

]]></Code>
<Arg><![CDATA[<Arg seed="43534efb-6f4e-4015-9baa-49fd97df25e1" version="1"><Param name="短期均線期數" varname="Shortlength" type="1" subtype="0" value="10" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="中期均線期數" varname="Midlength" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="長期均線期數" varname="Longlength" type="1" subtype="0" value="40" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="均線糾結區間%" varname="Percent" type="1" subtype="0" value="2" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="放量幅度%" varname="Volpercent" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="6328054f-7922-47fc-9c10-496865dad092" version="1" />]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c;1,6850ead727a842bf883a1501d030ba98</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="300" />
<Maxbb val="50" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="9.0for(迴圈)的用法" ID="1cb092eb9e8d42628eabb7863da3a412" ReturnType="0" ExecType="1" Folder="/!語法範例/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[//迴圈是用來重複執行多次相同的敘述句

//==============================範例：開盤五分鐘創三次新高======================

variable: n(0);
variable: count(0);

if  Barinterval=1 and barfreq ="Min" then Begin  //適用於1分鐘線
//執行迴圈，檢查過去五分鐘高點過前高的次數
if time = 90500 then begin
	for n=1 to 5 begin//以下的陳述(到end;為止)，n=1執行一次，n=2執行一次，一直到n=5
		if high[n]>high[n-1]
		then count=count+1;
	end;
end;
//設定警示條件：if.. then ret=1;
if count>=3
then ret=1;
end;]]></Code>
<Arg><![CDATA[<Arg seed="d46fe09e-f54f-4d75-b755-b306a76becab" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="4d66843d-536a-47e6-a076-bd7f6e203f62" version="1" />]]></Plots>
<Extra><![CDATA[<Extra>
<TotalBar val="10" />
<Maxbb val="5" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="火箭攻擊" ID="e3405170b40d4d51a4b88d48262e43b9" ReturnType="0" ExecType="1" Folder="/A股用語/" StatusMask="2">
<Desc><![CDATA[量增收高]]></Desc>
<Code><![CDATA[settotalbar(3);
IF CLOSE >=  CLOSE[1] * 1.015 and close=high and volume>volume[1]
then ret=1;]]></Code>
<Arg><![CDATA[<Arg seed="baae2dc3-2c08-4991-ae98-2392664c717f" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="519c1eee-fed5-4f88-9168-73f0a01d6f87" version="1" />]]></Plots>
<Extra><![CDATA[<Extra>
<Maxbb val="2" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="股價穿越突破單均線" ID="bce4e7bd9589436db0549fe8cb997467" ReturnType="0" ExecType="1" Folder="/技術分析/" StatusMask="2">
<Desc><![CDATA[開盤上漲,穿越突破均線時觸發]]></Desc>
<Code><![CDATA[input: length(5); setinputname(1,"均線期數");
input: Price(Close); setinputname(2,"價格別");

settotalbar(3);
setbarback(length);

variable: avgValue(0);
avgValue = Average(Price,length);

if close > avgValue and  open < avgValue  then ret=1;  



        ]]></Code>
<Arg><![CDATA[<Arg seed="f4552833-7266-455a-8a1b-d0f2c8845ad7" version="1"><Param name="均線期數" varname="length" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="價格別" varname="Price" type="1" subtype="1" value="Close" isSerial="1" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="a1e08dab-c31a-4548-952b-e6eaf15ad2e4" version="1" />]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c</RefFunc>
<Extra><![CDATA[<Extra>
<Maxbb val="20" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
<IsScriptSetBB val="1" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="多次到頂而破" ID="7e33a110fa2e43b594f8e153c8b62626" ReturnType="0" ExecType="1" Folder="/當沖交易型/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:HitTimes(3);    setinputname(1,"設定觸頂次數");
input:RangeRatio(1);  setinputname(2,"設定頭部區範圍寬度%");
input:Length(20);     setinputname(3,"計算期數");

settotalbar(Length + 3);

variable: theHigh(0); theHigh = Highest(High[1],Length);  //找到過去其間的最高點
variable: HighLowerBound(0);  HighLowerBound = theHigh *(100-RangeRatio)/100;  // 設為瓶頸區間上界
variable: TouchRangeTimes(0); 							  //期間中進入瓶頸區間的低點次數,每跟K棒要歸0
 
//回算在此區間中 進去瓶頸區的次數 
TouchRangeTimes = CountIF(High[1] > HighLowerBound, Length);
 
if  TouchRangeTimes >= HitTimes   and  ( q_ask> theHigh or   close > theHigh) then ret=1;
 
 ]]></Code>
<Arg><![CDATA[<Arg seed="85020cf8-d86d-4029-9544-4ea3c7b669ae" version="1"><Param name="設定觸頂次數" varname="HitTimes" type="1" subtype="0" value="3" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="設定頭部區範圍寬度%" varname="RangeRatio" type="1" subtype="0" value="1" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="計算期數" varname="Length" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="43a9f61e-9589-4e08-b534-af60a3bd5479" version="1" />]]></Plots>
<RefFunc>1,61c06064ad98469db9ce30287ae4a2c8;1,2bca774c6b7549c1b0b008d2a54b288e;1,d80cf92ddfcc42e0a6c53ec47edebd49</RefFunc>
<Extra><![CDATA[<Extra>
<Maxbb val="30" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="-1" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="波動放大" ID="3efb63aaf128408ba043c41b5a5423ab" ReturnType="0" ExecType="1" Folder="/技術分析/" StatusMask="2">
<Desc><![CDATA[過去一段期波動大於特定%
以近期最高點除以最低點計算其幅度]]></Desc>
<Code><![CDATA[// 波動放大
//
input: Length(20), Percent(7);

settotalbar(3);
setbarback(Length);

SetInputName(1, "期數");
SetInputName(2, "波動幅度%");

Ret = Highest(High, Length) / Lowest(Low, Length) -1 > Percent*0.01;



        ]]></Code>
<Arg><![CDATA[<Arg seed="2a7b3d32-e7f8-45e1-8553-ef7d0cda7fdf" version="1"><Param name="期數" varname="Length" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="波動幅度%" varname="Percent" type="1" subtype="0" value="7" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="9faeb37a-9a39-464b-a0e4-c72893d95fe0" version="1" />]]></Plots>
<RefFunc>1,61c06064ad98469db9ce30287ae4a2c8;1,2bca774c6b7549c1b0b008d2a54b288e;1,f1b429ac13b2447c909302198c18ca56</RefFunc>
<Extra><![CDATA[<Extra>
<Maxbb val="20" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
<IsScriptSetBB val="1" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="RSI背離" ID="56a2bdfee21641369c7290530026ae77" ReturnType="0" ExecType="3" Folder="/技術分析/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[value1=rsi(close,12);
if linearregslope(close,6)<0
and linearregslope(value1,6)>0
and close*1.2<close[20]
then ret=1;]]></Code>
<Arg><![CDATA[<Arg seed="2a507d3a-9fc5-485d-bf37-c30ad094d814" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="76360903-0d59-45e1-aafd-427138f5d334" version="1" />]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c;1,d64c2a71d3ea43d985ca22ef62a5a8de;1,8c2d025a23c548d3a76fba10c22527b4;1,210d0786cfe340538e34c095bc2ba049;1,626e6e5c42304bbea9809d1a07ae4e01</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<FirstBarDate val="0" />
<Maxbb val="20" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="理專之雙KD向上" ID="3ca65f2c91c14c96ad8bae5cff77a4b4" ReturnType="0" ExecType="3" Folder="/ETF策略/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input: Length_D(9, "日KD期間");
input: Length_W(5, "周KD期間");

variable:rsv_d(0),kk_d(0),dd_d(0);
variable:rsv_w(0),kk_w(0),dd_w(0);

stochastic(Length_D, 3, 3, rsv_d, kk_d, dd_d);
xf_stochastic("W", Length_W, 3, 3, rsv_w, kk_w, dd_w);

condition1 = kk_d crosses above dd_d;		// 日KD crosses over
condition2 = xf_GetBoolean("W",xf_crossover("W", kk_w, dd_w),1);	// 周KD crosses over
condition3 = kk_d <= 30;							// 日K 低檔
condition4 = xf_getvalue("W", kk_w, 1) <= 50;		// 周K 低檔
ret = condition1 and condition2 and condition3 and condition4;
]]></Code>
<Arg><![CDATA[<Arg seed="a635a084-f138-4465-841e-491f3cc8b0ad" version="1"><Param name="日KD期間" varname="Length_D" type="1" subtype="0" value="9" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="周KD期間" varname="Length_W" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="0d7c1394-5e61-4d25-8861-a183d1e2ded4" version="1" />]]></Plots>
<RefFunc>1,61c06064ad98469db9ce30287ae4a2c8;1,2bca774c6b7549c1b0b008d2a54b288e;1,f1b429ac13b2447c909302198c18ca56;1,847bcd706dda4a9caf2b783e181a8e42;1,57f222578a2c4d17b2b88b65b8f28696;1,bdf6d4140e2c4954b316120de89f2d59;1,6850ead727a842bf883a1501d030ba98;1,ae592f43d76b43c589aaa0eb0e6ecb27;1,e670c01522de45efa7f74c7f3c15a061;1,066d74f514e44dc2b33d2d137adf4b34</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<FirstBarDate val="0" />
<Maxbb val="20" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="DIF-MACD由負轉正" ID="9968ed8227eb4f39b8d84f6e8a2f75bc" ReturnType="0" ExecType="1" Folder="/技術分析/" StatusMask="2">
<Desc><![CDATA[DIF-MACD由負轉正]]></Desc>
<Code><![CDATA[// DIF-MACD翻正
//
input: FastLength(12), SlowLength(26), MACDLength(9);
variable: difValue(0), macdValue(0), oscValue(0);

SetTotalBar((maxlist(FastLength,SlowLength,6) + MACDLength) * 3 + 8);

SetInputName(1, "DIF短期期數");
SetInputName(2, "DIF長期期數");
SetInputName(3, "MACD期數");

MACD(weightedclose(), FastLength, SlowLength, MACDLength, difValue, macdValue, oscValue);

Ret = oscValue Crosses Above 0;




        
        ]]></Code>
<Arg><![CDATA[<Arg seed="2472ce16-1f22-48eb-adcc-5e12a4d69f84" version="1"><Param name="DIF短期期數" varname="FastLength" type="1" subtype="0" value="12" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="DIF長期期數" varname="SlowLength" type="1" subtype="0" value="26" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="MACD期數" varname="MACDLength" type="1" subtype="0" value="9" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="29d0207f-a774-4f29-b4d8-8fb193934e59" version="1" />]]></Plots>
<RefFunc>1,2549534038c6445884c25787277c86db;1,d02c45cba76f4163a048685f7bc4002b;1,8216021f4b11489b8faca5f2af7d0750;1,6850ead727a842bf883a1501d030ba98</RefFunc>
<Extra><![CDATA[<Extra>
<Maxbb val="2" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="-1" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="領先大盤創200日新高" ID="b3aad5869ff44807ab9fc7ae5f05cb6a" ReturnType="0" ExecType="3" Folder="/波段操作型/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:period(200,"計算創新高區間");

value1=GetSymbolField("tse.tw","收盤價");
value2=highest(value1,period);//大盤區間高點

if value1<value2//大盤未過新高
and close=highest(close,period)//股價創新高
and barslast(close=highest(close,period))[1]>100
and GetSymbolField("tse.tw","收盤價")>average(GetSymbolField("tse.tw","收盤價"),10)
and average(volume,100)>1000
then ret=1;]]></Code>
<Arg><![CDATA[<Arg seed="df7b2176-b677-4afb-9ca7-9034d37f2aa4" version="1"><Param name="計算創新高區間" varname="period" type="1" subtype="0" value="200" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="b2c5d09b-8b88-4032-b45c-65734b304420" version="1" />]]></Plots>
<RefFunc>1,61c06064ad98469db9ce30287ae4a2c8;1,2bca774c6b7549c1b0b008d2a54b288e;1,80fa4d5b31cc46ff93f8c9a1551b0529;1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<FirstBarDate val="0" />
<Maxbb val="20" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="MTM往上穿過0" ID="d1049478207c43919727cea12f242134" ReturnType="0" ExecType="3" Folder="/技術分析/" StatusMask="2">
<Desc><![CDATA[MTM往上穿過0軸]]></Desc>
<Code><![CDATA[// MTM往上穿越0軸
//
Input: Length(10);

settotalbar(maxlist(Length,6) + 8);

SetInputName(1, "期數");

Ret = Momentum(Close, Length) Crosses Above 0;
   

   
        ]]></Code>
<Arg><![CDATA[<Arg seed="43dc7f0d-aae2-4318-9a38-1a508f30b69c" version="1"><Param name="期數" varname="Length" type="1" subtype="0" value="10" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="e4052f30-41ac-4de5-a08d-7f694cfd152a" version="1" />]]></Plots>
<RefFunc>1,239cb1c1f329431ea731982d8f5d94f2;1,6850ead727a842bf883a1501d030ba98</RefFunc>
<Extra><![CDATA[<Extra>
<Maxbb val="11" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="-1" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="當日累計量突破" ID="08ae0a84339942a5b21357b33d48d407" ReturnType="0" ExecType="1" Folder="/當沖交易型/" StatusMask="2">
<Desc><![CDATA[當日成交金額或成交值突破設定值]]></Desc>
<Code><![CDATA[input:VolumeThre(1000); setinputname(1,"突破量門檻");
input:AmountThre(1000); setinputname(2,"突破成交值金額門檻(萬)");
settotalbar(3);
if GetField("Volume", "D") > VolumeThre or GetField("均價")*GetField("Volume", "D")/10 > AmountThre then ret=1;
]]></Code>
<Arg><![CDATA[<Arg seed="a06f7253-aae3-42b8-ab64-fc68b9dbef56" version="1"><Param name="突破量門檻" varname="VolumeThre" type="1" subtype="0" value="1000" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="突破成交值金額門檻(萬)" varname="AmountThre" type="1" subtype="0" value="1000" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="7c4cd468-fdff-4327-b8f9-baff1c11faf4" version="1" />]]></Plots>
<Extra><![CDATA[<Extra>
<Maxbb val="1" />
<script>
<freq support="8;11" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="開低走高" ID="0d654062d44a4fb59f7b75795329fe3f" ReturnType="0" ExecType="1" Folder="/2.市場常用語/" StatusMask="2">
<Desc><![CDATA[價格開最低逐步走高]]></Desc>
<Code><![CDATA[input:OpenGap(1); setinputname(1,"開低幅度%");
input:uppercent(1);setinputname(2,"從最低點反彈上揚幅度%");

settotalbar(3);

if  GetField("Low", "D") = GetField("Open", "D") and
    GetField("Open", "D") < GetField("RefPrice", "D") * (1- OpenGap/100) and
    q_Last	> GetField("Low", "D") * (1+uppercent/100)
then ret=1;]]></Code>
<Arg><![CDATA[<Arg seed="1c22db67-f543-4156-a343-92c6ed7000a9" version="1"><Param name="開低幅度%" varname="OpenGap" type="1" subtype="0" value="1" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="從最低點反彈上揚幅度%" varname="uppercent" type="1" subtype="0" value="1" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="1458e732-88b6-42e3-8fea-4fe3e05bd1c3" version="1" />]]></Plots>
<Extra><![CDATA[<Extra>
<Maxbb val="2" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="沖擊底部" ID="598eaea449334fd0ad6724e642e9dfdb" ReturnType="0" ExecType="1" Folder="/波段操作型/" StatusMask="2">
<Desc><![CDATA[股價逐步上揚且連續下影線收腳]]></Desc>
<Code><![CDATA[input:BarPercent(75); setinputname(1,"當期回升比例");

settotalbar(3);

if q_Ask > Close[1] and high[1] > high[2] and low[1] > low[2] and close[1] > close[2] then
  if TrueAll( (close[1]-low[1])>(high[1]-low[1])*BarPercent/100 ,2) then ret=1;
]]></Code>
<Arg><![CDATA[<Arg seed="a61fd74b-eb11-4c2b-82c3-8dd8d1014353" version="1"><Param name="當期回升比例" varname="BarPercent" type="1" subtype="0" value="75" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="1d48b778-c555-49f7-8b21-d06263f80048" version="1" />]]></Plots>
<RefFunc>1,93ec7a47222349e7ba8a2257d29196e4</RefFunc>
<Extra><![CDATA[<Extra>
<Maxbb val="3" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="股價創近期新低" ID="f15115eb058a499da285deb2662ae6a8" ReturnType="0" ExecType="1" Folder="/價量指標/" StatusMask="2">
<Desc><![CDATA[收盤價跌破過去N期以來低點]]></Desc>
<Code><![CDATA[input: Price(close); setinputname(1,"比較價別");
input: Length(20); setinputname(2,"近期期數");
settotalbar(3);
setbarback(Length);
if  Price < Lowest(Low[1] ,Length) then ret=1;



]]></Code>
<Arg><![CDATA[<Arg seed="12e83c72-dc6b-44cb-8dfc-cdca0be510b4" version="1"><Param name="比較價別" varname="Price" type="1" subtype="1" value="close" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="近期期數" varname="Length" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="8d34271d-6f52-43c0-a731-650ce86f7415" version="1" />]]></Plots>
<RefFunc>1,61c06064ad98469db9ce30287ae4a2c8;1,f1b429ac13b2447c909302198c18ca56</RefFunc>
<Extra><![CDATA[<Extra>
<Maxbb val="50" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
<IsScriptSetBB val="1" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="第一次站上20週均線" ID="0d7c1061a28c4d0393aeb037d580a079" ReturnType="0" ExecType="3" Folder="/技術分析/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[if barfreq<>"W" then return;
if close crosses over average(close,20)
and barslast(close crosses over average(close,20))[1]
>20
then ret=1;]]></Code>
<Arg><![CDATA[<Arg seed="2c087118-c5f0-4c2e-bf2e-0424ae62f23a" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="dcdbc4ac-2413-4a6c-8e94-c810a08a2c5a" version="1" />]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c;1,6850ead727a842bf883a1501d030ba98;1,80fa4d5b31cc46ff93f8c9a1551b0529</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<FirstBarDate val="0" />
<Maxbb val="20" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="炒高後沒有量" ID="e016d78545b843dd882da31e0d671eaa" ReturnType="0" ExecType="1" Folder="/短線操作型/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input: Periods(120); setinputname(1,"計算期數");
input: Ratio(50);setinputname(2,"期間漲幅%");
input: Sizes(2000);setinputname(3,"五日均量量縮張數");
input:TXT1("僅適用日線"); setinputname(4,"使用限制");
input:TXT2("需選用逐筆洗價"); setinputname(5,"使用說明");
settotalbar(3);
setbarback(Periods);

if BarFreq = "D"  and currenttime>130000 and
   getfield("融資餘額張數")[1] > 2000 and //昨日融資餘額多於2000張
   getfield("融券餘額張數")[1] < 2000 and //昨日融券餘額少於2000張
   close >= close[Periods] *(1 + Ratio*0.01) and //過去半年漲幅超過五成
   average(volume[1],5) < Sizes and //五日均量低於N張
   GetQuote("DailyVolume")< 500 and //當日總量
   GetQuote("OutSize") < GetQuote("DailyVolume")*0.5 //當日外盤量小於總量一半
then ret=1;
]]></Code>
<Arg><![CDATA[<Arg seed="4b224fe4-291a-45bf-8a0e-cc378b14c9c1" version="1"><Param name="計算期數" varname="Periods" type="1" subtype="0" value="120" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="期間漲幅%" varname="Ratio" type="1" subtype="0" value="50" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="五日均量量縮張數" varname="Sizes" type="1" subtype="0" value="2000" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="使用限制" varname="TXT1" type="3" subtype="0" value="僅適用日線" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="使用說明" varname="TXT2" type="3" subtype="0" value="需選用逐筆洗價" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="dd610896-1c86-4867-99be-7d7a050764df" version="1" />]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c</RefFunc>
<Extra><![CDATA[<Extra>
<Maxbb val="130" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
<IsScriptSetBB val="1" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="外盤漲停" ID="3eb67be32e294539996a4bf9c2323577" ReturnType="0" ExecType="1" Folder="/2.市場常用語/" StatusMask="2">
<Desc><![CDATA[外盤出現漲停價]]></Desc>
<Code><![CDATA[settotalbar(3);
if GetField("漲停價", "D") = q_Ask and close <> GetField("漲停價", "D") then ret=1;]]></Code>
<Arg><![CDATA[<Arg seed="510c799f-9348-4ba5-a5bc-e4b5dfa0327a" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="75fe9e84-20c3-49aa-9231-21f32b856292" version="1" />]]></Plots>
<Extra><![CDATA[<Extra>
<Maxbb val="1" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="帶量突破糾結的均線" ID="84f55c1a15ec4b76bc492fa4a803b2db" ReturnType="0" ExecType="1" Folder="/波段操作型/" StatusMask="2">
<Desc><![CDATA[股價帶量突破糾結的均線]]></Desc>
<Code><![CDATA[input: shortlength(5); setinputname(1,"短期均線期數");
input: midlength(10); setinputname(2,"中期均線期數");
input: Longlength(20); setinputname(3,"長期均線期數");
input: Percent(2);  setinputname(4,"均線糾結區間%");
input: Volpercent(25);  setinputname(5,"放量幅度%");//帶量突破的量是超過最長期的均量多少%
variable: shortaverage(0);
variable: midaverage(0);
variable: Longaverage(0);

settotalbar(8);
setbarback(maxlist(shortlength,midlength,Longlength));


if volume > average(volume,Longlength) * (1 + volpercent * 0.01) then
begin
	shortaverage = average(close,shortlength);
	midaverage = average(close,midlength);
	Longaverage = average(close,Longlength);
	if Close crosses over maxlist(shortaverage,midaverage,Longaverage) then
	begin
		value1= absvalue(shortaverage -midaverage);
		value2= absvalue(midaverage -Longaverage);
		value3= absvalue(Longaverage -shortaverage);
		if maxlist(value1,value2,value3)*100 < Percent*Close then  ret=1;
	end;
end;]]></Code>
<Arg><![CDATA[<Arg seed="9d11a284-fdfe-4ae6-ac75-2fbfc610dc58" version="1"><Param name="短期均線期數" varname="shortlength" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="中期均線期數" varname="midlength" type="1" subtype="0" value="10" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="長期均線期數" varname="Longlength" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="均線糾結區間%" varname="Percent" type="1" subtype="0" value="2" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="放量幅度%" varname="Volpercent" type="1" subtype="0" value="25" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="f62ec333-65a0-42dc-93a2-9b4aea9e66e5" version="1" />]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c;1,6850ead727a842bf883a1501d030ba98</RefFunc>
<Extra><![CDATA[<Extra>
<Maxbb val="20" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="8" />
<IsScriptSetBB val="1" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="沿均線前進" ID="99b48d0888cd48eead4b4fb8d95353d6" ReturnType="0" ExecType="1" Folder="/波段操作型/" StatusMask="2">
<Desc><![CDATA[股價持續沿均線前進後價格突破]]></Desc>
<Code><![CDATA[//沿著均線前進
input:Length(10); setinputname(1,"計算期數");
input:FollowLength(5); setinputname(2,"貼近均線期數");
input:Ratio(2);setinputname(3,"沿均線通道幅度%");
input:LongShort(0);setinputname(4,"觸發:創新高1,創新低-1,不指定0");

settotalbar(FollowLength + 3);
setbarback(Length);

condition1= false;

switch(LongShort)
begin
case =1:
 condition1 = close > highest(high[1],Length);
case -1:
 condition1 = close < lowest(low[1],Length);
case 0:
 condition1=true;
end;


If Condition1 and 
   TrueAll(absvalue(close-average(close,Length))< Close*Ratio/100,FollowLength)
then Ret=1;]]></Code>
<Arg><![CDATA[<Arg seed="28f6c742-0923-441d-a4c0-9a3f1775858a" version="1"><Param name="計算期數" varname="Length" type="1" subtype="0" value="10" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="貼近均線期數" varname="FollowLength" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="沿均線通道幅度%" varname="Ratio" type="1" subtype="0" value="2" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="觸發:創新高1,創新低-1,不指定0" varname="LongShort" type="1" subtype="0" value="0" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="609244ee-b855-4f68-aaa8-aae81c7abe2f" version="1" />]]></Plots>
<RefFunc>1,61c06064ad98469db9ce30287ae4a2c8;1,2bca774c6b7549c1b0b008d2a54b288e;1,f1b429ac13b2447c909302198c18ca56;1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c;1,93ec7a47222349e7ba8a2257d29196e4</RefFunc>
<Extra><![CDATA[<Extra>
<Maxbb val="15" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="-1" />
<IsScriptSetBB val="1" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="連續n日開高走低收最低" ID="6857415b6aff4624a43d3ddb58bcce98" ReturnType="0" ExecType="1" Folder="/3.出場常用警示/" StatusMask="2">
<Desc><![CDATA[連續多日開高0.5%可是最終下跌且收在最低點。
]]></Desc>
<Code><![CDATA[input:Length(2); setinputname(1,"計算期數");

settotalbar(Length + 3);

if Trueall( Open > Close[1]*1.005 and Close<open and close = low , Length) then ret=1;]]></Code>
<Arg><![CDATA[<Arg seed="00813952-f9f2-4e37-a426-c541dce01e77" version="1"><Param name="計算期數" varname="Length" type="1" subtype="0" value="2" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="b1ba7385-cc06-43e1-955a-0fe8061dd82f" version="1" />]]></Plots>
<RefFunc>1,93ec7a47222349e7ba8a2257d29196e4</RefFunc>
<Extra><![CDATA[<Extra>
<Maxbb val="10" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="-1" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="賣壓很輕" ID="769528d5c4df402ebb2c6465d548ba67" ReturnType="0" ExecType="1" Folder="/當沖交易型/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:rate(20);setinputname(1,"當日內盤量佔總成交比例%");
settotalbar(8);
if {內盤量}GetField("內盤量", "D")  < GetField("Volume", "D")*(Rate/100)  and Countif(close< close[1],5) < 3
then ret=1;]]></Code>
<Arg><![CDATA[<Arg seed="047026c6-941a-4109-bd94-17c444e048c3" version="1"><Param name="當日內盤量佔總成交比例%" varname="rate" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="a593cd84-0332-423c-a1d8-6b1ea1f24aaa" version="1" />]]></Plots>
<RefFunc>1,d80cf92ddfcc42e0a6c53ec47edebd49</RefFunc>
<Extra><![CDATA[<Extra>
<Maxbb val="6" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="8" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="空頭三星" ID="0af7a79723f74db7ad7ae1de4ea3496a" ReturnType="0" ExecType="1" Folder="/酒田戰法/" StatusMask="2">
<Desc><![CDATA[開高低收A型排列]]></Desc>
<Code><![CDATA[{																						
[檔名:]	空頭三星			[資料夾:]	酒田戰法	[適用方向]	空															
[說明:]	開高低收A型排列																																										
}																												
settotalbar(5);	
{判斷狀況}								
	condition1=	open[1] > open[2] and open[1] > open					;//狀況1:	開盤價A型
	condition2=	high[1] > high[2] and high[1] > high					;//狀況2:	最高價A型
	condition3=	low[1] > low[2] and low[1] > low					;//狀況3:	最低價A型
	condition4=	close[1] > close[2] and close[1] > close					;//狀況4:	收盤價A型
{結果判斷}		
IF		
		condition1
	and	condition2
	and	condition3
	and	condition4
THEN	RET=1;	]]></Code>
<Arg><![CDATA[<Arg seed="d974c761-5467-48af-9d3a-3826dee9bf1d" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="f4ebb7b4-e851-4825-a83c-e3ef1990a1c8" version="1" />]]></Plots>
<Extra><![CDATA[<Extra>
<Maxbb val="5" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="5" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="開始有人問津" ID="2a74ce865a124f66bc26185aeb18ff5f" ReturnType="0" ExecType="3" Folder="/技術分析/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[if average(truerange/close,20)*100<3
and truerange crosses over average(truerange,20)*1.2
and average(volume,30)<600
and close>close[1]*1.025
and close<30
then ret=1;]]></Code>
<Arg><![CDATA[<Arg seed="50d5f5f4-7326-489d-8281-b179a3059bad" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="52c2e4b6-ca67-432e-a00a-44220dd7f4c2" version="1" />]]></Plots>
<RefFunc>1,36d1fc033c6f48f8a136f9e1fdec110f;1,81394f9cf0c8469ea5f8832700aec8b7;1,9e03682196e24611b2fe326b6a56433d;1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c;1,6850ead727a842bf883a1501d030ba98</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<FirstBarDate val="0" />
<Maxbb val="20" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="週線二連紅之後" ID="787295dc047a45b3b7a119df3f1b86c3" ReturnType="0" ExecType="3" Folder="/ETF策略/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[if rateofchange(close,2)[1]>0 
and rateofchange(close,2)[2]>0
and close<close[2]*1.07
and close[10]>close*1.15
then ret=1;
 
]]></Code>
<Arg><![CDATA[<Arg seed="b20d21e6-718f-4181-b49a-1db49aaad436" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="0a2cab98-b949-465a-9ea0-a66dc3a29e9a" version="1" />]]></Plots>
<RefFunc>1,c9f2641e5de0497cb352ace96f64236e</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<FirstBarDate val="0" />
<Maxbb val="20" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="高檔雙死亡交叉" ID="ecc2af877dc94cbcb074ccf22417fda0" ReturnType="0" ExecType="3" Folder="/3.出場常用警示/" StatusMask="2">
<Desc><![CDATA[股價於高檔區MA及MACD的死亡交叉]]></Desc>
<Code><![CDATA[//近三天內ma及macd都發生過死亡交叉
input: FastLength(12); SetInputName(1, "DIF短期期數");
input: SlowLength(26); SetInputName(2, "DIF長期期數");
input: MACDLength(9);  SetInputName(3, "MACD期數");
input: Shortlength(5); setinputname(4,"短期均線期數");
input: Longlength(10); setinputname(5,"長期均線期數");
input: Length(20);     setinputname(6,"設定波段區間"); 
input: Ratio(20);      setinputname(7,"設波段上漲幅度"); 
input: ReactRatio(5);  setinputname(8,"距波段高點的跌幅"); 
input:TXT("建議使用日線"); setinputname(9,"使用說明");

SetTotalBar((maxlist(FastLength,SlowLength,6) + MACDLength) * 3 + 11);

if close >= lowest(close,Length)* (1+ Ratio/100) and
   close >= (1-ReactRatio/100)*highest(close,Length) then
begin

variable: price(0);  
price  = WeightedClose();
Value1 = XAverage(price, FastLength) - XAverage(price, SlowLength);//DIF
Value2 = XAverage( Value1, MACDLength ) ;//MACD
Value3 = Value1 - Value2 ;//OSC
{===============================================================}
value4=average(close,5);
value5=average(close,10);
value6=value4-value5;
{===============================================================}

condition1 = TrueAny( value3 crosses under 0 ,3);
condition2 = TrueAny( value6 crosses under 0 ,3);

if condition1 and condition2 
then ret=1;

end;]]></Code>
<Arg><![CDATA[<Arg seed="c07dd793-f57c-43ac-b77d-e2c32729318d" version="1"><Param name="DIF短期期數" varname="FastLength" type="1" subtype="0" value="12" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="DIF長期期數" varname="SlowLength" type="1" subtype="0" value="26" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="MACD期數" varname="MACDLength" type="1" subtype="0" value="9" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="短期均線期數" varname="Shortlength" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="長期均線期數" varname="Longlength" type="1" subtype="0" value="10" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="設定波段區間" varname="Length" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="設波段上漲幅度" varname="Ratio" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="距波段高點的跌幅" varname="ReactRatio" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="使用說明" varname="TXT" type="3" subtype="0" value="建議使用日線" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="6e866893-b4a3-4ed5-8805-5c8d9ef454d9" version="1" />]]></Plots>
<RefFunc>1,61c06064ad98469db9ce30287ae4a2c8;1,f1b429ac13b2447c909302198c18ca56;1,2bca774c6b7549c1b0b008d2a54b288e;1,2549534038c6445884c25787277c86db;1,d02c45cba76f4163a048685f7bc4002b;1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c;1,9dc3f19597ba44fa91524e91ca67aebd;1,1a0d56744f5a449ba941cf1b0ca7545f</RefFunc>
<Extra><![CDATA[<Extra>
<Maxbb val="40" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="-1" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="急殺" ID="9113368ca435434786baa76d3503173b" ReturnType="0" ExecType="1" Folder="/2.市場常用語/" StatusMask="2">
<Desc><![CDATA[股價急殺]]></Desc>
<Code><![CDATA[input:P1(1.5); setinputname(1,"急殺幅度%");

settotalbar(3);

IF close < close[1]*(1-P1/100)  and close=Low and volume>volume[1]
then ret=1;]]></Code>
<Arg><![CDATA[<Arg seed="ae04ac68-8fa8-47b5-b773-8ba619f6d3ce" version="1"><Param name="急殺幅度%" varname="P1" type="1" subtype="0" value="1.5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="a496280d-7ccc-4be8-b544-b78525333563" version="1" />]]></Plots>
<Extra><![CDATA[<Extra>
<Maxbb val="2" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="多日價量背離" ID="fd308ece05884d00b761f373bdab3fc0" ReturnType="0" ExecType="1" Folder="/3.出場常用警示/" StatusMask="2">
<Desc><![CDATA[價漲量縮背離次數過多則出場]]></Desc>
<Code><![CDATA[input:Length(5); setinputname(1,"計算期數");
input:times(3);setinputname(2,"價量背離次數");
input:TXT("建議使用日線"); setinputname(3,"使用說明");

variable:count(0);

settotalbar(Length + 3);

count = CountIf(close > close[1] and volume < volume[1], Length);

if count > times then 
ret = 1;

]]></Code>
<Arg><![CDATA[<Arg seed="45758aad-86eb-4235-8379-22b07af75cb0" version="1"><Param name="計算期數" varname="Length" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="價量背離次數" varname="times" type="1" subtype="0" value="3" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="使用說明" varname="TXT" type="3" subtype="0" value="建議使用日線" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="6886768c-c397-45c8-8e62-640ee9ea3e3f" version="1" />]]></Plots>
<RefFunc>1,d80cf92ddfcc42e0a6c53ec47edebd49</RefFunc>
<Extra><![CDATA[<Extra>
<Maxbb val="6" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="-1" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="預估量破均量" ID="dc89818b330344e98885838b12b0cd5b" ReturnType="0" ExecType="3" Folder="/盤中常用/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[value1=GetField("內盤量", "D");//當日內盤量
value2=GetField("外盤量", "D");//當日外盤量
if GetField("估計量") > average(volume[1],10)*1.3
and value2>value1
then ret=1;]]></Code>
<Arg><![CDATA[<Arg seed="fc8e50d8-6aed-48b8-b975-95ad914fc44a" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="e1004bc2-746d-465e-a01f-870d53e7f6cf" version="1" />]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="300" />
<Maxbb val="50" />
<script>
<freq support="8;11" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="帶量突破均線" ID="546cb31097f64943ae7e95822670eb9e" ReturnType="0" ExecType="1" Folder="/技術分析/" StatusMask="2">
<Desc><![CDATA[當K棒收盤價大於設定均線時觸發提示
附帶條件: 
1.需為實體紅K 
2.需帶量           
]]></Desc>
<Code><![CDATA[// 帶量突破均線
//
input: Length(10), VolFactor(2);

settotalbar(3);
setbarback(Length);

SetInputName(1, "期數");
SetInputName(2, "成交量放大倍數");

if close > Average(close, Length) and  close[1] <  Average(close, Length) and
   volume > Average(volume, Length) * VolFactor 
then ret=1;  



        ]]></Code>
<Arg><![CDATA[<Arg seed="b924f787-0952-4059-82a8-fb8058d4d127" version="1"><Param name="期數" varname="Length" type="1" subtype="0" value="10" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="成交量放大倍數" varname="VolFactor" type="1" subtype="0" value="2" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="29e8a802-59f2-4ffd-854b-437dac0b4391" version="1" />]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c</RefFunc>
<Extra><![CDATA[<Extra>
<Maxbb val="10" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
<IsScriptSetBB val="1" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="跌停回頭" ID="4c22e1c74997477cb1c6320e7b8e9866" ReturnType="0" ExecType="1" Folder="/價量指標/" StatusMask="2">
<Desc><![CDATA[跌停後出現買單
        ]]></Desc>
<Code><![CDATA[settotalbar(3);
If Close[1] = GetField("跌停價", "D") And Close> GetField("跌停價", "D") Then ret = 1;
        
        ]]></Code>
<Arg><![CDATA[<Arg seed="8ed89767-0251-4648-901e-3ccf33ce9e3e" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="2efe28cc-aed8-4ac1-9c41-47669b6b78e2" version="1" />]]></Plots>
<Extra><![CDATA[<Extra>
<Maxbb val="3" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="DIF-MACD由正轉負" ID="8be2def882c541a3910ab5d191d9f288" ReturnType="0" ExecType="1" Folder="/技術分析/" StatusMask="2">
<Desc><![CDATA[DIF-MACD由正轉負]]></Desc>
<Code><![CDATA[// DIF-MACD翻負
//
input: FastLength(12), SlowLength(26), MACDLength(9);
variable: difValue(0), macdValue(0), oscValue(0);

SetTotalBar((maxlist(FastLength,SlowLength,6) + MACDLength) * 3 + 8);

SetInputName(1, "DIF短期期數");
SetInputName(2, "DIF長期期數");
SetInputName(3, "MACD期數");

MACD(weightedclose(), FastLength, SlowLength, MACDLength, difValue, macdValue, oscValue);

Ret = oscValue Crosses Below 0;




        
        ]]></Code>
<Arg><![CDATA[<Arg seed="00560419-46d2-457d-8748-853a7ca1351b" version="1"><Param name="DIF短期期數" varname="FastLength" type="1" subtype="0" value="12" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="DIF長期期數" varname="SlowLength" type="1" subtype="0" value="26" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="MACD期數" varname="MACDLength" type="1" subtype="0" value="9" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="7f0e5cdc-1299-4be6-abab-de5db2e96aac" version="1" />]]></Plots>
<RefFunc>1,2549534038c6445884c25787277c86db;1,d02c45cba76f4163a048685f7bc4002b;1,8216021f4b11489b8faca5f2af7d0750;1,9dc3f19597ba44fa91524e91ca67aebd</RefFunc>
<Extra><![CDATA[<Extra>
<Maxbb val="2" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="-1" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="帶量衝破季線" ID="445eb2864b534d9aa120cab86a8fb0da" ReturnType="0" ExecType="3" Folder="/波段操作型/" StatusMask="2">
<Desc><![CDATA[股價帶量突破季線]]></Desc>
<Code><![CDATA[//股價長期低於季線
//帶量突破季線
input: PriceLength(66); setinputname(1,"季線計算期數");
input: BelowLength(66); setinputname(2,"低於季線期數");
input: VolLength(20);  setinputname(3,"均量期數");
input: Volpercent(20);  setinputname(4,"量增幅度%");
input:TXT("建議使用日線"); setinputname(5,"使用說明");

settotalbar(BelowLength + 8);
setbarback(maxlist(PriceLength,VolLength));

variable: PriceAverage(0); PriceAverage= average(Close,PriceLength);

if Close crosses over PriceAverage and
   volume > Average(volume[1],VolLength)* (1+Volpercent/100) and
   trueall(close[1] < PriceAverage[1],  BelowLength-1) then
   ret = 1;
]]></Code>
<Arg><![CDATA[<Arg seed="43a9bbbd-34e4-497b-a22c-7ea1d587756a" version="1"><Param name="季線計算期數" varname="PriceLength" type="1" subtype="0" value="66" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="低於季線期數" varname="BelowLength" type="1" subtype="0" value="66" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="均量期數" varname="VolLength" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="量增幅度%" varname="Volpercent" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="使用說明" varname="TXT" type="3" subtype="0" value="建議使用日線" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="28ba2f8d-5288-4df6-b90d-f6ef2a4c35de" version="1" />]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c;1,6850ead727a842bf883a1501d030ba98;1,93ec7a47222349e7ba8a2257d29196e4</RefFunc>
<Extra><![CDATA[<Extra>
<Maxbb val="66" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="-1" />
<IsScriptSetBB val="1" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="除權前的逆襲" ID="5fef512364bb466ab44099d495910031" ReturnType="0" ExecType="1" Folder="/短線操作型/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:Ratio(5); setinputname(1,"逆襲上漲幅度%");
input:TXT1("僅適用日線"); setinputname(2,"使用限制");
input:TXT2("需選用逐筆洗價"); setinputname(3,"使用說明");
settotalbar(5);

if BarFreq = "D" and Close > Close[2] *(1+Ratio/100) and
   Close > Close[1] and Close[1] > Close[2]
then
begin
  if GetField("融券餘額張數")[1] = 0 and  GetField("融券餘額張數")[2] = 0 and 
     GetField("融資餘額張數")[1] >0 {推測是除權前停券} then ret=1; 
end;]]></Code>
<Arg><![CDATA[<Arg seed="a7d5f267-d6c0-42d2-8809-2762c6c655af" version="1"><Param name="逆襲上漲幅度%" varname="Ratio" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="使用限制" varname="TXT1" type="3" subtype="0" value="僅適用日線" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="使用說明" varname="TXT2" type="3" subtype="0" value="需選用逐筆洗價" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="715df00c-1307-464b-af8e-e90590d0d98e" version="1" />]]></Plots>
<Extra><![CDATA[<Extra>
<Maxbb val="4" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="5" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="漲勢加速的股票" ID="90e330801905481994c307707917f0c9" ReturnType="0" ExecType="3" Folder="/短線操作型/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:day2(5,"近期");
input:day1(10,"中期");

if angle(date[day1],date[day2])>0
and angle(date[day2],date)>angle(date[day1],date[day2])
and angle(date[day2],date)>25
and GetSymbolField("tse.tw","收盤價","W")
>average(GetSymbolField("tse.tw","收盤價","W"),13)
then ret=1;]]></Code>
<Arg><![CDATA[<Arg seed="11d3d5e5-5166-4021-9f7f-27e622990d03" version="1"><Param name="近期" varname="day2" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="中期" varname="day1" type="1" subtype="0" value="10" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="f9a26bfb-dc22-4be3-a614-89f7fe33182c" version="1" />]]></Plots>
<RefFunc>1,9b53abb05bd943c58357ecbe2cc3f51f;1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="300" />
<FirstBarDate val="0" />
<Maxbb val="50" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="低檔連n日拉尾盤" ID="632e75b34fee4f23a7947d3f8a708d81" ReturnType="0" ExecType="1" Folder="/波段操作型/" StatusMask="2">
<Desc><![CDATA[股價於底檔且近N日拉最後一盤上揚]]></Desc>
<Code><![CDATA[input:Length(3); setinputname(1,"拉尾盤日數");
input:Ratio(1); setinputname(2,"拉尾盤幅度%");
input:closetime(132500); setinputname(3,"尾盤前時間");
input:ratiotoLow(7); setinputname(4,"低檔起算漲幅%");//距離區間最低價多少%
input:daystoLow(5); setinputname(5,"距離最低價天數");//輸入區間最低價的區間是幾天
input:TXT1("最高算5天"); setinputname(6,"拉尾盤日數使用限制");
input:TXT2("限用5分鐘"); setinputname(7,"頻率限制");

settotalbar(3);
setbarback(300);

if barfreq <> "Min" or barinterval <> 5  or Length>5 or daystoLow >5 then return;

variable:i(0);
variable:TodayBars(270/barinterval);

if close >= lowest(close,daystoLow * TodayBars) *( 1 + ratiotoLow*0.01) then return;

if time >= closetime then 
begin
  for i = 0 to Length-1
  begin
	// 判斷是否拉尾盤
    if close[TodayBars*i] <= close[TodayBars*i+1] * (1+ Ratio/100) then return;
  end;
  ret=1;
end;]]></Code>
<Arg><![CDATA[<Arg seed="9fed4022-cf1a-474c-a71f-1ffa3a6d23ee" version="1"><Param name="拉尾盤日數" varname="Length" type="1" subtype="0" value="3" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="拉尾盤幅度%" varname="Ratio" type="1" subtype="0" value="1" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="尾盤前時間" varname="closetime" type="1" subtype="0" value="132500" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="低檔起算漲幅%" varname="ratiotoLow" type="1" subtype="0" value="7" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="距離最低價天數" varname="daystoLow" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="拉尾盤日數使用限制" varname="TXT1" type="3" subtype="0" value="最高算5天" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="頻率限制" varname="TXT2" type="3" subtype="0" value="限用5分鐘" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="1c10be0a-42ae-40e4-8f5a-1e8b9187e8b7" version="1" />]]></Plots>
<RefFunc>1,61c06064ad98469db9ce30287ae4a2c8;1,f1b429ac13b2447c909302198c18ca56</RefFunc>
<Extra><![CDATA[<Extra>
<Maxbb val="275" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
<IsScriptSetBB val="1" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="當日量跌破" ID="4227a50780f5449082c36ad0321772cf" ReturnType="0" ExecType="1" Folder="/價量指標/" StatusMask="2">
<Desc><![CDATA[當K棒之成交量大於設定區間成交最大量且價格跌破基準價     ]]></Desc>
<Code><![CDATA[input:initialtime(090000); setinputname(1,"起算時間HHmmss");
input:timeline(100000);   setinputname(2,"截止時間HHmmss");
settotalbar(50);
variable: intervalhighv(0);
variable: keyprice(0);

if date <> date[1] then  intervalhighv =0 ; 

if time >= initialtime and time <= timeline then
begin 
   intervalhighv = maxlist(volume,intervalhighv ); 
   keyprice =close;
end;

if volume > intervalhighv and time >timeline and
   close < keyprice  and close>=open then ret=1;  
	
	



        
        ]]></Code>
<Arg><![CDATA[<Arg seed="33e8999e-cebc-4155-9ec5-5f873e4302c8" version="1"><Param name="起算時間HHmmss" varname="initialtime" type="1" subtype="0" value="90000" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="截止時間HHmmss" varname="timeline" type="1" subtype="0" value="100000" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="d326ab5b-e984-4253-a9c1-87a39db9e8fe" version="1" />]]></Plots>
<Extra><![CDATA[<Extra>
<Maxbb val="50" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="50" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="今日高點回跌" ID="3ded5bb880024236894e4d3dfa5df5f6" ReturnType="0" ExecType="1" Folder="/價量指標/" StatusMask="2">
<Desc><![CDATA[股價由今日高點回檔幅度%]]></Desc>
<Code><![CDATA[input:HighBound(2); setinputname(1,"高點幅度%");
input:Reaction(1); setinputname(2,"回檔預警幅度%");

settotalbar(3);

if GetField("High", "D") > GetField("RefPrice", "D")*(1+0.01*HighBound) and
   Close <=  GetField("High", "D")*(1-0.01*Reaction) then
   ret = 1;
]]></Code>
<Arg><![CDATA[<Arg seed="5d569678-fbea-4e25-aa8f-854121efa448" version="1"><Param name="高點幅度%" varname="HighBound" type="1" subtype="0" value="2" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="回檔預警幅度%" varname="Reaction" type="1" subtype="0" value="1" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="261f1344-ff6b-4ab3-96d0-08513c91f0a3" version="1" />]]></Plots>
<Extra><![CDATA[<Extra>
<Maxbb val="3" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="4.if..then..else" ID="9714b94d30274a439eee955bd62f63db" ReturnType="0" ExecType="1" Folder="/!語法範例/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[//if 條件1成立 then 動作1;
//這是常用的語法，代表滿足條件1時，執行動作1
//if 條件1成立 then 動作1 else 動作2;
//這是完整的語法，除了定義滿足條件1時，執行動作1外，還定義了不滿足條件1時，需執行動作2

//=====================範例：跳空上漲超過2%=======================================

//例如我們在股價跳空上漲超過2%時希望電腦可以通知我們，我們可以編寫腳本如下：

//1.宣告參數：利用input宣告輸入的參數。
input:percent(2);//宣告一個參數叫percent，預設值為2
variable:count(0);//宣告一個叫count的變數，初始值是0

//if 條件1成立 then 動作1;
//當出現2%跳空時，變數count等於1
if open >= high[1]*(1+percent/100)
then count=1; //只到這裡，這敘述最後必須加";"

//if 條件1成立 then 動作1 else 動作2;
//當count等於1時，觸發警示；count不等於1時，不觸發警示
if count=1
then ret=1 //有else時，這邊的敘述結束時就不必加上";"
else
ret=0;

//6.設定警示條件：if.. then ret=1;
//上面的句子可以簡化如下
if open >= high[1]* (1+percent/100)
then ret=1;
]]></Code>
<Arg><![CDATA[<Arg seed="fb93f463-e50a-4902-b884-20a733267f11" version="1"><Param name="percent" varname="percent" type="1" subtype="0" value="2" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="770c55e8-3b32-4240-ab81-738b0d916ffe" version="1" />]]></Plots>
<Extra><![CDATA[<Extra>
<TotalBar val="10" />
<Maxbb val="5" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="布林通道超買訊號" ID="cbafe049806e40f3b0e0257ccb50f4a6" ReturnType="0" ExecType="1" Folder="/技術分析/" StatusMask="2">
<Desc><![CDATA[最高價突破布林通道上緣時觸發提示]]></Desc>
<Code><![CDATA[// 布林通道超買訊號
//
Input: Length(20), UpperBand(2);

settotalbar(Length + 3);

SetInputName(1, "期數");
SetInputName(2, "通道上緣");

Ret = High >= bollingerband(Close, Length, UpperBand);



]]></Code>
<Arg><![CDATA[<Arg seed="fd993d1f-792b-4506-be80-47840312b5d8" version="1"><Param name="期數" varname="Length" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="通道上緣" varname="UpperBand" type="1" subtype="0" value="2" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="6fe8eed4-5aaa-44e5-b779-0d6c626f5311" version="1" />]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c;1,8c2d025a23c548d3a76fba10c22527b4;1,9c4f476d319b4f109a8dc8557099ded4;1,c1cda70a714d44999e5171fc53c95b0a;1,5f76de57dba441808c8c784d8fa54994</RefFunc>
<Extra><![CDATA[<Extra>
<Maxbb val="20" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="-1" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="均線多頭排列" ID="44f2e845ccf04b4db6f5a9c570e1997a" ReturnType="0" ExecType="1" Folder="/波段操作型/" StatusMask="2">
<Desc><![CDATA[均線多頭排列]]></Desc>
<Code><![CDATA[input: shortlength(5,"短期均線期數");
input: midlength(10,"中期均線期數");
input: Longlength(20,"長期均線期數");
input: SuperLong(60,"超長期均線期數");
variable: shortaverage(0);
variable: midaverage(0);
variable: Longaverage(0);
variable: SuperLongaverage(0);

settotalbar(3);
setbarback(maxlist(shortlength,midlength,Longlength,SuperLong));

if Close > close[1] then
begin
 shortaverage=Average(close,shortlength);
 midaverage=Average(close,midlength) ;
 Longaverage = Average(close,Longlength); 
 SuperLongaverage = Average(close,SuperLong); 
 if  close>shortaverage and 
     shortaverage>midaverage and 
	 midaverage>Longaverage and 
	 Longaverage>SuperLongaverage
 then ret=1;
end;]]></Code>
<Arg><![CDATA[<Arg seed="19cf92e4-ffe2-43f0-bcf5-9100421126ea" version="1"><Param name="短期均線期數" varname="shortlength" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="中期均線期數" varname="midlength" type="1" subtype="0" value="10" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="長期均線期數" varname="Longlength" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="超長期均線期數" varname="SuperLong" type="1" subtype="0" value="60" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="c561e4bc-8290-463f-a8cc-d49dd949bc28" version="1" />]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c</RefFunc>
<Extra><![CDATA[<Extra>
<Maxbb val="60" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
<IsScriptSetBB val="1" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="股價穿越跌破單均線" ID="5e1de8b188674061bd8fdf63ee2abf4b" ReturnType="0" ExecType="1" Folder="/技術分析/" StatusMask="2">
<Desc><![CDATA[開盤上漲,穿越突破均線時觸發]]></Desc>
<Code><![CDATA[input: length(5); setinputname(1,"均線期數");
input: Price(Close);setinputname(2,"價格別");

settotalbar(3);
setbarback(length);

variable: avgValue(0);
avgValue = Average(Price,length);

if close < avgValue and  open > avgValue  then ret=1;  



        ]]></Code>
<Arg><![CDATA[<Arg seed="c1c5000f-90d6-4087-b205-c2b46c6c8e91" version="1"><Param name="均線期數" varname="length" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="價格別" varname="Price" type="1" subtype="1" value="Close" isSerial="1" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="55877430-0472-4b27-b2ef-7abd6752908f" version="1" />]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c</RefFunc>
<Extra><![CDATA[<Extra>
<Maxbb val="20" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
<IsScriptSetBB val="1" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="即將漲停" ID="7767e118fad34a5eb092666b39a7be79" ReturnType="0" ExecType="1" Folder="/價量指標/" StatusMask="2">
<Desc><![CDATA[股價離漲停幅度%預警]]></Desc>
<Code><![CDATA[input: Percent(1);  setinputname(1,"距離漲停百分比");

settotalbar(3);

if close > GetField("漲停價", "D")*(1-Percent/100) then ret =1;]]></Code>
<Arg><![CDATA[<Arg seed="8404c66e-c858-4eac-b0b1-37ced636fd40" version="1"><Param name="距離漲停百分比" varname="Percent" type="1" subtype="0" value="1" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="a13e9253-9592-41f7-8689-c84f183306c4" version="1" />]]></Plots>
<Extra><![CDATA[<Extra>
<Maxbb val="3" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="川上三鴉" ID="af1daf8632684a7bacb3ecc5008fc699" ReturnType="0" ExecType="1" Folder="/3.出場常用警示/" StatusMask="2">
<Desc><![CDATA[連續三下跌黑K]]></Desc>
<Code><![CDATA[settotalbar(3);
if TrueAll((open-close) > (high-low) * 0.5 and close <close[1],3) then ret=1;
             

        
        ]]></Code>
<Arg><![CDATA[<Arg seed="2b72de71-22e1-4e45-a64f-9d4d6b115d88" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="fa17723a-48ed-44b4-815e-b3f20ea7f619" version="1" />]]></Plots>
<RefFunc>1,93ec7a47222349e7ba8a2257d29196e4</RefFunc>
<Extra><![CDATA[<Extra>
<Maxbb val="5" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="翻紅" ID="d1bbdf196ee642f898974a3e2c8e6136" ReturnType="0" ExecType="1" Folder="/2.市場常用語/" StatusMask="2">
<Desc><![CDATA[股價較前期上漲]]></Desc>
<Code><![CDATA[settotalbar(7);
if close crosses over close[1]
then ret=1;]]></Code>
<Arg><![CDATA[<Arg seed="cd3913ae-4cfb-41d3-9d93-6bf41bad5181" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="f52e0e86-d7d9-4634-b383-adccaa3216c0" version="1" />]]></Plots>
<RefFunc>1,6850ead727a842bf883a1501d030ba98</RefFunc>
<Extra><![CDATA[<Extra>
<FirstBarDate val="0" />
<Maxbb val="6" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="7" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="十字線" ID="804423a5d91246dda9aad1a026f47524" ReturnType="0" ExecType="1" Folder="/酒田戰法/" StatusMask="2">
<Desc><![CDATA[K棒收十字線]]></Desc>
<Code><![CDATA[{																						
[檔名:]	十字線			[資料夾:]	酒田戰法	[適用方向]	不指定															
[說明:]	K棒收十字線																																								
}																						
settotalbar(5);					
{判斷狀況}								
	condition1=	close =open					;//狀況1:	開盤價等於收盤價
	condition2=	high>open					;//狀況2:	有漲
	condition3=	low<open					;//狀況3:	有跌
{結果判斷}		
IF		
		condition1
	and	condition2
	and	condition3
THEN	RET=1;	]]></Code>
<Arg><![CDATA[<Arg seed="39d0bb11-b23f-4e3d-95f8-c77cbfc7508f" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="734e9768-e873-438a-b37a-04b1ddcb3e0c" version="1" />]]></Plots>
<Extra><![CDATA[<Extra>
<Maxbb val="5" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="5" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="跌破均線" ID="902f63251d174229a15552f61fbff269" ReturnType="0" ExecType="1" Folder="/3.出場常用警示/" StatusMask="2">
<Desc><![CDATA[收盤價穿越跌破短中長期均線]]></Desc>
<Code><![CDATA[input: shortlength(5); setinputname(1,"短期均線期數");
input: midlength(10); setinputname(2,"中期均線期數");
input: Longlength(20); setinputname(3,"長期均線期數");

variable: shortaverage(0);
variable: midaverage(0);
variable: Longaverage(0);

settotalbar(3);
setbarback(maxlist(shortlength,midlength,Longlength));

shortaverage=Average(close,shortlength);
midaverage=Average(close,midlength) ;
Longaverage = Average(close,Longlength); 

if open > maxlist(shortaverage, midaverage, longaverage) and
   close < minlist(shortaverage, midaverage, longaverage)
then ret=1;        ]]></Code>
<Arg><![CDATA[<Arg seed="0c73c57f-7001-41ca-bead-ceedc22592f2" version="1"><Param name="短期均線期數" varname="shortlength" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="中期均線期數" varname="midlength" type="1" subtype="0" value="10" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="長期均線期數" varname="Longlength" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="26991e71-54fd-4f4e-aa26-8f5c8dc88dc0" version="1" />]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c</RefFunc>
<Extra><![CDATA[<Extra>
<Maxbb val="30" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
<IsScriptSetBB val="1" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="法人主攻漲升" ID="e6744d2ae19d4e5e9322d182587588db" ReturnType="0" ExecType="1" Folder="/1.籌碼監控/" StatusMask="2">
<Desc><![CDATA[三大法人近N日聯手買超張數大於近N日成交量X % 今日收盤價漲過昨日高點.

需選用日線及逐筆洗價.]]></Desc>
<Code><![CDATA[input: pastDays(3); setinputname(1,"計算天數");
input: _BuyRatio(25); setinputname(2,"買超佔比例(%)");
input:TXT("僅適用日線"); setinputname(3,"使用限制");

variable: SumForce(0);
variable: SumTotalVolume(0);

settotalbar(pastDays + 3);

if BarFreq <> "D" then return;

if Close > High[1] and close[1] > close[2] then
begin
	SumForce = Summation(
		(GetField("外資買賣超")+GetField("自營商買賣超")+GetField("投信買賣超"))[1], 
		pastDays);
	SumTotalVolume = Summation(Volume[1], pastDays);

	if SumForce > SumTotalVolume * _BuyRatio / 100  then ret =1;
end;
        ]]></Code>
<Arg><![CDATA[<Arg seed="547454c0-12ab-4936-8b99-90062299e6d1" version="1"><Param name="計算天數" varname="pastDays" type="1" subtype="0" value="3" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="買超佔比例(%)" varname="_BuyRatio" type="1" subtype="0" value="25" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="使用限制" varname="TXT" type="3" subtype="0" value="僅適用日線" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="66c4efdf-ffa2-463b-8b2e-bf836e9000cf" version="1" />]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d</RefFunc>
<Extra><![CDATA[<Extra>
<Maxbb val="10" />
<script>
<freq support="8;11;9;12;10;13;14;15" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="-1" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="開高走低" ID="4d348647549f4f079e063596ab7d6f0c" ReturnType="0" ExecType="1" Folder="/2.市場常用語/" StatusMask="2">
<Desc><![CDATA[價格開最高逐步走低]]></Desc>
<Code><![CDATA[input:OpenGap(1); setinputname(1,"開高幅度%");
input:Downpercent(1);setinputname(2,"從最高點回檔下跌幅度%");

settotalbar(3);

if  GetField("High", "D") = GetField("Open", "D") and
    GetField("Open", "D") > GetField("RefPrice", "D") * (1+ OpenGap/100) and
    Close < GetField("High", "D") * (1 - Downpercent/100)
then ret=1;]]></Code>
<Arg><![CDATA[<Arg seed="39ec2055-51e4-4908-85a3-60cd31aebb69" version="1"><Param name="開高幅度%" varname="OpenGap" type="1" subtype="0" value="1" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="從最高點回檔下跌幅度%" varname="Downpercent" type="1" subtype="0" value="1" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="b816e563-de06-43c7-bf4a-4129fba4ab62" version="1" />]]></Plots>
<Extra><![CDATA[<Extra>
<Maxbb val="2" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="RSI高檔背離" ID="414c4bb3ac5b44baac8a45904e3a2a09" ReturnType="0" ExecType="3" Folder="/技術分析/" StatusMask="2">
<Desc><![CDATA[RSI高檔區往下與價格趨勢背離]]></Desc>
<Code><![CDATA[// RSI由高檔區往下, 與價格趨勢背離
//
Input: RSILength(6), Threshold(80), Region(5);
variable: rsiValue(0);

settotalbar(maxlist(RSILength,6) * 8 + 8);

SetInputName(1, "期數");
SetInputName(2, "高檔值");
SetInputName(3, "日期區間");

RSIValue = RSI(Close, RSILength);
If RSIValue Crosses Below Threshold and
   RSIValue < Lowest(RSIValue, Region) and 
   Close >= Highest(Close, Region) then
	Ret = 1;


        
        ]]></Code>
<Arg><![CDATA[<Arg seed="6091fb57-70ac-47a2-9b31-88aea1629e64" version="1"><Param name="期數" varname="RSILength" type="1" subtype="0" value="6" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="高檔值" varname="Threshold" type="1" subtype="0" value="80" isSerial="1" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="日期區間" varname="Region" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="7c02515b-ed16-4ebe-922d-2881e186b4ca" version="1" />]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c;1,d64c2a71d3ea43d985ca22ef62a5a8de;1,9dc3f19597ba44fa91524e91ca67aebd;1,61c06064ad98469db9ce30287ae4a2c8;1,f1b429ac13b2447c909302198c18ca56;1,2bca774c6b7549c1b0b008d2a54b288e</RefFunc>
<Extra><![CDATA[<Extra>
<Maxbb val="7" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="-1" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="多次觸底而破 " ID="5661acce683141a9a497e1059dcdedeb" ReturnType="0" ExecType="1" Folder="/2.市場常用語/" StatusMask="2">
<Desc><![CDATA[股價多次進入低檔區後破底創新低]]></Desc>
<Code><![CDATA[input:HitTimes(3);    setinputname(1,"設定觸底次數");
input:RangeRatio(1);  setinputname(2,"設定底部區範圍寬度%");
input:Length(20);     setinputname(3,"計算期數");

settotalbar(Length + 3);
 
variable: theLow(0); theLow = lowest(low[1],Length);  //找到過去期間的最低點
variable: LowUpperBound(0);  LowUpperBound = theLow *(100+RangeRatio)/100;  // 設為瓶頸區間上界
variable: TouchRangeTimes(0); TouchRangeTimes=0;  //期間中進入瓶頸區間的低點次數,每根K棒要歸0
variable: ix(0);
 
for ix = length-1  downto 1 
begin
      if Low[ix] < LowUpperBound  then TouchRangeTimes +=1;  //回算在此區間中 進去瓶頸區的次數
end;
 
if  TouchRangeTimes >= HitTimes   and  (q_bid <theLow  or  close < theLow)  then ret=1;
 
 ]]></Code>
<Arg><![CDATA[<Arg seed="464421cd-f7d2-48ac-9525-e37d71eef1e1" version="1"><Param name="設定觸底次數" varname="HitTimes" type="1" subtype="0" value="3" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="設定底部區範圍寬度%" varname="RangeRatio" type="1" subtype="0" value="1" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="計算期數" varname="Length" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="e1641c51-97f7-48a2-ad81-f1437320e4c2" version="1" />]]></Plots>
<RefFunc>1,61c06064ad98469db9ce30287ae4a2c8;1,f1b429ac13b2447c909302198c18ca56</RefFunc>
<Extra><![CDATA[<Extra>
<Maxbb val="30" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="-1" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="當日量突破" ID="78ec0ac39ced48e0a9ded414226d6c94" ReturnType="0" ExecType="1" Folder="/價量指標/" StatusMask="2">
<Desc><![CDATA[當K棒之成交量大於設定區間成交最大量且價格突破基準價
        ]]></Desc>
<Code><![CDATA[input:initialtime(090000); setinputname(1,"起算時間HHmmss");
input:timeline(100000);   setinputname(2,"截止時間HHmmss");
settotalbar(50);
variable: intervalhighv(0);
variable: keyprice(0);

if date <> date[1] then  intervalhighv =0 ; 

if time >= initialtime and time <= timeline then
begin 
   intervalhighv = maxlist(volume,intervalhighv ); 
   keyprice =close;
end;

if volume > intervalhighv and time >timeline and
   close > keyprice  and close>=open then ret=1;  
	
	



        
        ]]></Code>
<Arg><![CDATA[<Arg seed="39e5ad1a-35a6-4c5f-8870-a14a081c6bf4" version="1"><Param name="起算時間HHmmss" varname="initialtime" type="1" subtype="0" value="90000" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="截止時間HHmmss" varname="timeline" type="1" subtype="0" value="100000" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="9abd65c7-b8cc-4a6d-b51c-b9d31381101d" version="1" />]]></Plots>
<Extra><![CDATA[<Extra>
<Maxbb val="50" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="50" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="主力認賠再追賣" ID="c669e115ef79427cb733489fc8a68c8b" ReturnType="0" ExecType="1" Folder="/1.籌碼監控/" StatusMask="2">
<Desc><![CDATA[兩週內主力大量買入但昨日反手賣出 今日續賣創新低.
需選用日線逐筆洗價.]]></Desc>
<Code><![CDATA[input:TXT("僅適用日線"); setinputname(1,"使用限制");

variable: pastDays(10);

settotalbar(15);

if BarFreq <> "D" then return;
 
if close < lowest(low[1] ,pastDays) and
   volume > volume[1]*0.5 and
   GetField("主力買賣超張數")[1] < average(volume[1],pastDays)/-7 and
   Summation(GetField("主力買賣超張數")[2],pastDays) > Average(volume[2],pastDays)/7
 then ret =1;
        
	]]></Code>
<Arg><![CDATA[<Arg seed="3d90a3ce-cc8a-4f17-a4d4-86ac0aa54ca4" version="1"><Param name="使用限制" varname="TXT" type="3" subtype="0" value="僅適用日線" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="52907096-df16-403b-81af-df1e1eec0565" version="1" />]]></Plots>
<RefFunc>1,61c06064ad98469db9ce30287ae4a2c8;1,f1b429ac13b2447c909302198c18ca56;1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c</RefFunc>
<Extra><![CDATA[<Extra>
<Maxbb val="15" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="15" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="投信拉抬上攻" ID="f91a60dbf59e465bbcf0738a784d6b5a" ReturnType="0" ExecType="1" Folder="/1.籌碼監控/" StatusMask="2">
<Desc><![CDATA[投信近N日買超張數大於近N日成交量X % 
今日價格漲過昨日高點.
需選用日線及逐筆洗價.]]></Desc>
<Code><![CDATA[input: pastDays(3); setinputname(1,"計算天數");
input: _BuyRatio(25); setinputname(2,"買超佔比例(%)");
input:TXT("僅適用日線"); setinputname(3,"使用限制");

variable: SumForce(0);
variable: SumTotalVolume(0);

settotalbar(pastDays + 3);

if BarFreq <> "D" then return;

if Close > High[1] then
begin
	SumForce = Summation(GetField("投信買賣超")[1], pastDays);
	sumTotalVolume = Summation(Volume[1], pastDays);

	if SumForce > SumTotalVolume * _BuyRatio/100 then ret =1;

end;

        ]]></Code>
<Arg><![CDATA[<Arg seed="6cc8c235-bc56-42b9-86f1-d5fb889f4b5f" version="1"><Param name="計算天數" varname="pastDays" type="1" subtype="0" value="3" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="買超佔比例(%)" varname="_BuyRatio" type="1" subtype="0" value="25" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="使用限制" varname="TXT" type="3" subtype="0" value="僅適用日線" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="0662e47a-f5c3-42d9-8533-ae31559e0616" version="1" />]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d</RefFunc>
<Extra><![CDATA[<Extra>
<Maxbb val="30" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="-1" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="乖離過大" ID="a66ff41772f24ffb8e4b8e94aa095014" ReturnType="0" ExecType="1" Folder="/3.出場常用警示/" StatusMask="2">
<Desc><![CDATA[收盤價超過均線百分比過大]]></Desc>
<Code><![CDATA[input:Length(200); setinputname(1,"計算期數");
input:Ratio(70); setinputname(2,"正向乖離門檻%");

settotalbar(Length + 3);

if close/average(close,Length)>= 1+Ratio/100
then ret=1;]]></Code>
<Arg><![CDATA[<Arg seed="fcfc7ed9-6ecf-4db5-a5de-559c792e9d5b" version="1"><Param name="計算期數" varname="Length" type="1" subtype="0" value="200" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="正向乖離門檻%" varname="Ratio" type="1" subtype="0" value="70" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="db2efc8f-e565-4d5c-9ab1-4a8dbcd4685f" version="1" />]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c</RefFunc>
<Extra><![CDATA[<Extra>
<Maxbb val="200" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="-1" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="突破糾結均線" ID="2785e332578f4246800083d9a24695b7" ReturnType="0" ExecType="3" Folder="/波段操作型/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input: shortlength(5,"短期均線期數");
input: midlength(10,"中期均線期數");
input: Longlength(20,"長期均線期數");
input: Percent(5,"均線糾結區間%");
input: XLen(20,"均線糾結期數");
input: Volpercent(25,"放量幅度%"); //帶量突破的量是超過最長期的均量多少%

variable: Shortaverage(0),Midaverage(0),Longaverage(0);
variable: AvgHLp(0),AvgH(0),AvgL(0);

//透過Z的時間安排來決定現在用的是那一根Bar的資料 
variable: Z(0);
if currenttime > 180000 
or currenttime < 083000 then 
	Z =0 
else 
	Z=1;

Shortaverage = average(close,shortlength);
Midaverage = average(close,midlength);
Longaverage = average(close,Longlength);
AvgH = maxlist(Shortaverage,Midaverage,Longaverage);
AvgL = minlist(Shortaverage,Midaverage,Longaverage);

if AvgL > 0 then AvgHLp = 100*AvgH/AvgL -100;

condition1 = trueAll(AvgHLp < Percent,XLen);
condition2 = V > average(V[1],XLen)*(1+Volpercent/100) ;
condition3 = C > AvgH *(1.02) and H > highest(H[1],XLen);
condition4 = average(volume[1], 5) >= 1000; 
condition5 = tselsindex(10,6)[Z]=1;

if condition1 
and condition2 
and condition3 
and condition4 
and condition5
then ret=1;






]]></Code>
<Arg><![CDATA[<Arg seed="ac8acd7b-c9fa-49be-9e8c-986758d2b8f0" version="1"><Param name="短期均線期數" varname="shortlength" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="中期均線期數" varname="midlength" type="1" subtype="0" value="10" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="長期均線期數" varname="Longlength" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="均線糾結區間%" varname="Percent" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="均線糾結期數" varname="XLen" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="放量幅度%" varname="Volpercent" type="1" subtype="0" value="25" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="5774ecce-1a15-48c4-b30f-87e2902e390a" version="1" />]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c;1,93ec7a47222349e7ba8a2257d29196e4;1,61c06064ad98469db9ce30287ae4a2c8;1,2bca774c6b7549c1b0b008d2a54b288e;1,d80cf92ddfcc42e0a6c53ec47edebd49;1,b1f1a25bdc014e109dc92d7f9b6ef207</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<FirstBarDate val="0" />
<Maxbb val="20" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="突破下降趨勢線" ID="08ab607764e94bf0af1efc48aa1b0b2b" ReturnType="0" ExecType="1" Folder="/波段操作型/" StatusMask="2">
<Desc><![CDATA[突破下降趨勢線]]></Desc>
<Code><![CDATA[input:Length(20); setinputname(1,"下降趨勢計算期數");
input:Rate(150); setinputname(2,"反轉率%");
variable: Factor(0);

settotalbar(Length + 3);

Factor = 100/Close[Length];

value1 = linearregslope(high*Factor,Length);
value2 = linearregslope(high*Factor,3);

if close > open and close < close[length]  and  value1 < 0 and value2-value1 > Rate*0.01 then ret=1;]]></Code>
<Arg><![CDATA[<Arg seed="7e9eefc9-4a8b-44d2-a46f-ed4e44083140" version="1"><Param name="下降趨勢計算期數" varname="Length" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="反轉率%" varname="Rate" type="1" subtype="0" value="150" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="24d36832-bff7-44b1-806e-e12105e7af05" version="1" />]]></Plots>
<RefFunc>1,8c2d025a23c548d3a76fba10c22527b4;1,210d0786cfe340538e34c095bc2ba049;1,626e6e5c42304bbea9809d1a07ae4e01</RefFunc>
<Extra><![CDATA[<Extra>
<Maxbb val="20" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="-1" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="股價穿越跌破三均線" ID="ff40cde9ef21498c962436850ddc1dae" ReturnType="0" ExecType="1" Folder="/技術分析/" StatusMask="2">
<Desc><![CDATA[開盤上漲,穿越突破長中短期均線時觸發]]></Desc>
<Code><![CDATA[input: shortlength(5); setinputname(1,"短期均線期數");
input: midlength(10); setinputname(2,"中期均線期數");
input: Longlength(20); setinputname(3,"長期均線期數");

settotalbar(3);
setbarback(maxlist(shortlength,midlength,Longlength));

variable: shortaverage(0);
variable: midaverage(0);
variable: Longaverage(0);


shortaverage=Average(close,shortlength);
midaverage=Average(close,midlength) ;
Longaverage = Average(close,Longlength); 

if open > maxlist(shortaverage, midaverage, longaverage) and
   close < minlist(shortaverage, midaverage, longaverage)
then ret=1;        



        
        ]]></Code>
<Arg><![CDATA[<Arg seed="735a1e3b-6e23-4434-96be-937a5d95e0f5" version="1"><Param name="短期均線期數" varname="shortlength" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="中期均線期數" varname="midlength" type="1" subtype="0" value="10" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="長期均線期數" varname="Longlength" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="782a0d32-406a-4984-919b-0443b1629144" version="1" />]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c</RefFunc>
<Extra><![CDATA[<Extra>
<Maxbb val="60" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
<IsScriptSetBB val="1" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="帶量吊人" ID="2aa49178504042a5a1a6151fee01edf9" ReturnType="0" ExecType="1" Folder="/酒田戰法/" StatusMask="2">
<Desc><![CDATA[短黑棒留長下影線 量倍增]]></Desc>
<Code><![CDATA[{																						
[檔名:]	帶量吊人			[資料夾:]	酒田戰法	[適用方向]	空															
[說明:]	短黑棒留長下影線 量倍增																					
}																						
settotalbar(5);							
{判斷狀況}								
	condition1=	open = High and close < open					;//狀況1:	開高收低留黑棒
	condition2=	(high -low) > 2 *(high[1]-low[1])					;//狀況2:	波動倍增
	condition3=	(close-low)> (open-close)  *2					;//狀況3:	下影線為實體兩倍以上
	condition4=	Volume > Volume[1]					;//狀況4:		
{結果判斷}		
IF		
		condition1
	and	condition2
	and	condition3
	and	condition4
THEN	RET=1;	]]></Code>
<Arg><![CDATA[<Arg seed="6f9ccd6b-6949-42cf-8de3-2b8812310e74" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="1d010668-fb82-4f62-a2b1-2859e045cf2f" version="1" />]]></Plots>
<Extra><![CDATA[<Extra>
<Maxbb val="5" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="5" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="雙KD向上" ID="292a2c84353940b1bf1b1e46236153e9" ReturnType="0" ExecType="3" Folder="/波段操作型/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input: Length_D(9, "日KD期間");
input: Length_W(5, "周KD期間");

variable:rsv_d(0),kk_d(0),dd_d(0);
variable:rsv_w(0),kk_w(0),dd_w(0);

stochastic(Length_D, 3, 3, rsv_d, kk_d, dd_d);
xf_stochastic("W", Length_W, 3, 3, rsv_w, kk_w, dd_w);

//透過Z的時間安排來決定現在用的是那一根Bar的資料 
variable: Z(0);
if currenttime > 180000 
or currenttime < 083000 then 
	Z =0 
else 
	Z=1;
	
condition1 = kk_d crosses above dd_d;		// 日KD crosses over
condition2 = xf_GetBoolean("W",xf_crossover("W", kk_w, dd_w),1);	// 周KD crosses over
condition3 = average(volume[1], 5) >= 1000;
condition4 = kk_d[1] <= 30;							// 日K 低檔
condition5 = xf_getvalue("W", kk_w, 1) <= 50;		// 周K 低檔

// 成交量判斷
Condition99 = Average(Volume[1], 100) >= 1000;

if condition1 
and condition2 
and condition3 
and condition4 
and condition5 
and condition99
and tselsindex(10,6)[Z]=1
then ret=1;
]]></Code>
<Arg><![CDATA[<Arg seed="1d87b5ae-1d8c-47e1-8c20-0020104eb06b" version="1"><Param name="日KD期間" varname="Length_D" type="1" subtype="0" value="9" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="周KD期間" varname="Length_W" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="6c042e1c-5ad0-4365-9b5a-7d35df8207e1" version="1" />]]></Plots>
<RefFunc>1,61c06064ad98469db9ce30287ae4a2c8;1,2bca774c6b7549c1b0b008d2a54b288e;1,f1b429ac13b2447c909302198c18ca56;1,847bcd706dda4a9caf2b783e181a8e42;1,57f222578a2c4d17b2b88b65b8f28696;1,bdf6d4140e2c4954b316120de89f2d59;1,6850ead727a842bf883a1501d030ba98;1,ae592f43d76b43c589aaa0eb0e6ecb27;1,e670c01522de45efa7f74c7f3c15a061;1,066d74f514e44dc2b33d2d137adf4b34;1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c;1,d80cf92ddfcc42e0a6c53ec47edebd49;1,b1f1a25bdc014e109dc92d7f9b6ef207</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<FirstBarDate val="0" />
<Maxbb val="20" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="外資拉抬上攻" ID="9c994ac437394dc6a8a1be85eb42b2b3" ReturnType="0" ExecType="1" Folder="/1.籌碼監控/" StatusMask="2">
<Desc><![CDATA[外資近N日買超張數大於近N日成交量X % 
今日價格漲過昨日高點.
需選用日線及逐筆洗價.]]></Desc>
<Code><![CDATA[input: pastDays(3); setinputname(1,"計算天數");
input: _BuyRatio(25); setinputname(2,"買超佔比例(%)");
input:TXT("僅適用日線"); setinputname(3,"使用限制");

variable: SumForce(0);
variable: SumTotalVolume(0);

settotalbar(pastdays + 3);

if BarFreq <> "D" then return;

if Close > High[1] then
begin
	SumTotalVolume = Summation(volume[1], pastDays);
	SumForce = Summation(GetField("外資買賣超")[1], pastDays);

	if SumForce > SumTotalVolume * _BuyRatio / 100 then ret =1;
end;


        ]]></Code>
<Arg><![CDATA[<Arg seed="c727bb84-f33d-4dae-a9d0-2e1d79096fd5" version="1"><Param name="計算天數" varname="pastDays" type="1" subtype="0" value="3" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="買超佔比例(%)" varname="_BuyRatio" type="1" subtype="0" value="25" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="使用限制" varname="TXT" type="3" subtype="0" value="僅適用日線" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="8049bb6e-f824-4770-8f4b-a231cef5f1e6" version="1" />]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d</RefFunc>
<Extra><![CDATA[<Extra>
<Maxbb val="30" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="-1" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="投信近幾日買超比例高的" ID="9d7f9eb50e454eff9eebe6354eedc87c" ReturnType="0" ExecType="3" Folder="/技術分析/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input: pastDays(5); setinputname(1,"計算天數");
input: _BuyRatio(10); setinputname(2,"買超佔比例(%)");
input:TXT("僅適用日線"); setinputname(3,"使用限制");

variable: SumForce(0);
variable: SumTotalVolume(0);

if BarFreq <> "D" then return;

//透過Z的時間安排來決定現在用的是那一根Bar的資料 
variable: Z(0);
if GetFieldDate("主力買賣超張數") <> 0 then
	Z=0 
else 
	Z=1;
	
value1=GetField("主力買賣超張數")[Z];
 
SumForce = Summation(GetField("投信買賣超")[Z], pastDays);
sumTotalVolume = Summation(Volume, pastDays);
if SumForce > SumTotalVolume * _BuyRatio/100 
and tselsindex(10,8)[Z]=1
then ret =1;

]]></Code>
<Arg><![CDATA[<Arg seed="60bb3bcb-4d0d-4fa8-ba5f-042a4dddeca3" version="1"><Param name="計算天數" varname="pastDays" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="買超佔比例(%)" varname="_BuyRatio" type="1" subtype="0" value="10" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="使用限制" varname="TXT" type="3" subtype="0" value="僅適用日線" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="b9b641f6-8baa-44f3-b335-7785a001c5c6" version="1" />]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d;1,d80cf92ddfcc42e0a6c53ec47edebd49;1,b1f1a25bdc014e109dc92d7f9b6ef207</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="300" />
<Maxbb val="50" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="理專DBCD交易法則" ID="ad8464eb8bd14791b777eee5b6d9ebf9" ReturnType="0" ExecType="3" Folder="/ETF策略/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:length1(10,"短天期"),length2(20,"長天期"),length3(14,"平滑天期");
input:Threshold(-2,"觸發標準");

value1=bias(length1);
value2=bias(length2);
value3=value2-value1;
value4=average(value3,length3);

if value4 crosses over Threshold
then ret=1;]]></Code>
<Arg><![CDATA[<Arg seed="c4415099-9913-4027-9dc1-0b09bb4aa849" version="1"><Param name="短天期" varname="length1" type="1" subtype="0" value="10" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="長天期" varname="length2" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="平滑天期" varname="length3" type="1" subtype="0" value="14" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="觸發標準" varname="Threshold" type="1" subtype="0" value="-2" isSerial="1" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="961c6ced-303b-4beb-92aa-0f482c1f76ed" version="1" />]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c;1,aa300d6ee3de439ea5eeb2f9ff3a7ed2;1,6850ead727a842bf883a1501d030ba98</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<FirstBarDate val="0" />
<Maxbb val="20" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="MFO資金流震盪指標" ID="a5b20defdac245bb9e7f9a4816aef3bc" ReturnType="0" ExecType="3" Folder="/技術分析/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:period(20,"計算天期");

if range <> 0 and range[1] <> 0 then
	value1= ((high-low[1])-(high[1]-low))/((high-low[1])+(high[1]-low))*volume;
if summation(volume,period) <> 0 then
	value2= summation(value1,period)/summation(volume,period);

if value2 crosses over -0.5 then ret=1;]]></Code>
<Arg><![CDATA[<Arg seed="a562e99e-a4e9-490b-935d-e1952814a7f6" version="1"><Param name="計算天期" varname="period" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="8139f2bd-ec21-4f4e-b5ab-a7f843c7eade" version="1" />]]></Plots>
<RefFunc>1,b7522a72975a4d4bbc36f4fb684d6f77;1,c122bd6485c544f2bce8f374b5c7440d;1,6850ead727a842bf883a1501d030ba98</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<FirstBarDate val="0" />
<Maxbb val="20" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="潛龍昇天" ID="fbde11f38d0c449082a5324a06724553" ReturnType="0" ExecType="1" Folder="/技術分析/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:StartDate(20150301);
input:LowMonth(3);
 
if currentbar =1 and date < startdate then raiseruntimeerror("日期不夠遠");
 
variable:iHigh(0); iHigh=maxlist(iHigh,H);
variable:iLow(100000); iLow=minlist(iLow,L);
variable:hitlow(0),hitlowdate(0);
if iLow = Low then //觸低次觸與最後一次觸低日期
begin
hitlow+=1;
hitlowdate =date;
end;
 
if DateAdd(hitlowdate,"M",1) < Date and//如果自觸低點那天三個月後都沒有再觸低
iHigh/iLow < 1.3 and //波動在三成以內
iHigh = High then
 
//來到設定日期以來最高點
ret =1;]]></Code>
<Arg><![CDATA[<Arg seed="9272d6cb-2f35-4e63-84a4-358fde0cdcf4" version="1"><Param name="StartDate" varname="StartDate" type="1" subtype="0" value="20150301" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="LowMonth" varname="LowMonth" type="1" subtype="0" value="3" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="bcab3b0c-9872-4c4a-97e6-28e1281dcb7c" version="1" />]]></Plots>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<FirstBarDate val="0" />
<Maxbb val="20" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="貪婪指數太高" ID="1daaebc8c1e8495b9e8b951e1f08fc73" ReturnType="0" ExecType="3" Folder="/波段操作型/" StatusMask="2">
<Desc><![CDATA[股價處於相對滿足高檔]]></Desc>
<Code><![CDATA[input:RSILength(5); setinputname(1,"強弱計算期數");
input:CLength(5); setinputname(2,"比價期數");
input:VLength(20); setinputname(3,"量計算期數");
input:Raise(20); setinputname(4,"累計上揚幅度%");
input: TXT1("僅適用日線"); setinputname(5,"使用限制");
variable : MTRatio(0),CloseRatio(0),AVGV(0);

if barfreq <> "D" then return;

if close > lowest(low,VLength) * (1+Raise/100) then
begin
	MTRatio=getfield("融資增減張數")[1]/volume[1];
	CloseRatio = close/close[CLength];
	AVGV = volume[1]/average(volume[1],VLength);
	value1 = RSI(MTRatio,RSILength)+RSI(CloseRatio,RSILength)+RSI(AVGV,RSILength);
	if RSI(value1,RSILength) >75 then ret=1;
end;]]></Code>
<Arg><![CDATA[<Arg seed="ee220c31-9702-4c9a-9f73-3dcad9e64be2" version="1"><Param name="強弱計算期數" varname="RSILength" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="比價期數" varname="CLength" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="量計算期數" varname="VLength" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="累計上揚幅度%" varname="Raise" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="使用限制" varname="TXT1" type="3" subtype="0" value="僅適用日線" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="bbb19a4a-0544-463d-9e55-f89762e8f041" version="1" />]]></Plots>
<RefFunc>1,61c06064ad98469db9ce30287ae4a2c8;1,f1b429ac13b2447c909302198c18ca56;1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c;1,d64c2a71d3ea43d985ca22ef62a5a8de</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="100" />
<Maxbb val="25" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="6.condition條件的交集" ID="082b5410c3ff45d3a5cba1dd1fe17ac4" ReturnType="0" ExecType="1" Folder="/!語法範例/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[//就像value1~value99是系統內建變數，其回傳值是一個數值
//condition1~condition99是系統內建回傳true或false邏輯值的變數名稱
//於是我們在口語上的如果~而且~就通知我，這樣的語法很容易用這個方式來撰寫

//========範例：融資餘額前十天大減超過2000張且減幅超過兩成===================
//1.宣告參數：利用input宣告輸入的參數。
input: range1(2000);
input: percent(0.2);

condition1=false;//將condition1設成false狀態，一旦符合條件才轉成true

//4.運用函數
//利用getfield取得外資買賣超資料
value1=getfield("融資餘額張數")[1];
value2=getfield("融資餘額張數")[10];


if value2-value1>range1 and (value2-value1)/value2>percent//計算融資增減張數
then condition1=true;//融資餘額前十天大減超過2000張且減幅超過兩成

//6.設定警示條件：if.. then ret=1;
//多重條件交易才觸發警示
if condition1 and average(close,20)/close[1]>1.05 and q_ask>open//近20天跌幅超過5%且現在外盤超過開盤價
then ret=1;








]]></Code>
<Arg><![CDATA[<Arg seed="c4e8c181-b8fe-4c7f-9542-62dd54c98dc3" version="1"><Param name="range1" varname="range1" type="1" subtype="0" value="2000" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="percent" varname="percent" type="1" subtype="0" value="0.2" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="e7598955-fa04-447a-b516-8604f8190c40" version="1" />]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="50" />
<Maxbb val="25" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="連續期間下跌" ID="5383fa5b63964167a4927105cd37fcd0" ReturnType="0" ExecType="1" Folder="/價量指標/" StatusMask="2">
<Desc><![CDATA[連續下跌走勢]]></Desc>
<Code><![CDATA[input:Length(3); setinputname(1,"連續下跌期數");
settotalbar(Length + 3);
If TrueAll(Close < Close[1],Length) then ret=1;


        
        ]]></Code>
<Arg><![CDATA[<Arg seed="1f627911-4949-4ed2-be3d-f33c466d89e8" version="1"><Param name="連續下跌期數" varname="Length" type="1" subtype="0" value="3" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="8f418b94-4c8a-4237-ab06-7ba8dbde8106" version="1" />]]></Plots>
<RefFunc>1,93ec7a47222349e7ba8a2257d29196e4</RefFunc>
<Extra><![CDATA[<Extra>
<Maxbb val="25" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="-1" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="景氣循環股操作法" ID="13a3185a5ab74e8e96009ccf649c6fd7" ReturnType="0" ExecType="3" Folder="/技術分析/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input: shortlength(5); setinputname(1,"短期均線期數");
input: midlength(10); setinputname(2,"中期均線期數");
input: Longlength(20); setinputname(3,"長期均線期數");
input: Percent(2); setinputname(4,"均線糾結區間%");
input: Volpercent(40); setinputname(5,"放量幅度%");//帶量突破的量是超過最長期的均量多少%
variable: shortaverage(0);
variable: midaverage(0);
variable: Longaverage(0);
variable:Kprice(0);
 
if volume > average(volume,Longlength) * (1 + volpercent * 0.01) then
begin
shortaverage = average(close,shortlength);
midaverage = average(close,midlength);
Longaverage = average(close,Longlength);
if Close crosses over maxlist(shortaverage,midaverage,Longaverage) then
begin
value1= absvalue(shortaverage -midaverage);
value2= absvalue(midaverage -Longaverage);
value3= absvalue(Longaverage -shortaverage);
if maxlist(value1,value2,value3)*100 < Percent*Close then Kprice=H;
end;
end;
 
if C crosses above Kprice
//and tselsindex(10,8)=1
 then ret=1;]]></Code>
<Arg><![CDATA[<Arg seed="008d2a22-c640-438e-8f87-25a19ab099f1" version="1"><Param name="短期均線期數" varname="shortlength" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="中期均線期數" varname="midlength" type="1" subtype="0" value="10" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="長期均線期數" varname="Longlength" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="均線糾結區間%" varname="Percent" type="1" subtype="0" value="2" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="放量幅度%" varname="Volpercent" type="1" subtype="0" value="40" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="3c6d8cc1-59b8-461c-be19-a60ee14e6120" version="1" />]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c;1,6850ead727a842bf883a1501d030ba98</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<FirstBarDate val="0" />
<Maxbb val="20" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="藍籌股RSI低檔背離" ID="e1fca2b9125d45aca56be59cce5e3045" ReturnType="0" ExecType="3" Folder="/波段操作型/" StatusMask="2">
<Desc><![CDATA[RSI低檔背離]]></Desc>
<Code><![CDATA[input: Periods(50); setinputname(1,"計算期間");
input: Length(6); setinputname(2,"RSI");
input: LowFilter(25); setinputname(3,"RSI低檔區");

settotalbar(maxlist(Periods,maxlist(Length,6) * 8) + 3);

variable: rsivalue(0);

condition1 = false;
condition2 = false;
condition3 = false;
condition4 = false;

rsivalue = RSI(Close,Length);
value1 = highestbar(high,Periods);//轉折高點距離
value2 = lowestbar(low,Periods);//轉折低點距離

if value2 = 0	//今日為創新低的第二隻腳
then condition1 = true
else return;

if rsivalue <= LowFilter	//RSI位於低檔區
then condition2 = true
else return;

if value2[value1] + value1 < Periods //在計算區間內存在第一隻腳
then condition3 = true
else return;

if rsivalue[value2[value1] + value1] < rsivalue //RSI不再創新低
then condition4 = true
else return;

if condition1 and condition2 and condition3 and condition4
then ret = 1;

        
        ]]></Code>
<Arg><![CDATA[<Arg seed="b70ff899-1588-41b4-8c27-e02ac69845c0" version="1"><Param name="計算期間" varname="Periods" type="1" subtype="0" value="50" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="RSI" varname="Length" type="1" subtype="0" value="6" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="RSI低檔區" varname="LowFilter" type="1" subtype="0" value="25" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="449fec98-d567-45d1-bbd5-cb1382309825" version="1" />]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c;1,d64c2a71d3ea43d985ca22ef62a5a8de;1,61c06064ad98469db9ce30287ae4a2c8;1,328818c303ce4aa6a307cee4c60046b3;1,68349c444a9c43f09b19def4bddc206e</RefFunc>
<Extra><![CDATA[<Extra>
<Maxbb val="51" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="-1" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="當日開盤跳空開低" ID="8e678f9d33464f73b78ed312e2f1c58d" ReturnType="0" ExecType="1" Folder="/價量指標/" StatusMask="2">
<Desc><![CDATA[開盤跳空開低幅度警示]]></Desc>
<Code><![CDATA[input: UseQuote(True); setinputname(1,"使用即時價欄位");
input: Gap(1.5); setinputname(2,"跳空百分比(%)");
settotalbar(3);
if UseQuote then 
	Ret = IFF(100*(GetField("RefPrice", "D") -GetField("Open", "D")) > GetField("RefPrice", "D")*Gap, 1, 0)
else 
	Ret = IFF(date <> date[1] and 100*(close[1] -open) > close[1]*Gap, 1, 0);




        ]]></Code>
<Arg><![CDATA[<Arg seed="130d26c0-57d2-45db-b2b0-93d4b6d85d37" version="1"><Param name="使用即時價欄位" varname="UseQuote" type="2" subtype="0" value="1" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="跳空百分比(%)" varname="Gap" type="1" subtype="0" value="1.5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="fe78bc8c-3baf-4c1b-9f39-e18da341c891" version="1" />]]></Plots>
<RefFunc>1,8c2d025a23c548d3a76fba10c22527b4</RefFunc>
<Extra><![CDATA[<Extra>
<FirstBarDate val="0" />
<Maxbb val="3" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="大跌後均線黃金交叉" ID="3e18992e144b4e0884a005bacf9934d5" ReturnType="0" ExecType="3" Folder="/ETF策略/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[Input: Length1(5, "短天期");
Input: Length2(20, "長天期");

value1=highest(high,100);

if value1 > close*1.2
and average(close,Length1) crosses over average(close,Length2)
then ret=1;]]></Code>
<Arg><![CDATA[<Arg seed="ce228d47-30a5-4983-896d-8d80827b22d1" version="1"><Param name="短天期" varname="Length1" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="長天期" varname="Length2" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="45f2cda9-4a68-44be-81a6-7028658b2045" version="1" />]]></Plots>
<RefFunc>1,61c06064ad98469db9ce30287ae4a2c8;1,2bca774c6b7549c1b0b008d2a54b288e;1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c;1,6850ead727a842bf883a1501d030ba98</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<FirstBarDate val="0" />
<Maxbb val="20" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="吊人" ID="5b73a9a1bf2f45a89ed4b0eb3deb6fd5" ReturnType="0" ExecType="1" Folder="/酒田戰法/" StatusMask="2">
<Desc><![CDATA[短黑棒留長下影線]]></Desc>
<Code><![CDATA[{																						
[檔名:]	吊人			[資料夾:]	酒田戰法	[適用方向]	空															
[說明:]	短黑棒留長下影線																																								
}																						
settotalbar(5);						
{判斷狀況}								
	condition1=	open = High and close < open					;//狀況1:	開高收低留黑棒
	condition2=	(high -low) > 2 *(high[1]-low[1])					;//狀況2:	波動倍增
	condition3=	(close-low)> (open-close)  *2					;//狀況3:	下影線為實體兩倍以上
{結果判斷}		
IF		
		condition1
	and	condition2
	and	condition3
THEN	RET=1;	]]></Code>
<Arg><![CDATA[<Arg seed="b5158ede-1678-4506-ad08-d979702bb6b8" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="9a6373b9-90c3-4086-9240-dbd762fa6ab6" version="1" />]]></Plots>
<Extra><![CDATA[<Extra>
<Maxbb val="5" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="5" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="中小型股趨勢成型" ID="39a912585ba14e2eb52ac66c627162a6" ReturnType="0" ExecType="3" Folder="/技術分析/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[
// ADX趨勢成形
// 用有量的中小型股，5%停利，5%停損
 
if GetSymbolField("tse.tw","收盤價")
> average(GetSymbolField("tse.tw","收盤價"),10) 
//大盤OK
then begin
input: Length(14,"期數"), Threshold(25,"穿越值");
 
variable: pdi_value(0), ndi_value(0), adx_value(0);
 
  
DirectionMovement(Length, pdi_value, ndi_value, adx_value);
 
if adx_value Crosses Above Threshold
//adx趨勢成形
and pdi_value>ndi_value
//+DI>-DI
and close <close[30]
then ret=1;
end;]]></Code>
<Arg><![CDATA[<Arg seed="9df6be0a-01e0-4099-8237-a9dbefb7550b" version="1"><Param name="期數" varname="Length" type="1" subtype="0" value="14" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="穿越值" varname="Threshold" type="1" subtype="0" value="25" isSerial="1" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="1a3e4b70-6770-423b-bf63-e8124ce06222" version="1" />]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c;1,7721dca8cc7242c09d21b782bbb59bd9;1,6850ead727a842bf883a1501d030ba98</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<FirstBarDate val="0" />
<Maxbb val="20" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="價量同創近期新低" ID="36c61bab5b2f4a6aa935d2ac7ae18b14" ReturnType="0" ExecType="1" Folder="/價量指標/" StatusMask="2">
<Desc><![CDATA[收盤價跌破過去N期以來低點,成交量創新低]]></Desc>
<Code><![CDATA[input: Price(close); setinputname(1,"比較價別");
input: Length(20); setinputname(2,"近期期數");

settotalbar(3);
setbarback(Length);

if  Price < lowest(low[1] ,Length) and 
    volume < lowest(volume[1],length) then ret=1;



]]></Code>
<Arg><![CDATA[<Arg seed="01d22ae3-dd1a-4e49-ab7c-ab1ca0270983" version="1"><Param name="比較價別" varname="Price" type="1" subtype="1" value="close" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="近期期數" varname="Length" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="6efb8c37-697a-45b5-afe9-c1af2a8bdb72" version="1" />]]></Plots>
<RefFunc>1,61c06064ad98469db9ce30287ae4a2c8;1,f1b429ac13b2447c909302198c18ca56</RefFunc>
<Extra><![CDATA[<Extra>
<Maxbb val="50" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
<IsScriptSetBB val="1" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="漲停回頭" ID="c3c38c5cf72e4fd59e2d68310c593c40" ReturnType="0" ExecType="1" Folder="/價量指標/" StatusMask="2">
<Desc><![CDATA[漲停後出現賣單]]></Desc>
<Code><![CDATA[settotalbar(3);
If Close[1] = GetField("漲停價", "D") And q_Last < GetField("漲停價", "D") Then ret = 1;
        
        ]]></Code>
<Arg><![CDATA[<Arg seed="61c477cb-b61c-4c34-8cc2-32840b6ed235" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="68d39c5b-65d6-49ad-ba38-7cd9c0212746" version="1" />]]></Plots>
<Extra><![CDATA[<Extra>
<Maxbb val="3" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="大跌後的定存股標的" ID="6e7c6ae66cf840debf65c7532ab16b59" ReturnType="0" ExecType="1" Folder="/長線投資/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:Length(200,"尋找高點期數");
input:percent(38.2,"自高點回檔幅度%");
 
if close < highest(high,Length)*(1- percent/100) then Ret=1;]]></Code>
<Arg><![CDATA[<Arg seed="8366a0ca-2ca4-4b92-8ca0-518929fe66ab" version="1"><Param name="尋找高點期數" varname="Length" type="1" subtype="0" value="200" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="自高點回檔幅度%" varname="percent" type="1" subtype="0" value="38.2" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="a972522e-1c08-4420-9566-0852a8c7388d" version="1" />]]></Plots>
<RefFunc>1,61c06064ad98469db9ce30287ae4a2c8;1,2bca774c6b7549c1b0b008d2a54b288e</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<FirstBarDate val="0" />
<Maxbb val="20" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="盤中多方警示" ID="5fe6942837aa4f32be0648ee5a63db3b" ReturnType="0" ExecType="3" Folder="/2.市場常用語/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[settotalbar(20);

array:intrabarpersist Trigger[20](True);

Array: intrabarpersist MK[330,6](0),intrabarpersist MD[7](1); {Time,Open,High,Low,Close,Volume}
variable:intrabarpersist BI(1),OT(090000){開盤時間},MF{KBbar頻率}(1);
if CurrentTime < TimeAdd(OT,"M",BI*MF) then 
begin  
MD[2]=MaxList(MD[2],C); MD[3]=MinList(MD[3],C);MD[4]=C; MD[7]+=q_TickVolume;
if BI =1 then  begin MD[1]=GetField("Open", "D");MD[2]=GetField("High", "D");MD[3]=GetField("Low", "D") ;end;
end else begin
MK[BI,0]=TimeAdd(OT,"M",BI-1);MK[BI,1]=MD[1];MK[BI,2]=MD[2];MK[BI,3]= MD[3];MK[BI,4]= MD[4];MK[BI,5]=GetField("Volume", "D")-q_TickVolume-MD[5];            
BI+=1; MD[1]=C;MD[2]=C;MD[3]=C;MD[4]=C; MD[5]=GetField("Volume", "D")-q_TickVolume; MD[7]=q_TickVolume;
end;

array:intrabarpersist Q1[100,3](90000),intrabarpersist Q2[10,3](90000),intrabarpersist QI[5,5](0); QI[1,4] = 99; QI[2,4] = 9; 
variable:QD(1);
for QD = 1 to 2
begin
if QI[QD,1] < QI[QD,4] then QI[QD,1]+=1 else QI[QD,1]=0; 
if QI[QD,1] =0 then QI[QD,2]=QI[QD,4] else QI[QD,2]=QI[QD,2]-1; 
if QI[QD,1] =QI[QD,4] then QI[QD,3]=0 else QI[QD,3]=QI[QD,1]+1;
end;
Q1[QI[1,1],0] = currenttime;Q1[QI[1,1],1] = Close;Q1[QI[1,1],2] = q_TickVolume;     
Q2[QI[2,1],0] = currenttime;Q2[QI[2,1],1] = Close;Q2[QI[2,1],2] = q_TickVolume;     


{=============}
variable:TA1(-1),TA2(-1),AVGX(10000);
if Date = currentdate then begin
if TA1 = -1  then TA1 = Countif( GetField("融資增減張數")[1]<0,10);
variable: forceratio(0);
if V[1] > 0 then forceratio = GetField("主力買賣超張數")[1]/V[1] else forceratio = forceratio[1];
if TA2 = -1 then TA2 = Summation(forceratio,10);
if AVGX =10000 then AVGX = Average(Close,5);{五日}
end;
{=============}

{開盤處理融資追繳後的反彈}
if Trigger[19] then  if currenttime < 093000 and Close > Low *1.02 and Close > Open and  V > V[1]*0.6 and  TA1=10{融資增減張數之減少天數}
and Low = Lowest(Low,20) and Low < Highest(high,20)*0.7 then  begin ret=1; trigger[19]=false; end;
if h > highest(h[1],8) and v < highest(v[1],18)*BI/135 then return; 
{過濾} 
if Close = GetField("漲停價", "D") or Close < highest(high,10)*0.95 or GetField("均價")*GetField("Volume", "D") < 10000{仟元}   
   or Close < GetField("Volume", "D")*0.985 or Date <currentdate 
   or Close > AVGX*1.25 or Close > C[5]*1.25   then return;

{1.1分鐘線爆量上漲}
if Trigger[1] then  if MD[7] > (V[1]+V)/(270+BI)*3 and Close > MD[1]*1.01  then begin ret=1; trigger[1]=false; end;
{2.5分鐘線3連陽}
if Trigger[2] then  if BI >= 15 and MK[BI,4]> MK[BI-4,1] and MK[BI-5,4]> MK[BI-9,1] and MK[BI-10,4] > MK[BI-14,1] then begin ret=1; trigger[2]=false; end;
{3.連日盤整後急拉}
if Trigger[3] then  if Close > Q2[QI[2,3],1]*1.015 and TimeDiff(currenttime, Q2[QI[2,3],0],"M") <5 and TrueAll(absvalue(high[1]/low[1]-1) < 0.03,10) then begin ret=1; trigger[3]=false; end;
{4.主動性買盤大增} variable: AvgOutSideVol(averageIF( close > close[1] ,volume,15));
if Trigger[4] then if GetField("外盤量", "D") > AvgOutSideVol*1.5 then begin ret=1; trigger[4]=false; end;
{5.多頭波動表態}   variable:STDEV(standarddev(High[1]-Low[1],15,1)*3);
if Trigger[5] then if q_PriceChangeRatio >3{%} and Volume*GetField("均價") > 30000{仟元} and  High > Low + average(High[1]-Low[1],15)+STDEV then begin ret=1; trigger[5]=false; end;
{6.多方放量待起漲} variable:VSTDEV(standarddev(volume,15,1)*3);
if Trigger[6] then if q_PriceChangeRatio>2{%} and  volume > average(volume[1],15)+3*VSTDEV and close > highest(high[1],15)*0.965 then begin ret=1; trigger[6]=false; end;
{7.連日強攻再滾量攻高}
if Trigger[7] then  if BI>3 and  Close > High[1] and (MK[BI,5]+MK[BI-1,5]+MK[BI-2,5])*GetField("均價") > 10000{仟元} and CountIF(high>high[1],10) > 7 then begin ret=1; trigger[7]=false; end;
{8.10個1分鐘階梯連漲} variable:Steps(true); 
if Trigger[8] then if BI>10 then begin for QD=0 to 9   begin    Steps  = Steps and (MK[BI-QD,4]>MK[BI-1-QD,4]); end;  if Steps then begin ret=1; trigger[8]=false; end; ;end;  
{9.多方人氣急增}
if Trigger[9] then if BI>4  and q_PriceChangeRatio > 2{%} and MK[BI,4]> MK[BI-1,1]  and MK[BI-1,4]> MK[BI-3,1]  and (TimeDiff( currenttime, Q1[QI[1,3],0],"S")- TimeDiff(currenttime, Q2[QI[2,3],0],"S"))/90 > TimeDiff(currenttime, Q2[QI[2,3],0],"S")*3/10 then begin ret=1; trigger[9]=false; end;
{10.主力決心作價}
if Trigger[10] then if  V*GetField("均價")> 30000{仟元} and TA2{"主力買賣超張數"} > 0.33 and high= Highest(High,10) then  begin ret=1; trigger[10]=false; end;
{11.開盤快速急攻}
if Trigger[11] then if CurrentTime < 091500  and q_PriceChangeRatio >2{%} and Volume*GetField("均價") > 30000{仟元}  and high =Highest(High,15)  and  High > Low[1] + average(High[1]-Low[1],15)+STDEV then begin ret=1; trigger[11]=false; end;
{12.2%門前急拉} 
if Trigger[12] then if Q2[QI[2,1],1] < GetField("RefPrice", "D") *1.02 and close >= GetField("RefPrice", "D") *1.02 and  Close * q_TickVolume >500{仟元} and  Close > Q2[QI[2,3],1]*1.01  and   timediff(Currenttime,Q2[QI[2,3],0],"M")< 3{分鐘}  then begin ret=1; trigger[12]=false; end;    {3分鐘內快速拉升}
{13.下殺後反彈過今高}
if Trigger[13] then if Close > GetField("RefPrice", "D") and Close > GetField("Open", "D") and  Close = GetField("Volume", "D") and  Close >= GetField("Low", "D")*1.02 then begin ret=1; trigger[13]=false; end;
{14.帶量衝新高}
if Trigger[14] then if Close = GetField("Volume", "D") and Close > highest(H[1],20)  and Close*q_TickVolume > 3000  then begin ret=1; trigger[14]=false; end;
{15.開盤15分鐘一路向上不回頭} variable:Counter(0);
if Trigger[15] then  If BI =15 then  for QD =0 to 13  if MK[BI-QD,4] > MK[BI-1-QD,4] then Counter+=1;  if Counter > 12 then begin ret=1; trigger[15]=false; end;]]></Code>
<Arg><![CDATA[<Arg seed="65361475-7302-49dc-b78b-b27ebf706352" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="b4e30d9c-c7a5-4a42-8f1f-27c1c08a6809" version="1" />]]></Plots>
<RefFunc>1,d80cf92ddfcc42e0a6c53ec47edebd49;1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c;1,61c06064ad98469db9ce30287ae4a2c8;1,f1b429ac13b2447c909302198c18ca56;1,2bca774c6b7549c1b0b008d2a54b288e;1,93ec7a47222349e7ba8a2257d29196e4;1,89f2091af8c84f7bbe02544e9b39138d;1,8c2d025a23c548d3a76fba10c22527b4;1,9c4f476d319b4f109a8dc8557099ded4;1,c1cda70a714d44999e5171fc53c95b0a</RefFunc>
<Extra><![CDATA[<Extra>
<Maxbb val="20" />
<ScriptComplexity val="136" />
<script>
<freq support="8;11" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{&quot;8&quot;:[5,6,7,9,192,21,194],&quot;0&quot;:[43,54,315]},&quot;symbol_freq_field&quot;:{}}" />
<IsScriptSetTB val="1" />
<TotalBar val="20" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="抗跌" ID="16ac10d952a546709096eedbc9867bd6" ReturnType="0" ExecType="1" Folder="/波段操作型/" StatusMask="2">
<Desc><![CDATA[開盤價上揚且未有強力賣盤]]></Desc>
<Code><![CDATA[settotalbar(3);
if open>open[1] and open < 1.005*low then ret=1;
]]></Code>
<Arg><![CDATA[<Arg seed="66d79dc5-f8f7-49b2-b7f5-7bcdc7db0e4e" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="bcb6e0df-a51a-49e4-a71c-b108d878184b" version="1" />]]></Plots>
<Extra><![CDATA[<Extra>
<Maxbb val="2" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="9.2while(一直算到條件不符合)" ID="f7fb4ceb04784f27a89c49d237a3b1dd" ReturnType="0" ExecType="1" Folder="/!語法範例/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[//還有另一種迴圈是while，會一直執行到條件不符合
//請小心不要造成無法跳出的無窮迴圈

//==============================範例：開盤五分鐘創三次新高﹙改用while迴圈﹚======================

variable: n(0);
variable: count(0);
if  Barinterval=1 and barfreq ="Min" then Begin  //適用於1分鐘線
//執行迴圈，檢查過去五分鐘高點過前高的次數
if time = 90500 then begin
	n = 1;
	while n <= 5 begin//以下的陳述(到end;為止)，n=1執行一次，n=2執行一次，一直到n=5
		if high[n]>high[n-1]
		then count=count+1;
		n = n + 1;
	end;
end;

//設定警示條件：if.. then ret=1;
if count>=3
then ret=1;
end;
]]></Code>
<Arg><![CDATA[<Arg seed="1a4f1b8c-ca40-4f89-bbd2-2635d8dd6152" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="fc7cde1e-6c5e-496d-85f9-035199f0c889" version="1" />]]></Plots>
<Extra><![CDATA[<Extra>
<TotalBar val="10" />
<Maxbb val="5" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="股價穿越跌破雙均線" ID="a7f861bd4e524bdf966c87ddd6873049" ReturnType="0" ExecType="1" Folder="/技術分析/" StatusMask="2">
<Desc><![CDATA[開盤下跌,穿越跌破長短期均線時觸發]]></Desc>
<Code><![CDATA[input: shortlength(5); setinputname(1,"短期均線期數");
input: Longlength(20); setinputname(2,"長期均線期數");

settotalbar(3);
setbarback(maxlist(shortlength,Longlength));

variable: Longaverage(0);
variable: shortaverage(0);

Longaverage = Average(close,Longlength);
shortaverage=Average(close,shortlength) ;

if open > maxlist(shortaverage, longaverage) and
   close < minlist(shortaverage, longaverage)
 then ret=1;


 
        ]]></Code>
<Arg><![CDATA[<Arg seed="c7999729-cd56-421a-b092-03ee3de9e788" version="1"><Param name="短期均線期數" varname="shortlength" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="長期均線期數" varname="Longlength" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="677eceba-7d40-4a58-a6f3-01502c52f82a" version="1" />]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c</RefFunc>
<Extra><![CDATA[<Extra>
<Maxbb val="60" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
<IsScriptSetBB val="1" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="上昇趨勢確立" ID="e1daae78d5c3464ca9190a79ad6ac4b5" ReturnType="0" ExecType="3" Folder="/技術分析/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[//市值適中的股票 20天出場

input:Length(20); //"計算期間"

//透過Z的時間安排來決定現在用的是那一根Bar的資料 
variable: Z(0);
if GetFieldDate("主力買賣超張數") <> 0 then
	Z=0 
else 
	Z=1;
	
LinearReg(close, Length, 0, value1, value2, value3, value4);
//做收盤價20天線性回歸
{value1:斜率,value4:預期值}
value5=rsquare(close,value4,20);//算收盤價與線性回歸值的R平方
value6=GetField("主力買賣超張數")[Z];
if value1> 0 and value5 crosses over 0.2
and trueall(value6>100,3)
and tselsindex(10,8)[Z]=1
then ret=1;]]></Code>
<Arg><![CDATA[<Arg seed="8e45a0d8-8153-4773-ad19-1636336c5e67" version="1"><Param name="Length" varname="Length" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="1ad911c0-0d56-4963-9502-91361e0ceb2b" version="1" />]]></Plots>
<RefFunc>1,8c2d025a23c548d3a76fba10c22527b4;1,210d0786cfe340538e34c095bc2ba049;1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c;1,92fc51a453da4cd1b4448cc9a7677e84;1,63d7a17cf80a49098dfc97fc4b986abc;1,6850ead727a842bf883a1501d030ba98;1,93ec7a47222349e7ba8a2257d29196e4;1,d80cf92ddfcc42e0a6c53ec47edebd49;1,b1f1a25bdc014e109dc92d7f9b6ef207</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="300" />
<Maxbb val="50" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="晨星" ID="ef9ab03dad26401ca62a583ed24bd481" ReturnType="0" ExecType="1" Folder="/酒田戰法/" StatusMask="2">
<Desc><![CDATA[前前期收長黑K棒 前期再開低震盪收短紅棒後  當期開高紅棒反攻起跌點]]></Desc>
<Code><![CDATA[{																						
[檔名:]	晨星			[資料夾:]	酒田戰法	[適用方向]	多															
[說明:]	前前期收長黑K棒 前期再開低震盪收短紅棒後  當期開高紅棒反攻起跌點 																																									
}																														
settotalbar(5);	
{判斷狀況}								
	condition1=	( open[2] - close[2] ) >(high[2] -low[2]) * 0.75					;//狀況1:	前前期出黑K棒
	condition2=	close[2] < close[3]-(high[3]-low[3])					;//狀況2:	跌勢擴大
	condition3=	( close - open ) >(high -low) * 0.75					;//狀況3:	當期收紅K棒
	condition4=	close> close[2]					;//狀況4:	收復黑棒收盤價
	condition5=	close[1] <= close[2] and close[1] < open					;//狀況5:	前低收盤為三期低點
{結果判斷}		
IF		
		condition1
	and	condition2
	and	condition3
	and	condition4
	and	condition5
THEN	RET=1;	]]></Code>
<Arg><![CDATA[<Arg seed="5e7d4a50-4712-4a3e-bb4d-e3596ff7974d" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="c4bf5f2e-4141-481f-94db-cd516d33a3cd" version="1" />]]></Plots>
<Extra><![CDATA[<Extra>
<Maxbb val="5" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="5" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="帶量鎚頭" ID="8130321660b24034a470bc72388718a4" ReturnType="0" ExecType="1" Folder="/酒田戰法/" StatusMask="2">
<Desc><![CDATA[開盤後下跌試底,盤中拉升上攻後,收在高點留下下影線 衝出倍增量]]></Desc>
<Code><![CDATA[{									
[檔名:]	帶量鎚頭			[資料夾:]	酒田戰法	[適用方向]	多		
[說明:]	開盤後下跌試底,盤中拉升上攻後,收在高點留下下影線 衝出倍增量														
}													
settotalbar(5);	
{判斷狀況}								
	condition1=	close >=high	and 	close > open			;//狀況1:	收高
	condition2=	(high -low) > 2 *(high[1]-low[1])					;//狀況2:	波動放大
	condition3=	(open-low) > (close - open)  *2 					;//狀況3:	長下影線
	condition4=	Volume > Volume[1]*2					;//狀況4:	當期量倍增	
{結果判斷}									
IF									
		condition1							
	and	condition2							
	and	condition3							
	and	condition4														
THEN	RET=1;								]]></Code>
<Arg><![CDATA[<Arg seed="79dd3301-d0e8-4814-b764-0830a8385463" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="464edf04-d5e6-4911-ab0d-33f9df05f1e2" version="1" />]]></Plots>
<Extra><![CDATA[<Extra>
<Maxbb val="5" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="5" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="斷頭鍘刀" ID="5364b62f846447bdbe39807997594f9f" ReturnType="0" ExecType="1" Folder="/A股用語/" StatusMask="2">
<Desc><![CDATA[股價穿越跌破短中長期均線]]></Desc>
<Code><![CDATA[input:ShortLength(5); setinputname(1,"短期均線期數");
input:MidLength(20); setinputname(2,"中期均線期數");
input:LongLength(60); setinputname(3,"長期均線期數");

settotalbar(8);
setbarback(maxlist(ShortLength,MidLength,LongLength));

value1=average(close,ShortLength);
value2=average(close,MidLength);
value3=average(close,LongLength);

if close crosses below value1 and 
   close crosses below value2 and 
   close crosses below value3 
then ret=1;
 ]]></Code>
<Arg><![CDATA[<Arg seed="5d74c1fb-0b91-4141-ab3c-068f70dfbe41" version="1"><Param name="短期均線期數" varname="ShortLength" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="中期均線期數" varname="MidLength" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="長期均線期數" varname="LongLength" type="1" subtype="0" value="60" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="bb0475a6-0d33-4192-bc18-6f09873e3b5e" version="1" />]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c;1,9dc3f19597ba44fa91524e91ca67aebd</RefFunc>
<Extra><![CDATA[<Extra>
<Maxbb val="65" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="8" />
<IsScriptSetBB val="1" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="大跌後的低檔五連陽" ID="6bacda99c9ed42489a52384af4a22e20" ReturnType="0" ExecType="3" Folder="/抄底策略/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[if trueall(close>open,5) 
and close*1.4<close[90]
then ret=1;]]></Code>
<Arg><![CDATA[<Arg seed="183c8a58-a6b5-4232-a8f2-7a5f70df8b1f" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="b3c80e3a-bc00-4a32-b068-1c93a060bc1f" version="1" />]]></Plots>
<RefFunc>1,93ec7a47222349e7ba8a2257d29196e4</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<FirstBarDate val="0" />
<Maxbb val="20" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="多頭執帶" ID="942351f7158741159b02cbdcd4ce2140" ReturnType="0" ExecType="1" Folder="/酒田戰法/" StatusMask="2">
<Desc><![CDATA[開在最低點一路走高收在最高點附近的K棒]]></Desc>
<Code><![CDATA[{								
[檔名:]	多頭執帶			[資料夾:]	酒田戰法	[適用方向]	多	
[說明:]	開在最低點一路走高收在最高點附近的K棒												
}
settotalbar(5);																
{判斷狀況}								
	condition1=	close>open					;//狀況1:	
	condition2=	(Close-Open)>(high-low)*0.9					;//狀況2:	
	condition3=	Close>Close[1]+high[1]-low[1]					;//狀況3:	
{結果判斷}		
IF		
		condition1
	and	condition2
	and	condition3
THEN	RET=1;	]]></Code>
<Arg><![CDATA[<Arg seed="972ddea5-759b-4f18-a3be-bbe0105e5117" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="7b76b7ac-8c30-42df-b98a-252578fae4c4" version="1" />]]></Plots>
<Extra><![CDATA[<Extra>
<Maxbb val="5" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="5" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="多次到底而破" ID="12e27e8057154923a53bc727bb7cca36" ReturnType="0" ExecType="3" Folder="/波段操作型/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:day(100,"計算區間");
input:band1(4,"三高點之高低價差");

value1=nthlowest(1,low[1],day);
value2=nthlowest(3,low[1],day);
value4=nthlowestbar(1,low,day);
value5=nthlowestbar(3,low,day);
value6=nthlowestbar(5,low,day);
value7=absvalue(value4-value6);
value8=absvalue(value5-value6);
value9=absvalue(value4-value5);

condition1=false;
if value7>3 and value8>3 and value9>3
then condition1=true;

value3=(value1-value2)/value2;
if value3<=band1/100
and close crosses under value1
and volume>2000
and condition1
then ret=1;
]]></Code>
<Arg><![CDATA[<Arg seed="cbf5cad8-1ecd-4f01-861e-32219766a6fe" version="1"><Param name="計算區間" varname="day" type="1" subtype="0" value="100" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="三高點之高低價差" varname="band1" type="1" subtype="0" value="4" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="0ab0a65f-d75d-400d-bd4b-b0d680cf5abd" version="1" />]]></Plots>
<RefFunc>1,f2404d9ffb2f49b3a38c431fcfc254b5;1,f44858c38f4249558a8b2ac032207f15;1,6bbc72256c3d4dbd9c7b3abd21a0be15;1,9dc3f19597ba44fa91524e91ca67aebd</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="300" />
<Maxbb val="50" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="突破波動範圍" ID="dae2191e81a04bbb8e5f0eb280d0c223" ReturnType="0" ExecType="3" Folder="/當沖交易型/" StatusMask="2">
<Desc><![CDATA[波動放大]]></Desc>
<Code><![CDATA[input:Length(20); setinputname(1,"高低計算期數");
settotalbar(3);
setbarback(Length);
variable:HighLow(0);
HighLow=high-low;
if C>highest(H[1],Length) *1.005 and  HighLow>highest(HighLow[1],Length) then ret=1;]]></Code>
<Arg><![CDATA[<Arg seed="061265a8-c9b0-498b-8db7-a7d19a069013" version="1"><Param name="高低計算期數" varname="Length" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="afa185ef-f2d8-4601-b72a-abfc65f1967b" version="1" />]]></Plots>
<RefFunc>1,61c06064ad98469db9ce30287ae4a2c8;1,2bca774c6b7549c1b0b008d2a54b288e</RefFunc>
<Extra><![CDATA[<Extra>
<Maxbb val="25" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
<IsScriptSetBB val="1" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="空頭遭遇" ID="58fa0cb9ee8740108436de6d7a820e02" ReturnType="0" ExecType="1" Folder="/酒田戰法/" StatusMask="2">
<Desc><![CDATA[紅棒後 開高走低守平盤]]></Desc>
<Code><![CDATA[{																						
[檔名:]	空頭遭遇			[資料夾:]	酒田戰法	[適用方向]	空															
[說明:]	紅棒後 開高走低守平盤																					
}																													
settotalbar(5);	
{判斷狀況}								
	condition1=	( close[1] - open[1] ) > (high[1] -low[1]) * 0.5					;//狀況1:	前期實體紅棒
	condition2=	( open - close ) > (high -low) * 0.5					;//狀況2:	當期實體黑棒
	condition3=	open > high[1] and close > close[1]					;//狀況3:	開過昨高收守平盤	
{結果判斷}		
IF		
		condition1
	and	condition2
	and	condition3
THEN	RET=1;	]]></Code>
<Arg><![CDATA[<Arg seed="7dbc08d4-2c44-41b1-a2bb-cd6d11248002" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="b855bdac-dc43-4e71-8e71-e9dfa1d3d086" version="1" />]]></Plots>
<Extra><![CDATA[<Extra>
<Maxbb val="5" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="5" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="RSI黃金交叉" ID="c4221982621a4e98a5b729e482ea6b7f" ReturnType="0" ExecType="3" Folder="/技術分析/" StatusMask="2">
<Desc><![CDATA[RSI短天期往上穿越長天期]]></Desc>
<Code><![CDATA[// RSI短天期往上穿越長天期
//
input: ShortLength(6), LongLength(12);

settotalbar(maxlist(ShortLength,LongLength,6) * 8 + 8);

SetInputName(1, "短期期數");
SetInputName(2, "長期期數");

Ret = RSI(Close, ShortLength) Crosses Above RSI(Close, LongLength);



]]></Code>
<Arg><![CDATA[<Arg seed="0c1b0eff-927e-48b4-88fe-eb2a425a8354" version="1"><Param name="短期期數" varname="ShortLength" type="1" subtype="0" value="6" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="長期期數" varname="LongLength" type="1" subtype="0" value="12" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="571d149f-ae42-4c1c-9f87-b2f867ecb073" version="1" />]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c;1,d64c2a71d3ea43d985ca22ef62a5a8de;1,6850ead727a842bf883a1501d030ba98</RefFunc>
<Extra><![CDATA[<Extra>
<Maxbb val="13" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="-1" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="即將跌停" ID="9f9132a6a73b4ba8a82b5aa44a5f4a17" ReturnType="0" ExecType="1" Folder="/價量指標/" StatusMask="2">
<Desc><![CDATA[股價離跌停幅度%預警]]></Desc>
<Code><![CDATA[input: Percent(1);  setinputname(1,"距離跌停百分比");

settotalbar(3);

if close < GetField("跌停價", "D")*(1+Percent/100) then ret =1;]]></Code>
<Arg><![CDATA[<Arg seed="498e5d54-a857-411a-8be1-1502afcbe2f2" version="1"><Param name="距離跌停百分比" varname="Percent" type="1" subtype="0" value="1" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="a87de35e-74ae-42a6-8da5-601978222424" version="1" />]]></Plots>
<Extra><![CDATA[<Extra>
<Maxbb val="3" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="底部出大量" ID="36bb588f2f744b40b7686f9de7ec5fb4" ReturnType="0" ExecType="3" Folder="/技術分析/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:period(60);
if close=lowest(close,period)
and volume=highest(volume,period)
then ret=1;

]]></Code>
<Arg><![CDATA[<Arg seed="cd5f77c6-bd22-44ce-8338-e1ab41942553" version="1"><Param name="period" varname="period" type="1" subtype="0" value="60" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="b0364fc7-38ea-4d22-9497-495da2f33432" version="1" />]]></Plots>
<RefFunc>1,61c06064ad98469db9ce30287ae4a2c8;1,f1b429ac13b2447c909302198c18ca56;1,2bca774c6b7549c1b0b008d2a54b288e</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<FirstBarDate val="0" />
<Maxbb val="20" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="突破上切線" ID="dc2cc19da9ce43b38276aa2239d46423" ReturnType="0" ExecType="1" Folder="/2.市場常用語/" StatusMask="2">
<Desc><![CDATA[股價緩漲加速急漲創新高]]></Desc>
<Code><![CDATA[input:Length(20); setinputname(1,"上切計算期數");
input:Rate(50); setinputname(2,"陡增率");

settotalbar(Length + 3);

variable: Factor(0);

Factor = 100/Close[Length];

if close > open and close > highest(high[1],Length) and 
   (linearregslope(high*Factor,3) -linearregslope(high*Factor,Length))>Rate*0.01 
then ret=1;]]></Code>
<Arg><![CDATA[<Arg seed="383d3502-7191-4f16-93dc-3b61df83d437" version="1"><Param name="上切計算期數" varname="Length" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="陡增率" varname="Rate" type="1" subtype="0" value="50" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="c874d6dc-0418-4e17-aff9-98bedda0c575" version="1" />]]></Plots>
<RefFunc>1,61c06064ad98469db9ce30287ae4a2c8;1,2bca774c6b7549c1b0b008d2a54b288e;1,8c2d025a23c548d3a76fba10c22527b4;1,210d0786cfe340538e34c095bc2ba049;1,626e6e5c42304bbea9809d1a07ae4e01</RefFunc>
<Extra><![CDATA[<Extra>
<Maxbb val="21" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="-1" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="KST趨勢確認策略" ID="03ec7f4195f348b2a2c393ecb677ee4c" ReturnType="0" ExecType="3" Folder="/ETF策略/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[variable:kst(0);
 
kst=callfunction("KST確認指標");

if kst crosses over -50 then ret=1;


]]></Code>
<Arg><![CDATA[<Arg seed="b1dd542b-7f8a-4736-964c-2772ec4f3bfd" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="7f68b38b-c0b6-4ebe-bd1f-cb37860e6ee6" version="1" />]]></Plots>
<RefFunc>1,c9f2641e5de0497cb352ace96f64236e;1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c;1,a23c81648d064f80855a462cfd76366e;1,6850ead727a842bf883a1501d030ba98</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<FirstBarDate val="0" />
<Maxbb val="20" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="開高帶量走低" ID="fead427080de443cbca164a44ea09940" ReturnType="0" ExecType="1" Folder="/價量指標/" StatusMask="2">
<Desc><![CDATA[當日開盤第1根黑K帶量]]></Desc>
<Code><![CDATA[Input: AmountThre(2000); setinputname(1,"開高量(萬)");
variable: initialAmount(0);
variable: intrabarpersist XDate(0);
settotalbar(25);
if Date > XDate then
  begin
	XDate = Date;
	initialAmount = (High+low)/2 * volume/10; //計算K棒成交金額
	if Open > Close[1] and
       (open - close) > (high -low) * 0.75 and 
	   initialAmount > AmountThre then ret = 1;
  end;
  


        
        ]]></Code>
<Arg><![CDATA[<Arg seed="6c7d6e1b-8196-4de9-aaa0-c16d08bda34c" version="1"><Param name="開高量(萬)" varname="AmountThre" type="1" subtype="0" value="2000" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="6cbc7194-6619-4c15-a04b-c610ed4bc43d" version="1" />]]></Plots>
<Extra><![CDATA[<Extra>
<Maxbb val="3" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="25" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="出水芙蓉" ID="8fee4cc809e64f1ea4d984d2e49ff5d2" ReturnType="0" ExecType="3" Folder="/A股用語/" StatusMask="2">
<Desc><![CDATA[股價長期低於季線 今日帶量突破季線]]></Desc>
<Code><![CDATA[{股價長期低於季線 今日帶量突破季線 [僅適用日線] }
input:Length(66); setinputname(1,"計算期間[僅日線有效]");
input:downLength(100); setinputname(2,"長期低於季線的天數");
input:ratio(25); setinputname(3,"突破量超過均量百分比(%)");
input:VLength(20); setinputname(4,"突破幾日均量");
input:TXT("僅適用日線"); setinputname(5,"使用限制");

settotalbar(downLength + 8);
setbarback(maxlist(Length + vLength));

if barfreq <> "D" then return;

value1=average(close,Length);//季線值
value2=average(volume,VLength);//均量值

condition1 = TrueAll(high[1] < value1[1], downLength);

if condition1 and close crosses over value1 and volume > value2* (100+ratio)/100
then ret=1;
]]></Code>
<Arg><![CDATA[<Arg seed="393b24fc-8944-4548-8c8d-e9f507f890dc" version="1"><Param name="計算期間[僅日線有效]" varname="Length" type="1" subtype="0" value="66" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="長期低於季線的天數" varname="downLength" type="1" subtype="0" value="100" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="突破量超過均量百分比(%)" varname="ratio" type="1" subtype="0" value="25" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="突破幾日均量" varname="VLength" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="使用限制" varname="TXT" type="3" subtype="0" value="僅適用日線" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="56c397b3-9586-4a5d-971e-4eea578decf9" version="1" />]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c;1,93ec7a47222349e7ba8a2257d29196e4;1,6850ead727a842bf883a1501d030ba98</RefFunc>
<Extra><![CDATA[<Extra>
<Maxbb val="200" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="-1" />
<IsScriptSetBB val="1" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="巨量長黑" ID="9878deebd5eb4783a2c28ddc8be3d621" ReturnType="0" ExecType="1" Folder="/3.出場常用警示/" StatusMask="2">
<Desc><![CDATA[開盤走低2.5%,爆量較昨日下跌3.5%以上]]></Desc>
<Code><![CDATA[input:Amount(10000); setinputname(1,"依頻率設定巨量門檻");
settotalbar(3);
if open > Close * 1.025//實體 
and close[1] > Close * 1.035 //較前一日大跌
and volume >=amount 
then ret=1;]]></Code>
<Arg><![CDATA[<Arg seed="44d5d504-81e4-48ff-a453-ee774ae7bb68" version="1"><Param name="依頻率設定巨量門檻" varname="Amount" type="1" subtype="0" value="10000" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="1ea5ac5d-410c-4324-9b12-6d426fed46a6" version="1" />]]></Plots>
<Extra><![CDATA[<Extra>
<Maxbb val="1" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="盤中直線下跌" ID="46600a33cc9e415a993d8bea1a09bf10" ReturnType="0" ExecType="1" Folder="/3.出場常用警示/" StatusMask="2">
<Desc><![CDATA[近期價格急跌]]></Desc>
<Code><![CDATA[input:SlopeThre(2); setinputname(1,"下降坡度[2~15越大跌越快]");
input:Length(5); setinputname(2,"計算期數");

settotalbar(Length + 3);

variable:KBarOfDay(0),tOpen(100); KBarOfDay+=1;
if date<>date[1] then begin KBarOfDay=1; tOpen =Open; end;

if Length < KBarOfDay and currentbar > maxbarsback and
   Linearregslope(Low/tOpen*1000,Length) < SlopeThre*-1 then 
ret=1;
]]></Code>
<Arg><![CDATA[<Arg seed="be57fc30-0c11-4f12-90a3-20609647b3d3" version="1"><Param name="下降坡度[2~15越大跌越快]" varname="SlopeThre" type="1" subtype="0" value="2" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="計算期數" varname="Length" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="48b85f43-00fb-421c-8d88-3880592ecb47" version="1" />]]></Plots>
<RefFunc>1,8c2d025a23c548d3a76fba10c22527b4;1,210d0786cfe340538e34c095bc2ba049;1,626e6e5c42304bbea9809d1a07ae4e01</RefFunc>
<Extra><![CDATA[<Extra>
<Maxbb val="5" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="-1" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="股價穿越突破三均線" ID="c9229411c3464c7a8e0fc7774e79db64" ReturnType="0" ExecType="1" Folder="/技術分析/" StatusMask="2">
<Desc><![CDATA[開盤上漲,穿越突破長中短期均線時觸發]]></Desc>
<Code><![CDATA[input: shortlength(5); setinputname(1,"短期均線期數");
input: midlength(10);  setinputname(2,"中期均線期數");
input: Longlength(20); setinputname(3,"長期均線期數");

settotalbar(3);
setbarback(maxlist(shortlength,midlength,Longlength));

variable: shortaverage(0);
variable: midaverage(0);
variable: Longaverage(0);


shortaverage=Average(close,shortlength);
midaverage=Average(close,midlength) ;
Longaverage = Average(close,Longlength); 

if close > maxlist(shortaverage, midaverage, longaverage) and
     open < minlist(shortaverage, midaverage, longaverage)
     then ret=1;  



        
        ]]></Code>
<Arg><![CDATA[<Arg seed="74df475c-0dd1-45e3-80d9-1202879a68e4" version="1"><Param name="短期均線期數" varname="shortlength" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="中期均線期數" varname="midlength" type="1" subtype="0" value="10" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="長期均線期數" varname="Longlength" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="d88013c3-ecb9-4688-961b-6362ee42c619" version="1" />]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c</RefFunc>
<Extra><![CDATA[<Extra>
<Maxbb val="60" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
<IsScriptSetBB val="1" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="螞蟻功" ID="038935f7b9ba43a4b2576f316d077f66" ReturnType="0" ExecType="3" Folder="/A股用語/" StatusMask="2">
<Desc><![CDATA[延著均線前進]]></Desc>
<Code><![CDATA[//延著均線前進
input:Length(10); setinputname(1,"均線計算期數");
input:Length1(5); setinputname(2,"沿均線前進的期數");
input:Ratio(2); setinputname(3,"沿均線的範圍定義%");

settotalbar(maxlist(Length,Length1) + 3);

variable:x(0);
variable:count(0); count=0;

value1=average(close,Length);

for x=Length-1 downto 0
begin

	if value1[x] >= close[x]  and value1[x]*100 <=  (100+ratio) *Close
	then count += 1;

end;
if count >= Length1 then ret=1;
]]></Code>
<Arg><![CDATA[<Arg seed="e43354e9-ca22-4765-8aeb-83250e50b379" version="1"><Param name="均線計算期數" varname="Length" type="1" subtype="0" value="10" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="沿均線前進的期數" varname="Length1" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="沿均線的範圍定義%" varname="Ratio" type="1" subtype="0" value="2" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="92cb0688-95e3-45ac-8363-7f87b6fc38e2" version="1" />]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c</RefFunc>
<Extra><![CDATA[<Extra>
<Maxbb val="15" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="-1" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="連續五分鐘一路走高" ID="e446d207818346dcb8f3b81d1c849fe8" ReturnType="0" ExecType="1" Folder="/當沖交易型/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:TXT1("僅適用1分鐘線"); setinputname(1,"使用限制");
settotalbar(8);
if barfreq = "Min" and barinterval = 1 and
   TrueAll(close >Close[1] ,5) then ret=1;]]></Code>
<Arg><![CDATA[<Arg seed="e1b2823a-e4bb-4562-ac15-4a02c6b42eff" version="1"><Param name="使用限制" varname="TXT1" type="3" subtype="0" value="僅適用1分鐘線" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="1db633d7-c837-437f-b295-4e7eb7a618bd" version="1" />]]></Plots>
<RefFunc>1,93ec7a47222349e7ba8a2257d29196e4</RefFunc>
<Extra><![CDATA[<Extra>
<Maxbb val="5" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="8" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="一黑破三紅" ID="3a380a49c62747d7830e2b055bdbdc4c" ReturnType="0" ExecType="1" Folder="/短線操作型/" StatusMask="2">
<Desc><![CDATA[短線高點出現一黑破三紅的轉弱現象]]></Desc>
<Code><![CDATA[input:periods(20);setinputname(1,"計算期數(最小為5)");
input:ratio(20);setinputname(2,"累計漲幅%");

settotalbar(5);
setbarback(Periods);

variable:x(0);

if periods < 5 then return;

condition1=false;
condition2=false;
condition3=false;

if (high[1] - low[periods-1])/low[periods-1] >= ratio*0.01 
then condition1=true//近n日漲幅超過?%
else return;

if high>highest(high[1],3) and c<lowest(low[1],3)
then condition2=true//開盤是四日來新高但收盤比三日前低點低
else return;

//前二天每天比前一天上漲且連續三天收紅棒
condition3 = TrueAll(c[1]>c[2], 2) and
			 TrueAll(open[1]<close[1], 3); 

if condition1 and condition2 and condition3
then ret=1;


]]></Code>
<Arg><![CDATA[<Arg seed="5b89a3ba-f3b3-42b0-bde4-a214ee51f2d8" version="1"><Param name="計算期數(最小為5)" varname="periods" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="累計漲幅%" varname="ratio" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="f19bff49-3f3a-4069-a664-3f7eb9cea6bc" version="1" />]]></Plots>
<RefFunc>1,61c06064ad98469db9ce30287ae4a2c8;1,2bca774c6b7549c1b0b008d2a54b288e;1,f1b429ac13b2447c909302198c18ca56;1,93ec7a47222349e7ba8a2257d29196e4</RefFunc>
<Extra><![CDATA[<Extra>
<Maxbb val="25" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="5" />
<IsScriptSetBB val="1" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="價創近期新低量創新高" ID="65f538a36738401cab672e2f58a9bf11" ReturnType="0" ExecType="1" Folder="/價量指標/" StatusMask="2">
<Desc><![CDATA[收盤價跌破過去N期以來低點,成交量創新高]]></Desc>
<Code><![CDATA[input: Price(close); setinputname(1,"比較價別");
input: Length(20); setinputname(2,"近期期數");

settotalbar(3);
setbarback(Length);

if  Price < lowest(low[1] ,Length) and 
    volume > highest(volume[1],length) then ret=1;



	]]></Code>
<Arg><![CDATA[<Arg seed="fcedee14-7bb0-403e-b268-398849673003" version="1"><Param name="比較價別" varname="Price" type="1" subtype="1" value="close" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="近期期數" varname="Length" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="3796772f-53ba-44f7-941e-f683f4ae9f11" version="1" />]]></Plots>
<RefFunc>1,61c06064ad98469db9ce30287ae4a2c8;1,f1b429ac13b2447c909302198c18ca56;1,2bca774c6b7549c1b0b008d2a54b288e</RefFunc>
<Extra><![CDATA[<Extra>
<Maxbb val="50" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
<IsScriptSetBB val="1" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="三長下影線" ID="10ce4677f641422c8eac4adf6994bf37" ReturnType="0" ExecType="1" Folder="/酒田戰法/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input: Percent(1.5); setinputname(1,"下影線佔股價絕對百分比");
settotalbar(5);

condition1 = (minlist(open,close)-Low) > absvalue(open-close)*3; 
condition2 =  minlist(open, close)  > low* (100 + Percent)/100;

if trueall( condition1 and condition2, 3) then ret=1;]]></Code>
<Arg><![CDATA[<Arg seed="a31da151-80e3-425c-8f76-ba5e4a0a870a" version="1"><Param name="下影線佔股價絕對百分比" varname="Percent" type="1" subtype="0" value="1.5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="d4199cac-b3e3-4415-a45d-d3c82dc40bc6" version="1" />]]></Plots>
<RefFunc>1,93ec7a47222349e7ba8a2257d29196e4</RefFunc>
<Extra><![CDATA[<Extra>
<Maxbb val="5" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="5" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="RSI低檔背離" ID="9b22a66be6954810b0b83eeab96ebe31" ReturnType="0" ExecType="3" Folder="/技術分析/" StatusMask="2">
<Desc><![CDATA[RSI低檔往上與價格趨勢背離]]></Desc>
<Code><![CDATA[// RSI由下往上, 與價格趨勢背離
//
Input: RSILength(6), Threshold(20), Region(5);
variable: rsiValue(0);

settotalbar(maxlist(RSILength,6) * 8 + 8);

SetInputName(1, "期數");
SetInputName(2, "低檔值");
SetInputName(3, "日期區間");

RSIValue = RSI(Close, RSILength);
If RSIValue Crosses Above Threshold and
   RSIValue >= Highest(RSIValue, Region) and 
   Close <= Lowest(Close, Region) then
   Ret = 1;



        ]]></Code>
<Arg><![CDATA[<Arg seed="ed44cd3e-328b-42c2-8bf3-7efd5c7b8ce3" version="1"><Param name="期數" varname="RSILength" type="1" subtype="0" value="6" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="低檔值" varname="Threshold" type="1" subtype="0" value="20" isSerial="1" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="日期區間" varname="Region" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="22b8ff96-ae39-4ed3-98b0-437c1f2c5bd0" version="1" />]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c;1,d64c2a71d3ea43d985ca22ef62a5a8de;1,6850ead727a842bf883a1501d030ba98;1,61c06064ad98469db9ce30287ae4a2c8;1,2bca774c6b7549c1b0b008d2a54b288e;1,f1b429ac13b2447c909302198c18ca56</RefFunc>
<Extra><![CDATA[<Extra>
<Maxbb val="7" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="-1" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="投信搶買的股票" ID="dac915e21c7742b3904ef5eae49aa12e" ReturnType="0" ExecType="1" Folder="/短線操作型/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input: miniratio(10); setinputname(1,"投信買進佔今日總量%");
input: lv(2000); setinputname(2,"投信持股張數上限");
input: holdratio(10); setinputname(3,"投信持股比例上限%");
input:TXT1("僅適用日線"); setinputname(4,"使用限制");
input:TXT2("需選用逐筆洗價"); setinputname(5,"使用說明");
settotalbar(3);

if BarFreq <> "D"  then return;

//1.中小型股
//2.原來庫存低
//3.今天買進張數超過成交量的一成
//4.收今天最高

value1=GetField("Stotalbuy")[1];//投信買張
value2=GetField("Ssharesheld")[1];//投信持股
value3=GetField("Ssharesheldratio")[1];//投信持股比例

if close > high[1] and close[1]=high[1]   and //昨天收高 今日再漲
   value1 > volume[1] * miniratio*0.01 and //昨日買進張數超過成交量的一成
   value2 < lv and //原來庫存低
   value3 < holdratio //原來庫存低
then ret=1;
]]></Code>
<Arg><![CDATA[<Arg seed="f4050e66-380f-4f4d-bd26-23ab264558ae" version="1"><Param name="投信買進佔今日總量%" varname="miniratio" type="1" subtype="0" value="10" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="投信持股張數上限" varname="lv" type="1" subtype="0" value="2000" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="投信持股比例上限%" varname="holdratio" type="1" subtype="0" value="10" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="使用限制" varname="TXT1" type="3" subtype="0" value="僅適用日線" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="使用說明" varname="TXT2" type="3" subtype="0" value="需選用逐筆洗價" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="291a052f-9426-4c77-b877-99316bcd4801" version="1" />]]></Plots>
<Extra><![CDATA[<Extra>
<Maxbb val="2" />
<script>
<freq support="8;11;9;12;10;13;14;15" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="開高不拉回後再創新高" ID="5764c093506946e8b4fefcd7f2c79067" ReturnType="0" ExecType="2" Folder="/當沖交易型/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[if barfreq <>"Min" or barinterval<> 1 then raiseruntimeerror("歹勢，本腳本只適用於1分鐘線");

variable:count(0);

if date<>date[1] then count=0;
count=count+1;
  
if GetField("開盤價","D")> GetField("收盤價","D")[1]*1.025
and count>5
and lowest(low[1],count-1)*1.015>highest(high[1],count-1)
and close =highest(high,count)
then ret=1;]]></Code>
<Arg><![CDATA[<Arg seed="d732c554-a3bb-4742-b4c2-38597b97088d" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="d32ce865-ecae-4278-ba64-a2b97fdea354" version="1" />]]></Plots>
<RefFunc>1,61c06064ad98469db9ce30287ae4a2c8;1,f1b429ac13b2447c909302198c18ca56;1,2bca774c6b7549c1b0b008d2a54b288e</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="300" />
<Maxbb val="50" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="MACD黃金交叉" ID="1ab6815b8a7d4fcca720afbfe48a70b0" ReturnType="0" ExecType="1" Folder="/技術分析/" StatusMask="2">
<Desc><![CDATA[MACD黃金交叉]]></Desc>
<Code><![CDATA[// MACD 黃金交叉 (dif向上穿越macd)
//
input: FastLength(12), SlowLength(26), MACDLength(9);
variable: difValue(0), macdValue(0), oscValue(0);

SetTotalBar((maxlist(FastLength,SlowLength,6) + MACDLength) * 3 + 8);

SetInputName(1, "DIF短期期數");
SetInputName(2, "DIF長期期數");
SetInputName(3, "MACD期數");

MACD(weightedclose(), FastLength, SlowLength, MACDLength, difValue, macdValue, oscValue);

Ret = difValue Crosses Above macdValue;



]]></Code>
<Arg><![CDATA[<Arg seed="daf5c278-700c-4d26-b6ea-3fcd36247607" version="1"><Param name="DIF短期期數" varname="FastLength" type="1" subtype="0" value="12" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="DIF長期期數" varname="SlowLength" type="1" subtype="0" value="26" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="MACD期數" varname="MACDLength" type="1" subtype="0" value="9" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="9751191e-c128-45af-8cd2-c95ad2a9bb59" version="1" />]]></Plots>
<RefFunc>1,2549534038c6445884c25787277c86db;1,d02c45cba76f4163a048685f7bc4002b;1,8216021f4b11489b8faca5f2af7d0750;1,6850ead727a842bf883a1501d030ba98</RefFunc>
<Extra><![CDATA[<Extra>
<Maxbb val="2" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="-1" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="主力累計買超比例過門檻" ID="57807a43920c449895fbdf6133ae3015" ReturnType="0" ExecType="3" Folder="/技術分析/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[//作多  中小型股  持有二十天

input: Length(5); setinputname(1,"計算天數");
input:TXT("僅適用日線以上"); setinputname(2,"使用限制");
input:limit1(20);
setinputname(3,"買超佔成交量比例");

//透過Z的時間安排來決定現在用的是那一根Bar的資料 
variable: Z(0);
if GetFieldDate("主力買賣超張數") <> 0 then
	Z=0 
else 
	Z=1;
	
variable: b1(0), v1(0),ratio(0);

b1 = summation(GetField("主力買賣超張數")[Z], Length);
v1 = summation(Volume, Length);
ratio=b1/v1*100;
value1=GetField("主力買賣超張數")[Z];
if v1<>0
then 
begin
if ratio>=limit1 and average(volume,20)>1000
and trueall(value1>100,3)
and tselsindex(10,6)[Z]=1
then ret=1;
end;

]]></Code>
<Arg><![CDATA[<Arg seed="484b8d91-d8e7-4992-8142-128b4be43a2c" version="1"><Param name="計算天數" varname="Length" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="使用限制" varname="TXT" type="3" subtype="0" value="僅適用日線以上" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="買超佔成交量比例" varname="limit1" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="7fcd8456-606d-4128-a86b-9fbb9a9093d6" version="1" />]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c;1,93ec7a47222349e7ba8a2257d29196e4;1,d80cf92ddfcc42e0a6c53ec47edebd49;1,b1f1a25bdc014e109dc92d7f9b6ef207</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="300" />
<Maxbb val="50" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="死蜘蛛" ID="167c80a48da2423fb661c14e70d505db" ReturnType="0" ExecType="1" Folder="/A股用語/" StatusMask="2">
<Desc><![CDATA[三條均線上走後均走平後在同一時點交叉下彎]]></Desc>
<Code><![CDATA[input:ShortLength(5); setinputname(1,"短期均線期數");
input:MidLength(20); setinputname(2,"中期均線期數");
input:LongLength(60); setinputname(3,"長期均線期數");

settotalbar(3);
setbarback(maxlist(ShortLength,MidLength,LongLength));

value1=average(close,ShortLength);
value2=average(close,MidLength);
value3=average(close,LongLength);


condition1  = value1>close;
condition2  = close[1]>value3;

value4=maxlist(value1,value2,value3);
value5=minlist(value1,value2,value3);
value6=(value4-value5)/value4;

condition3 =  value6<0.02;

if condition1 and condition2 and condition3 then ret=1;]]></Code>
<Arg><![CDATA[<Arg seed="6c7e09cb-fbe3-4446-947d-480c919562db" version="1"><Param name="短期均線期數" varname="ShortLength" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="中期均線期數" varname="MidLength" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="長期均線期數" varname="LongLength" type="1" subtype="0" value="60" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="bbd11024-14e2-48e1-9434-eb8fa0564f7b" version="1" />]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c</RefFunc>
<Extra><![CDATA[<Extra>
<Maxbb val="65" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
<IsScriptSetBB val="1" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="開盤委賣暴增" ID="ea3e03bdef0742a7bdc0a9c1e70500e9" ReturnType="0" ExecType="3" Folder="/出場訊號/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[if close>close[90]*1.3 then begin
//先前有一定的漲幅
	value1=GetField("開盤委買","D");
	value2=GetField("開盤委賣","D");
	value3=value2-value1;
	if trueall(absvalue(value3[1])<250,10)
	//近十日開盤委買與開盤委賣張數差不多
	and value3>=500
	//今日開盤委賣比開盤委買多出500張以上
	and close<close[1]
	//收盤比前一日下跌
	and close<low*1.01
	//收盤接近當日最低價
	then ret=1;
end;
 ]]></Code>
<Arg><![CDATA[<Arg seed="04a458aa-0f8d-4c77-a80a-d04a0f2519f8" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="61b6cb05-5238-463e-aa70-27661984f5de" version="1" />]]></Plots>
<RefFunc>1,93ec7a47222349e7ba8a2257d29196e4</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<FirstBarDate val="0" />
<Maxbb val="20" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="Pivot Point短多策略" ID="f2c8c9a44cb94310b788d70ef773009c" ReturnType="0" ExecType="3" Folder="/技術分析/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[variable:pivot(0);

//透過Z的時間安排來決定現在用的是那一根Bar的資料 
variable: Z(0);
if currenttime > 180000 
or currenttime < 083000 then 
	Z =0 
else 
	Z=1;
	
pivot=(high+low+close)/3;
value1=2*pivot-low;
if close=value1
and tselsindex(10,6)[Z]=1
and volume>=1000
then ret=1;]]></Code>
<Arg><![CDATA[<Arg seed="de4d26c2-6c37-490c-85ec-9f767c7110b2" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="eda3cbb8-59d2-4cb6-8b2f-daf981e497bf" version="1" />]]></Plots>
<RefFunc>1,d80cf92ddfcc42e0a6c53ec47edebd49;1,b1f1a25bdc014e109dc92d7f9b6ef207</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<FirstBarDate val="0" />
<Maxbb val="20" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="ADX形成上昇趨勢" ID="b7ad2f9380de43a393d6c90327092d9b" ReturnType="0" ExecType="3" Folder="/技術分析/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input: Length(14, "期數"), Threshold(25, "穿越值");

variable: pdi_value(0), ndi_value(0), adx_value(0);

settotalbar(maxlist(Length,6) * 13 + 8);

//透過Z的時間安排來決定現在用的是那一根Bar的資料 
variable: Z(0);
if GetFieldDate("主力買賣超張數") <> 0 then
	Z=0 
else 
	Z=1;

DirectionMovement(Length, pdi_value, ndi_value, adx_value);

value1=GetField("主力買賣超張數")[Z];
if tselsindex(10,8)[Z]=1
and value1>300
and adx_value Crosses Above Threshold
then ret=1;

]]></Code>
<Arg><![CDATA[<Arg seed="a0b1b0ee-e9c1-4c21-bc91-ebbe2f89fc81" version="1"><Param name="期數" varname="Length" type="1" subtype="0" value="14" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="穿越值" varname="Threshold" type="1" subtype="0" value="25" isSerial="1" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="ac6c2e8f-68fc-4216-9eb0-1228076131c6" version="1" />]]></Plots>
<RefFunc>1,7721dca8cc7242c09d21b782bbb59bd9;1,d80cf92ddfcc42e0a6c53ec47edebd49;1,b1f1a25bdc014e109dc92d7f9b6ef207;1,6850ead727a842bf883a1501d030ba98</RefFunc>
<Extra><![CDATA[<Extra>
<FirstBarDate val="0" />
<Maxbb val="20" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="-1" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="突破繼續型態" ID="b9e3b3f440314721a754b87a3bf9de5f" ReturnType="0" ExecType="1" Folder="/短線操作型/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:Length(20); setinputname(1,"下降趨勢計算期數");
input:Rate(150); setinputname(2,"反轉率%");
variable: Factor(0);
settotalbar(Length + 3);

Factor = 100/Close[Length];

if close > open and  close < close[length] then
begin
	value1 = linearregslope(high*Factor,Length);
	value2 = linearregslope(high*Factor,3);
	if value1 < 0 and  value2-value1 > Rate*0.01 then ret=1;
end;]]></Code>
<Arg><![CDATA[<Arg seed="1d4d44e8-63b4-4ff9-b716-e05ce381168d" version="1"><Param name="下降趨勢計算期數" varname="Length" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="反轉率%" varname="Rate" type="1" subtype="0" value="150" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="3cf187ce-bc21-455b-bdde-20ffef11346a" version="1" />]]></Plots>
<RefFunc>1,8c2d025a23c548d3a76fba10c22527b4;1,210d0786cfe340538e34c095bc2ba049;1,626e6e5c42304bbea9809d1a07ae4e01</RefFunc>
<Extra><![CDATA[<Extra>
<Maxbb val="20" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="-1" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="下降趨勢突破" ID="7eb508d8a5cb4dc7a4a47c37876c954b" ReturnType="0" ExecType="3" Folder="/技術分析/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:in1(70,"計算區間"),in2(false,"嚴格模式");
//尋找不同區間大小下目測所認為的高點。

value1=highest(H,in1);//找出一定區間的高點
if value1>value1[1] then value2=value1;
//如果高點變高則保留高點，這樣做的原因是可以找到一波下降之後的高點
condition1 = value2=value2[1];
//條件:保留之高點維持(階梯的平台)
condition2 = trueall(condition1,in1);
//在計算區間內高點都沒有變 

if condition2 and not condition2[1]

then begin
	value6=value5;
	value5=value4;
	value4=value3;
	value3=value2;
end;
condition3 = 
	value3-value2<value4-value3 
	and value4-value3<value5-value4 
	and (value5-value4<value6-value5 or not in2)//嚴格模式多判斷一階
	and value3-value2>0
	;//平台的高度一階比一階低
if condition3[1] and not condition3 then ret=1;
	//此秩序被打破時進場
]]></Code>
<Arg><![CDATA[<Arg seed="c93e0989-734e-45a5-b45a-de8ed9248924" version="1"><Param name="計算區間" varname="in1" type="1" subtype="0" value="70" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="嚴格模式" varname="in2" type="2" subtype="0" value="0" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="b433b869-5041-4f6e-93aa-d555191d5a88" version="1" />]]></Plots>
<RefFunc>1,61c06064ad98469db9ce30287ae4a2c8;1,2bca774c6b7549c1b0b008d2a54b288e;1,93ec7a47222349e7ba8a2257d29196e4</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<FirstBarDate val="0" />
<Maxbb val="20" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="MTM突破零且投信買超" ID="e753d135fe684f10bd559c134c3456ee" ReturnType="0" ExecType="3" Folder="/技術分析/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[//透過Z的時間安排來決定現在用的是那一根Bar的資料 
variable: Z(0);
if GetFieldDate("主力買賣超張數") <> 0 then
	Z=0 
else 
	Z=1;
	
if momentum(close,10) crosses over 0
and GetField("投信買賣超")[Z]>1000 
then ret=1;]]></Code>
<Arg><![CDATA[<Arg seed="4736d5ed-f3f0-4a0f-a0c6-4ddb2995d292" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="3dc29649-efca-4aa1-88ee-e8acb944c8b6" version="1" />]]></Plots>
<RefFunc>1,239cb1c1f329431ea731982d8f5d94f2;1,6850ead727a842bf883a1501d030ba98</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<FirstBarDate val="0" />
<Maxbb val="20" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="當日上漲n%" ID="c7e65ba12ee24d5389a22bb5338e92bd" ReturnType="0" ExecType="1" Folder="/2.市場常用語/" StatusMask="2">
<Desc><![CDATA[當日上漲幅度大於設定值時觸發]]></Desc>
<Code><![CDATA[input:percent(1.5); setinputname(1,"當日上漲幅度%");

settotalbar(3);

variable:WorkTrue(true);

if  WorkTrue and  currenttime <= TimeAdd(time,"M",1) and 
    Close > GetField("RefPrice", "D") * (1+ Percent/100) then 
begin
Ret=1;
WorkTrue =false;
end;

if WorkTrue =false and Close < GetField("RefPrice", "D") * (1+ Percent/100) then WorkTrue =true;]]></Code>
<Arg><![CDATA[<Arg seed="5ce4ab6d-a3d0-4e5b-a98c-6da71d26c249" version="1"><Param name="當日上漲幅度%" varname="percent" type="1" subtype="0" value="1.5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="63570241-65f3-4ba3-9f94-d6ff77dfa367" version="1" />]]></Plots>
<Extra><![CDATA[<Extra>
<Maxbb val="2" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="底部確認" ID="86db7ef8da5446c0af4d59722b8b86f5" ReturnType="0" ExecType="3" Folder="/抄底策略/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:period(200,"天數");
variable: ld(0),hd(0),ldb(0),hdb(0),count(0),x1(0);

//透過Z的時間安排來決定現在用的是那一根Bar的資料 
variable: Z(0);
if currenttime > 180000 
or currenttime < 083000 then 
	Z =0 
else 
	Z=1;
	
count=0;
ld=lowest(low,period);
ldb=lowestbar(low,period);
hd=highest(high,period);
hdb=highestbar(high,period);
x1=GetField("總市值","D")[Z];//單位：億

if hdb>ldb and hd>ld*1.4 and ld>=ld[1] and x1>20 then begin
//股價大跌後
	value1=countif((close-open)/open>1.5,ldb);
	//自最低點以來的中長紅K棒數
	if value1>=ldb/5 then count=count+1;
	
	value2=summationif(close>close[1],volume,ldb);
	//自最低點以來的上漲量
	value3=summationif(close<close[1],volume,ldb);
	//自最低點以來的下跌量
	if value2>2*value3 then count=count+1;
	
	value4=nthlowestbar(2,low,ldb);
	//第二個低點的k棒位置
	value5=nthlowestbar(3,low,ldb);
	//第三個低點的K棒位置
	value6=nthlowestbar(4,low,ldb);
	//第四個低點的K棒位置
	if value4>value5 and value5>value6 then count=count+1;
	
	value7=countif(absvalue(close[1]/close-1)/close[1]*100<1 and close<close[1],ldb);
	//自低點以來的小黑棒K棒數
	if value7>0.5*countif(close<close[1],ldb) then count=count+1;
	//小黑k棒佔下跌k棒超過一半

	value8=countif(close>low*1.01,ldb);
	//自低點以來的長下影線天數
	if value8 >=ldb/5 then count=count+1;

	value9=countif(close=high,ldb);
	//自低點以來收最高的天數
	if value9>=ldb/5 then count=count+1;

	if ldb>=5 then count=count+1;
end;

if count[1]>2 and count crosses over 5 then ret=1;
]]></Code>
<Arg><![CDATA[<Arg seed="f503e1f3-c162-4f1d-96fa-a48ea051ab61" version="1"><Param name="天數" varname="period" type="1" subtype="0" value="200" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="d6a28cba-170f-499d-b6bf-f36ea884c40c" version="1" />]]></Plots>
<RefFunc>1,61c06064ad98469db9ce30287ae4a2c8;1,f1b429ac13b2447c909302198c18ca56;1,68349c444a9c43f09b19def4bddc206e;1,2bca774c6b7549c1b0b008d2a54b288e;1,328818c303ce4aa6a307cee4c60046b3;1,d80cf92ddfcc42e0a6c53ec47edebd49;1,95a5e49d2f6f4d369865c6de85a56469;1,f2404d9ffb2f49b3a38c431fcfc254b5;1,6bbc72256c3d4dbd9c7b3abd21a0be15;1,6850ead727a842bf883a1501d030ba98</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<FirstBarDate val="0" />
<Maxbb val="20" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="投信買張超過成交量一成" ID="d1b7ea3e3126428cade6960c77892023" ReturnType="0" ExecType="1" Folder="/短線操作型/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input: Ratio(10); setinputname(1,"投信持股%");
input: Gap(2.5); setinputname(2,"開盤不漲過幅度%");
input:TXT1("僅適用日線"); setinputname(3,"使用限制");
input:TXT2("須逐筆洗價"); setinputname(4,"使用說明");
settotalbar(3);
if BarFreq <> "D"  or currenttime > 90500 then return;

   
value1=GetField("Stotalbuy")[1];//投信買張
value2=GetField("Ssharesheldratio")[1];//投信持股比例
if value2<Ratio and value1/volume[1]>0.1 and close < close[1] *(1 + Gap * 0.01)
then ret=1;     ]]></Code>
<Arg><![CDATA[<Arg seed="a3f9d001-ec65-40c6-9850-fb5fd394dbc7" version="1"><Param name="投信持股%" varname="Ratio" type="1" subtype="0" value="10" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="開盤不漲過幅度%" varname="Gap" type="1" subtype="0" value="2.5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="使用限制" varname="TXT1" type="3" subtype="0" value="僅適用日線" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="使用說明" varname="TXT2" type="3" subtype="0" value="須逐筆洗價" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="32afbb59-5fc6-4662-8c52-0871e3b64cbc" version="1" />]]></Plots>
<Extra><![CDATA[<Extra>
<Maxbb val="2" />
<script>
<freq support="8;11;9;12;10;13;14;15" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="跌跌不休" ID="60a420b291aa4f31a9265dad3782c417" ReturnType="0" ExecType="1" Folder="/價量指標/" StatusMask="2">
<Desc><![CDATA[階梯量連三下跌 成交量逐步放大 價格逐步走低
        ]]></Desc>
<Code><![CDATA[settotalbar(5);
if volume > volume[1]     and 
   volume[1] > volume[2]  and
   close < close[1]       and   
   close[1] < close[2]    and 
   close < open and 
   close[1] < open[1] and 
   close[2] < open[2]
then ret=1;  



        
        ]]></Code>
<Arg><![CDATA[<Arg seed="cfa48e5b-21d4-44d5-aab5-c21cf429dd12" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="1868fa46-6e10-4f25-b055-a1c469c20e4c" version="1" />]]></Plots>
<Extra><![CDATA[<Extra>
<Maxbb val="5" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="5" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="融資追捧戰新高" ID="062db1f9913f4a56be8cc78477f64e3d" ReturnType="0" ExecType="1" Folder="/1.籌碼監控/" StatusMask="2">
<Desc><![CDATA[融資創N日新高後收盤價亦創N日新高.

需選用日線及逐筆洗價.]]></Desc>
<Code><![CDATA[input: pastDays(10); setinputname(1,"計算天數");
input:TXT("僅適用日線"); setinputname(2,"使用限制");

settotalbar(pastDays + 3);

if BarFreq <> "D" then return;

if Getfield("融資餘額張數")[1] = highest(Getfield("融資餘額張數")[1] ,pastDays) and
   close >= highest(high[1],pastDays)  
then ret=1;



        ]]></Code>
<Arg><![CDATA[<Arg seed="e049f00e-314e-437f-8b00-195305ad3f8b" version="1"><Param name="計算天數" varname="pastDays" type="1" subtype="0" value="10" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="使用限制" varname="TXT" type="3" subtype="0" value="僅適用日線" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="6a00b315-225b-415e-9b94-5a95718e10cb" version="1" />]]></Plots>
<RefFunc>1,61c06064ad98469db9ce30287ae4a2c8;1,2bca774c6b7549c1b0b008d2a54b288e</RefFunc>
<Extra><![CDATA[<Extra>
<Maxbb val="30" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="-1" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="野百合的春天" ID="d122d480bbd146b7a6ce0056d248a191" ReturnType="0" ExecType="3" Folder="/技術分析/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[//獲利穩定的公司  20天後出場

settotalbar(700);
if getsymbolfield("tse.tw","收盤價")
> average(getsymbolfield("tse.tw","收盤價"),10)
then begin
value4=GetField("總市值");
value5=average(value4,600);
if value4[1]<value5[1]*0.7
and close=highest(close,10)
then ret=1;
end;]]></Code>
<Arg><![CDATA[<Arg seed="2834c91b-ea83-4961-91ad-5db5fe272ca7" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="bccbfebd-72a4-48d3-bc8d-76b2bc33fac0" version="1" />]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c;1,61c06064ad98469db9ce30287ae4a2c8;1,2bca774c6b7549c1b0b008d2a54b288e</RefFunc>
<Extra><![CDATA[<Extra>
<FirstBarDate val="0" />
<Maxbb val="20" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="700" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="1.基本語法" ID="d49a730a955242c7b274f862da98ee3f" ReturnType="0" ExecType="1" Folder="/!語法範例/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[//基本語法共有以下幾個元素
//1.宣告參數
//2.宣告變數
//3.引用時間序列的回傳值﹙包括開高低收成交量等﹚
//4.運用函數
//5.條件判斷：例如使用cross over這樣的關係因子
//6.設定警示條件：if.. then ret=1;
//在這邊我們用一個警示來示範這幾個基本語法的使用方式。

//=================範例：平均漲跌幅變大========================================
//1.宣告參數：利用input宣告輸入的參數。
//宣告後的參數，可以直接在警示中進場數值的調整，而不需要調整腳本內容
input:shortlength(5),longlength(20);
//參數的名稱，可以用setinputname來指定中文的說明
//指定後再設定警示參數時，就可以直接看到中文，而非參數英文名稱
//我們在這邊故意只指定第一個參數的中文名，讓大家看看效果
setinputname(1,"短天期");

//2.宣告變數，利用variable
//這是宣告一個變數叫xi，其初始值為0
variable:xi(0);
variable:yi(0);

//3.引用時間序列的回傳值﹙包括開高低收成交量等﹚
//系統也提供value1~value99共99個不必宣告就可直接用的變數名稱
value1=close-close[1];//close[1]代表前一天收盤價

//4.運用函數
//透過absvalue這個函數取close-close[1]的絕對值
value2=absvalue(value1); 
//指定變數值的計算公式，計算漲跌幅
yi=value2/close; 
//透過average這個函數計算數列的平均值
value3=average(yi,longlength);//計算長期平均漲跌幅
value4=average(yi,shortlength);//計算短期平均漲跌幅

//5.條件判斷：例如使用cross over這樣的關係因子
//6.設定警示條件：if.. then ret=1;
//最後設定警示條件，當短期平均漲跌幅與長期平均漲跌幅黃金交叉時，觸發警示
if value4 crosses over value3
then ret=1;

]]></Code>
<Arg><![CDATA[<Arg seed="39156ae6-c786-49ef-977c-77007f58c0bd" version="1"><Param name="短天期" varname="shortlength" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="longlength" varname="longlength" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="f3be2f45-c907-47f9-9217-a635aa678150" version="1" />]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c;1,6850ead727a842bf883a1501d030ba98</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="50" />
<Maxbb val="25" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="趨勢翻多" ID="2f08aa893e564336b8c06b9f63036a4c" ReturnType="0" ExecType="3" Folder="/ETF策略/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:Length(20,"計算期間");

LinearReg(close, Length, 0, value1, value2, value3, value4);
//做收盤價20天線性回歸
//value1:斜率、value4:預期值
value5=rsquare(close,value4,20);//算收盤價與線性回歸值的R平方
 
if value1>0 and value1[1]<0 and value5>0.2 then ret=1;]]></Code>
<Arg><![CDATA[<Arg seed="63f55d80-9edc-4da7-a5c7-abde25002314" version="1"><Param name="計算期間" varname="Length" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="f722aa76-a27c-44bf-8578-a650f386697f" version="1" />]]></Plots>
<RefFunc>1,8c2d025a23c548d3a76fba10c22527b4;1,210d0786cfe340538e34c095bc2ba049;1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c;1,92fc51a453da4cd1b4448cc9a7677e84;1,63d7a17cf80a49098dfc97fc4b986abc</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<FirstBarDate val="0" />
<Maxbb val="20" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="長腳十字星" ID="aa9a1852fe3a4691b4df35b591b8addc" ReturnType="0" ExecType="1" Folder="/酒田戰法/" StatusMask="2">
<Desc><![CDATA[大波動十字線]]></Desc>
<Code><![CDATA[{																						
[檔名:]	長腳十字星			[資料夾:]	酒田戰法	[適用方向]	空															
[說明:]	大波動十字線																					
}																												
settotalbar(5);	
{判斷狀況}								
	condition1=	close>=open and open>=close					;//狀況1:	開收同價
	condition2=	(high-low)> close *0.015					;//狀況2:	波動大於1.5%
{結果判斷}		
IF		
		condition1
	and	condition2
THEN	RET=1;	]]></Code>
<Arg><![CDATA[<Arg seed="019c4dcb-35fb-4c04-878b-7c7f50f8854c" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="9d1dce07-df76-43e0-8a36-cf1e2cac7cb6" version="1" />]]></Plots>
<Extra><![CDATA[<Extra>
<Maxbb val="5" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="5" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="45度切線突破" ID="6643e0e08e7a4b439b9d2002f60a7188" ReturnType="0" ExecType="3" Folder="/技術分析/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input: period(20,"計算區間");
value1=rateofchange(close,period);
//計算區間漲跌幅
value2=arctangent(value1/period*100);
//計算上漲的角度
if value2 crosses over 45
then ret=1;]]></Code>
<Arg><![CDATA[<Arg seed="91fe97f4-6736-44c3-b33e-58d7bfa009db" version="1"><Param name="計算區間" varname="period" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="9ec85310-ca44-4153-a82d-8440145a6f44" version="1" />]]></Plots>
<RefFunc>1,c9f2641e5de0497cb352ace96f64236e;1,6850ead727a842bf883a1501d030ba98</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<FirstBarDate val="0" />
<Maxbb val="20" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="長波段回升" ID="cf0009882f00486088d9664b0bc6a492" ReturnType="0" ExecType="3" Folder="/波段操作型/" StatusMask="2">
<Desc><![CDATA[股價沉澱後拉升幅度預警]]></Desc>
<Code><![CDATA[input: Length1(30); setinputname(1,"落底天數");
input: Size1(2000); setinputname(2,"量縮張數");
input: Length2(20); setinputname(3,"籌碼沉澱天數");
input: Size2(1000); setinputname(4,"籌碼清洗張數");
input: Ratio(10); setinputname(5,"融資使用率%");
input: Percent(3); setinputname(6,"今日漲幅%");
input: Type(1); setinputname(7,"融資資料：0=今日 1=昨日");
input: TXT1("僅適用日線"); setinputname(8,"使用限制");
input: TXT2("盤中無當日融資資料"); setinputname(9,"建議使用單次洗價模式");

settotalbar(maxlist(Length1,Length2) + 3);

variable:newlowcount(0);

if barfreq <> "D"  or (currenttime < 133000 and Type=0) then return;
if Type = 0 then value1 = 0 else value1 = 1;

condition1=false;
condition2=false;
condition3=false;
condition4=false;

if close/close[1] > 1 + Percent * 0.01 //今日強勢股
then condition1=true
else return;


if average(volume,Length1) < Size1//長期乏人問津
then condition2=true
else return;

if  trueany( Low < Low[1],length1) then return;//多日未破底


value2=GetField("Pomremain")[value1];//融資餘額
value3=GetField("Pomusingratio")[value1];//融資使用率
if value2[Length2]-value2 > Size2 and value3 < Ratio * 0.01//籌碼長期沈澱
then condition3 = true 
else return;

if average(truerange,5)>average(truerange,10)//短線波動幅度開始變大
then condition4 = true
else return;

if condition1 and condition2 and condition3 and condition4 
then ret=1;

]]></Code>
<Arg><![CDATA[<Arg seed="ee2a7368-6cce-4d5d-be8b-0cdc5751a43e" version="1"><Param name="落底天數" varname="Length1" type="1" subtype="0" value="30" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="量縮張數" varname="Size1" type="1" subtype="0" value="2000" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="籌碼沉澱天數" varname="Length2" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="籌碼清洗張數" varname="Size2" type="1" subtype="0" value="1000" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="融資使用率%" varname="Ratio" type="1" subtype="0" value="10" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="今日漲幅%" varname="Percent" type="1" subtype="0" value="3" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="融資資料：0=今日 1=昨日" varname="Type" type="1" subtype="0" value="1" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="使用限制" varname="TXT1" type="3" subtype="0" value="僅適用日線" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="建議使用單次洗價模式" varname="TXT2" type="3" subtype="0" value="盤中無當日融資資料" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="484e5d91-dc55-48f9-ba6f-e78b21efec49" version="1" />]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c;1,1a0d56744f5a449ba941cf1b0ca7545f;1,36d1fc033c6f48f8a136f9e1fdec110f;1,81394f9cf0c8469ea5f8832700aec8b7;1,9e03682196e24611b2fe326b6a56433d</RefFunc>
<Extra><![CDATA[<Extra>
<Maxbb val="31" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="-1" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="散戶撿到出貨後創低" ID="08a01091ce4d42e3b6bdc7a95a2b127e" ReturnType="0" ExecType="1" Folder="/1.籌碼監控/" StatusMask="2">
<Desc><![CDATA[昨日主力籌碼轉進散戶後今日創新低.

需選用日線及逐筆洗價.]]></Desc>
<Code><![CDATA[input: ChangeKshares(1000); setinputname(1,"主力出貨張數");
input:TXT("僅適用日線"); setinputname(2,"使用限制");

settotalbar(3);

if BarFreq <> "D" then return;

if close < low[1] and
	GetField("主力買賣超張數")[1] < ChangeKshares*-1 and 
	GetField("散戶買賣超張數")[1] > ChangeKshares
then ret=1;

        ]]></Code>
<Arg><![CDATA[<Arg seed="65001920-d181-4e8e-9726-6957f78a9da0" version="1"><Param name="主力出貨張數" varname="ChangeKshares" type="1" subtype="0" value="1000" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="使用限制" varname="TXT" type="3" subtype="0" value="僅適用日線" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="83a6f89e-ae8a-4642-8013-513043a3d701" version="1" />]]></Plots>
<Extra><![CDATA[<Extra>
<Maxbb val="5" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="帶量空頭執帶" ID="375cc964d3fb4f7c8889b84affba5620" ReturnType="0" ExecType="1" Folder="/酒田戰法/" StatusMask="2">
<Desc><![CDATA[量倍增長黑棒]]></Desc>
<Code><![CDATA[{																						
[檔名:]	帶量空頭執帶			[資料夾:]	酒田戰法	[適用方向]	空															
[說明:]	量倍增長黑棒																																									
}
settotalbar(5);																														
{判斷狀況}								
	condition1=	( open - close ) > (high -low) * 0.8					;//狀況1:	實體黑K棒
	condition2=	close < close[1] - (high[1]-low[1])					;//狀況2:	波動向下放大
	condition3=	Volume > Volume[1]*2					;//狀況3:		
{結果判斷}		
IF		
		condition1
	and	condition2
	and	condition3
THEN	RET=1;	]]></Code>
<Arg><![CDATA[<Arg seed="fdfc4ab8-aef7-4ec9-8ffb-eba164d32064" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="df3b7b88-ce29-405a-bc56-d7b0bc1f000c" version="1" />]]></Plots>
<Extra><![CDATA[<Extra>
<Maxbb val="5" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="5" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="一分鐘K三連紅" ID="5d6ce573c4f5416c9f49b2d22bc2a759" ReturnType="0" ExecType="3" Folder="/當沖交易型/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[if barfreq <> "Min" or Barinterval <>1 then RaiseRuntimeError("請設定頻率為1分鐘");

variable:BarNumberOfToday(0); 

if Date <> Date[1] then 
	BarNumberOfToday=1
else 
	BarNumberOfToday+=1;{記錄今天的Bar數}
 
if barnumberoftoday=3 then begin
//今天第三根1分鐘K，也就是開盤第三分鐘
	if trueall(close>=close[1],3)
	//連三根K棒都是紅棒
	and volume>average(volume[1],3)*2
	//成交量是過去三根量平均量的兩倍以上
	and close=highd(0)
	//收最高
	then ret=1;
end;]]></Code>
<Arg><![CDATA[<Arg seed="2f154f0b-9839-4511-97f9-ea4d4de2a7b6" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="c38e7c67-e808-4b7a-9cbd-bfa1d56f1e24" version="1" />]]></Plots>
<RefFunc>1,93ec7a47222349e7ba8a2257d29196e4;1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c;1,61b7479e4304402c83419e5e14e287ba</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<FirstBarDate val="0" />
<Maxbb val="20" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="開大跌後未再探底" ID="a24514bacf504522b95dd87b25dc25b7" ReturnType="0" ExecType="1" Folder="/當沖交易型/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:ratio(4);     setinputname(1,"開低幅度%"); 
input:ratio1(0.5);  setinputname(2,"開低後回升幅度%");
settotalbar(3);
if GetField("Open", "D") < GetField("RefPrice", "D") * (1 -Ratio/100) and 
   GetField("Open", "D") >= GetField("Low", "D")  and
   (GetField("Open", "D")- GetField("Low", "D"))<  Close * Ratio1 and
   Close > GetField("Open", "D") * (1 + Ratio1/100) 
then ret=1;]]></Code>
<Arg><![CDATA[<Arg seed="6d311653-0820-4ff3-bba6-3832faae9f3b" version="1"><Param name="開低幅度%" varname="ratio" type="1" subtype="0" value="4" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="開低後回升幅度%" varname="ratio1" type="1" subtype="0" value="0.5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="6be5a835-d0fc-4f8a-ac5e-f07df416d0c4" version="1" />]]></Plots>
<Extra><![CDATA[<Extra>
<Maxbb val="2" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="外資買超但只開平高盤" ID="2736b98a2f9a4627a852ba90b3d9f6e3" ReturnType="0" ExecType="1" Folder="/短線操作型/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input: Atleast(1000); setinputname(1,"外資買超張數");
input: Gap(2); setinputname(2,"平盤幅度%");
input:TXT1("僅適用日線"); setinputname(3,"使用限制");
input:TXT2("需逐筆洗價"); setinputname(4,"使用說明:選日內單次觸發");

settotalbar(3);

if BarFreq = "D" and  Getfield("外資買賣超")[1] > Atleast and
   GetField("Open", "D") < GetField("RefPrice", "D") *(1+Gap/100) and
   GetField("Open", "D") > GetField("RefPrice", "D") 
then ret=1;

]]></Code>
<Arg><![CDATA[<Arg seed="083f9df6-4bfc-4be1-9105-97bbfd4f8cfb" version="1"><Param name="外資買超張數" varname="Atleast" type="1" subtype="0" value="1000" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="平盤幅度%" varname="Gap" type="1" subtype="0" value="2" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="使用限制" varname="TXT1" type="3" subtype="0" value="僅適用日線" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="使用說明:選日內單次觸發" varname="TXT2" type="3" subtype="0" value="需逐筆洗價" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="f80b7105-57ae-4a02-b07a-70b1cf5fba15" version="1" />]]></Plots>
<Extra><![CDATA[<Extra>
<Maxbb val="3" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="帶量多頭執帶" ID="2a50c09f525a48bf8847d5fe0abc4516" ReturnType="0" ExecType="1" Folder="/酒田戰法/" StatusMask="2">
<Desc><![CDATA[開在最低點一路走高收在最高點附近的K棒衝出倍增量]]></Desc>
<Code><![CDATA[{								
[檔名:]	帶量多頭執帶			[資料夾:]	酒田戰法	[適用方向]	多	
[說明:]	開在最低點一路走高收在最高點附近的K棒	衝出倍增量												
}								
settotalbar(5);								
{判斷狀況}								
	condition1=	close>open					;//狀況1:	
	condition2=	(Close-Open)>(high-low)*0.9					;//狀況2:	
	condition3=	Close>Close[1]+high[1]-low[1]					;//狀況3:	
	condition4=	Volume > Volume[1]*2					;//狀況4:		
{結果判斷}		
IF		
		condition1
	and	condition2
	and	condition3
	and	condition4
THEN	RET=1;	]]></Code>
<Arg><![CDATA[<Arg seed="817d40e3-890c-41d7-ba3a-719e5912342b" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="fb25f274-1451-4202-a959-e242f5f455f9" version="1" />]]></Plots>
<Extra><![CDATA[<Extra>
<Maxbb val="5" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="5" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="布林通道超賣訊號" ID="049eca86ab7b40b2ae81076e6390fc49" ReturnType="0" ExecType="1" Folder="/技術分析/" StatusMask="2">
<Desc><![CDATA[最低價跌破布林通道下緣時觸發提示]]></Desc>
<Code><![CDATA[// 布林通道超賣訊號
//
Input: Length(20), LowerBand(2);

settotalbar(Length + 3);

SetInputName(1, "期數");
SetInputName(2, "通道下緣");

Ret = Low <= bollingerband(Close, Length, -1 * LowerBand);



        ]]></Code>
<Arg><![CDATA[<Arg seed="f5872164-a9e0-4323-84e4-00061f571a91" version="1"><Param name="期數" varname="Length" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="通道下緣" varname="LowerBand" type="1" subtype="0" value="2" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="187d137c-7083-42d4-bd2a-56d0fa8246d1" version="1" />]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c;1,8c2d025a23c548d3a76fba10c22527b4;1,9c4f476d319b4f109a8dc8557099ded4;1,c1cda70a714d44999e5171fc53c95b0a;1,5f76de57dba441808c8c784d8fa54994</RefFunc>
<Extra><![CDATA[<Extra>
<Maxbb val="20" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="-1" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="開盤跳空上漲N%且有量" ID="8e73a35f8904401cbf2aff1b2dcd6749" ReturnType="0" ExecType="1" Folder="/盤中常用/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[if open >=close[1]*1.03
and volume*close>300000
then ret=1;]]></Code>
<Arg><![CDATA[<Arg seed="736b2378-5c60-4349-a1a6-32303b83511d" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="aca5ef7c-f413-4378-a2f8-f8169b09e410" version="1" />]]></Plots>
<Extra><![CDATA[<Extra>
<TotalBar val="300" />
<FirstBarDate val="0" />
<Maxbb val="50" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="OBV退潮" ID="de8de5c952b64cc789f35f22269c5c37" ReturnType="0" ExecType="3" Folder="/3.出場常用警示/" StatusMask="2">
<Desc><![CDATA[OBV量能退潮,股價翻轉向下]]></Desc>
<Code><![CDATA[input:Length(15); setinputname(1,"計算期數");
variable: OBVolume(0);

settotalbar(10);

value1 = close-close[1];

if close<> close[1] then 
   OBVolume +=  Volume*(value1)/absvalue(value1);

 if close<highest(high,Length) and
    OBVolume[2]=highest(OBVolume,Length) and 
	OBVolume=lowest(OBVolume,3)
 then ret=1;]]></Code>
<Arg><![CDATA[<Arg seed="ba9266d5-f65d-435e-8af0-b2cec7b75cb4" version="1"><Param name="計算期數" varname="Length" type="1" subtype="0" value="15" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="080df886-e44b-494a-a319-b979300998a6" version="1" />]]></Plots>
<RefFunc>1,61c06064ad98469db9ce30287ae4a2c8;1,2bca774c6b7549c1b0b008d2a54b288e;1,f1b429ac13b2447c909302198c18ca56</RefFunc>
<Extra><![CDATA[<Extra>
<Maxbb val="20" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="10" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="MACD出現賣出訊號" ID="62fa3e9095ce4218af76439f5c1fd0b0" ReturnType="0" ExecType="1" Folder="/3.出場常用警示/" StatusMask="2">
<Desc><![CDATA[MACD震盪往下穿越0軸]]></Desc>
<Code><![CDATA[input: FastLength(12), SlowLength(26), MACDLength(9);

SetTotalBar((maxlist(FastLength,SlowLength,6) + MACDLength) * 3 + 8);

SetInputName(1, "DIF短期期數");
SetInputName(2, "DIF長期期數");
SetInputName(3, "MACD天數");

variable: difValue(0), macdValue(0), oscValue(0);

MACD(weightedclose(), FastLength, SlowLength, MACDLength, difValue, macdValue, oscValue);

Ret = oscValue Crosses Below 0;
]]></Code>
<Arg><![CDATA[<Arg seed="2096d298-d252-453a-8c20-5c81b3c6a27a" version="1"><Param name="DIF短期期數" varname="FastLength" type="1" subtype="0" value="12" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="DIF長期期數" varname="SlowLength" type="1" subtype="0" value="26" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="MACD天數" varname="MACDLength" type="1" subtype="0" value="9" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="0283dab6-7ee1-402d-9885-3512354aae3a" version="1" />]]></Plots>
<RefFunc>1,2549534038c6445884c25787277c86db;1,d02c45cba76f4163a048685f7bc4002b;1,8216021f4b11489b8faca5f2af7d0750;1,9dc3f19597ba44fa91524e91ca67aebd</RefFunc>
<Extra><![CDATA[<Extra>
<Maxbb val="30" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="-1" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="券增價漲再推升" ID="61c263c6129140e28fcef9d397448c58" ReturnType="0" ExecType="1" Folder="/1.籌碼監控/" StatusMask="2">
<Desc><![CDATA[昨日融券餘額創新高,今日股價大幅再上漲3.5%.	
需選用日線及逐筆洗價.
        ]]></Desc>
<Code><![CDATA[input: pastDays(10); setinputname(1,"近期天數");
input: UpRatio(3.5); setinputname(2, "上漲幅度(%)");
input:TXT("僅適用日線"); setinputname(3,"使用限制");

settotalbar(pastdays + 3);

if BarFreq <> "D" then return;

if  close > high[1] and close > close[1]*(1 + UpRatio/100) and
	Getfield("融券餘額張數")[1] = highest(Getfield("融券餘額張數")[1] ,pastDays)  
then ret=1;
        ]]></Code>
<Arg><![CDATA[<Arg seed="c32f08e8-0eac-4eb8-83ca-f2607dea4ece" version="1"><Param name="近期天數" varname="pastDays" type="1" subtype="0" value="10" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="上漲幅度(%)" varname="UpRatio" type="1" subtype="0" value="3.5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="使用限制" varname="TXT" type="3" subtype="0" value="僅適用日線" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="c6b2e50d-3f91-4a14-b925-9f3e83c8cfd3" version="1" />]]></Plots>
<RefFunc>1,61c06064ad98469db9ce30287ae4a2c8;1,2bca774c6b7549c1b0b008d2a54b288e</RefFunc>
<Extra><![CDATA[<Extra>
<Maxbb val="30" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="-1" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="RSI高檔死亡交叉" ID="f088182a62bb46e98587b0ae196a1d34" ReturnType="0" ExecType="3" Folder="/3.出場常用警示/" StatusMask="2">
<Desc><![CDATA[短期RSI處於高於75之高檔,向下穿越長期RSI時觸發]]></Desc>
<Code><![CDATA[input: Length1(6); SetInputName(1, "短期期數");
input: Length2(12); SetInputName(2, "長期期數");
input: HighBound(75); SetInputName(3, "高檔區");

settotalbar(maxlist(Length1,Length2,6) * 8 + 8);

value1=RSI(close,Length1);
value2=RSI(close,Length2);

if value1 crosses under value2 and value1>HighBound
then ret=1;
]]></Code>
<Arg><![CDATA[<Arg seed="45268e81-0191-4f84-89ce-68b7fad128d0" version="1"><Param name="短期期數" varname="Length1" type="1" subtype="0" value="6" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="長期期數" varname="Length2" type="1" subtype="0" value="12" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="高檔區" varname="HighBound" type="1" subtype="0" value="75" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="1503be76-7f61-4196-8bb0-df04f433344b" version="1" />]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c;1,d64c2a71d3ea43d985ca22ef62a5a8de;1,9dc3f19597ba44fa91524e91ca67aebd</RefFunc>
<Extra><![CDATA[<Extra>
<Maxbb val="26" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="-1" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="股價震盪變大且收最低" ID="88502387dfff4732a167a38d8f4e760d" ReturnType="0" ExecType="1" Folder="/3.出場常用警示/" StatusMask="2">
<Desc><![CDATA[震盪幅度放大到一定幅度後收在當期收在最低點]]></Desc>
<Code><![CDATA[input:Length(5);setinputname(1,"計算震盪幅度的區間期數");
input:BaseLength(20);setinputname(2,"震盪幅度計算區間");
input:Ratio(50);setinputname(3,"震盪放大百分比%");

settotalbar(8);
setbackbar(maxlist(Length,BaseLength));

value1=highest(high,Length)-lowest(low,Length);
value2=average(value1,BaseLength);

if	value1 crosses over value2 *(1+ratio/100) and close=low
then ret=1;
]]></Code>
<Arg><![CDATA[<Arg seed="0a38ad17-4878-4217-ae63-d516ee5b8d1a" version="1"><Param name="計算震盪幅度的區間期數" varname="Length" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="震盪幅度計算區間" varname="BaseLength" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="震盪放大百分比%" varname="Ratio" type="1" subtype="0" value="50" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="5513db5f-3413-4d4e-9ce5-39d9e9b80af8" version="1" />]]></Plots>
<RefFunc>1,61c06064ad98469db9ce30287ae4a2c8;1,2bca774c6b7549c1b0b008d2a54b288e;1,f1b429ac13b2447c909302198c18ca56;1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c;1,6850ead727a842bf883a1501d030ba98</RefFunc>
<Extra><![CDATA[<Extra>
<Maxbb val="20" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="8" />
<IsScriptSetBB val="1" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="階梯式上漲" ID="834fb73a80e14a32aae7214e574b0857" ReturnType="0" ExecType="1" Folder="/當沖交易型/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:TXT1("僅適用1分鐘線"); setinputname(1,"使用限制");
input:TXT2("只於9:10判斷"); setinputname(2,"使用說明");
settotalbar(12);
if barfreq = "Min" and barinterval = 1 and time =91000 and
   TrueAll(close >Close[1] ,10) then ret=1;




]]></Code>
<Arg><![CDATA[<Arg seed="6c708410-224d-4034-99cf-6c01e08cbaaa" version="1"><Param name="使用限制" varname="TXT1" type="3" subtype="0" value="僅適用1分鐘線" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="使用說明" varname="TXT2" type="3" subtype="0" value="只於9:10判斷" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="bcdcc44d-c0e5-424f-8808-871dfafff193" version="1" />]]></Plots>
<RefFunc>1,93ec7a47222349e7ba8a2257d29196e4</RefFunc>
<Extra><![CDATA[<Extra>
<Maxbb val="10" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="12" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="N期內破底次數" ID="3414cd62ebac4abca905ab1222f8ae49" ReturnType="0" ExecType="1" Folder="/2.市場常用語/" StatusMask="2">
<Desc><![CDATA[N期內破底天數超過設定後再創低]]></Desc>
<Code><![CDATA[input:Length(10); setinputname(1,"n期內");
input:mNewLowTimes(3); setinputname(2,"創幾次以上新低");
 
variable: la(Length-1); //日數與參數調整
variable: QLow(0); QLow=Low[la]; //含當根K棒 最左邊第一筆資料起算
variable: _outputdays(0);　　_outputdays=0; //每跟K要歸0
variable: i(0); //迴圈用數

settotalbar(Length + 3);
 
for i = 1 to la begin  
     if ( Low[la-i]  < QLow ) then
      begin
        _outputdays+=1;　　
      　QLow = Low[la-i];
     end; 
end;

if Low = QLow and _outputdays >= mNewLowTimes then ret=1;]]></Code>
<Arg><![CDATA[<Arg seed="af5a1a21-c182-4c33-91c4-922c2ce8cded" version="1"><Param name="n期內" varname="Length" type="1" subtype="0" value="10" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="創幾次以上新低" varname="mNewLowTimes" type="1" subtype="0" value="3" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="f0105d48-ecfe-4db6-9d39-2918d3d35325" version="1" />]]></Plots>
<Extra><![CDATA[<Extra>
<Maxbb val="20" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="-1" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="外資換手再創高" ID="b7ab18f72fbe4ad38bd6021510ec4d4d" ReturnType="0" ExecType="1" Folder="/1.籌碼監控/" StatusMask="2">
<Desc><![CDATA[外資籌碼換手給外資,股價再創高點.
需選用日線及逐筆洗價.
        ]]></Desc>
<Code><![CDATA[Input: Percent(30); SetInputName(1, "外資換手比重(%)");
input:TXT("僅適用日線"); setinputname(2,"使用限制");

variable:FB(0);	FB=GetField("外資買張")[1];
variable:FS(0); FS=GetField("外資賣張")[1];	

settotalbar(5);

if BarFreq <> "D" then return;

if close > high[1] and FB-FS > 0 and (FB+FS) > 2 * volume[1] * Percent / 100  then ret=1;
]]></Code>
<Arg><![CDATA[<Arg seed="852ec8bc-3dcf-4575-8f3b-7e52b01ca5c2" version="1"><Param name="外資換手比重(%)" varname="Percent" type="1" subtype="0" value="30" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="使用限制" varname="TXT" type="3" subtype="0" value="僅適用日線" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="b2d7b885-db5a-4552-a545-1f311b740357" version="1" />]]></Plots>
<Extra><![CDATA[<Extra>
<Maxbb val="5" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="5" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="回頭高飛" ID="0a174d588a5949599b5810bf4d5ba192" ReturnType="0" ExecType="1" Folder="/A股用語/" StatusMask="2">
<Desc><![CDATA[開高5%以上，拉回又再拉漲停]]></Desc>
<Code><![CDATA[//開高5%以上，拉回又再拉漲停
settotalbar(3);

condition1  =  (Close  =  GetField("漲停價", "D"));
condition2  =  (GetField("Open", "D") > GetField("RefPrice", "D") *1.05);
condition3  =  (GetField("Low", "D") < GetField("Open", "D"));
condition4  =   close > close[1];

if condition1 and condition2 and condition3 and condition4 then ret=1;]]></Code>
<Arg><![CDATA[<Arg seed="6c402f80-d80b-43df-b3e5-23a177a9e10a" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="f4c8ad62-5381-45a2-b050-16c7d396aabf" version="1" />]]></Plots>
<Extra><![CDATA[<Extra>
<Maxbb val="2" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="多頭吞噬" ID="d69269540d594e33924862f78f98596c" ReturnType="0" ExecType="1" Folder="/酒田戰法/" StatusMask="2">
<Desc><![CDATA[前期收短黑K棒 當期開低走高拉出長紅棒 波動率放大 穿過昨高]]></Desc>
<Code><![CDATA[{																						
[檔名:]	多頭吞噬			[資料夾:]	酒田戰法	[適用方向]	多															
[說明:]	前期收短黑K棒 當期開低走高拉出長紅棒 波動率放大 穿過昨高																																									
}																												
settotalbar(5);	
{判斷狀況}								
	condition1=	( open[1] - close[1] ) >(high[1] -low[1])*0.75					;//狀況1:	前期出黑K棒
	condition2=	( close - open ) >(high -low) * 0.75					;//狀況2:	當期紅棒
	condition3=	high > high[1]					;//狀況3:	高過昨高
	condition4=	open<low[1]					;//狀況4:	開低破昨低	
{結果判斷}		
IF		
		condition1
	and	condition2
	and	condition3
	and	condition4
THEN	RET=1;	]]></Code>
<Arg><![CDATA[<Arg seed="b34c0a95-152a-4765-bcb2-3bcd2813972e" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="5ec009fd-b375-46d0-82bf-c30b0155fa9e" version="1" />]]></Plots>
<Extra><![CDATA[<Extra>
<Maxbb val="5" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="5" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="三下影線反轉直上買進訊號" ID="8e772499c37041b3b262a0c7dc0fbc6c" ReturnType="0" ExecType="3" Folder="/ETF策略/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input: Percent(0.5,"下影線佔股價絕對百分比");

variable:Kprice(0),OCDate(0);

condition1 = (minlist(open,close)-Low) > absvalue(open-close)*2; 
condition2 =  minlist(open, close)  > low* (100 + Percent)/100;

if trueall( condition1 and condition2, 3) then begin
	OCDate = Date;
	Kprice = average(H,3);
end;

if DateDiff(Date,OCDate) <3 and Close crosses over Kprice then ret = 1;

]]></Code>
<Arg><![CDATA[<Arg seed="5476ce4b-9b9d-43ef-9191-0856f78cc38a" version="1"><Param name="下影線佔股價絕對百分比" varname="Percent" type="1" subtype="0" value="0.5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="4f9bcbb9-bee6-4923-8190-8aa2edb85736" version="1" />]]></Plots>
<RefFunc>1,93ec7a47222349e7ba8a2257d29196e4;1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c;1,6850ead727a842bf883a1501d030ba98</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="300" />
<Maxbb val="50" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="投信連日大買超，股價未開高" ID="e221709fe51e43dbb6639fd982bd6da3" ReturnType="0" ExecType="1" Folder="/短線操作型/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:Periods(3); setinputname(1,"投信連續買超天數");
input:Atleast(10000); setinputname(2,"每日買超金額(萬元)");
input:Gap(1); setinputname(3,"開盤幅度%");
input:TXT1("僅適用日線"); setinputname(4,"使用限制");
input:TXT2("需逐筆洗價"); setinputname(5,"使用說明:選日內單次觸發");
settotalbar(Periods + 3);


if BarFreq = "D" and
   Trueall( Getfield("投信買賣超")[1]*Close*0.1 > Atleast ,Periods)  and
   GetField("Open", "D") < GetField("RefPrice", "D") *(1+Gap/100) 
then ret=1;
]]></Code>
<Arg><![CDATA[<Arg seed="b36ac172-1923-4182-84b3-151bcb71af26" version="1"><Param name="投信連續買超天數" varname="Periods" type="1" subtype="0" value="3" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="每日買超金額(萬元)" varname="Atleast" type="1" subtype="0" value="10000" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="開盤幅度%" varname="Gap" type="1" subtype="0" value="1" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="使用限制" varname="TXT1" type="3" subtype="0" value="僅適用日線" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="使用說明:選日內單次觸發" varname="TXT2" type="3" subtype="0" value="需逐筆洗價" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="c2b57180-d612-4207-97ee-820f80a015cc" version="1" />]]></Plots>
<RefFunc>1,93ec7a47222349e7ba8a2257d29196e4</RefFunc>
<Extra><![CDATA[<Extra>
<Maxbb val="15" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="-1" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="乖離反轉作多買進訊號" ID="9d76b97a99a44de89037a5a113f70070" ReturnType="0" ExecType="3" Folder="/技術分析/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[//用週線  四週後出場
input:Length(20,"計算期數");
input:Ratio(21,"乖離%");
input:TXT("僅適用日線","使用限制");

settotalbar((Length+10)*5);

//透過Z的時間安排來決定現在用的是那一根Bar的資料 
variable: Z(0);
if GetFieldDate("主力買賣超張數") <> 0 then
	Z=0 
else 
	Z=1;
	
variable:KPrice(0);
if close <= average(getfield("close","W"),Length) * (1-Ratio/100) then KPrice = getfield("high","W");
value1=GetField("投信買賣超")[Z];
value2=value1*close*1000;
if countif(value2>1000000,3)>2
and close>KPrice and getfield("close","W")[1] < xf_getvalue("W",KPrice,1)
then ret=1 ;
]]></Code>
<Arg><![CDATA[<Arg seed="8927577e-d462-47a9-9ea3-c72137bf8db0" version="1"><Param name="計算期數" varname="Length" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="乖離%" varname="Ratio" type="1" subtype="0" value="21" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="使用限制" varname="TXT" type="3" subtype="0" value="僅適用日線" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="1e4a1260-182f-455f-9695-4e0bbc4d6266" version="1" />]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c;1,d80cf92ddfcc42e0a6c53ec47edebd49;1,57f222578a2c4d17b2b88b65b8f28696;1,ae592f43d76b43c589aaa0eb0e6ecb27</RefFunc>
<Extra><![CDATA[<Extra>
<Maxbb val="50" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="-1" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="突破投信成本線" ID="5dc53f4f26d2465897503aea6b8c95ea" ReturnType="0" ExecType="1" Folder="/技術分析/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[//小型股
input: pastDays(3); setinputname(1,"計算天數");
input: _BuyRatio(10); setinputname(2,"買超佔比例(%)");
 
variable: SumAm(0),SumForce(0), SumTotalVolume(0),APrice(0),AVGP(0),Kprice(0),QDate(0);
 
if V[1] <> 0 then
	APrice = GetField("成交金額")[1] / V[1]/1000;
 
SumAm = Summation(GetField("投信買賣超")[1]*APrice, pastDays);
SumForce = Summation(GetField("投信買賣超")[1], pastDays);
 
sumTotalVolume = Summation(Volume[1], pastDays);
 
if SumAm > 30000 and SumForce > SumTotalVolume * _BuyRatio/100 then
begin
Kprice =highest(avgprice,pastDays);
QDate=Date;
end;
 
if DateDiff(Date,QDate) < pastDays+5 and C > Kprice and C[1] < Kprice then ret=1;]]></Code>
<Arg><![CDATA[<Arg seed="67c1fa61-a8a7-4f26-bd45-201ff254c91d" version="1"><Param name="計算天數" varname="pastDays" type="1" subtype="0" value="3" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="買超佔比例(%)" varname="_BuyRatio" type="1" subtype="0" value="10" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="d9df65a1-2062-4ea5-b4bd-d3a23f0bf36c" version="1" />]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d;1,388033a24d7843e0b867cdc134206623;1,61c06064ad98469db9ce30287ae4a2c8;1,2bca774c6b7549c1b0b008d2a54b288e</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<FirstBarDate val="0" />
<Maxbb val="20" />
<script>
<freq support="8;11;9;12;10;13" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="跌幅警示" ID="aec37f8a3c7f48b8ad3dbec3ad2c4263" ReturnType="0" ExecType="1" Folder="/技術分析/" StatusMask="2">
<Desc><![CDATA[N期跌幅大於某個幅度]]></Desc>
<Code><![CDATA[input: Length(5), Percent(3);

settotalbar(3);
setbarback(length);

SetInputName(1, "計算期數");
SetInputName(2, "累計下跌幅度(%)");

Ret = RateOfChange(Close, Length) < -1 * Percent;



]]></Code>
<Arg><![CDATA[<Arg seed="0f3f5e19-7a69-49cc-8dc4-34208ef9c853" version="1"><Param name="計算期數" varname="Length" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="累計下跌幅度(%)" varname="Percent" type="1" subtype="0" value="3" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="9c3014ef-d275-4117-b374-1408b516bcc6" version="1" />]]></Plots>
<RefFunc>1,c9f2641e5de0497cb352ace96f64236e</RefFunc>
<Extra><![CDATA[<Extra>
<Maxbb val="5" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
<IsScriptSetBB val="1" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="當沖一號" ID="33f4a52a15cf48a8a9cc478003bd0751" ReturnType="0" ExecType="3" Folder="/當沖交易型/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[if barfreq <>"Min" or  barinterval<> 1 then raiseruntimeerror("歹勢，本腳本只適用於1分鐘線");

variable:count(0);

if date<>date[1] then count=0;
count=count+1;

if GetField("開盤價","D")> GetField("收盤價","D")[1]*1.025
and count>20
and lowest(low[1],count-1)*1.015>highest(high[1],count-1)
and close =highest(high,count)
then ret=1;



]]></Code>
<Arg><![CDATA[<Arg seed="877f2d79-d506-419d-81d7-566fc03f319d" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="1ebe37d0-ee04-4794-bde8-86ef4eaf7ecc" version="1" />]]></Plots>
<RefFunc>1,61c06064ad98469db9ce30287ae4a2c8;1,f1b429ac13b2447c909302198c18ca56;1,2bca774c6b7549c1b0b008d2a54b288e</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<FirstBarDate val="0" />
<Maxbb val="20" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="波幅縮小後的突破" ID="d0f4b5e75f3b445c8c7f2c795b846c3e" ReturnType="0" ExecType="3" Folder="/波段操作型/" StatusMask="2">
<Desc><![CDATA[波幅縮小後的突破]]></Desc>
<Code><![CDATA[input:period2(4);  setinputname(1,"短期期數");
input:period1(12); setinputname(2,"長期期數");
input:ratio(2);    setinputname(3, "漲幅%");
input:TXT("建議使用5分鐘"); setinputname(4,"使用說明");

settotalbar(3);
setbarback(maxlist(period1,period2));

if close > close[1] * (1 + ratio*0.01) then 
begin
	value1=average(truerange,period1);
	value2=average(truerange,period2);
	if value1>value2 and value2 < close* 0.02 then ret=1;
end;]]></Code>
<Arg><![CDATA[<Arg seed="b01dcace-9bee-4326-ba0b-a87b85a14a60" version="1"><Param name="短期期數" varname="period2" type="1" subtype="0" value="4" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="長期期數" varname="period1" type="1" subtype="0" value="12" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="漲幅%" varname="ratio" type="1" subtype="0" value="2" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="使用說明" varname="TXT" type="3" subtype="0" value="建議使用5分鐘" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="2882bcd5-5afa-4e95-9f9f-13f9948d1197" version="1" />]]></Plots>
<RefFunc>1,36d1fc033c6f48f8a136f9e1fdec110f;1,81394f9cf0c8469ea5f8832700aec8b7;1,9e03682196e24611b2fe326b6a56433d;1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c</RefFunc>
<Extra><![CDATA[<Extra>
<Maxbb val="16" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
<IsScriptSetBB val="1" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="中小型股整理結束" ID="d59695b8e7b64cbe9758cd1a67fb616d" ReturnType="0" ExecType="3" Folder="/短線操作型/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input: Periods(20); setinputname(1,"計算期數");
input: Ratio(3);setinputname(2,"近期波動幅度%");

settotalbar(300);
setbarback(50);

condition1 = false;

if (highest(high[1],Periods-1) - lowest(low[1],Periods-1)) <= ratio*0.01*close[1]
then condition1=true//近期波動在?%以內
else return;

if condition1 
and high = highest(high, Periods)
and GetSymbolField("tse.tw","收盤價")>average(GetSymbolField("tse.tw","收盤價"),10)
and average(GetSymbolField("tse.tw","收盤價"),5)>average(GetSymbolField("tse.tw","收盤價"),20)
then ret=1;//盤整後往上突破
]]></Code>
<Arg><![CDATA[<Arg seed="c6113790-b3d8-4b8c-8bed-a7ee624fd837" version="1"><Param name="計算期數" varname="Periods" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="近期波動幅度%" varname="Ratio" type="1" subtype="0" value="3" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="d42ab763-97e3-4dee-93ad-e66f0ee05ff9" version="1" />]]></Plots>
<RefFunc>1,61c06064ad98469db9ce30287ae4a2c8;1,2bca774c6b7549c1b0b008d2a54b288e;1,f1b429ac13b2447c909302198c18ca56;1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c</RefFunc>
<Extra><![CDATA[<Extra>
<FirstBarDate val="0" />
<Maxbb val="20" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="300" />
<IsScriptSetBB val="1" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="漲幅警示" ID="39a0b049715946b6a186197bcc941ee9" ReturnType="0" ExecType="1" Folder="/技術分析/" StatusMask="2">
<Desc><![CDATA[N期漲幅大於某個幅度]]></Desc>
<Code><![CDATA[input: Length(5), Percent(3);

settotalbar(3);
setbarback(Length);

SetInputName(1, "計算期數");
SetInputName(2, "累計上漲幅度(%)");

Ret = Rateofchange(Close, Length) > Percent;



]]></Code>
<Arg><![CDATA[<Arg seed="7564e30b-50f8-4dd3-a13c-676081256ee4" version="1"><Param name="計算期數" varname="Length" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="累計上漲幅度(%)" varname="Percent" type="1" subtype="0" value="3" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="7abaeeea-bafe-4b3a-9991-d106e14b39ec" version="1" />]]></Plots>
<RefFunc>1,c9f2641e5de0497cb352ace96f64236e</RefFunc>
<Extra><![CDATA[<Extra>
<Maxbb val="5" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
<IsScriptSetBB val="1" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="MTM跌破0" ID="ae50edbe0f1e4e8d939661cd7033bd73" ReturnType="0" ExecType="3" Folder="/技術分析/" StatusMask="2">
<Desc><![CDATA[MTM往下穿過0軸]]></Desc>
<Code><![CDATA[// MTM往下跌破0軸
//
Input: Length(10);

settotalbar(maxlist(Length,6) + 8);

SetInputName(1, "期數");

Ret = Momentum(Close, Length) Crosses Below 0;



]]></Code>
<Arg><![CDATA[<Arg seed="97738a1e-76b1-4ea5-a9ff-85ab7f36f091" version="1"><Param name="期數" varname="Length" type="1" subtype="0" value="10" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="ec854390-af36-4688-8fc2-68d12e99ed7c" version="1" />]]></Plots>
<RefFunc>1,239cb1c1f329431ea731982d8f5d94f2;1,9dc3f19597ba44fa91524e91ca67aebd</RefFunc>
<Extra><![CDATA[<Extra>
<Maxbb val="11" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="-1" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="連日外盤攻擊創新高" ID="8a5940b0f425480e8d28a10c3a17270d" ReturnType="0" ExecType="1" Folder="/1.籌碼監控/" StatusMask="2">
<Desc><![CDATA[連續三日出外盤量推升,今日再攻擊.

需選用日線及逐筆洗價.
        ]]></Desc>
<Code><![CDATA[input:TXT("僅適用日線"); setinputname(1,"使用限制");

settotalbar(3);

if BarFreq <> "D" then return;

if Close > maxlist(high[1],high[2]) and GetField("內盤量","D")>0 and GetField("外盤量") > GetField("內盤量","D") * 1.2  then
begin
	if TrueAll(Getfield("外盤量")[1] > 1.1 * Getfield("內盤量")[1], 3) then ret=1;
end;
        ]]></Code>
<Arg><![CDATA[<Arg seed="c7515a66-61cc-4357-bcc2-7150ea48b28d" version="1"><Param name="使用限制" varname="TXT" type="3" subtype="0" value="僅適用日線" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="4ea89b0c-7ec0-413d-baee-3fe63146ab48" version="1" />]]></Plots>
<RefFunc>1,93ec7a47222349e7ba8a2257d29196e4</RefFunc>
<Extra><![CDATA[<Extra>
<Maxbb val="5" />
<script>
<freq support="8;11" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="大單敲進" ID="af16457a10c6411a8655e9bbbe89b274" ReturnType="0" ExecType="3" Folder="/盤中常用/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input: atVolume(50,"大單門檻");
input: LaTime(10,"大單筆數");
input: TXT("須逐筆洗價","使用限制");

settotalbar(3);

variable:  intrabarpersist Xtime(0);
//計數器
variable: intrabarpersist Volumestamp(0);

Volumestamp =GetField("Volume", "D");
if time < time[1] 
or Volumestamp = Volumestamp[1]
then Xtime =0; //開盤那根要歸0次數

if GetField("Volume", "Tick") > atVolume
//單筆tick成交量超過大單門檻
and GetField("內外盤","Tick")=1
//外盤成交
then Xtime+=1; 
//量夠大就加1次
if Xtime > LaTime then begin
	ret=1; 
	Xtime=0;
end;]]></Code>
<Arg><![CDATA[<Arg seed="33535b49-593d-4e80-a08e-60b06e463635" version="1"><Param name="大單門檻" varname="atVolume" type="1" subtype="0" value="50" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="大單筆數" varname="LaTime" type="1" subtype="0" value="10" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="使用限制" varname="TXT" type="3" subtype="0" value="須逐筆洗價" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="ae5cb554-2060-4b76-b146-b0cfb0c2818c" version="1" />]]></Plots>
<Extra><![CDATA[<Extra>
<FirstBarDate val="0" />
<Maxbb val="20" />
<script>
<freq support="1;8;11;9;12;10;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="近期持續強勢股階梯式上漲" ID="56e454068a214bf1af7f92d47ffe260e" ReturnType="0" ExecType="3" Folder="/當沖交易型/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[if barfreq<> "Min"and barinterval<> 5 then raiseruntimeerror("本腳本只限五分鐘線");

condition1 = GetSymbolField("tse.tw","收盤價","D") > average(GetSymbolField("tse.tw","收盤價","D"),10);
//多頭市場

condition2 = GetSymbolField("tse.tw","收盤價","D") / GetSymbolField("tse.tw","收盤價","D")[2]+0.01
			  <  GetField("收盤價","D")/GetField("收盤價","D")[2];
//前兩日比大盤明顯走強

condition3 = GetField("收盤價","D")[1] <GetField("收盤價","D")[10]*1.07;
//近十日沒有漲的太兇

condition4 = Average(GetField("Volume", "D")[1], 100) >= 1000;

if condition1 and condition2 and condition3 and condition4 then begin
	if time=091500
	and trueall(close>close[1],3)
	//開盤三根五分鐘線都是紅棒
	and average(volume,3)>average(volume,20)*1.3
	//開盤的量能明顯增加
	and GetField("收盤價","D")[1]<GetField("收盤價","D")[2]
	then ret=1;
end;

]]></Code>
<Arg><![CDATA[<Arg seed="808b4986-bebe-4cf8-90a2-6b28a862a03c" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="da659047-10f7-4a99-8eee-9feeee57927f" version="1" />]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c;1,93ec7a47222349e7ba8a2257d29196e4</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<FirstBarDate val="0" />
<Maxbb val="20" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="一小時線長期盤整後突破" ID="fc2ff1d2f28d4ad99fed71936b47c8cc" ReturnType="0" ExecType="1" Folder="/短線操作型/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[//盤整後噴出
input: Periods(20); setinputname(1,"計算期數");
input: Ratio(3);setinputname(2,"近期波動幅度%");
input: Direction(1);setinputname(3,"方向:1突破 -1跌破");
input: TXT1("僅適用60分鐘"); setinputname(4,"使用限制");

settotalbar(3);
setbarback(Periods);


condition1 = false;

if (highest(high[1],Periods-1) - lowest(low[1],Periods-1))/close[1] <= ratio*0.01 
then condition1=true//近期波動在?%以內
else return;

if condition1 and Direction > 0 and high = highest(high, Periods)
then ret=1;//盤整後往上突破

if condition1 and Direction < 0 and low = lowest(low, Periods)
then ret=1;//盤整後往下跌破


]]></Code>
<Arg><![CDATA[<Arg seed="c689b7c2-3187-4215-b302-750238af914a" version="1"><Param name="計算期數" varname="Periods" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="近期波動幅度%" varname="Ratio" type="1" subtype="0" value="3" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="方向:1突破 -1跌破" varname="Direction" type="1" subtype="0" value="1" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="使用限制" varname="TXT1" type="3" subtype="0" value="僅適用60分鐘" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="65bcad13-fe67-4407-8178-f0b84c71e91c" version="1" />]]></Plots>
<RefFunc>1,61c06064ad98469db9ce30287ae4a2c8;1,2bca774c6b7549c1b0b008d2a54b288e;1,f1b429ac13b2447c909302198c18ca56</RefFunc>
<Extra><![CDATA[<Extra>
<Maxbb val="30" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
<IsScriptSetBB val="1" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="盤整後跳空走高" ID="a53b345e0bac4e039b3dec5ad78ed1dc" ReturnType="0" ExecType="3" Folder="/技術分析/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[//中小型股  停損停利都是5%
input:period(20,"盤整區間");

//透過Z的時間安排來決定現在用的是那一根Bar的資料 
variable: Z(0);
if currenttime > 180000 
or currenttime < 083000 then 
	Z =0 
else 
	Z=1;
	
value1=highest(high[1],period);
value2=lowest(low[1],period);
if value1<value2*1.05
and open > high[1]*1.025
and tselsindex(10,7)[Z]=1
then ret=1;]]></Code>
<Arg><![CDATA[<Arg seed="9f5b7849-b4b2-4569-a4b8-05287235d7f2" version="1"><Param name="盤整區間" varname="period" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="d27ff6f9-9c9c-41e2-9544-9def7019e0a8" version="1" />]]></Plots>
<RefFunc>1,61c06064ad98469db9ce30287ae4a2c8;1,2bca774c6b7549c1b0b008d2a54b288e;1,f1b429ac13b2447c909302198c18ca56;1,d80cf92ddfcc42e0a6c53ec47edebd49;1,b1f1a25bdc014e109dc92d7f9b6ef207</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<FirstBarDate val="0" />
<Maxbb val="20" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="三連陽過前年最高點" ID="fddb10829b4a4f53be004720ce55a4d3" ReturnType="0" ExecType="3" Folder="/技術分析/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[//全部  持有二十天

input:period(500,"創n日新高");
settotalbar(period);

//透過Z的時間安排來決定現在用的是那一根Bar的資料 
variable: Z(0);
if GetFieldDate("主力買賣超張數") <> 0 then
	Z=0 
else 
	Z=1;

value1=GetField("強弱指標","D")[Z];
value2=GetField("主力買賣超張數")[Z];
if close crosses over highest(close[1],period)
and trueall(close>close[1],3)
and trueall(value2>0,3)
and tselsindex(10,6)[Z]=1

then ret=1;
]]></Code>
<Arg><![CDATA[<Arg seed="f3180a42-d4be-470c-81c3-ad9a746a7c41" version="1"><Param name="創n日新高" varname="period" type="1" subtype="0" value="500" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="5f8f4e12-77ed-4676-a0da-bddde833d7be" version="1" />]]></Plots>
<RefFunc>1,61c06064ad98469db9ce30287ae4a2c8;1,2bca774c6b7549c1b0b008d2a54b288e;1,6850ead727a842bf883a1501d030ba98;1,93ec7a47222349e7ba8a2257d29196e4;1,d80cf92ddfcc42e0a6c53ec47edebd49;1,b1f1a25bdc014e109dc92d7f9b6ef207</RefFunc>
<Extra><![CDATA[<Extra>
<FirstBarDate val="0" />
<Maxbb val="20" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="-1" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="開盤五分鐘創三新高" ID="c3478004b3b14e65967276380eab3e0f" ReturnType="0" ExecType="1" Folder="/當沖交易型/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:TXT("僅適用1分鐘線"); setinputname(1,"使用限制");
settotalbar(8);
variable:KBarOfDay(0); KBarOfDay+=1; if date<>date[1] then  KBarOfDay=1; 

if barfreq<> "Min"  and barinterval = 1 and Date = CurrentDate   and
   KBarOfDay = 6 and
   Countif(High > High[1] and Close > Close[1] ,5) >=3  then Ret=1;]]></Code>
<Arg><![CDATA[<Arg seed="921c8ff4-822f-4ab3-8761-a097953b3540" version="1"><Param name="使用限制" varname="TXT" type="3" subtype="0" value="僅適用1分鐘線" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="8775144e-ef3b-478a-a656-53686aef7104" version="1" />]]></Plots>
<RefFunc>1,d80cf92ddfcc42e0a6c53ec47edebd49</RefFunc>
<Extra><![CDATA[<Extra>
<Maxbb val="6" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="8" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="近幾日總是收黑K" ID="36470ecc642d454ab47ce28a6b6302d4" ReturnType="0" ExecType="3" Folder="/出場訊號/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[if countif(close<open,7)>=5
//過去七天有五天以上收黑
and lowest(close,90)*1.4<close
//過去九十天漲幅超過四成
and lowest(close,10)*1.2<close
//過去十天有急拉過
and volume*1.2<average(volume,20)
//成交量低於二十日均量的兩成
then ret=1;]]></Code>
<Arg><![CDATA[<Arg seed="46e379e7-a02d-45f7-8fcd-5cac5e9a74f1" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="5a08460a-77f3-4283-9914-2cb14b28e392" version="1" />]]></Plots>
<RefFunc>1,d80cf92ddfcc42e0a6c53ec47edebd49;1,61c06064ad98469db9ce30287ae4a2c8;1,f1b429ac13b2447c909302198c18ca56;1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<FirstBarDate val="0" />
<Maxbb val="20" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="天量後價量未再創新高" ID="2c84445ec2f24f30bd249d91bc83569e" ReturnType="0" ExecType="3" Folder="/3.出場常用警示/" StatusMask="2">
<Desc><![CDATA[出長期大量創新高後超過N日價量皆未再創新高]]></Desc>
<Code><![CDATA[input:XLength(60); setinputname(1,"長期大量計算期數");
input:Length(3); setinputname(2,"自高點回檔天數");
input:TXT("建議使用日線"); setinputname(3,"使用說明");

variable: PriceHighBar(0),VolumeHighBar(0);

settotalbar(XLength + 3);

extremes(high,Length,1,value1,PriceHighBar);
extremes(volume,XLength,1,value1,VolumeHighBar);

if (PriceHighBar =Length-1) and VolumeHighBar=Length-1  then
ret=1;

]]></Code>
<Arg><![CDATA[<Arg seed="30f509ee-ded5-4138-a624-ed6b6d19a465" version="1"><Param name="長期大量計算期數" varname="XLength" type="1" subtype="0" value="60" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="自高點回檔天數" varname="Length" type="1" subtype="0" value="3" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="使用說明" varname="TXT" type="3" subtype="0" value="建議使用日線" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="5ba9cc11-e1ee-4e04-8717-9b1a41fa0cca" version="1" />]]></Plots>
<RefFunc>1,61c06064ad98469db9ce30287ae4a2c8</RefFunc>
<Extra><![CDATA[<Extra>
<Maxbb val="60" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="-1" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="即將鎖第一根漲停" ID="927bb27370374555adeed20e78a749b6" ReturnType="0" ExecType="1" Folder="/當沖交易型/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:Length(20); setinputname(1,"過去無漲停期數");
input:Ratio(1); setinputname(2,"差幾%漲停");
input:TXT("請用日線逐筆洗價"); setinputname(3,"使用限制");

settotalbar(Length + 3);

if BarFreq = "D" then 
  if Close > GetField("漲停價", "D")*(1- Ratio/100)  then
    if TrueAll(close[1] < Close[2]*1.068,Length) then ret=1;
]]></Code>
<Arg><![CDATA[<Arg seed="c7dac128-231c-460a-9959-a1b53d69c064" version="1"><Param name="過去無漲停期數" varname="Length" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="差幾%漲停" varname="Ratio" type="1" subtype="0" value="1" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="使用限制" varname="TXT" type="3" subtype="0" value="請用日線逐筆洗價" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="c3084108-df2d-4003-b490-b11247feb6c6" version="1" />]]></Plots>
<RefFunc>1,93ec7a47222349e7ba8a2257d29196e4</RefFunc>
<Extra><![CDATA[<Extra>
<Maxbb val="25" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="-1" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="瀑布波型" ID="69ad190a83f24ae1bd4696c1b6eab2ea" ReturnType="0" ExecType="1" Folder="/A股用語/" StatusMask="2">
<Desc><![CDATA[漲升後的急跌]]></Desc>
<Code><![CDATA[settotalbar(3);
setbarback(30);
if close[1] > lowest(close,30) * 1.2 and 
   (high-low)> close * 0.035 and 
   (close-low)> close * 0.01 
then ret=1;]]></Code>
<Arg><![CDATA[<Arg seed="3c7bc50f-9f38-4ad0-a4a8-ecca9fdf4183" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="56a04d6a-247f-4f36-a62b-c72a2cf8d45b" version="1" />]]></Plots>
<RefFunc>1,61c06064ad98469db9ce30287ae4a2c8;1,f1b429ac13b2447c909302198c18ca56</RefFunc>
<Extra><![CDATA[<Extra>
<Maxbb val="2" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
<IsScriptSetBB val="1" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="主力出貨 " ID="1313690853144a278954393c7954675f" ReturnType="0" ExecType="1" Folder="/3.出場常用警示/" StatusMask="2">
<Desc><![CDATA[1.下跌時幅度比上漲時大
2.下跌時有量，上漲時量縮
3.下跌時走勢較陡]]></Desc>
<Code><![CDATA[input:RatioThre(1.5); setinputname(1,"下跌量上漲量比");

settotalbar(8);

variable: upvolume(0);//累計上漲量
variable: downvolume(0);//累計下跌量
variable: uprange(0);//累計上漲值
variable: downrange(0);//累計下跌值
variable: DUratio(0);//下跌量上漲量比
if date[1] <> date then 
begin 
      downvolume  =0; upvolume =0;
	  uprange =0; downrange=0;
      if close > open then  
	    begin 
	      upvolume = volume; 
		  uprange = close -open;   
		end
      else 
	  if close < open then  
		begin 
		  downvolume = volume;  
		  downrange = open -close; 
		end
	  else 
	  if close < close[1] then  
	    begin 
		  downvolume = volume;  
		  downrange = close[1] -close; 
	    end
	  else 
	  if close > close[1] then  
	    begin 
		  upvolume = volume; 
		  uprange = close -close[1]; 
	    end;
end;//如果前一個跟Bar跟目前的bar日期不同 今天第一根起算

if date[1] = date then  //還在同一天
begin 
      if close > close[1] then  
	    begin 
	      upvolume += volume; 
		  uprange += close -close[1];   
		end
      else 
	  if close < close[1] then  
	    begin 
		  downvolume += volume;  
		  downrange += close[1] -close; 
	    end;
 if upvolume > 0 then DUratio = downvolume/upvolume else DUratio=1;
end;

if DUratio crosses over RatioThre and uprange crosses under downrange then ret=1;
]]></Code>
<Arg><![CDATA[<Arg seed="323b2343-182f-4cda-a1a1-fdf1fa43e217" version="1"><Param name="下跌量上漲量比" varname="RatioThre" type="1" subtype="0" value="1.5" isSerial="1" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="da5e27ca-f661-4acd-b081-57b1ccec9322" version="1" />]]></Plots>
<RefFunc>1,6850ead727a842bf883a1501d030ba98;1,9dc3f19597ba44fa91524e91ca67aebd</RefFunc>
<Extra><![CDATA[<Extra>
<FirstBarDate val="0" />
<Maxbb val="6" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="8" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="KD高檔死亡交叉" ID="8ac84a27abb743bd82f5fdd7b7179799" ReturnType="0" ExecType="3" Folder="/3.出場常用警示/" StatusMask="2">
<Desc><![CDATA[K值處於75以上的高檔區,往下穿越D值時觸發]]></Desc>
<Code><![CDATA[input: Length(9), RSVt(3), Kt(3), HighBound(75);

SetTotalBar(maxlist(Length,6) * 3 + 8);

SetInputName(1, "計算期數");
SetInputName(2, "RSVt權數");
SetInputName(3, "Kt權數");
setInputName(4, "高檔區");

variable: rsv(0), k(0), _d(0);

Stochastic(Length, RSVt, Kt, rsv, k, _d);

if k>HighBound and k crosses under _d
then ret=1;
]]></Code>
<Arg><![CDATA[<Arg seed="830354a6-5a68-45d4-8889-7474ce9acdd9" version="1"><Param name="計算期數" varname="Length" type="1" subtype="0" value="9" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="RSVt權數" varname="RSVt" type="1" subtype="0" value="3" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="Kt權數" varname="Kt" type="1" subtype="0" value="3" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="高檔區" varname="HighBound" type="1" subtype="0" value="75" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="8284f104-f43d-4124-92e7-c2d216a711d5" version="1" />]]></Plots>
<RefFunc>1,61c06064ad98469db9ce30287ae4a2c8;1,2bca774c6b7549c1b0b008d2a54b288e;1,f1b429ac13b2447c909302198c18ca56;1,847bcd706dda4a9caf2b783e181a8e42;1,9dc3f19597ba44fa91524e91ca67aebd</RefFunc>
<Extra><![CDATA[<Extra>
<Maxbb val="9" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="-1" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="7.0date(日期)的用法" ID="9f41621664eb47b69b3449b69d00e19b" ReturnType="0" ExecType="1" Folder="/!語法範例/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[//系統用date來表示每根bar的日期，其回傳值為yyyymmdd，例如2013年3月20日為20130320

//=========================範例：大單買進========================

//1.宣告參數：利用input宣告輸入的參數。
input: atVolume(100); //最少要求的量
input: LaTime(10); //至少要有幾次

//2.宣告變數，利用variable
value1=GetField("內外盤","Tick");//內外盤標記  內盤為-1 外盤為1

variable: Xtime(0);//計數器
variable: intrabarpersist XDate(0);

//3.引用時間序列的回傳值﹙包括開高低收成交量等﹚
//日期函數應用
if Date > XDate then Xtime =0; //開盤那根要歸0次數
XDate = Date;

if q_tickvolume > atVolume and value1>0 then  Xtime=Xtime+1; //外盤且單量夠大就加1次

//6.設定警示條件：if.. then ret=1;
if Xtime > LaTime  then ret=1; 
]]></Code>
<Arg><![CDATA[<Arg seed="aa114d14-6dd6-4afc-a1c4-891ba8133527" version="1"><Param name="atVolume" varname="atVolume" type="1" subtype="0" value="100" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="LaTime" varname="LaTime" type="1" subtype="0" value="10" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="79a3d284-b9c1-400d-9373-0deb419ac369" version="1" />]]></Plots>
<Extra><![CDATA[<Extra>
<TotalBar val="5" />
<Maxbb val="3" />
<script>
<freq support="1;8;11;9;12;10;13;14;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="五分鐘線整理後突破" ID="769a536e891a4d16a424be7682949d7d" ReturnType="0" ExecType="1" Folder="/當沖交易型/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:Length(20); setinputname(1,"計算期數");
input:Ratio(0.5); setinputname(2,"突破幅度%");
input:RRatio(1.5); setinputname(3,"盤整區間幅度%");
input:TXT1("僅適用5分鐘線"); setinputname(4,"使用限制");

settotalbar(3);
setbarback(Length);

if barfreq<> "Min" or barinterval <> 5 then return;

variable: RangeHigh(0);
variable: RangeLow(0);
RangeHigh=highest(close[1],length);
RangeLow=lowest(close[1],length);

if Close > RangeHigh*(1+Ratio/100) then
   if RangeHigh <  RangeLow * (1+ RRatio/100) then ret=1;
]]></Code>
<Arg><![CDATA[<Arg seed="38d7edd9-e8c3-4324-aee0-e799fd6eedf5" version="1"><Param name="計算期數" varname="Length" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="突破幅度%" varname="Ratio" type="1" subtype="0" value="0.5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="盤整區間幅度%" varname="RRatio" type="1" subtype="0" value="1.5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="使用限制" varname="TXT1" type="3" subtype="0" value="僅適用5分鐘線" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="f51ed3cf-3dc0-450e-8e8e-0b0430373dc0" version="1" />]]></Plots>
<RefFunc>1,61c06064ad98469db9ce30287ae4a2c8;1,2bca774c6b7549c1b0b008d2a54b288e;1,f1b429ac13b2447c909302198c18ca56</RefFunc>
<Extra><![CDATA[<Extra>
<Maxbb val="25" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
<IsScriptSetBB val="1" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="海龜進場法則" ID="1cefbdd9c87f48e78a3ac4c195fadc81" ReturnType="0" ExecType="1" Folder="/波段操作型/" StatusMask="2">
<Desc><![CDATA[突破近N週高點]]></Desc>
<Code><![CDATA[input:Length(10); setinputname(1,"近N週期數");
input:TXT("僅適用日線"); setinputname(2,"使用限制");

settotalbar((Length + 3)*5);

if barfreq <> "D" and barfreq <> "AD" then Return;

if close > highest(getfield("High","W")[1],Length)//近n週最高價
then ret=1;]]></Code>
<Arg><![CDATA[<Arg seed="5739a82c-57c6-44a1-9944-f8d707dfc31b" version="1"><Param name="近N週期數" varname="Length" type="1" subtype="0" value="10" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="使用限制" varname="TXT" type="3" subtype="0" value="僅適用日線" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="58d43e1d-8cbd-4476-8d09-4f1b8e2eaba0" version="1" />]]></Plots>
<RefFunc>1,61c06064ad98469db9ce30287ae4a2c8;1,2bca774c6b7549c1b0b008d2a54b288e</RefFunc>
<Extra><![CDATA[<Extra>
<Maxbb val="10" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="-1" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="3.getquote" ID="bbbbd1e723ba45a7b5f541903072ad52" ReturnType="0" ExecType="1" Folder="/!語法範例/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[//第三個範例，我們示範如何利用盤中即時數據﹙委買、委賣、內盤量、外盤量等等﹚來製作警示
//使用者可以透過"getquote"來取得這些數據
//只要在編輯器上打getquote就可以直接挑選所提供的欄位

//=====================範例：外盤漲停=======================================

//4.運用函數
//利用getfield取得買進價、賣出價及漲停價
value1=GetQuote("Ask");//賣出價
value2=GetQuote("DailyUplimit");//漲停價
value3=GetQuote("Bid");//買進價
//可以用q_來取代GetQuote完成快速引用

//6.設定警示條件：if.. then ret=1;
//賣出價=漲停價  且買進價跟賣出價相差不超過0.5%
if value1=value2 and value1/value2<=1.005
then ret=1;]]></Code>
<Arg><![CDATA[<Arg seed="874de46d-48db-4b7a-a438-13064edc49e2" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="e45434ae-8e3f-4a20-833f-f372eb37b07e" version="1" />]]></Plots>
<Extra><![CDATA[<Extra>
<TotalBar val="3" />
<Maxbb val="1" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="共振策略" ID="a8d361f622384b45b6996d31f38f9211" ReturnType="0" ExecType="3" Folder="/技術分析/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input: shortlength(5,"短期均線期數");
input: midlength(20,"中期均線期數");
input: Longlength(60,"長期均線期數");
input: Percent(5,"均線糾結區間%");
input: XLen(6,"均線糾結期數");
variable:sv(0),mv(0),lv(0);
sv = average(close,shortlength);
mv = average(close,midlength);
lv = average(close,Longlength);	
variable: avgh(0),avgl(0),avghlp(0);	
AvgH = maxlist(sv,mv,lv );
AvgL = minlist(sv,mv,lv );
if AvgL > 0 then AvgHLp = 100*AvgH/AvgL -100;

input: Length1(14 , "威廉指標計算天數");
value1 = PercentR(Length1);
if trueAll(AvgHLp < Percent,XLen)
and value1>80
and close>close[1]*1.025
then ret=1;]]></Code>
<Arg><![CDATA[<Arg seed="7e56f102-1c60-47f6-8ac0-eb2ea2fc5a4b" version="1"><Param name="短期均線期數" varname="shortlength" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="中期均線期數" varname="midlength" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="長期均線期數" varname="Longlength" type="1" subtype="0" value="60" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="均線糾結區間%" varname="Percent" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="均線糾結期數" varname="XLen" type="1" subtype="0" value="6" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="威廉指標計算天數" varname="Length1" type="1" subtype="0" value="14" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="500a4eca-5541-4ab7-9d05-09ad6e65c072" version="1" />]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c;1,61c06064ad98469db9ce30287ae4a2c8;1,2bca774c6b7549c1b0b008d2a54b288e;1,f1b429ac13b2447c909302198c18ca56;1,b348a25d74c84ec4b6c1807d146a49fa;1,93ec7a47222349e7ba8a2257d29196e4</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<FirstBarDate val="0" />
<Maxbb val="20" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="高檔出現黑暗之星" ID="a7c0b736eb9d4788bb70d3018d03df41" ReturnType="0" ExecType="1" Folder="/3.出場常用警示/" StatusMask="2">
<Desc><![CDATA[高檔出線紅棒後,連續短黑棒再長黑棒]]></Desc>
<Code><![CDATA[input:Length(10); setinputname(1,"計算期數");

settotalbar(Length + 3);

if (open-close)>= open *0.025 then //最近一根是長黑棒
begin

	value1 = highest(high,length);
	value2 = lowest(low,length);
	
	if value1 = value2 then return;
	
	value3 = (value1-close)/(value1-value2)*100;

	condition1 = value3 < 10; //接近近n日高點
	condition2 = (close[2]-open[2])/open[2]>=0.03;//一根長陽線
	condition3 =  open[1]>close[1]  and (high[1]-low[1])<=close[1]*0.02 
	and close[1]>close[2] - 0.5*(close[1]-open[1]) ; //一根小黑棒且未形成覆蓋線

	if condition1 and condition2 and condition3 then ret=1;

end;]]></Code>
<Arg><![CDATA[<Arg seed="b7e2dd11-4572-46e0-b8c8-6a766c7862c0" version="1"><Param name="計算期數" varname="Length" type="1" subtype="0" value="10" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="2e844d5d-3888-4797-8e22-383c95890a8e" version="1" />]]></Plots>
<RefFunc>1,61c06064ad98469db9ce30287ae4a2c8;1,2bca774c6b7549c1b0b008d2a54b288e;1,f1b429ac13b2447c909302198c18ca56</RefFunc>
<Extra><![CDATA[<Extra>
<Maxbb val="25" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="-1" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="投信殺完之跌深反彈" ID="036e943c0bb94ff7884b930165780dfe" ReturnType="0" ExecType="1" Folder="/短線操作型/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:day(5); setinputname(1,"投信連續賣超天數");
input:ratio(60);setinputname(2,"合計賣超減持幅度%");
input:TXT1("僅適用日線"); setinputname(3,"使用限制");
input:TXT2("須逐筆洗價"); setinputname(4,"使用說明");
settotalbar(day + 3);

if close>open and close[3] > close[1] * 1.1  and BarFreq ="D" then
begin
  if TrueAll(GetField("Sdifference")[1] <0,day) and
     GetField("Ssharesheld")[1] < GetField("Ssharesheld")[Day+1] * (1- Ratio/100) 
  then ret=1;
end;

]]></Code>
<Arg><![CDATA[<Arg seed="c162ca25-52b0-405b-8843-5bf97309ebf7" version="1"><Param name="投信連續賣超天數" varname="day" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="合計賣超減持幅度%" varname="ratio" type="1" subtype="0" value="60" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="使用限制" varname="TXT1" type="3" subtype="0" value="僅適用日線" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="使用說明" varname="TXT2" type="3" subtype="0" value="須逐筆洗價" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="6b0e22a0-35d5-4530-9fe2-2388cd8271fe" version="1" />]]></Plots>
<RefFunc>1,93ec7a47222349e7ba8a2257d29196e4</RefFunc>
<Extra><![CDATA[<Extra>
<Maxbb val="10" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="-1" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="當期成交量倍增" ID="4d42a7632dca425b83919dff693e87f0" ReturnType="0" ExecType="1" Folder="/價量指標/" StatusMask="2">
<Desc><![CDATA[當期成交量突破前期量N倍]]></Desc>
<Code><![CDATA[input: VolumeXtime(3);   setinputname(1,"量增倍數");
settotalbar(3);
if volume > volume[1] * VolumeXtime then ret=1;
]]></Code>
<Arg><![CDATA[<Arg seed="e19334cd-27c6-43f3-9108-03dabdf939ff" version="1"><Param name="量增倍數" varname="VolumeXtime" type="1" subtype="0" value="3" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="266a6603-7306-4c3c-959e-049ce0549168" version="1" />]]></Plots>
<Extra><![CDATA[<Extra>
<Maxbb val="5" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="倒狀鎚子" ID="be4e33d0f322453389c2f45c4b4831b2" ReturnType="0" ExecType="1" Folder="/酒田戰法/" StatusMask="2">
<Desc><![CDATA[前期收長黑K棒 今期開低試圖上攻後收上影線短紅棒]]></Desc>
<Code><![CDATA[{								
[檔名:]	倒狀鎚子			[資料夾:]	酒田戰法	[適用方向]	多	
[說明:]	前期收長黑K棒 今期開低試圖上攻後收上影線短紅棒												
}								
settotalbar(5);
{判斷狀況}								
	condition1=	( open[1] - close[1] ) >(high[1] -low[1]) * 0.75					;//狀況1:	前期出長黑K棒
	condition2=	 close[1] < close[2] - (high[2]-low[2])					;//狀況2:	前期呈波動放大下跌
	condition3=	close > open and (high -close)> (close-open) *2					;//狀況3:	收紅上影線
{結果判斷}		
IF		
		condition1
	and	condition2
	and	condition3
THEN	RET=1;	]]></Code>
<Arg><![CDATA[<Arg seed="34a74a9a-28c3-47a2-8703-516ae79654b9" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="d16b3a68-de66-49c2-ad07-1f220b5b1b26" version="1" />]]></Plots>
<Extra><![CDATA[<Extra>
<Maxbb val="5" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="5" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="WVAD買進訊號" ID="0830029a2e35443792f4d89a5d7f59f1" ReturnType="0" ExecType="3" Folder="/技術分析/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[//ETF 作多  40天後出場

input:length(14);
variable:wvad(0);
value1=close-open;
value2=high-low;
if high<>low
then value3=value1/value2*volume
else
value3=value3[1];
wvad=summation(value3,length);
if wvad<0
and linearregslope(wvad,5)>0
and linearregslope(wvad,15)<0
and linearregslope(close,20)<0
and GetSymbolField("tse.tw","收盤價","W")
>average(GetSymbolField("tse.tw","收盤價","W"),13)
then ret=1;]]></Code>
<Arg><![CDATA[<Arg seed="062be97c-9a76-49a9-ac02-5fc9b771423c" version="1"><Param name="length" varname="length" type="1" subtype="0" value="14" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="04013937-61fe-41da-bf76-502b228c0b27" version="1" />]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d;1,8c2d025a23c548d3a76fba10c22527b4;1,210d0786cfe340538e34c095bc2ba049;1,626e6e5c42304bbea9809d1a07ae4e01;1,3a62e42e463c46b58e5dee79ae1e581c</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<FirstBarDate val="0" />
<Maxbb val="20" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="散戶下車股價漲" ID="59ff7c8792704ca2b3a855a47ffa0ed0" ReturnType="0" ExecType="1" Folder="/1.籌碼監控/" StatusMask="2">
<Desc><![CDATA[昨日散戶大量出場後今日再創高.

需選用日線及逐筆洗價.]]></Desc>
<Code><![CDATA[input:TXT("僅適用日線"); setinputname(1,"使用限制");

settotalbar(3);

if BarFreq <> "D" then return;

if close > high[1] and 
	GetField("散戶買賣超張數")[1] < volume[1] * -0.1  then ret=1;
        ]]></Code>
<Arg><![CDATA[<Arg seed="7600a2da-a577-4b11-ae68-2661694c1932" version="1"><Param name="使用限制" varname="TXT" type="3" subtype="0" value="僅適用日線" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="0f64a4a0-22e7-4ff1-83cb-573802c450c9" version="1" />]]></Plots>
<Extra><![CDATA[<Extra>
<Maxbb val="5" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="跳空下跌再破底" ID="0ca28340ff0f453c9a50b6483f5ca675" ReturnType="0" ExecType="1" Folder="/3.出場常用警示/" StatusMask="2">
<Desc><![CDATA[開盤跳空下跌1.5%且分鐘線繼續下跌。
僅適用於分鐘線。
]]></Desc>
<Code><![CDATA[//分鐘線
input:Gapratio(1.5);setinputname(1,"跳空下跌百分比%");
input:TXT("僅適用分鐘線"); setinputname(2,"使用限制");

settotalbar(5);

if barfreq<>"Min" then return;

if Close < close[1] and Close < GetField("Open", "D") then 
   if GetField("Open", "D") < GetField("RefPrice", "D")*(100-Gapratio)/100  then ret=1;
]]></Code>
<Arg><![CDATA[<Arg seed="780fa9c2-5b3e-42de-95e5-123b9568aa40" version="1"><Param name="跳空下跌百分比%" varname="Gapratio" type="1" subtype="0" value="1.5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="使用限制" varname="TXT" type="3" subtype="0" value="僅適用分鐘線" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="b0765fb6-40f7-4c40-903b-ce6da369675b" version="1" />]]></Plots>
<Extra><![CDATA[<Extra>
<Maxbb val="5" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="5" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="散戶買單比例太高且走低" ID="ddbd64861906443a9cfd3dfbf198917d" ReturnType="0" ExecType="3" Folder="/3.出場常用警示/" StatusMask="2">
<Desc><![CDATA[散單比例太高且持續下跌]]></Desc>
<Code><![CDATA[input:ratio(20); setinputname(1,"散戶買單比例%");
input:TXT("須逐筆洗價"); setinputname(2,"使用限制");

//單筆外盤成交值低於五十萬元稱為散單 //內外盤:內盤-1 外盤1
variable: intrabarpersist ACount(0);
variable: intrabarpersist TimeStamp(0);

settotalbar(3);

if barfreq ="Min" and currentdate = date then //分鐘線在今天時
begin
  TimeStamp =currenttime;
  if TimeStamp = TimeStamp[1] then  ACount=0;
  if TimeStamp[1] <= time  then // 盤中開啟 or 換Bar第一個進價
  begin
      if  GetField("內外盤","Tick") > 0 and GetField("Volume", "Tick") *Close <=500 then
            ACount = GetField("Volume", "Tick") *Close
 	    else 
	        ACount=0;
  end
  else
  begin
     if  GetField("內外盤","Tick") > 0 and GetField("Volume", "Tick") *Close <=500 then ACount+= GetField("Volume", "Tick") *Close;
  end;
  if ACount >= Ratio/100 * volume*close and  
     Close < GetField("RefPrice", "D")*0.985 and GetField("High", "D") < GetField("RefPrice", "D")*1.005 then ret=1;
end;

if barfreq ="D" then 
begin
  if  Date <> currentdate then Acount=0;
  if  GetField("內外盤","Tick") > 0 and GetField("Volume", "Tick") *Close <=500 then ACount+= GetField("Volume", "Tick") *Close;
  if ACount >= Ratio/100 * GetField("Volume", "D") * GetField("均價") and
     Close < GetField("RefPrice", "D")*0.985 and GetField("High", "D") < GetField("RefPrice", "D")*1.005 then ret=1;
end;

]]></Code>
<Arg><![CDATA[<Arg seed="510adf39-963e-4587-a238-ad0d8a3c3386" version="1"><Param name="散戶買單比例%" varname="ratio" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="使用限制" varname="TXT" type="3" subtype="0" value="須逐筆洗價" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="d214cb21-025a-43eb-8a0a-9b41da90b361" version="1" />]]></Plots>
<Extra><![CDATA[<Extra>
<Maxbb val="3" />
<script>
<freq support="1;8;11" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="站上五根bar高點" ID="3b722c2f0a234bddbc287b4c8fc4691c" ReturnType="0" ExecType="1" Folder="/短線操作型/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[settotalbar(5);

if close > highest(High[1],4)
then ret=1;]]></Code>
<Arg><![CDATA[<Arg seed="6e80c37f-7cfd-4823-a824-9633c079d714" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="450a4b2a-d8e9-4571-9257-a1b14b2a5a30" version="1" />]]></Plots>
<RefFunc>1,61c06064ad98469db9ce30287ae4a2c8;1,2bca774c6b7549c1b0b008d2a54b288e</RefFunc>
<Extra><![CDATA[<Extra>
<Maxbb val="5" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="5" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="當沖二號(空)" ID="f463c83bba37460bbbe188b29d89ef76" ReturnType="0" ExecType="3" Folder="/當沖交易型/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[if barfreq <>"Min" or  barinterval<> 1
then raiseruntimeerror("歹勢，本腳本只適用於1分鐘線");

variable:count(0);

if date<>date[1] then count=0;
count=count+1;
 
if GetField("開盤價","D")*1.025< GetField("收盤價","D")[1] 
and count>10
and lowest(low[1],count-1)*1.015>highest(high[1],count-1)
and close =lowest(low,count)
then ret=1;
]]></Code>
<Arg><![CDATA[<Arg seed="7e692147-9c7a-41ad-bc31-54d4cfdf1c66" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="fff5a0d6-d298-445d-be88-a09ac0c1da32" version="1" />]]></Plots>
<RefFunc>1,61c06064ad98469db9ce30287ae4a2c8;1,f1b429ac13b2447c909302198c18ca56;1,2bca774c6b7549c1b0b008d2a54b288e</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<FirstBarDate val="0" />
<Maxbb val="20" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="多方人氣表態" ID="0ea38424f60e40d0a529f5c830e1a15f" ReturnType="0" ExecType="1" Folder="/價量指標/" StatusMask="2">
<Desc><![CDATA[股價漲升過昨高且總量突破昨量]]></Desc>
<Code><![CDATA[settotalbar(3);
if Close > highD(1) and GetField("Volume", "D")>  GetField("Volume", "D")[1] then ret=1;  ]]></Code>
<Arg><![CDATA[<Arg seed="3999e6b3-75b2-4e3d-909f-54faeaff6a46" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="a2267cc8-c48e-4a80-94e4-21641a1f8137" version="1" />]]></Plots>
<RefFunc>1,61b7479e4304402c83419e5e14e287ba</RefFunc>
<Extra><![CDATA[<Extra>
<Maxbb val="3" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="高檔量縮收黑" ID="3d786268200f4a52b674ea90ee17b35e" ReturnType="0" ExecType="1" Folder="/3.出場常用警示/" StatusMask="2">
<Desc><![CDATA[高檔量縮後收下跌黑棒]]></Desc>
<Code><![CDATA[input:DownPercent(4);  setinputname(1,"當期下跌幅度");
input:Ratio(20);       setinputname(2,"量縮程度%");
input:TieDays(3);      setinputname(3,"量縮持續期數");
input:UpTrendDays(20); setinputname(4,"累計上漲期數");
input:RaisingRatio(20);setinputname(5,"累計上漲幅度");

settotalbar(3);
setbarback(UpTrendDays+TieDays);

if Close[TieDays] >  close[UpTrendDays+TieDays-1] * (1+RaisingRatio/100) then
begin
  if Close< high[TieDays] * (1 - DownPercent/100) and 
     volume[TieDays] > volume *(1+Ratio/100) 
  then ret=1;
end;]]></Code>
<Arg><![CDATA[<Arg seed="29383527-c3cc-4eab-a234-32ca126f4db2" version="1"><Param name="當期下跌幅度" varname="DownPercent" type="1" subtype="0" value="4" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="量縮程度%" varname="Ratio" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="量縮持續期數" varname="TieDays" type="1" subtype="0" value="3" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="累計上漲期數" varname="UpTrendDays" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="累計上漲幅度" varname="RaisingRatio" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="4d9bd021-078f-4e8c-9b36-a5ef5a6d9737" version="1" />]]></Plots>
<Extra><![CDATA[<Extra>
<Maxbb val="30" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
<IsScriptSetBB val="1" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="空頭執帶" ID="01624513f8624336a2e1e702a71a6631" ReturnType="0" ExecType="1" Folder="/酒田戰法/" StatusMask="2">
<Desc><![CDATA[長黑棒]]></Desc>
<Code><![CDATA[{																						
[檔名:]	空頭執帶			[資料夾:]	酒田戰法	[適用方向]	空															
[說明:]	長黑棒																																									
}																						
settotalbar(5);	
{判斷狀況}								
	condition1=	( open - close ) > (high -low) * 0.8					;//狀況1:	實體黑K棒
	condition2=	close < close[1] - (high[1]-low[1])					;//狀況2:	波動向下放大
{結果判斷}		
IF		
		condition1
	and	condition2
THEN	RET=1;	]]></Code>
<Arg><![CDATA[<Arg seed="98d8f92d-af43-4850-82c2-7f3fb9d9982e" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="06b9bf09-99ce-490c-aa0d-5bc60ef7e97a" version="1" />]]></Plots>
<Extra><![CDATA[<Extra>
<Maxbb val="5" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="5" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="外資連續買超n天" ID="050681bb8fed4341bdd2ff57f5320424" ReturnType="0" ExecType="1" Folder="/短線操作型/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:Periods(5); setinputname(1,"外資連續買超天數");
input:TXT1("僅適用日線"); setinputname(2,"使用限制");

settotalbar(3);
setbarback(Periods);

if BarFreq <> "D"  then return;

Ret = TrueAll(GetField("外資買賣超")[1] > 0, Periods);
]]></Code>
<Arg><![CDATA[<Arg seed="00eb935c-04ba-477a-9cd7-3de1fccd9b4a" version="1"><Param name="外資連續買超天數" varname="Periods" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="使用限制" varname="TXT1" type="3" subtype="0" value="僅適用日線" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="48e59344-eda4-4f34-9e65-997edaf56ff7" version="1" />]]></Plots>
<RefFunc>1,93ec7a47222349e7ba8a2257d29196e4</RefFunc>
<Extra><![CDATA[<Extra>
<Maxbb val="20" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
<IsScriptSetBB val="1" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="多頭母子" ID="b17f0d648d8141d68da4e7334ba3ebff" ReturnType="0" ExecType="1" Folder="/酒田戰法/" StatusMask="2">
<Desc><![CDATA[前期收長黑K棒 今期開高小幅收紅不過昨高]]></Desc>
<Code><![CDATA[{																						
[檔名:]	多頭母子			[資料夾:]	酒田戰法	[適用方向]	多															
[說明:]	前期收長黑K棒 今期開高小幅收紅不過昨高																					
}																						
settotalbar(5);	
{判斷狀況}								
	condition1=	( open[1] - close[1] ) >(high[1] -low[1])*0.75					;//狀況1:	前期出長黑K棒
	condition2=	close[1] < close[2] - high[2]-low[2]					;//狀況2:	前期呈波動放大下跌
	condition3=	( close - open ) >(high -low) * 0.75					;//狀況3:	當期紅棒
	condition4=	high < high[1]					;//狀況4:	高不過昨高
	condition5=	low>low[1]					;//狀況5:	低不破昨低
{結果判斷}		
IF		
		condition1
	and	condition2
	and	condition3
	and	condition4
	and	condition5
THEN	RET=1;	]]></Code>
<Arg><![CDATA[<Arg seed="47486faf-4168-43be-a369-bb8f24e9c879" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="da868f1b-c87e-4235-b1b0-0bd2cee78eae" version="1" />]]></Plots>
<Extra><![CDATA[<Extra>
<Maxbb val="5" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="5" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="連日量縮下跌" ID="6af1b39cf57f4964862dd44319cf5fed" ReturnType="0" ExecType="1" Folder="/2.市場常用語/" StatusMask="2">
<Desc><![CDATA[練股價連續下跌且量逐步縮減]]></Desc>
<Code><![CDATA[input:percent(4);setinputname(1,"累計下跌幅度%"); 
input:ratio(20); setinputname(2,"量縮幅度%"); 
input:Length(3);setinputname(3,"持續期數");

settotalbar(Length + 3);

if close[Length-1]  > Close * (1+percent/100) and 
   volume[Length-1] > Volume* (1+ratio/100) and 
   TrueAll(Close < Close[1] ,Length-1) 
then ret=1;]]></Code>
<Arg><![CDATA[<Arg seed="88fd9e72-6a83-4b39-8157-74102fa3f1a9" version="1"><Param name="累計下跌幅度%" varname="percent" type="1" subtype="0" value="4" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="量縮幅度%" varname="ratio" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="持續期數" varname="Length" type="1" subtype="0" value="3" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="617a2bc3-01cf-4db6-8547-4f90b76b762a" version="1" />]]></Plots>
<RefFunc>1,93ec7a47222349e7ba8a2257d29196e4</RefFunc>
<Extra><![CDATA[<Extra>
<Maxbb val="5" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="-1" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="高點回檔n%" ID="6b2d180f9335487ea8da41489e0fe44e" ReturnType="0" ExecType="1" Folder="/2.市場常用語/" StatusMask="2">
<Desc><![CDATA[價格自高檔回跌N%預警]]></Desc>
<Code><![CDATA[input:Length(20);  setinputname(1,"尋找高點期數");
input:percent(7); setinputname(2,"自高點回檔幅度%");

settotalbar(Length + 3);

if close < highest(high,Length)*(1- percent/100) then Ret=1;]]></Code>
<Arg><![CDATA[<Arg seed="02abf0de-eda3-4dc3-8279-b5f5a78e0a1a" version="1"><Param name="尋找高點期數" varname="Length" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="自高點回檔幅度%" varname="percent" type="1" subtype="0" value="7" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="5641bf09-9c96-44d1-bcb1-6a31f544b793" version="1" />]]></Plots>
<RefFunc>1,61c06064ad98469db9ce30287ae4a2c8;1,2bca774c6b7549c1b0b008d2a54b288e</RefFunc>
<Extra><![CDATA[<Extra>
<Maxbb val="25" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="-1" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="三黑鴨" ID="e66f4bf3f8404955a271f89d17f945d8" ReturnType="0" ExecType="1" Folder="/酒田戰法/" StatusMask="2">
<Desc><![CDATA[連三黑K棒]]></Desc>
<Code><![CDATA[{																						
[檔名:]	三黑鴨			[資料夾:]	酒田戰法	[適用方向]	空															
[說明:]	連三黑K棒																																								
}		
settotalbar(5);																											
{判斷狀況}								
	condition1=	( open - close ) > (high -low) * 0.75					;//狀況1:	當期黑K棒
	condition2=	( open[1] - close[1] ) > (high[1] -low[1]) * 0.75					;//狀況2:	前期黑K棒
	condition3=	( open[2] - close[2] ) > (high[2] -low[2]) * 0.75					;//狀況3:	前前期黑K棒
	condition4=	close < close[1] and close[1] < close[2]					;//狀況4:	連續下跌	
{結果判斷}		
IF		
		condition1
	and	condition2
	and	condition3
	and	condition4
THEN	RET=1;	]]></Code>
<Arg><![CDATA[<Arg seed="609a8220-1eb1-4da0-9356-18788b3fac58" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="d48e396f-79eb-4f9b-b87d-9b67ed7d1556" version="1" />]]></Plots>
<Extra><![CDATA[<Extra>
<Maxbb val="5" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="5" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="爆量長黑" ID="7250696c1afe4c69a720f4e952fb981d" ReturnType="0" ExecType="1" Folder="/價量指標/" StatusMask="2">
<Desc><![CDATA[爆量長黑]]></Desc>
<Code><![CDATA[settotalbar(8);
if volume >  Average(volume[1],5)  *3    and 
 ( open - close ) >( high -low ) * 0.75  and 
   open > close  + (high[1]- low[1])
then ret=1;  


        
        ]]></Code>
<Arg><![CDATA[<Arg seed="b9f47f85-6eba-4976-b8c2-0b2d20fe87ef" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="c7d03921-cb30-4fe6-9e0f-e703dcc751fd" version="1" />]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c</RefFunc>
<Extra><![CDATA[<Extra>
<Maxbb val="10" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="8" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="會打開的跌停" ID="b0141dad3e1a4ee69bc0dca2b8886fd1" ReturnType="0" ExecType="1" Folder="/當沖交易型/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[settotalbar(605);
if q_ask=GetField("跌停價", "D") and
   q_bestasksize1<1500 and
   (closeD(2)-close)>0.07*Close  
then ret=1;]]></Code>
<Arg><![CDATA[<Arg seed="d87bb8f9-2c0c-40ad-b31b-cd56d2a201b3" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="d8414a31-e4b8-4618-a310-83715e82213a" version="1" />]]></Plots>
<RefFunc>1,e53a55e6d49b466da1125c878df9cf9a</RefFunc>
<Extra><![CDATA[<Extra>
<Maxbb val="601" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="605" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="過去N日有多日跳空且未拉回" ID="bd23e59c714d4d76850986e32dbd3074" ReturnType="0" ExecType="3" Folder="/技術分析/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[//中小型股  停損停利都是5%
input:day(5,"過去N日");
input:lowlimit(2,"符合條件天數");
input:period(20,"盤整區間");

//透過Z的時間安排來決定現在用的是那一根Bar的資料 
variable: Z(0);
if currenttime > 180000 
or currenttime < 083000 then 
	Z =0 
else 
	Z=1;
	
value1=highest(high[day],period);
value2=lowest(low[day],period);
if value1<value2*1.05
and countif(high>high[1]
and low>low[1],day)>=lowlimit
and tselsindex(10,8)[Z]=1
then ret=1;]]></Code>
<Arg><![CDATA[<Arg seed="2c67c9d5-b3ae-43df-a07c-8b47fa0cf07e" version="1"><Param name="過去N日" varname="day" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="符合條件天數" varname="lowlimit" type="1" subtype="0" value="2" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="盤整區間" varname="period" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="c44f1bed-7c2a-4f1d-8a88-051111477905" version="1" />]]></Plots>
<RefFunc>1,61c06064ad98469db9ce30287ae4a2c8;1,2bca774c6b7549c1b0b008d2a54b288e;1,f1b429ac13b2447c909302198c18ca56;1,d80cf92ddfcc42e0a6c53ec47edebd49;1,b1f1a25bdc014e109dc92d7f9b6ef207</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<FirstBarDate val="0" />
<Maxbb val="20" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="RSI死亡交叉" ID="58cabd4e651e46658ec8a8730a2a594a" ReturnType="0" ExecType="3" Folder="/技術分析/" StatusMask="2">
<Desc><![CDATA[RSI短天期往下穿越長天期]]></Desc>
<Code><![CDATA[// RSI短天期往下穿越長天期
//
input: ShortLength(6), LongLength(12);

settotalbar(maxlist(ShortLength,6) * 8 + 8);

SetInputName(1, "短期期數");
SetInputName(2, "長期期數");

Ret = RSI(Close, ShortLength) Crosses Below RSI(Close, LongLength);



]]></Code>
<Arg><![CDATA[<Arg seed="c2225331-2e0b-471f-9df8-666cf3d0a2fd" version="1"><Param name="短期期數" varname="ShortLength" type="1" subtype="0" value="6" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="長期期數" varname="LongLength" type="1" subtype="0" value="12" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="0c635b76-da06-4367-b471-2004bfe03eb9" version="1" />]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c;1,d64c2a71d3ea43d985ca22ef62a5a8de;1,9dc3f19597ba44fa91524e91ca67aebd</RefFunc>
<Extra><![CDATA[<Extra>
<Maxbb val="13" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="-1" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="盤中委買遠大於委賣" ID="93abeadf01a74647b03dfa409ca5689c" ReturnType="0" ExecType="2" Folder="/盤中常用/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:v1(2000,"委買五檔總金額(萬)");
input:v2(500,"委賣五檔總金額(萬)");
input:v3(1500,"委買委賣總差額(萬)");
input:v4(400,"單一價位委買金額下限");
input:v5(100,"單一價位委賣金額上限");

variable:bidtv(0),asktv(0),tb(0),ta(0),b1(0),b2(0),b3(0),b4(0),b5(0),s1(0),s2(0),s3(0),s4(0),s5(0);
condition1=false;
condition2=false;
condition3=false;

bidtv=q_SumBidSize;//總委買
asktv=q_SumAskSize;//總委賣

value1=q_BestBidSize1;//委買一
value2=q_BestBidSize2;
value3=q_bestbidsize3;
value4=q_bestbidsize4;
value5=q_bestbidsize5;

value6=q_bestasksize1;//委賣一
value7=q_bestasksize2;
value8=q_bestasksize3;
value9=q_bestasksize4;
value10=q_bestasksize5;

tb=bidtv*close/10;
ta=asktv*close/10;

if tb>v1 and ta<v2 and tb-ta>v3
then condition1=true;

b1=value1*close/10;
b2=value2*close/10;
b3=value3*close/10;
b4=value4*close/10;
b5=value5*close/10;
s1=value6*close/10;
s2=value7*close/10;
s3=value8*close/10;
s4=value9*close/10;
s5=value10*close/10;

if minlist(b1,b2,b3,b4,b5)>v4
then condition2=true;

if maxlist(s1,s2,s3,s4,s5)<v5
then condition3=true;

if close<>GetField("漲停價", "D") then begin
	if  condition1 
	or (condition2 and condition3)
	then ret=1; 
end;



]]></Code>
<Arg><![CDATA[<Arg seed="411ba8d3-24b8-462c-b499-687eccd3ae37" version="1"><Param name="委買五檔總金額(萬)" varname="v1" type="1" subtype="0" value="2000" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="委賣五檔總金額(萬)" varname="v2" type="1" subtype="0" value="500" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="委買委賣總差額(萬)" varname="v3" type="1" subtype="0" value="1500" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="單一價位委買金額下限" varname="v4" type="1" subtype="0" value="400" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="單一價位委賣金額上限" varname="v5" type="1" subtype="0" value="100" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="a9e34e9e-f344-47d8-89f1-7dd8dfa917f5" version="1" />]]></Plots>
<Extra><![CDATA[<Extra>
<TotalBar val="300" />
<Maxbb val="50" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="籌碼由發散轉收集" ID="ed460b789fb14ba9a28bd8968bcb04af" ReturnType="0" ExecType="3" Folder="/短線操作型/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input: Length_D(9, "日KD期間");
input: Length_W(5, "周KD期間");
variable:rsv_d(0),kk_d(0),dd_d(0);
variable:rsv_w(0),kk_w(0),dd_w(0);

SetTotalBar(maxlist(Length_D,6) * 3);

//透過Z的時間安排來決定現在用的是那一根Bar的資料 
variable: Z(0);
if GetFieldDate("主力買賣超張數") <> 0 then
	Z=0 
else 
	Z=1;
	
condition1=false;
value1=GetField("現股當沖張數","D")[Z];
value2=GetField("外資買賣超","D")[Z];
value3=GetField("投信買賣超","D")[Z];
value4=GetField("自營商買賣超","D")[Z];
value5=GetField("主力買賣超張數","D")[Z];
value6=GetField("融資增減張數","D")[Z];
value7=GetField("融券增減張數","D")[Z];
value8=volume-value1;//當日淨交易張數
value9=value2+value3+value4+value5-value6+value7;
//籌碼收集張數

if TSELSindex(10,5)[Z]=1 then begin
	if value8<>0 then 
		value10=value9/value8*100
	else
		value10=value10[1];
	
	value11=average(value10,10);
	if value11 crosses over 10 then condition1=true;

	stochastic(Length_D, 3, 3, rsv_d, kk_d, dd_d);
	xf_stochastic("W", Length_W, 3, 3, rsv_w, kk_w, dd_w);

	condition2 = kk_d crosses above dd_d;		// 日KD crosses over
	condition3 = xf_GetBoolean("W",xf_crossover("W", kk_w, dd_w),1);	// 周KD crosses over
	condition4 = kk_d[1] <= 30;							// 日K 低檔
	condition5 = xf_getvalue("W", kk_w, 1) <= 50;		// 周K 低檔
	
	if condition1 and condition2 and condition3 and condition4 and condition5
	then ret = 1;
end;
]]></Code>
<Arg><![CDATA[<Arg seed="b0f59c29-7d87-4806-aec9-b1bc4281294b" version="1"><Param name="日KD期間" varname="Length_D" type="1" subtype="0" value="9" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="周KD期間" varname="Length_W" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="1c40147e-f261-4276-9759-ab0c7a7bed51" version="1" />]]></Plots>
<RefFunc>1,d80cf92ddfcc42e0a6c53ec47edebd49;1,b1f1a25bdc014e109dc92d7f9b6ef207;1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c;1,6850ead727a842bf883a1501d030ba98;1,61c06064ad98469db9ce30287ae4a2c8;1,2bca774c6b7549c1b0b008d2a54b288e;1,f1b429ac13b2447c909302198c18ca56;1,847bcd706dda4a9caf2b783e181a8e42;1,57f222578a2c4d17b2b88b65b8f28696;1,bdf6d4140e2c4954b316120de89f2d59;1,ae592f43d76b43c589aaa0eb0e6ecb27;1,e670c01522de45efa7f74c7f3c15a061;1,066d74f514e44dc2b33d2d137adf4b34</RefFunc>
<Extra><![CDATA[<Extra>
<FirstBarDate val="0" />
<Maxbb val="20" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="-1" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="1分鐘K開盤暴量三連陽" ID="a8f0c5e34a32418eabb6870a501f3392" ReturnType="0" ExecType="3" Folder="/盤中常用/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[if barfreq <> "Min" or Barinterval <>1 then RaiseRuntimeError("請設定頻率為1分鐘");

variable:BarNumberOfToday(0); 

if Date <> Date[1] then
	BarNumberOfToday=1 
else
	BarNumberOfToday+=1;{記錄今天的Bar數} 

if barnumberoftoday=3 then begin
//今天第三根1分鐘K，也就是開盤第三分鐘
	if trueall(close>=close[1],3)
	//連三根K棒都是紅棒
	and volume>average(volume[1],3)*2
	//成交量是過去三根量平均量的兩倍以上
	and close=highd(0)
	//收最高
	then ret=1;
end;
 
]]></Code>
<Arg><![CDATA[<Arg seed="b0df348d-15ee-498e-9d35-445d06109d74" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="19ecec96-61b5-4bed-b668-aaa8fffd343c" version="1" />]]></Plots>
<RefFunc>1,93ec7a47222349e7ba8a2257d29196e4;1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c;1,61b7479e4304402c83419e5e14e287ba</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="300" />
<Maxbb val="50" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="帶量上影線" ID="4a82d879277645d5861778b8170b0380" ReturnType="0" ExecType="1" Folder="/價量指標/" StatusMask="2">
<Desc><![CDATA[帶量上影線]]></Desc>
<Code><![CDATA[settotalbar(5);
if high - maxlist(open,close) > absvalue(open-close)*2 and
    Volume > maxlist(volume[1],volume[2],volume[3]) then ret=1;



]]></Code>
<Arg><![CDATA[<Arg seed="27d533b8-9eac-4a41-a1d8-3c5d956c745d" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="cde71baa-e81f-4d43-b8e5-7d10676d91a9" version="1" />]]></Plots>
<Extra><![CDATA[<Extra>
<Maxbb val="3" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="5" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="OBV買進訊號" ID="fd98c6104c834d068a40f91075c329c6" ReturnType="0" ExecType="3" Folder="/ETF策略/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[variable: obvolume(0);

if CurrentBar = 1 then
	obvolume = 0
else begin	
	if close > close[1] then
		obvolume = obvolume[1] + volume
	else begin
		if close < close[1] then
			obvolume = obvolume[1] - volume
		else
			obvolume = obvolume[1];
	end;		
end;

value1=average(obvolume,20);

if obvolume crosses over value1*1.3 then ret=1;
]]></Code>
<Arg><![CDATA[<Arg seed="8cc02b7b-4535-45cc-a0b6-af5003bfffa1" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="b612088f-d557-4111-a1ed-5986c9947b06" version="1" />]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c;1,6850ead727a842bf883a1501d030ba98</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<FirstBarDate val="0" />
<Maxbb val="20" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="月KD高檔鈍化且日KD黃金交叉" ID="06ebfc9e302f49dc8ed7486931cb012a" ReturnType="0" ExecType="3" Folder="/ETF策略/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input: Length_D(9, "日KD期間");
input: Length_M(5, "月KD期間");

variable:rsv_d(0),kk_d(0),dd_d(0);
variable:rsv_M(0),kk_M(0),dd_M(0);

stochastic(Length_D, 3, 3, rsv_d, kk_d, dd_d);
xf_stochastic("M", Length_M, 3, 3, rsv_m, kk_m, dd_m);

if xf_getvalue("M", kk_m, 1) >= 85 and kk_d crosses over dd_d then ret=1;


]]></Code>
<Arg><![CDATA[<Arg seed="6bb371bf-b168-443e-bc4d-3f601f91d864" version="1"><Param name="日KD期間" varname="Length_D" type="1" subtype="0" value="9" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="月KD期間" varname="Length_M" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="c4f3b207-11ba-4c0e-b11e-e51d67486c0b" version="1" />]]></Plots>
<RefFunc>1,61c06064ad98469db9ce30287ae4a2c8;1,2bca774c6b7549c1b0b008d2a54b288e;1,f1b429ac13b2447c909302198c18ca56;1,847bcd706dda4a9caf2b783e181a8e42;1,57f222578a2c4d17b2b88b65b8f28696;1,bdf6d4140e2c4954b316120de89f2d59;1,ae592f43d76b43c589aaa0eb0e6ecb27;1,6850ead727a842bf883a1501d030ba98</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<FirstBarDate val="0" />
<Maxbb val="20" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="加速趕底中" ID="1e718d5d101c4b35ac79c63a2be9e10c" ReturnType="0" ExecType="1" Folder="/短線操作型/" StatusMask="2">
<Desc><![CDATA[自高檔回跌三成且近5期收低7%以上,近3期每期波動至少有2%]]></Desc>
<Code><![CDATA[settotalbar(210);

if Close[4] > Close *1.07 and
   TrueAll (truerange/Close > 0.02,3) and
   Close < Highest(high,200) *0.7 
then Ret=1;
    
{自高檔回跌三成且近5期收低7%以上,近3期每期波動至少有2%}]]></Code>
<Arg><![CDATA[<Arg seed="5fff8ecf-c9f0-4c21-b770-128a6d8c3348" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="de8f7e60-3eae-4e28-8b89-fe9458bf353c" version="1" />]]></Plots>
<RefFunc>1,36d1fc033c6f48f8a136f9e1fdec110f;1,81394f9cf0c8469ea5f8832700aec8b7;1,9e03682196e24611b2fe326b6a56433d;1,93ec7a47222349e7ba8a2257d29196e4;1,61c06064ad98469db9ce30287ae4a2c8;1,2bca774c6b7549c1b0b008d2a54b288e</RefFunc>
<Extra><![CDATA[<Extra>
<Maxbb val="200" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="210" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="CCI超買" ID="0c81f79d77124cdcb34b612cba7482cd" ReturnType="0" ExecType="3" Folder="/技術分析/" StatusMask="2">
<Desc><![CDATA[CCI指標穿越買超設定值進入買超區]]></Desc>
<Code><![CDATA[// CCI超買
//
Input: Length(14), AvgLength(9), Overbought(100);
Variable: cciValue(0), cciMAValue(0);

SetTotalBar(maxlist(AvgLength + Length + 1,6) + 11);

SetInputName(1, "期數");
SetInputName(2, "平滑期數");
SetInputName(3, "超買值");

cciValue = CommodityChannel(Length);
cciMAValue = Average(cciValue, AvgLength);

Ret = cciMAValue Crosses Above OverBought;



]]></Code>
<Arg><![CDATA[<Arg seed="d7129ead-08aa-43c6-83a9-021fb51bf128" version="1"><Param name="期數" varname="Length" type="1" subtype="0" value="14" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="平滑期數" varname="AvgLength" type="1" subtype="0" value="9" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="超買值" varname="Overbought" type="1" subtype="0" value="100" isSerial="1" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="66a5a676-7d02-4c10-9112-5fbf39ef460a" version="1" />]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c;1,6673d58f85784adc88e05084868c3d49;1,6850ead727a842bf883a1501d030ba98</RefFunc>
<Extra><![CDATA[<Extra>
<Maxbb val="25" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="-1" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="開盤三連陽" ID="e83e1434f91c4c9485b859ccc3d1ffb8" ReturnType="0" ExecType="1" Folder="/當沖交易型/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:TXT("僅適用60分鐘線以內"); setinputname(1,"使用限制");
settotalbar(5);
if barfreq = "Min" and barinterval <= 60 and
   (time[2] = 84500 or time[2] = 90000) and
    Close > Close[1] and Close[1] > Close[2] and
	Close[2] > Open[2] 
then ret=1;]]></Code>
<Arg><![CDATA[<Arg seed="7f4e9075-a322-4113-a88d-9c3f64a61240" version="1"><Param name="使用限制" varname="TXT" type="3" subtype="0" value="僅適用60分鐘線以內" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="5c28cd66-4e29-4ed7-b30c-799d2529f666" version="1" />]]></Plots>
<Extra><![CDATA[<Extra>
<Maxbb val="3" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="5" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="步步高升" ID="16df38a8a46d465585cbf80e085a2d5e" ReturnType="0" ExecType="1" Folder="/價量指標/" StatusMask="2">
<Desc><![CDATA[階梯量 階梯價 揚升]]></Desc>
<Code><![CDATA[settotalbar(3);
if volume > volume[1]     and 
   volume[1] > volume[2]  and
   close > close[1]       and   
   close[1] > close[2]    and 
   close > open and 
   close[1] > open[1] and 
   close[2] > open[2]
then ret=1; 


 
]]></Code>
<Arg><![CDATA[<Arg seed="5f36eb96-6b72-4024-b990-7b62c8e4d8ad" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="64eadb6d-7ee6-4c48-b92b-25e7c6f5031e" version="1" />]]></Plots>
<Extra><![CDATA[<Extra>
<Maxbb val="3" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="法人累計買超超過N張" ID="72e90b6b678d4385bf685a70c17bf556" ReturnType="0" ExecType="3" Folder="/波段操作型/" StatusMask="2">
<Desc><![CDATA[法人累計買超超過N張]]></Desc>
<Code><![CDATA[input: ForceType(1); setinputname(1,"法人：0=合計 1=外資 2=投信 3=自營商");
input: Periods(20); setinputname(2,"計算期間");
input: Size(3000); setinputname(3,"累計買超張數");
input: Type(1); setinputname(4,"使用資料：0=今日 1=昨日");
input: TXT1("僅適用日線"); setinputname(5,"使用限制");
input: TXT2("盤中無當日法人資料"); setinputname(6,"建議使用單次洗價模式");

settotalbar(Periods + 3);

if barfreq <> "D" then return;

variable: ForcePush(0);

if Type = 0 then value1 = 0 else value1 = 1;

Switch ( ForceType ) 
Begin 
Case 1: 
ForcePush = Getfield("外資持股")[value1];
Case 2: 
ForcePush = Getfield("投信持股")[value1]; 
Case 3: 
ForcePush = Getfield("自營商持股")[value1]; 
default: 
ForcePush = Getfield("外資持股")[value1]+Getfield("投信持股")[value1]+Getfield("自營商持股")[value1];
End; 

if currentbar <= Periods then return;

if ForcePush[value1] - ForcePush[Periods+value1] >= Size then ret=1;
]]></Code>
<Arg><![CDATA[<Arg seed="9b110c18-d440-4b0c-8cb4-4f393368eb64" version="1"><Param name="法人：0=合計 1=外資 2=投信 3=自營商" varname="ForceType" type="1" subtype="0" value="1" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="計算期間" varname="Periods" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="累計買超張數" varname="Size" type="1" subtype="0" value="3000" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="使用資料：0=今日 1=昨日" varname="Type" type="1" subtype="0" value="1" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="使用限制" varname="TXT1" type="3" subtype="0" value="僅適用日線" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="建議使用單次洗價模式" varname="TXT2" type="3" subtype="0" value="盤中無當日法人資料" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="abd9b54c-5165-45c5-9e6b-73c8760c71c0" version="1" />]]></Plots>
<Extra><![CDATA[<Extra>
<Maxbb val="5" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="-1" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="短期均線跌破長期均線" ID="f204bd1e24cb4d7c894a5c99860629be" ReturnType="0" ExecType="1" Folder="/技術分析/" StatusMask="2">
<Desc><![CDATA[短期均線跌破長期均線]]></Desc>
<Code><![CDATA[input: Shortlength(5); setinputname(1,"短期均線期數");
input: Longlength(20); setinputname(2,"長期均線期數");

settotalbar(8);
setbarback(maxlist(Shortlength,Longlength,6));

If Average(Close,Shortlength) crosses under Average(Close,Longlength) then Ret=1;



]]></Code>
<Arg><![CDATA[<Arg seed="cdc88963-ec3f-4dd3-b767-0c9c4e1373ef" version="1"><Param name="短期均線期數" varname="Shortlength" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="長期均線期數" varname="Longlength" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="33c6d9d7-a7c3-444c-bafe-4d420b7b982b" version="1" />]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c;1,9dc3f19597ba44fa91524e91ca67aebd</RefFunc>
<Extra><![CDATA[<Extra>
<Maxbb val="80" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="8" />
<IsScriptSetBB val="1" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="殺尾盤" ID="8084cc09424d4f29bd438404bde5dd65" ReturnType="0" ExecType="1" Folder="/2.市場常用語/" StatusMask="2">
<Desc><![CDATA[台股最後一盤下跌超過1%]]></Desc>
<Code><![CDATA[input:TXT("限用10分鐘以下"); setinputname(1,"使用限制");

settotalbar(3);

variable:KeyPrice(0);

if Date> date[1] then KeyPrice = 0;		// 換日的話則重新定義KeyPrice
if time>132000 and KeyPrice = 0 then KeyPrice =close;

if KeyPrice > 0 and close <= KeyPrice *0.99//時間超過13:20分且十分鐘跌幅超過1%
then ret=1;
]]></Code>
<Arg><![CDATA[<Arg seed="0d5e5721-5f19-4cf8-8d1a-bcb9e695f6e2" version="1"><Param name="使用限制" varname="TXT" type="3" subtype="0" value="限用10分鐘以下" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="c7daa10e-3d45-4a83-904c-544881f7f22f" version="1" />]]></Plots>
<Extra><![CDATA[<Extra>
<Maxbb val="3" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="大跌三成之後" ID="b2869acbcfad4d0daf73ff128999e172" ReturnType="0" ExecType="1" Folder="/ETF策略/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:n(30,"下跌幅度");
input:period(60,"計算天數");

if close*(1+n/100) < close[period-1] then ret=1;

]]></Code>
<Arg><![CDATA[<Arg seed="ee04754b-de07-436f-8cc1-c7781a6e9d92" version="1"><Param name="下跌幅度" varname="n" type="1" subtype="0" value="30" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="計算天數" varname="period" type="1" subtype="0" value="60" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="a55bb481-8406-4315-aeb6-a937bc1b4433" version="1" />]]></Plots>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<FirstBarDate val="0" />
<Maxbb val="20" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="開盤五分鐘創三新低" ID="077d0f1e92144f139d40ae48cf0080ae" ReturnType="0" ExecType="1" Folder="/當沖交易型/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:TXT("僅適用1分鐘線"); setinputname(1,"使用限制");
settotalbar(8);
variable:KBarOfDay(0); KBarOfDay+=1; if date<>date[1] then  KBarOfDay=1; 

if barfreq = "Min"  and barinterval = 1 and Date = CurrentDate   and
   KBarOfDay = 6 and
   Countif(Low < Low[1] and Close < Close[1] ,5) >=3  then Ret=1;]]></Code>
<Arg><![CDATA[<Arg seed="afce2e72-5071-4bee-ac85-aa6f274302f3" version="1"><Param name="使用限制" varname="TXT" type="3" subtype="0" value="僅適用1分鐘線" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="a828e9ae-dcfd-49d4-b951-0ec4ec301a95" version="1" />]]></Plots>
<RefFunc>1,d80cf92ddfcc42e0a6c53ec47edebd49</RefFunc>
<Extra><![CDATA[<Extra>
<Maxbb val="6" />
<ScriptComplexity val="2" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
<UsedFieldList val="{&quot;freq_field&quot;:{},&quot;symbol_freq_field&quot;:{}}" />
<IsScriptSetTB val="1" />
<TotalBar val="8" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="短期均線突破長期均線" ID="a2055f9d53ba4cfaa633fb024cd7f9ba" ReturnType="0" ExecType="1" Folder="/技術分析/" StatusMask="2">
<Desc><![CDATA[短期均線突破長期均線  ]]></Desc>
<Code><![CDATA[input: Shortlength(5); setinputname(1,"短期均線期數");
input: Longlength(20); setinputname(2,"長期均線期數");

settotalbar(8);
setbarback(maxlist(Shortlength,Longlength,6));

If Average(Close,Shortlength) crosses over Average(Close,Longlength) then Ret=1;



        ]]></Code>
<Arg><![CDATA[<Arg seed="77921bbd-ae81-43d4-9b07-7a54cad646a9" version="1"><Param name="短期均線期數" varname="Shortlength" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="長期均線期數" varname="Longlength" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="f83c0248-53d5-478d-a346-d63cf46090ae" version="1" />]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c;1,6850ead727a842bf883a1501d030ba98</RefFunc>
<Extra><![CDATA[<Extra>
<Maxbb val="80" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="8" />
<IsScriptSetBB val="1" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="MTM背離" ID="a917126ba9ac42b7ac0022af5354a9f6" ReturnType="0" ExecType="3" Folder="/技術分析/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[value1=momentum(close,10);
if linearregslope(close,6)<0
and linearregslope(value1,6)>0
and close*1.2<close[20]
then ret=1;]]></Code>
<Arg><![CDATA[<Arg seed="7255a026-ea3d-4d6f-8314-c3302cc9a0bf" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="62602035-e6df-4ede-bf0e-0949f2d44510" version="1" />]]></Plots>
<RefFunc>1,239cb1c1f329431ea731982d8f5d94f2;1,8c2d025a23c548d3a76fba10c22527b4;1,210d0786cfe340538e34c095bc2ba049;1,626e6e5c42304bbea9809d1a07ae4e01</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<FirstBarDate val="0" />
<Maxbb val="20" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="分鐘線九連黑" ID="f274bf7b693a426588e40fd0063ea40c" ReturnType="0" ExecType="1" Folder="/3.出場常用警示/" StatusMask="2">
<Desc><![CDATA[分鐘線連九黑]]></Desc>
<Code><![CDATA[Input: Length(9); SetInputName(1, "連續筆數");

settotalbar(Length + 3);

if Barfreq ="Min" then 
   if trueall(close < open,Length) then ret=1;
]]></Code>
<Arg><![CDATA[<Arg seed="b0d379c9-d397-44ca-a3e4-087351307901" version="1"><Param name="連續筆數" varname="Length" type="1" subtype="0" value="9" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="78bac8e5-fb40-48b5-8625-42afcac86796" version="1" />]]></Plots>
<RefFunc>1,93ec7a47222349e7ba8a2257d29196e4</RefFunc>
<Extra><![CDATA[<Extra>
<Maxbb val="10" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="-1" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="成交量突破均量" ID="b20b5fa767e241f1ae96d5fcf8eb5800" ReturnType="0" ExecType="1" Folder="/價量指標/" StatusMask="2">
<Desc><![CDATA[當期成交量突破過去N期量平均]]></Desc>
<Code><![CDATA[input: length(20);  setinputname(1,"均量期數");
input: confirmVolume(500);  setinputname(2,"突破均量張數");

settotalbar(3);
setbarback(Length);

if volume > Average( volume[1],length) +confirmVolume then ret=1;



        ]]></Code>
<Arg><![CDATA[<Arg seed="6d9570b6-518a-42e9-99ab-b6d6d24ee301" version="1"><Param name="均量期數" varname="length" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="突破均量張數" varname="confirmVolume" type="1" subtype="0" value="500" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="be7ecda6-3b4d-4b13-9903-0b3921509859" version="1" />]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c</RefFunc>
<Extra><![CDATA[<Extra>
<Maxbb val="50" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
<IsScriptSetBB val="1" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="空頭部隊進攻" ID="8d47d37d14c74c4088a5f54a714c952e" ReturnType="0" ExecType="1" Folder="/價量指標/" StatusMask="2">
<Desc><![CDATA[量增價跌,價格破昨日低點且總量突破昨日量
        ]]></Desc>
<Code><![CDATA[settotalbar(25);
if low < lowD(1) and GetField("Volume", "D")>  GetField("Volume", "D")[1]  then ret=1;  


        
        ]]></Code>
<Arg><![CDATA[<Arg seed="4cf8478a-dda6-45de-8d2f-de7fed2c0ed1" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="b6aecaf7-b098-4b01-8910-5522d6b77969" version="1" />]]></Plots>
<RefFunc>1,7513ef4c00b84668bb971542273f8683</RefFunc>
<Extra><![CDATA[<Extra>
<Maxbb val="3" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="25" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="開盤五分鐘三創新高" ID="6efd514d2565426e87d9802243db1b8f" ReturnType="0" ExecType="3" Folder="/當沖交易型/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input: volumeRatio(0.1, "分鐘量暴量比例");
input: changeRatio(3, "最近3日最大上漲幅度");
input: averageVolume(1000, "5日均量");

variable:KBarOfDay(0), BreakHigh(false); 
 
KBarOfDay+=1;
if date<>date[1] then begin
	KBarOfDay=1; 
	BreakHigh = false;
end; 
 
condition1 = KBarOfDay = 6;
//一分鐘線每天的第六根

condition2 = Countif(High > High[1] and Close > Close[1] ,5) >=3;
//近五根裡至少三根最高價比前一根高且收盤比前一根高

if KBarOfDay = 1
and close > getfield("close", "d")[1] 
then BreakHigh = true;
//開高

value1 = average(GetField("Volume", "D")[1], 5);
//五日均量

condition3 = value1 > averageVolume;
//五日均量大於某張數 

value2 = rateofchange(GetField("Close", "D")[1], 3);
condition4 = AbsValue(value2) < changeRatio;
//前三日漲帳幅小於一定標準

condition5 = summation(volume, 5) > value1 * volumeRatio;
//前五根一分鐘線成交量的合計大於五日均量某個比例

condition6 = GetSymbolField("TSE.TW","收盤價","D")>average(GetSymbolField("TSE.TW","收盤價","D"),10);
//大盤屬於多頭結構

if condition1 and condition2 and condition3
and Condition4 and Condition5 and condition6
and BreakHigh
then ret=1;]]></Code>
<Arg><![CDATA[<Arg seed="491bb9db-e402-4965-8865-a1c679bf3ef9" version="1"><Param name="分鐘量暴量比例" varname="volumeRatio" type="1" subtype="0" value="0.1" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="最近3日最大上漲幅度" varname="changeRatio" type="1" subtype="0" value="3" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="5日均量" varname="averageVolume" type="1" subtype="0" value="1000" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="ef80b5d0-2008-4893-9a0c-24110d4fecb0" version="1" />]]></Plots>
<RefFunc>1,d80cf92ddfcc42e0a6c53ec47edebd49;1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c;1,c9f2641e5de0497cb352ace96f64236e</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="300" />
<Maxbb val="50" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="成交量突破N倍均量" ID="39bfd582bdf640fcacbc7dc4f95e7ab0" ReturnType="0" ExecType="1" Folder="/價量指標/" StatusMask="2">
<Desc><![CDATA[成交量突破近期均量N倍]]></Desc>
<Code><![CDATA[input: length(20);  setinputname(1,"均量期數");
input: VolumeXtime(3);  setinputname(2,"量增倍數");

settotalbar(3);
setbarback(Length);

if volume > Average( volume[1],length)* VolumeXtime then ret=1;



]]></Code>
<Arg><![CDATA[<Arg seed="d1e55188-4ec2-4aa0-bef4-5d1e8206f29e" version="1"><Param name="均量期數" varname="length" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="量增倍數" varname="VolumeXtime" type="1" subtype="0" value="3" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="284e6b79-c06c-4380-b707-06cece7f6f8d" version="1" />]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c</RefFunc>
<Extra><![CDATA[<Extra>
<Maxbb val="50" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
<IsScriptSetBB val="1" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="暴量剛起漲" ID="1a31dcaaf14f41bfb5ed5d33b575a50c" ReturnType="0" ExecType="1" Folder="/波段操作型/" StatusMask="2">
<Desc><![CDATA[股價處於低檔時爆量上揚]]></Desc>
<Code><![CDATA[input: Length(20);       setinputname(1,"計算期數");
input: VLength(10);      setinputname(2,"均量期數");
input: volpercent(50);   setinputname(3,"爆量增幅%");
input: Rate(5);          setinputname(4,"離低點幅度%");

settotalbar(3);
setbarback(maxlist(Length,VLength));

if Close >  Close[1] and
   Volume >=  average(volume,VLength) *(1+ volpercent/100) and
   Close <= lowest(close,Length) * (1+Rate/100)
then ret=1;

]]></Code>
<Arg><![CDATA[<Arg seed="b0635521-a813-474d-85d7-f199b8a475b1" version="1"><Param name="計算期數" varname="Length" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="均量期數" varname="VLength" type="1" subtype="0" value="10" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="爆量增幅%" varname="volpercent" type="1" subtype="0" value="50" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="離低點幅度%" varname="Rate" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="6edbd717-1ebb-450d-87a1-53165bf2fbf5" version="1" />]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c;1,61c06064ad98469db9ce30287ae4a2c8;1,f1b429ac13b2447c909302198c18ca56</RefFunc>
<Extra><![CDATA[<Extra>
<Maxbb val="20" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
<IsScriptSetBB val="1" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="拉尾盤" ID="0994e771e66246409f95d51a9c44389f" ReturnType="0" ExecType="1" Folder="/2.市場常用語/" StatusMask="2">
<Desc><![CDATA[台股最後一盤上拉超過1%]]></Desc>
<Code><![CDATA[input:Ratio(1); setinputname(1,"拉尾盤幅度%");
input:tTime(130000); setinputname(2,"尾盤切算時間%");
input:TXT("限用5分鐘以下"); setinputname(3,"使用限制");
if barfreq <> "Min" or barinterval > 5 then return;

settotalbar(3);

variable:fPrice(0); if date<>date[1] then fPrice=0;

if time < tTime then fPrice = Close else
if Close > fPrice*(1+Ratio/100) and time >= tTime and fPrice>0 
then RET=1;]]></Code>
<Arg><![CDATA[<Arg seed="a4f9be42-8fb4-4320-9dfc-90f5ca2e67a2" version="1"><Param name="拉尾盤幅度%" varname="Ratio" type="1" subtype="0" value="1" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="尾盤切算時間%" varname="tTime" type="1" subtype="0" value="130000" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="使用限制" varname="TXT" type="3" subtype="0" value="限用5分鐘以下" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="438539c9-3650-4ebb-b222-078018043f64" version="1" />]]></Plots>
<Extra><![CDATA[<Extra>
<Maxbb val="3" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="內困三日翻紅" ID="3d7aff1f47dd4c1a94199c0ac1377d15" ReturnType="0" ExecType="1" Folder="/酒田戰法/" StatusMask="2">
<Desc><![CDATA[黑K棒後內包前期短紅棒 當期再以紅棒突破黑棒開盤價]]></Desc>
<Code><![CDATA[{								
[檔名:]	內困三日翻紅			[資料夾:]	酒田戰法	[適用方向]	多	
[說明:]	黑K棒後內包前期短紅棒 當期再以紅棒突破黑棒開盤價												
}								
settotalbar(5);					
{判斷狀況}								
	condition1=	( open[2] - close[2] ) >(high[2] -low[2]) * 0.75					;//狀況1:	實體下跌K棒
	condition2=	( close[1] - open[1] ) >(high[1] -low[1]) * 0.75					;//狀況2:	實體上漲K棒
	condition3=	 high[1] < high[2] and low[1] > low[2]					;//狀況3:	前期內包於前前期
	condition4=	( close - open )  > 0.75 *(high -low)					;//狀況4:	當期實體上漲K棒
	condition5=	close > open[2]					;//狀況5:	現價突破前前期開盤價
{結果判斷}		
IF		
		condition1
	and	condition2
	and	condition3
	and	condition4
	and	condition5
THEN	RET=1;	]]></Code>
<Arg><![CDATA[<Arg seed="38b9f61d-7c16-4775-b9d9-b78b4ce166b6" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="957a659b-53c2-45cd-8d4f-cb9c52de56be" version="1" />]]></Plots>
<Extra><![CDATA[<Extra>
<Maxbb val="5" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="5" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="九陰白骨爪" ID="54f5f95fdc9f408bb8fba46595941af2" ReturnType="0" ExecType="1" Folder="/A股用語/" StatusMask="2">
<Desc><![CDATA[連續9期K棒收黑]]></Desc>
<Code><![CDATA[// 連續9筆K線收黑
//
settotalbar(10);
Ret = TrueAll(close < open, 9);
]]></Code>
<Arg><![CDATA[<Arg seed="4569e8a3-872c-4082-8d80-d971a754416b" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="044bf059-62df-420a-922d-ec53cb6e25f0" version="1" />]]></Plots>
<RefFunc>1,93ec7a47222349e7ba8a2257d29196e4</RefFunc>
<Extra><![CDATA[<Extra>
<Maxbb val="10" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="10" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="主力押大注" ID="afc94c33d3a3427a89a136dc4e1ff4d4" ReturnType="0" ExecType="1" Folder="/技術分析/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[//透過Z的時間安排來決定現在用的是那一根Bar的資料 
variable: Z(0);
if GetFieldDate("主力買賣超張數") <> 0 then
	Z=0 
else 
	Z=1;
	
value1=GetField("主力買賣超張數")[Z];
if value1=highest(value1,120)
and trueall(value1>0,3)
and volume>500
and close>close[1]*1.03
then ret=1;]]></Code>
<Arg><![CDATA[<Arg seed="286969a8-501c-48a6-9104-505eb636f772" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="7123065e-0a27-46a2-a292-1cf2e0ab147a" version="1" />]]></Plots>
<RefFunc>1,61c06064ad98469db9ce30287ae4a2c8;1,2bca774c6b7549c1b0b008d2a54b288e;1,93ec7a47222349e7ba8a2257d29196e4</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<FirstBarDate val="0" />
<Maxbb val="20" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="快到期了還是價內" ID="7bf49e80e39b486fb442efe3e9d23fcd" ReturnType="0" ExecType="1" Folder="/期權策略/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[if  q_IOofMoney>0 
and datediff(GetSymbolInfo("到期日"),date)<10
and datediff(GetSymbolInfo("到期日"),date)>0
then ret=1;





]]></Code>
<Arg><![CDATA[<Arg seed="ec819351-fd59-4a63-8497-376d37071068" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="33a49cb1-4735-4cc7-9774-aa1ddee53432" version="1" />]]></Plots>
<Extra><![CDATA[<Extra>
<TotalBar val="300" />
<FirstBarDate val="0" />
<Maxbb val="50" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="夜星" ID="8bd675b5c19c4263a7878017abf64598" ReturnType="0" ExecType="1" Folder="/酒田戰法/" StatusMask="2">
<Desc><![CDATA[紅棒後 開高走低守平盤]]></Desc>
<Code><![CDATA[{																						
[檔名:]	夜星			[資料夾:]	酒田戰法	[適用方向]	空															
[說明:]	紅棒後 開高走低守平盤																																									
}
settotalbar(5);																														
{判斷狀況}								
	condition1=	 ( close[2] - open[2] ) > (high[2] -low[2]) * 0.75					;//狀況1:	前前期實體紅棒
	condition2=	close[2] > close[3] + (high[3]-low[3])					;//狀況2:	前前期波動放大
	condition3=	low[1] > high[2] and close[1]>open[1]					;//狀況3:	前期高開收紅
	condition4=	open < close[1] and close < open - (high[1]-low[1])					;//狀況4:	當期開低收黑K棒
{結果判斷}		
IF		
		condition1
	and	condition2
	and	condition3
	and	condition4
THEN	RET=1;	]]></Code>
<Arg><![CDATA[<Arg seed="d5a1f0c3-aa21-474f-8193-1eeebc285219" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="d4391ccc-e69d-4369-acf8-7eeca698909b" version="1" />]]></Plots>
<Extra><![CDATA[<Extra>
<Maxbb val="50" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="5" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="漲停量縮不下來" ID="f922d381c5a24c4cbd5f3a0737a1dafa" ReturnType="0" ExecType="1" Folder="/當沖交易型/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input: lastvolume1(2000);  setinputname(1,"漲停期間放量張數");
input: lastvolume2(10000); setinputname(2,"當日總成交量上限");
input:TXT1("需使用逐筆洗價"); setinputname(3,"使用限制");

settotalbar(3);

variable: UPLVol(0);

if Date <> Date[1] then UPLVol = 0;

if Close =GetField("漲停價", "D") then 
begin
  UPLVol += GetField("Volume", "Tick");
  if q_BestBidSize1 <lastvolume1 and 
     GetField("Volume", "D") >lastvolume2 and
	 UPLVol > lastvolume1 
  then RET=1;
end;
]]></Code>
<Arg><![CDATA[<Arg seed="421ab807-7a01-4a5e-a7f3-e3044dbe7a7c" version="1"><Param name="漲停期間放量張數" varname="lastvolume1" type="1" subtype="0" value="2000" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="當日總成交量上限" varname="lastvolume2" type="1" subtype="0" value="10000" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="使用限制" varname="TXT1" type="3" subtype="0" value="需使用逐筆洗價" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="105f0bd6-0bb9-46d9-9df3-9580c47c529a" version="1" />]]></Plots>
<Extra><![CDATA[<Extra>
<Maxbb val="2" />
<script>
<freq support="1;8;11;9;12;10;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="主力切入見真章" ID="b0e9f9f62d00436ba82183cb59599165" ReturnType="0" ExecType="1" Folder="/1.籌碼監控/" StatusMask="2">
<Desc><![CDATA[主力近日買超金額超過X萬,今日股價大漲3.5%以上.
需選用日線逐筆洗價.]]></Desc>
<Code><![CDATA[input: pastDays(3); setinputname(1,"近期天數");
input: UpRatio(3.5); setinputname(2, "上漲幅度(%)");
input: _buyAmount(3000); setinputname(3,"累積金額(萬)");
input:TXT("僅適用日線"); setinputname(4,"使用限制");

variable: SumForce(0);
variable:intrabarpersist tickcounter(0);

settotalbar(pastdays + 3);

if BarFreq <> "D" then return;

if   close > close[1]*(1 + UpRatio/100) then
begin
	// 過去N日 主力買賣超的成交金額的總和
    //	
    SumForce = Summation((AvgPrice * GetField("主力買賣超張數")/10)[1], pastDays);

	if SumForce > _buyAmount  then ret =1;
end;
]]></Code>
<Arg><![CDATA[<Arg seed="563d68ed-1e03-4afd-a443-a04a725a88e2" version="1"><Param name="近期天數" varname="pastDays" type="1" subtype="0" value="3" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="上漲幅度(%)" varname="UpRatio" type="1" subtype="0" value="3.5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="累積金額(萬)" varname="_buyAmount" type="1" subtype="0" value="3000" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="使用限制" varname="TXT" type="3" subtype="0" value="僅適用日線" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="d4995d0c-2a6d-4c5b-9928-6fffd2dd2356" version="1" />]]></Plots>
<RefFunc>1,388033a24d7843e0b867cdc134206623;1,c122bd6485c544f2bce8f374b5c7440d</RefFunc>
<Extra><![CDATA[<Extra>
<Maxbb val="15" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="-1" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="一舉跌破多根均線" ID="6e5f1cdaad4b473a8086721def82c0d6" ReturnType="0" ExecType="1" Folder="/3.出場常用警示/" StatusMask="2">
<Desc><![CDATA[收盤價跌破短中長期均線]]></Desc>
<Code><![CDATA[input: shortlength(5); setinputname(1,"短期均線期數");
input: midlength(10);  setinputname(2,"中期均線期數");
input: Longlength(20); setinputname(3,"長期均線期數");

setbarback(maxlist(shortlength,midlength,Longlength,6)+8);

variable: shortaverage(0);
variable: midaverage(0);
variable: Longaverage(0);


shortaverage=Average(close,shortlength);
midaverage=Average(close,midlength) ;
Longaverage = Average(close,Longlength); 

if close  crosses under  shortaverage and 
   close  crosses under  midlength and 
   close  crosses under  Longaverage 
then ret=1;  
]]></Code>
<Arg><![CDATA[<Arg seed="12b41919-6848-423e-be4b-b43f3f4719cf" version="1"><Param name="短期均線期數" varname="shortlength" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="中期均線期數" varname="midlength" type="1" subtype="0" value="10" isSerial="1" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="長期均線期數" varname="Longlength" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="a995a805-9eb2-4659-8258-ccbb00724310" version="1" />]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c;1,9dc3f19597ba44fa91524e91ca67aebd</RefFunc>
<Extra><![CDATA[<Extra>
<Maxbb val="20" />
<TotalBar val="-1" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetBB val="1" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="帶量多頭吞噬" ID="e18cd32f2ac84dadabf0c35dbd762ca8" ReturnType="0" ExecType="1" Folder="/酒田戰法/" StatusMask="2">
<Desc><![CDATA[前期收短黑K棒 當期開低走高拉出長紅棒 波動率放大 穿過昨高]]></Desc>
<Code><![CDATA[{																						
[檔名:]	多頭吞噬			[資料夾:]	酒田戰法	[適用方向]	多															
[說明:]	前期收短黑K棒 當期開低走高拉出長紅棒 波動率放大 穿過昨高																																									
}																						
settotalbar(5);							
{判斷狀況}								
	condition1=	( open[1] - close[1] ) >(high[1] -low[1])*0.75					;//狀況1:	前期出黑K棒
	condition2=	( close - open ) >(high -low) * 0.75					;//狀況2:	當期紅棒
	condition3=	high > high[1]					;//狀況3:	高過昨高
	condition4=	open<low[1]					;//狀況4:	開低破昨低
	condition5=	Volume > Volume[1]*2					;//狀況5:	
{結果判斷}		
IF		
		condition1
	and	condition2
	and	condition3
	and	condition4
	and	condition5
THEN	RET=1;	]]></Code>
<Arg><![CDATA[<Arg seed="4798292e-9bab-446b-97d3-3cc27cf6ed79" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="bd52f220-6d24-4662-9f90-5fdd64fcaf82" version="1" />]]></Plots>
<Extra><![CDATA[<Extra>
<Maxbb val="5" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="5" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="資增券減還收黑" ID="1a33d000ab9e4e24b943da39698b9d97" ReturnType="0" ExecType="1" Folder="/3.出場常用警示/" StatusMask="2">
<Desc><![CDATA[昨日融資增加，融券減少，且今日收黑。
]]></Desc>
<Code><![CDATA[input:V1(1000); setinputname(1,"融資增加張數");
input:V2(500); setinputname(2,"融券減少張數");
input:TXT("僅適用日線"); setinputname(3,"使用限制");

settotalbar(3);

if BarFreq <> "D" then return;

if close < close[1] and 
   GetField("融資增減張數")[1] > V1 and
   GetField("融券增減張數")[1] < V2*-1
then ret=1;
   
]]></Code>
<Arg><![CDATA[<Arg seed="3567f99e-374e-4ba4-9588-2d34315616d6" version="1"><Param name="融資增加張數" varname="V1" type="1" subtype="0" value="1000" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="融券減少張數" varname="V2" type="1" subtype="0" value="500" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="使用限制" varname="TXT" type="3" subtype="0" value="僅適用日線" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="17f035b3-bcf3-4ead-9b59-28df111978df" version="1" />]]></Plots>
<Extra><![CDATA[<Extra>
<Maxbb val="2" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="DIF-MACD轉正買進訊號" ID="eb34c8a3fe794e15a94d4d13ba4fd933" ReturnType="0" ExecType="3" Folder="/技術分析/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[{L.J.R. Sep.2014}
// DIF-MACD翻正
//
input: FastLength(12), SlowLength(26), MACDLength(9);
variable: difValue(0), macdValue(0), oscValue(0);

SetInputName(1, "DIF短期期數");
SetInputName(2, "DIF長期期數");
SetInputName(3, "MACD期數");

//透過Z的時間安排來決定現在用的是那一根Bar的資料 
variable: Z(0);
if GetFieldDate("主力買賣超張數") <> 0 then
	Z=0 
else 
	Z=1;

MACD(weightedclose(), FastLength, SlowLength, MACDLength, difValue, macdValue, oscValue);

value1=GetField("主力買賣超張數")[Z];
if oscValue Crosses Above 0
and trueall(value1>300,3)
and tselsindex(10,8)[Z]=1
then ret=1;

]]></Code>
<Arg><![CDATA[<Arg seed="d6332d04-15c0-4d04-a1da-1c1a5597127e" version="1"><Param name="DIF短期期數" varname="FastLength" type="1" subtype="0" value="12" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="DIF長期期數" varname="SlowLength" type="1" subtype="0" value="26" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="MACD期數" varname="MACDLength" type="1" subtype="0" value="9" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="7e780d88-69eb-42b3-95c1-f56dbd0fa28f" version="1" />]]></Plots>
<RefFunc>1,2549534038c6445884c25787277c86db;1,d02c45cba76f4163a048685f7bc4002b;1,8216021f4b11489b8faca5f2af7d0750;1,6850ead727a842bf883a1501d030ba98;1,93ec7a47222349e7ba8a2257d29196e4;1,d80cf92ddfcc42e0a6c53ec47edebd49;1,b1f1a25bdc014e109dc92d7f9b6ef207</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="300" />
<Maxbb val="50" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="今日多方表態" ID="e4fc76a8083c4952ae3fc84334850262" ReturnType="0" ExecType="3" Folder="/2.市場常用語/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[
{三次到頂而破}
variable:CaliPrice(0),peakIndex(0),MaxPeak(0);
Array:peakDate[50](0),peakPrice[50](0),LongTrendPercent[50](0);
CaliPrice = (High[0]+Low[0]+Close[0])/3;

if CaliPrice[2] = MaxList(CaliPrice ,CaliPrice[1],CaliPrice[2],CaliPrice[3],CaliPrice[4]) and High[2] > CaliPrice[4]*1.02 and High[2] > CaliPrice[0]*1.02  then begin
	peakDate[peakIndex] = Date[2];peakPrice[peakIndex] = High[2];
	if peakIndex = 0 then LongTrendPercent[peakIndex]  = ( High[2]/ Close[2+20]-1)*100;
	if peakIndex > 0 and DateDiff(date,peakDate[peakIndex-1]) >5 then LongTrendPercent[peakIndex]  = ( High[2]/ Close[2+20]-1)*100;
	peakIndex+=1;
end;

if Date=CurrentDate  and Close > Open then begin

  if peakIndex >2 and Absvalue(peakPrice[peakIndex-1]/ peakPrice[peakIndex-2]-1 )< 0.01 and DateDiff(Date, peakDate[peakIndex-1])>20 then condition1 =true ;
  if  condition1  and  Close*1.065   >  highest(high[1],100) and
    minlist(low[100],low[99],low[98],low[97],low[96]) = Lowest(Low,100) and
    peakIndex >3 and LongTrendPercent[peakIndex-2] >20 and 
    Absvalue( peakPrice[peakIndex-1]/ peakPrice[peakIndex-2]-1 )< 0.01 and 
    DateDiff( peakDate[peakIndex-2] ,peakDate[peakIndex-3]) > 20 and 
    DateDiff( peakDate[peakIndex-1] ,peakDate[peakIndex-2]) > 5 and 
    Date < DateAdd(peakDate[peakIndex-1],"D",20)  
    then begin
    MaxPeak =MaxList(peakPrice[peakIndex-1],peakPrice[peakIndex-2]);
    if  Close > MaxPeak*1.005  and C>O then ret=1; 
    end;
end;

{激烈波動}
if Date =currentdate then  begin
	variable:STDEV(standarddev(volume[1],19,1)*3);
	if C>O and Volume*GetField("均價") > 30000{仟元} and  Close > High*0.99 and high = highest(high,20) and highest(high[1],19)/lowest(Low[1],19) - 1 <0.065 and 
	   TrueAll(ABSValue(high[1]/low[1]-1)<0.04,15) and  Volume > average(Volume[1],19)+STDEV then ret=1;   
end;

{波段初漲}
variable:hHigh(0),pC(0),iHigh(0),iLow(10000),iDate(0),eLow(10000);
if DateDiff(currentdate,date) < 93 then begin 	
    eLow = minlist(low,elow);
	if DateDiff(currentdate,date) >=90 then begin iHigh =high; iDate= Date; value1=open; end;
	hHigh = maxlist(high,hHigh); 
	if eLow = Low then hHigh = low;
	if hHigh > iHigh  then begin
	if C>O and iHigh<> iLow and close> eLow*1.08 and DateDiff(Date,iDate)> 30 and v>500 then  ret=1;
	iHigh =hHigh;iLOw = hHigh;iDate =Date;
	end else iLow =minlist(Low,iLow);
end;

{突破均線極度糾結}
variable:VSTDEV(1000000),PSTDEV(1000),AVG1(0),AVG2(0),AVG3(0),AVG4(0);
 AVG1 = average(close,5);AVG2 = average(close,10);AVG3 = average(close,20);AVG4 = average(close,60);
 if Date = currentdate then   begin
   VSTDEV=standarddev(volume[1],19,1)*3;
   PSTDEV=standarddev(H[1]-L[1],19,1)*3;
   if volume < average(Volume[1],19)+VSTDEV  or (C-O)/(H-L) < 0.7 then return;
   if C>O and Close  > maxlist(AVG1,AVG2,AVG3,AVG4)  and C > L +PSTDEV and  TrueAll( H[1]/L[1]-1 < 0.07,20) and 
       TrueAll(maxlist(AVG1,AVG2,AVG3,AVG4)/Maxlist( Minlist(AVG1,AVG2,AVG3,AVG4),0.01)-1 < 0.035,20) then ret=1;
 end;
]]></Code>
<Arg><![CDATA[<Arg seed="51f83be6-b8e4-4661-b39b-29e4aadff787" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="848cd27b-b7bd-4c85-9630-85dd3e44c6c5" version="1" />]]></Plots>
<RefFunc>1,61c06064ad98469db9ce30287ae4a2c8;1,2bca774c6b7549c1b0b008d2a54b288e;1,f1b429ac13b2447c909302198c18ca56;1,8c2d025a23c548d3a76fba10c22527b4;1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c;1,9c4f476d319b4f109a8dc8557099ded4;1,c1cda70a714d44999e5171fc53c95b0a;1,93ec7a47222349e7ba8a2257d29196e4</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<Maxbb val="100" />
<script>
<freq support="8;11" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="獲利穩定的公司來到市值低位區" ID="17281e93b35b47e2ac6f3a2f7e4d6c9f" ReturnType="0" ExecType="3" Folder="/長線投資/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[settotalbar(700);

if getsymbolfield("tse.tw","收盤價") > average(getsymbolfield("tse.tw","收盤價"),10) then begin
	value4=GetField("總市值");
	value5=average(value4,600);
	if value4[1]<value5[1]*0.7
	and close=highest(close,10)
	then ret=1;
end;]]></Code>
<Arg><![CDATA[<Arg seed="8f51cf7a-4b5c-4c5e-bcc2-a9bb33aba928" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="9fc371aa-98d4-40b1-bc82-59cb9755917b" version="1" />]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c;1,61c06064ad98469db9ce30287ae4a2c8;1,2bca774c6b7549c1b0b008d2a54b288e</RefFunc>
<Extra><![CDATA[<Extra>
<FirstBarDate val="0" />
<Maxbb val="20" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="700" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="自營商拉抬上攻" ID="014fc28010944aa0beffbdaefd493cc2" ReturnType="0" ExecType="1" Folder="/1.籌碼監控/" StatusMask="2">
<Desc><![CDATA[自營商近N日買超張數大於近N日成交量X % 
今日價格漲過昨日高點.
需選用日線及逐筆洗價.]]></Desc>
<Code><![CDATA[input: pastDays(3); setinputname(1,"計算天數");
input: _BuyRatio(25); setinputname(2,"買超佔比例(%)");
input:TXT("僅適用日線"); setinputname(3,"使用限制");

variable: SumForce(0);
variable: SumTotalVolume(0);

settotalbar(pastDays + 3);

if BarFreq <> "D" then return;

if Close > High[1] then
begin
	SumForce = Summation(GetField("自營商買賣超")[1], pastDays);
	SumTotalVolume = Summation(Volume[1], pastDays);

	if SumForce > SumTotalVolume * _BuyRatio / 100 then ret =1;
end;
]]></Code>
<Arg><![CDATA[<Arg seed="30576663-79b7-44f4-9968-4aa3305f0d2a" version="1"><Param name="計算天數" varname="pastDays" type="1" subtype="0" value="3" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="買超佔比例(%)" varname="_BuyRatio" type="1" subtype="0" value="25" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="使用限制" varname="TXT" type="3" subtype="0" value="僅適用日線" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="f228277f-ff31-4816-b04e-8d761c793de8" version="1" />]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d</RefFunc>
<Extra><![CDATA[<Extra>
<Maxbb val="30" />
<script>
<freq support="8;11;9;12;10;13;14;15" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="-1" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="股價跌破走平後的高壓電線" ID="1b52d1a623d647d78b0ef86ee4a9cc41" ReturnType="0" ExecType="1" Folder="/3.出場常用警示/" StatusMask="2">
<Desc><![CDATA[股價收斂後,收盤價往下貫穿地心引力線]]></Desc>
<Code><![CDATA[input:Ratio(10); setinputname(1,"高壓電線幅度%");
input:Length(5); setinputname(2,"計算走平期數");

settotalbar(Length + 8);
setbarback(72);

variable: Factor(0);Factor = 100/Close;

if absvalue(linearregslope(avgprice[1]*Factor,Length))<=0.1 and  //走平
   close crosses under ((average(close,30)+average(close,72))/2 )* (1+Ratio*0.01) 
then ret=1;]]></Code>
<Arg><![CDATA[<Arg seed="d45999fc-02df-401f-8074-82f1da9078a5" version="1"><Param name="高壓電線幅度%" varname="Ratio" type="1" subtype="0" value="10" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="計算走平期數" varname="Length" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="9b30190d-2539-457b-83a2-b3114bd01ff3" version="1" />]]></Plots>
<RefFunc>1,388033a24d7843e0b867cdc134206623;1,8c2d025a23c548d3a76fba10c22527b4;1,210d0786cfe340538e34c095bc2ba049;1,626e6e5c42304bbea9809d1a07ae4e01;1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c;1,9dc3f19597ba44fa91524e91ca67aebd</RefFunc>
<Extra><![CDATA[<Extra>
<Maxbb val="80" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="-1" />
<IsScriptSetBB val="1" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="鎚頭" ID="25ae974b6ff24faa853f4e7c8aba353c" ReturnType="0" ExecType="1" Folder="/酒田戰法/" StatusMask="2">
<Desc><![CDATA[開盤後下跌試底,盤中拉升上攻後,收在高點留下下影線]]></Desc>
<Code><![CDATA[{									
[檔名:]	鎚頭			[資料夾:]	酒田戰法	[適用方向]	多		
[說明:]	開盤後下跌試底,盤中拉升上攻後,收在高點留下下影線								
}																
settotalbar(5);	
{判斷狀況}								
	condition1=	close >=high	and 	close > open			;//狀況1:	收高
	condition2=	(high -low) > 2 *(high[1]-low[1])					;//狀況2:	波動放大
	condition3=	(open-low) > (close - open)  *2 					;//狀況3:	長下影線
{結果判斷}									
IF									
		condition1							
	and	condition2							
	and	condition3													
THEN	RET=1;								]]></Code>
<Arg><![CDATA[<Arg seed="0edd5f6e-4c75-49bf-8a6e-44dd8a3981b6" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="f07e82c6-1441-46b3-93aa-353545584000" version="1" />]]></Plots>
<Extra><![CDATA[<Extra>
<Maxbb val="5" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="5" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="期指短打" ID="4c9cf3f2393b45f0a992fe4b1dd6c56f" ReturnType="0" ExecType="3" Folder="/期權策略/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[if barfreq<>"Min" or barinterval<>1 then raiseruntimeerror("頻率請用1分K");

variable:l1(0),l2(0),l3(0),l4(0),l5(0),l6(0),l7(0),l8(0),l9(0),l10(0),x(0),i(0), base(0);
variable:day(3);

if GetField("日期","Tick") <> currentdate then return;
if time = 091500 then begin
	base = GetField("收盤價","Tick");   // 基準點
	x = 0;
	for i=1 to day
		x=highd(i)-lowd(i)+x;
	value4=x/day;

	l1=base+value4*0.191;
	l2=base+value4*0.382;
	l3=base+value4*0.5;
	l4=base+value4*0.618;
	l5=base+value4*0.809;
	l6=base-value4*0.191;
	l7=base-value4*0.382;
	l8=base-value4*0.5;
	l9=base-value4*0.618;
	l10=base-value4*0.809;
end;

if base <> 0 then begin  
    if GetField("收盤價","Tick") crosses over base+6 then begin
		ret=1;
		retmsg="作多第一口";
    end;
    if GetField("收盤價","Tick") crosses over base+12 then begin
		ret=1;
		retmsg="作多第二口";
    end;
    if GetField("收盤價","Tick") crosses over base+18 then begin
		ret=1;
		retmsg="作多第三口";
    end;
    if GetField("收盤價","Tick") crosses over base+24 then begin
		ret=1;
		retmsg="作多第四口";
    end;
    if GetField("收盤價","Tick") crosses over base+30 then begin
		ret=1;
		retmsg="作多第五口";
    end;
    if GetField("收盤價","Tick") crosses over base+36 then begin
		ret=1;
		retmsg="作多第六口";
    end;
    if GetField("收盤價","Tick") crosses under value3-6 then begin
		ret=1;
		retmsg="作空第一口";
    end;
    if GetField("收盤價","Tick") crosses under value3-12 then begin
		ret=1;
		retmsg="作空第二口";
    end;
    if GetField("收盤價","Tick") crosses under value3-18 then begin
		ret=1;
		retmsg="作空第三口";
    end;
    if GetField("收盤價","Tick") crosses under value3-24 then begin
		ret=1;
		retmsg="作空第四口";
    end;
    if GetField("收盤價","Tick") crosses under value3-30 then begin
		ret=1;
		retmsg="作空第五口";
    end;
    if GetField("收盤價","Tick") crosses under value3-36 then begin
		ret=1;
		retmsg="作空第六口";
    end;
    
    if GetField("收盤價","Tick") crosses over l1
    or GetField("收盤價","Tick") crosses over l2
    or GetField("收盤價","Tick") crosses over l3
    or GetField("收盤價","Tick") crosses over l4
    or GetField("收盤價","Tick") crosses over l5
    then begin
		ret=1;
		retmsg="50秒後請自動平倉";
    end;
    if GetField("收盤價","Tick") crosses under l6
    or GetField("收盤價","Tick") crosses under l7
    or GetField("收盤價","Tick") crosses under l8
    or GetField("收盤價","Tick") crosses under l9
    or GetField("收盤價","Tick") crosses under l10
    then begin
		ret=1;
		retmsg="50秒後請自動平倉";
    end;
end;

print(date,time,GetField("日期","Tick"),GetField("時間","Tick"),GetField("收盤價","Tick"),l1);]]></Code>
<Arg><![CDATA[<Arg seed="00492b19-7310-48cb-8d29-92acae0cde39" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="27591225-c32a-4698-97b0-447ea597e5cc" version="1" />]]></Plots>
<RefFunc>1,61b7479e4304402c83419e5e14e287ba;1,7513ef4c00b84668bb971542273f8683;1,6850ead727a842bf883a1501d030ba98;1,9dc3f19597ba44fa91524e91ca67aebd</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<FirstBarDate val="0" />
<Maxbb val="20" />
<script>
<freq support="1;8;11;9;12;10;13;14;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="火箭後拉回" ID="fb0ef001b0554a239b9051590c9968ef" ReturnType="0" ExecType="1" Folder="/當沖交易型/" StatusMask="2">
<Desc><![CDATA[股價衝高後回檔]]></Desc>
<Code><![CDATA[input:TXT1("僅適用1分鐘線"); setinputname(1,"使用限制");
settotalbar(3);
if barfreq ="Min" and barinterval =1 and
   close[1]/close[2]>1.015 and //上個1分鐘線單分鐘拉超過1.5%
   GetField("High", "D") > high and //高不過高
   Close < GetField("High", "D")*0.99 and //自高檔回1%
   Close > Low[1] 
then ret=1;]]></Code>
<Arg><![CDATA[<Arg seed="7dfba4e7-be7d-4b91-832c-93afea724b7a" version="1"><Param name="使用限制" varname="TXT1" type="3" subtype="0" value="僅適用1分鐘線" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="ce27d408-79ed-4311-94bc-20587839a56f" version="1" />]]></Plots>
<Extra><![CDATA[<Extra>
<Maxbb val="3" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="CCI超賣" ID="25100d8de82f42199873ca1c3c0fc0b7" ReturnType="0" ExecType="3" Folder="/技術分析/" StatusMask="2">
<Desc><![CDATA[CCI指標跌破賣超設定值進入賣超區]]></Desc>
<Code><![CDATA[// CCI超賣
//
Input: Length(14), AvgLength(9), OverSold(-100);
Variable: cciValue(0), cciMAValue(0);

SetTotalBar(maxlist(AvgLength + Length + 1,6) + 11);

SetInputName(1, "期數");
SetInputName(2, "平滑期數");
SetInputName(3, "超賣值");

cciValue = CommodityChannel(Length);
cciMAValue = Average(cciValue, AvgLength);

Ret = cciMAValue Crosses Below OverSold;



        ]]></Code>
<Arg><![CDATA[<Arg seed="8e588255-9de9-4ec5-b22e-e7ef689f632e" version="1"><Param name="期數" varname="Length" type="1" subtype="0" value="14" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="平滑期數" varname="AvgLength" type="1" subtype="0" value="9" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="超賣值" varname="OverSold" type="1" subtype="0" value="-100" isSerial="1" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="5a96292b-dbf7-4bd2-824f-ce68a9df15d8" version="1" />]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c;1,6673d58f85784adc88e05084868c3d49;1,9dc3f19597ba44fa91524e91ca67aebd</RefFunc>
<Extra><![CDATA[<Extra>
<Maxbb val="25" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="-1" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="8.0常用函數" ID="5c73d1eb43954e84b82cf4259a4da716" ReturnType="0" ExecType="1" Folder="/!語法範例/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[//函數是用來協助語法快速運算的功能

//===========範例：均線糾結======================

//1.宣告參數：利用input宣告輸入的參數。
input:shortLen(5),midLen(10),longLen(20),percent(0.02);

//4.運用函數
//透過average這個函數計算數列的平均值
value1=average(close,shortLen);//短期移動平均
value2=average(close,midLen);//中期移動平均
value3=average(close,longLen);//長期移動平均
value4=value1-value2;
value5=value2-value3;
value6=value1-value3;

//6.設定警示條件：if.. then ret=1;
if absvalue(value4)/close<percent 
and absvalue(value5)/close<percent 
and absvalue(value6)/close<percent
and close crosses above maxlist(value1,value2,value3)
then ret=1;]]></Code>
<Arg><![CDATA[<Arg seed="e3c8dbd8-2f75-4ba0-acad-c2a31260bda5" version="1"><Param name="shortLen" varname="shortLen" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="midLen" varname="midLen" type="1" subtype="0" value="10" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="longLen" varname="longLen" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="percent" varname="percent" type="1" subtype="0" value="0.02" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="da06eeac-8528-4623-ba94-bd131437f415" version="1" />]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c;1,6850ead727a842bf883a1501d030ba98</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="50" />
<Maxbb val="25" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="五分鐘K狹幅整理後帶量破" ID="8d97121b50244d36894a102aec35799d" ReturnType="0" ExecType="3" Folder="/當沖交易型/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:Length(100,"計算期數");
input:Ratio(0.5,"突破幅度%");
input:RRatio(1.5,"盤整區間幅度%");
input:TXT1("僅適用5分鐘線","使用限制");
 
settotalbar(3);
setbarback(Length);
 
if barfreq<> "Min" or barinterval <> 5 then return;
 
variable: RangeHigh(0);
variable: RangeLow(0);
RangeHigh=highest(close[1],length);
RangeLow=lowest(close[1],length);
 
if RangeHigh[1] < RangeLow[1] * (1+ RRatio/100) then begin
	if Close crosses over RangeHigh*(1+Ratio/100)
	and volume>average(volume,length)*1.5
	and trueall(GetField("成交量","D")>500,10)
	and countif(GetField("主力買賣超張數","D")[1]>0,10)>=7
	and GetSymbolField("tse.tw","收盤價","D")>GetSymbolField("tse.tw","收盤價","D")[1]
	and GetSymbolField("tse.tw","收盤價","D")>average(GetSymbolField("tse.tw","收盤價","D"),5)
	then ret=1;
end;]]></Code>
<Arg><![CDATA[<Arg seed="e92fba9d-7a59-417d-b5e7-f3c8e3ceaf9d" version="1"><Param name="計算期數" varname="Length" type="1" subtype="0" value="100" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="突破幅度%" varname="Ratio" type="1" subtype="0" value="0.5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="盤整區間幅度%" varname="RRatio" type="1" subtype="0" value="1.5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="使用限制" varname="TXT1" type="3" subtype="0" value="僅適用5分鐘線" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="919a0984-eaa2-40eb-9202-a8b663558123" version="1" />]]></Plots>
<RefFunc>1,61c06064ad98469db9ce30287ae4a2c8;1,2bca774c6b7549c1b0b008d2a54b288e;1,f1b429ac13b2447c909302198c18ca56;1,6850ead727a842bf883a1501d030ba98;1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c;1,93ec7a47222349e7ba8a2257d29196e4;1,d80cf92ddfcc42e0a6c53ec47edebd49</RefFunc>
<Extra><![CDATA[<Extra>
<FirstBarDate val="0" />
<Maxbb val="20" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
<IsScriptSetBB val="1" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="價量同創近期新高" ID="1ed06dd8f50246e9ad3d07c879496a93" ReturnType="0" ExecType="1" Folder="/價量指標/" StatusMask="2">
<Desc><![CDATA[收盤價突破過去N期以來高點,成交量創高]]></Desc>
<Code><![CDATA[input: Price(close); setinputname(1,"比較價別");
input: Length(20); setinputname(2,"近期期數");

settotalbar(3);
setbarback(Length);

if  Price > highest(high[1] ,Length) and 
    volume > highest(volume[1],length) then ret=1;



]]></Code>
<Arg><![CDATA[<Arg seed="e49c979f-f358-4a7f-a96f-d0a8805cac02" version="1"><Param name="比較價別" varname="Price" type="1" subtype="1" value="close" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="近期期數" varname="Length" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="0aa417f9-8f3b-4365-b554-b92a09dabacc" version="1" />]]></Plots>
<RefFunc>1,61c06064ad98469db9ce30287ae4a2c8;1,2bca774c6b7549c1b0b008d2a54b288e</RefFunc>
<Extra><![CDATA[<Extra>
<Maxbb val="50" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
<IsScriptSetBB val="1" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="烏龜進場法則" ID="345f0740efe4432cb0563143b22cf3ab" ReturnType="0" ExecType="3" Folder="/ETF策略/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[if average(close,3) crosses above average(close,55)
and volume> average(volume,5)
and atr(3) > atr(20)
then ret=1;]]></Code>
<Arg><![CDATA[<Arg seed="2772c2e5-7dc8-4ac7-b943-2f9edc50d5aa" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="4ce57347-41be-4f89-952e-5570a3d1905c" version="1" />]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c;1,6850ead727a842bf883a1501d030ba98;1,36d1fc033c6f48f8a136f9e1fdec110f;1,81394f9cf0c8469ea5f8832700aec8b7;1,9e03682196e24611b2fe326b6a56433d;1,e8e5ac3753db447abac5b44618fa7dc8</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="300" />
<Maxbb val="50" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="7.1time(時間)的用法" ID="68542718a6204a8792889faf2d251528" ReturnType="0" ExecType="1" Folder="/!語法範例/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[//系統用time來代表時間，顯示格式為hhmmss

//===========範例：開盤前三根K線都是陽線======================

//3.引用時間序列的回傳值﹙包括開高低收成交量等﹚
//時間函數應用
if time=091500 //時間是九點十五分

and close>close[1]     and close>open      
and close[1]>close[2]  and close[1]>open[1]
and close[2]>close[3]  and close[2]>open[2]

then ret=1;]]></Code>
<Arg><![CDATA[<Arg seed="8fb551f0-8e3e-475a-9ec4-76a90cb069e0" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="9d83204a-48cd-4051-bf17-ae7647dd1fe9" version="1" />]]></Plots>
<Extra><![CDATA[<Extra>
<TotalBar val="10" />
<Maxbb val="5" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="進入上昇趨勢" ID="b502691d060f4c5c8a1bc940d7e5d04a" ReturnType="0" ExecType="3" Folder="/技術分析/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[
//高ROE股持有20天
input:period(12);
value1=countif(low<lowest(low[1],period),period);
value2=countif(high>highest(high[1],period),period);
value3=value2-value1;
if average(GetSymbolField("tse.tw","收盤價","D"),5)
> average(GetSymbolField("tse.tw","收盤價","D"),20)
then begin
 
if value3 crosses over 4
  
then ret=1;
 
end;]]></Code>
<Arg><![CDATA[<Arg seed="1a19a50a-667b-4c2b-9d50-4dbcf0dde152" version="1"><Param name="period" varname="period" type="1" subtype="0" value="12" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="ae770024-b5d8-407c-9511-b6dabf2fb562" version="1" />]]></Plots>
<RefFunc>1,61c06064ad98469db9ce30287ae4a2c8;1,f1b429ac13b2447c909302198c18ca56;1,d80cf92ddfcc42e0a6c53ec47edebd49;1,2bca774c6b7549c1b0b008d2a54b288e;1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c;1,6850ead727a842bf883a1501d030ba98</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<FirstBarDate val="0" />
<Maxbb val="20" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="紅三兵" ID="66f656fe04c84b27a9f1f21f128a6021" ReturnType="0" ExecType="1" Folder="/酒田戰法/" StatusMask="2">
<Desc><![CDATA[連續三根上漲實體K棒]]></Desc>
<Code><![CDATA[{								
[檔名:]	紅三兵			[資料夾:]	酒田戰法	[適用方向]	多	
[說明:]	連續三根上漲實體K棒							
}															
settotalbar(5);	
{判斷狀況}								
	condition1=	( close - open ) >(high -low) * 0.75					;//狀況1:	實體上漲K棒
	condition2=	( close[1] - open[1] ) >(high[1] -low[1]) * 0.75					;//狀況2:	實體上漲K棒
	condition3=	( close[2] - open[2] ) >(high[2] -low[2]) * 0.75					;//狀況3:	實體上漲K棒
	condition4=	close > close[1]					;//狀況4:	上漲
	condition5=	close[1] > close[2]					;//狀況5:	上漲
{結果判斷}		
IF		
		condition1
	and	condition2
	and	condition3
	and	condition4
	and	condition5
THEN	RET=1;	]]></Code>
<Arg><![CDATA[<Arg seed="a0374b00-e821-4062-bea5-e86d381b9184" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="88dfc826-ee13-489e-a115-d227889f0056" version="1" />]]></Plots>
<Extra><![CDATA[<Extra>
<Maxbb val="5" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="5" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="短線轉強" ID="c903f84ca14b466ca9ed927e4aa89dae" ReturnType="0" ExecType="3" Folder="/短線操作型/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:day(66,"移動平均天數");
input:ratio(30,"超出均值比率");
variable:count(0);

//透過Z的時間安排來決定現在用的是那一根Bar的資料 
variable: Z(0);
if currenttime > 180000 
or currenttime < 083000 then 
	Z =0 
else 
	Z=1;

value1=GetField("法人買張")[Z]; value2=average(value1,day);
value3=GetField("強弱指標")[Z]; value4=average(value3,day);
value5=GetField("外盤均量")[Z]; value6=average(value5,day);
value7=GetField("主動買力")[Z]; value8=average(value7,day);
value9=GetField("開盤委買"); value10=average(value9,day);
 
count=0;
if value1>=value2*(1+ratio/100) then count=count+1;
if value3>=value4*(1+ratio/100) then count=count+1;
if value5>=value6*(1+ratio/100) then count=count+1;
if value7>=value8*(1+ratio/100) then count=count+1;
if value9>=value10*(1+ratio/100) then count=count+1;
 
if count>=4 and close<lowest(close,day)*1.1
and GetSymbolField("tse.tw","收盤價","D")>average(GetSymbolField("tse.tw","收盤價","D"),10)
and average(volume,200)>2000
then ret=1;
]]></Code>
<Arg><![CDATA[<Arg seed="2f33eaa6-5436-4add-9a8f-dac8615f6c2d" version="1"><Param name="移動平均天數" varname="day" type="1" subtype="0" value="66" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="超出均值比率" varname="ratio" type="1" subtype="0" value="30" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="96ca7a59-368a-47be-a554-f96f4e834255" version="1" />]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c;1,61c06064ad98469db9ce30287ae4a2c8;1,f1b429ac13b2447c909302198c18ca56</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="300" />
<Maxbb val="50" />
<script>
<freq support="8;11" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="跌破n日低點" ID="c6e6f48dc67d48ebbded186d6354c3d9" ReturnType="0" ExecType="1" Folder="/3.出場常用警示/" StatusMask="2">
<Desc><![CDATA[股價跌破N日的低點.
]]></Desc>
<Code><![CDATA[input:Length(20); setinputname(1,"計算期數");

settotalbar(Length + 3);

if close  < lowest(low[1],Length) then ret=1;]]></Code>
<Arg><![CDATA[<Arg seed="36dc0c4f-133b-41dd-8a0b-34b270e2fcf7" version="1"><Param name="計算期數" varname="Length" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="35470bfb-8556-45ff-b597-5086893fd50f" version="1" />]]></Plots>
<RefFunc>1,61c06064ad98469db9ce30287ae4a2c8;1,f1b429ac13b2447c909302198c18ca56</RefFunc>
<Extra><![CDATA[<Extra>
<Maxbb val="30" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="-1" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="內困三日翻黑" ID="d0fc7be8a99f411a9ae8b3c15e56da0e" ReturnType="0" ExecType="1" Folder="/酒田戰法/" StatusMask="2">
<Desc><![CDATA[前兩期為長紅棒後包黑K棒 當期往下跌破紅棒開盤價]]></Desc>
<Code><![CDATA[{																						
[檔名:]	內困三日翻黑			[資料夾:]	酒田戰法	[適用方向]	空															
[說明:]	前兩期為長紅棒後包黑K棒 當期往下跌破紅棒開盤價																																								
}	
settotalbar(5);																											
{判斷狀況}								
	condition1=	close[2] > open[2] + high[3]-low[3]					;//狀況1:	前前期長紅棒
	condition2=	high[2] < high[3] and low[2] > low[3]					;//狀況2:	前期內包黑K棒
	condition3=	open >= close[1] and close < open[2]					;//狀況3:	開平高跌破三日低點
{結果判斷}		
IF		
		condition1
	and	condition2
	and	condition3
THEN	RET=1;	]]></Code>
<Arg><![CDATA[<Arg seed="acfc1cf4-f731-47ef-b92e-d7fca6499404" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="791da5db-c77a-455b-bc8e-1e0602c0de4d" version="1" />]]></Plots>
<Extra><![CDATA[<Extra>
<Maxbb val="5" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="5" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="跌破上升趨勢線" ID="3b1631596e3d4b5caf45eaaef32fc78e" ReturnType="0" ExecType="3" Folder="/3.出場常用警示/" StatusMask="2">
<Desc><![CDATA[股價往下跌破N天期的上升趨勢而且上升角度小於設定值。
]]></Desc>
<Code><![CDATA[input:Length(10); setinputname(1,"上升趨勢計算期數");
input:_Angle(30); setinputname(2,"上升趨勢角度");

settotalbar(Length + 3);

variable: TrendAngle(0);
variable: TrendAngleDelta(0);

if Close< Close[1] and Close[1] <Close[2] and Close[Length]>0 then begin

linearreg((high/Close[Length]-1)*100,Length,0,value1,TrendAngle,value3,value4);
 
TrendAngleDelta =TrendAngle-TrendAngle[1];
IF TrendAngleDelta-TrendAngleDelta[1] < -10 and close >Close[Length] THEN RET=1;
  
end;]]></Code>
<Arg><![CDATA[<Arg seed="ef2d5355-ac2e-48c0-8da9-daf14f87aac3" version="1"><Param name="上升趨勢計算期數" varname="Length" type="1" subtype="0" value="10" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="上升趨勢角度" varname="_Angle" type="1" subtype="0" value="30" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="d845e4ba-19aa-443e-8797-4dec52f396a5" version="1" />]]></Plots>
<RefFunc>1,8c2d025a23c548d3a76fba10c22527b4;1,210d0786cfe340538e34c095bc2ba049</RefFunc>
<Extra><![CDATA[<Extra>
<Maxbb val="30" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="-1" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="急拉" ID="7ed64565af044cc1b368a9bd0fac16df" ReturnType="0" ExecType="1" Folder="/2.市場常用語/" StatusMask="2">
<Desc><![CDATA[股價急拉]]></Desc>
<Code><![CDATA[input:P1(1.5); setinputname(1,"急拉幅度%");

settotalbar(3);

IF close > close[1]*(1+P1/100)  and close=high and volume>volume[1]
then ret=1;]]></Code>
<Arg><![CDATA[<Arg seed="0dfded5b-e0f9-4bef-aeae-19288f3d52fe" version="1"><Param name="急拉幅度%" varname="P1" type="1" subtype="0" value="1.5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="e99cc218-38d4-4114-9cd5-3abbb820c9d6" version="1" />]]></Plots>
<Extra><![CDATA[<Extra>
<Maxbb val="2" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="調整型均線黃金交叉" ID="d1d7cf5700794c509e22bce442945f41" ReturnType="0" ExecType="3" Folder="/波段操作型/" StatusMask="2">
<Desc><![CDATA[價格突破特殊均線計算值]]></Desc>
<Code><![CDATA[input:Length(6); setinputname(1,"起始期數");
input:TLength(20); setinputname(2,"終止期數");
input:AddLength(1); setinputname(3,"期數調整項");
input:TuneRatio(3); setinputname(4,"調整係數");

settotalbar(TLength + 8);

variable: AvgTR(0);

if Length >= TLength then return;

AvgTR = average(TrueRange,Length);

value2 = intportion( (TLength -Length)/ AddLength);
for value1 =  Length to TLength
begin
    if mod( value1 ,AddLength) = 0  or value1 =TLength then
	 begin
		if (AvgTR > Close *  TuneRatio*0.01 ) then
		begin
		AvgTR = average(TrueRange,value1);
		value3 = value1; 
		end;
   end;
end;

if close crosses over  average(close[1] ,value3) then ret=1;]]></Code>
<Arg><![CDATA[<Arg seed="4ff936e9-3b02-4daa-9748-635ded48da8d" version="1"><Param name="起始期數" varname="Length" type="1" subtype="0" value="6" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="終止期數" varname="TLength" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="期數調整項" varname="AddLength" type="1" subtype="0" value="1" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="調整係數" varname="TuneRatio" type="1" subtype="0" value="3" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="9318c89b-98fb-4b88-8429-bbba7b8d5720" version="1" />]]></Plots>
<RefFunc>1,36d1fc033c6f48f8a136f9e1fdec110f;1,81394f9cf0c8469ea5f8832700aec8b7;1,9e03682196e24611b2fe326b6a56433d;1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c;1,6850ead727a842bf883a1501d030ba98</RefFunc>
<Extra><![CDATA[<Extra>
<Maxbb val="40" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="-1" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="休息後風雲再起" ID="a86e69667b9641e5b275543705f5109e" ReturnType="0" ExecType="1" Folder="/波段操作型/" StatusMask="2">
<Desc><![CDATA[紅棒上漲後小做休息再漲升]]></Desc>
<Code><![CDATA[settotalbar(5);

condition1 =  Close[3] > low[3]* 1.01;
condition2 =  close[2] > open[2] * 1.01 and open[2]>close[3];
condition3 =  close[1] < close[2] and high[1] < close[1]* 1.005;
condition4 =  close > close[1] * 1.01;

if condition1 and condition2 and condition3 and condition4 then ret=1;  
]]></Code>
<Arg><![CDATA[<Arg seed="d8d62288-256c-44ed-bae2-9a513d0e233b" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="c6257e7d-1cfd-4e0c-8392-5c6d13698c23" version="1" />]]></Plots>
<Extra><![CDATA[<Extra>
<Maxbb val="5" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="5" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="主力慢慢收集籌碼後攻堅" ID="4433f0b4e8bd43ea81e0888d8c30ccbe" ReturnType="0" ExecType="3" Folder="/短線操作型/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:period(10,"籌碼計算天期");

//透過Z的時間安排來決定現在用的是那一根Bar的資料 
variable: Z(0);
if currenttime > 180000 
or currenttime < 083000 then 
	Z =0 
else 
	Z=1;

Value1=GetField("分公司買進家數","D")[Z];
value2=GetField("分公司賣出家數","D")[Z];
value3=(value2-value1);
//賣出的家數比買進家數多的部份
value4=average(close,5);
//五日移動平均

if countif(value3>30, period)/period >0.7
and linearregslope(value4,5)>0
and Average(Volume[1], 100) >= 500
and tselsindex(10,7)[Z]=1
then ret=1;]]></Code>
<Arg><![CDATA[<Arg seed="03fdd7e6-9b8a-4666-a768-0c2911d4b793" version="1"><Param name="籌碼計算天期" varname="period" type="1" subtype="0" value="10" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="fe8a0464-fdef-44da-a0f4-00b8175e87d6" version="1" />]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c;1,d80cf92ddfcc42e0a6c53ec47edebd49;1,8c2d025a23c548d3a76fba10c22527b4;1,210d0786cfe340538e34c095bc2ba049;1,626e6e5c42304bbea9809d1a07ae4e01;1,b1f1a25bdc014e109dc92d7f9b6ef207</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<FirstBarDate val="0" />
<Maxbb val="20" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="ATR通道突破策略" ID="7134ccb77b8b4153b24cbe772ad597c0" ReturnType="0" ExecType="3" Folder="/技術分析/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:period(20,"計算truerange的區間");

value1=average(truerange,period);
value2=average(close,period)+2*value1;

if close crosses over value2 then ret=1;
]]></Code>
<Arg><![CDATA[<Arg seed="26962e65-13a5-419d-92a9-32003c74d6b6" version="1"><Param name="計算truerange的區間" varname="period" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="f74b70c6-9ac3-43c8-bf72-02c559c15f93" version="1" />]]></Plots>
<RefFunc>1,36d1fc033c6f48f8a136f9e1fdec110f;1,81394f9cf0c8469ea5f8832700aec8b7;1,9e03682196e24611b2fe326b6a56433d;1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c;1,6850ead727a842bf883a1501d030ba98</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<FirstBarDate val="0" />
<Maxbb val="20" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="高檔出現吊人線" ID="1ac1a9d16b2242ad97d15c777498da95" ReturnType="0" ExecType="1" Folder="/3.出場常用警示/" StatusMask="2">
<Desc><![CDATA[在近30期的高點之後出現吊人線的線型。]]></Desc>
<Code><![CDATA[settotalbar(33);

if Close < Close[1] then begin
	  
	condition1 = 
		open = High and close < open and
	   (high -low) > 2 *(high[1]-low[1]) and 
	   (close-low) > (open-close) *2;
	  
	condition2= close[1] > highest(High,30)*0.98; //昨日收盤價接近三十日高點

	if condition1 and condition2 then ret=1;

end;]]></Code>
<Arg><![CDATA[<Arg seed="51b10b37-2017-4994-b4f9-5103613d8dba" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="f1311b7f-83c3-4d55-9ff2-ba650f0e038f" version="1" />]]></Plots>
<RefFunc>1,61c06064ad98469db9ce30287ae4a2c8;1,2bca774c6b7549c1b0b008d2a54b288e</RefFunc>
<Extra><![CDATA[<Extra>
<Maxbb val="30" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="33" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="自營商獨自偏好" ID="b38f8455b75c419789c062c442a1c672" ReturnType="0" ExecType="1" Folder="/波段操作型/" StatusMask="2">
<Desc><![CDATA[自營商偏好買進張數大於設定]]></Desc>
<Code><![CDATA[input:Length(20); setinputname(1,"計算日數");
input:_BuyRatio(5); setinputname(2,"買超佔比%");
input:TXT("僅適用日線"); setinputname(3,"使用限制");

settotalbar(3);
setbarback(Length);

if barfreq <> "D" then return;

variable: SumForce(0);
variable: SumTotalVolume(0);
variable: OtherForce(0);

SumForce = Summation(GetField("自營商買賣超")[1], Length);
SumTotalVolume = Summation(Volume[1], Length);
OtherForce = Summation(GetField("外資買賣超")[1] + GetField("投信買賣超")[1], Length);

if SumForce > SumTotalVolume  *_BuyRatio  and SumForce > OtherForce   then ret =1;
        ]]></Code>
<Arg><![CDATA[<Arg seed="d08da778-ebcf-4759-99ce-dfb20256e05a" version="1"><Param name="計算日數" varname="Length" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="買超佔比%" varname="_BuyRatio" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="使用限制" varname="TXT" type="3" subtype="0" value="僅適用日線" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="d5d8ed38-c438-428e-a76c-204ddff63563" version="1" />]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d</RefFunc>
<Extra><![CDATA[<Extra>
<Maxbb val="25" />
<script>
<freq support="8;11;9;12;10;13;14;15" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
<IsScriptSetBB val="1" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="連續期間上漲" ID="d1303866bffa4d2a832609ada9c503d9" ReturnType="0" ExecType="1" Folder="/價量指標/" StatusMask="2">
<Desc><![CDATA[連續上漲走勢]]></Desc>
<Code><![CDATA[input:Length(3); setinputname(1,"連續上漲期數");
settotalbar(Length + 3);
If TrueAll(Close > Close[1],Length) then ret=1;


        
        ]]></Code>
<Arg><![CDATA[<Arg seed="565e61ea-c95d-47c5-9dfb-445d9c808f88" version="1"><Param name="連續上漲期數" varname="Length" type="1" subtype="0" value="3" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="544c917f-4dc2-479d-abd7-b2cde3ee867b" version="1" />]]></Plots>
<RefFunc>1,93ec7a47222349e7ba8a2257d29196e4</RefFunc>
<Extra><![CDATA[<Extra>
<FirstBarDate val="0" />
<Maxbb val="25" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="-1" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="斷頭後的止跌" ID="af5cdcfebf594d659c5aa35d7e563004" ReturnType="0" ExecType="1" Folder="/當沖交易型/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:Length(4); setinputname(1,"比較N天前融資張數");
input:DVOL(3000); setinputname(2,"比N天前融資減少張數");
input:TXT1("僅適用日線"); setinputname(3,"使用限制");
input:TXT2("建議使用逐筆洗價"); setinputname(4,"盤中使用說明");

settotalbar(3);
setbarback(Length);

if barfreq = "D" and 
   Close > Close[1] and 
   Close[Length] > Close * 1.1 and
   GetField("融資餘額張數")[Length] - GetField("融資餘額張數")[1] > DVOL 
then ret=1;
]]></Code>
<Arg><![CDATA[<Arg seed="ba2502ca-5d5e-4380-813e-7f87e06d3665" version="1"><Param name="比較N天前融資張數" varname="Length" type="1" subtype="0" value="4" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="比N天前融資減少張數" varname="DVOL" type="1" subtype="0" value="3000" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="使用限制" varname="TXT1" type="3" subtype="0" value="僅適用日線" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="盤中使用說明" varname="TXT2" type="3" subtype="0" value="建議使用逐筆洗價" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="21d44af6-7d19-47d2-b8b4-7dda553e3435" version="1" />]]></Plots>
<Extra><![CDATA[<Extra>
<Maxbb val="8" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
<IsScriptSetBB val="1" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="跌停鎖住" ID="0660a644e06f47439fe64311ab902882" ReturnType="0" ExecType="1" Folder="/價量指標/" StatusMask="2">
<Desc><![CDATA[跌停鎖住]]></Desc>
<Code><![CDATA[settotalbar(3);
If Close = GetField("跌停價", "D") And q_bidsize <=0 Then ret = 1;
        
        ]]></Code>
<Arg><![CDATA[<Arg seed="f50d3490-933b-4604-85c3-df9437e8b4f2" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="7d25c377-55e8-436e-81b7-ae0757f33a3d" version="1" />]]></Plots>
<Extra><![CDATA[<Extra>
<Maxbb val="3" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="漲停鎖住" ID="07b842faf2c34f8b8dfc1fdcd239b5c4" ReturnType="0" ExecType="1" Folder="/價量指標/" StatusMask="2">
<Desc><![CDATA[漲停鎖住]]></Desc>
<Code><![CDATA[settotalbar(3);
If Close = GetField("漲停價", "D") And q_AskSize <=0 Then ret = 1;
        
        ]]></Code>
<Arg><![CDATA[<Arg seed="f50d3490-933b-4604-85c3-df9437e8b4f2" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="7421d6bb-ed29-436f-ab31-15753bfd6a68" version="1" />]]></Plots>
<Extra><![CDATA[<Extra>
<Maxbb val="3" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="外資連日大買超，股價未開高" ID="e7abd32a1efb48c19bcc9eb5a137ff9f" ReturnType="0" ExecType="1" Folder="/短線操作型/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:Periods(3); setinputname(1,"外資連續買超天數");
input:Atleast(10000); setinputname(2,"每日買超金額(萬元)");
input:Gap(1); setinputname(3,"開盤幅度%");
input:TXT1("僅適用日線"); setinputname(4,"使用限制");
input:TXT2("需逐筆洗價"); setinputname(5,"使用說明:選日內單次觸發");

settotalbar(3);
setbarback(Periods);

if BarFreq = "D" and
   Trueall( Getfield("外資買賣超")[1]*Close*0.1 > Atleast ,Periods)  and
   GetField("Open", "D") < GetField("RefPrice", "D") *(1+Gap/100)
then ret=1;
]]></Code>
<Arg><![CDATA[<Arg seed="3041bf43-30c9-4f08-acb5-e13d0d1cdfb8" version="1"><Param name="外資連續買超天數" varname="Periods" type="1" subtype="0" value="3" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="每日買超金額(萬元)" varname="Atleast" type="1" subtype="0" value="10000" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="開盤幅度%" varname="Gap" type="1" subtype="0" value="1" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="使用限制" varname="TXT1" type="3" subtype="0" value="僅適用日線" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="使用說明:選日內單次觸發" varname="TXT2" type="3" subtype="0" value="需逐筆洗價" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="ffa91502-ab44-42f4-9642-17f604524bd3" version="1" />]]></Plots>
<RefFunc>1,93ec7a47222349e7ba8a2257d29196e4</RefFunc>
<Extra><![CDATA[<Extra>
<Maxbb val="15" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
<IsScriptSetBB val="1" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="當日時段區間價突破" ID="438e8934fc1d4cd6be0847f722e51014" ReturnType="0" ExecType="1" Folder="/價量指標/" StatusMask="2">
<Desc><![CDATA[收盤價或最高價突破設定區間之高點
        ]]></Desc>
<Code><![CDATA[input:initialtime(090000); setinputname(1,"起算時間HHmmss");
input:timeline(100000);   setinputname(2,"截止時間HHmmss");
input:CloseAtHigh(false); setinputname(3,"收盤價亦須創新高");
input:TXT1("限用分鐘線"); setinputname(4,"使用限制");

settotalbar(50);

if barfreq<> "Min" then return;
variable: intervalhigh(0);

if date <> date[1] then  intervalhigh = 0; 

if time >= initialtime and time <= timeline then 
begin
  intervalhigh = maxlist(high,intervalhigh);
end;

if time > timeline then
begin
  if CloseAtHigh then  
    Ret = IFF(close > intervalhigh, 1, 0)
  else  
    Ret = IFF(high > intervalhigh, 1, 0); 
end;]]></Code>
<Arg><![CDATA[<Arg seed="f5bad3d4-3b9f-47cf-b88d-762ff5074fe6" version="1"><Param name="起算時間HHmmss" varname="initialtime" type="1" subtype="0" value="90000" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="截止時間HHmmss" varname="timeline" type="1" subtype="0" value="100000" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="收盤價亦須創新高" varname="CloseAtHigh" type="2" subtype="0" value="0" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="使用限制" varname="TXT1" type="3" subtype="0" value="限用分鐘線" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="1cb85519-458d-4c4f-aef7-d2b239a6c46e" version="1" />]]></Plots>
<RefFunc>1,8c2d025a23c548d3a76fba10c22527b4</RefFunc>
<Extra><![CDATA[<Extra>
<Maxbb val="50" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="50" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="今日資券籌碼分析" ID="8941ec93103d4c988868f3846cbbce38" ReturnType="0" ExecType="1" Folder="/2.市場常用語/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[variable:i(1);
if Currenttime > 220000  or Currenttime < 083000 then i=0; 

settotalbar(3);

if GetField("成交金額")[i]>10000000 and GetField("融資使用率")[i+1] > 0 and
   (GetField("融資使用率")[i]/GetField("融資使用率")[i+1]-1)*100 * (C[i]/C[i+1]-1)*100 >40
then ret=1;

if  C[i] > C[i+2]*1.1 and (GetField("融券增減張數")[i]*C[i])> 10000 then ret=1;]]></Code>
<Arg><![CDATA[<Arg seed="5ebde24e-ac34-481f-bf16-c6c1e455a221" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="af04e1eb-b0ab-411c-9525-43f6a4eae9b1" version="1" />]]></Plots>
<Extra><![CDATA[<Extra>
<Maxbb val="3" />
<script>
<freq support="8;9;10;11;12;13" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="多頭遭遇" ID="bbddd905fca54c39b87bf52b8e534a91" ReturnType="0" ExecType="1" Folder="/酒田戰法/" StatusMask="2">
<Desc><![CDATA[前期收黑K棒 當期開低走高紅棒嘗試反攻昨收]]></Desc>
<Code><![CDATA[{																						
[檔名:]	多頭遭遇			[資料夾:]	酒田戰法	[適用方向]	多															
[說明:]	前期收黑K棒 當期開低走高紅棒嘗試反攻昨收 																																								
}
settotalbar(5);																														
{判斷狀況}								
	condition1=	 (open[1] - close[1] ) >(high[1] -low[1]) * 0.75					;//狀況1:	前期出黑K棒
	condition2=	close[1] < close[2]					;//狀況2:	前期收跌
	condition3=	( close - open ) >(high -low) * 0.75					;//狀況3:	當期收紅K棒
	condition4=	open  < close[1] and close < close[1]					;//狀況4:	開低且收跌
	condition5=	low <  low[1]					;//狀況5:	破前期低點
{結果判斷}		
IF		
		condition1
	and	condition2
	and	condition3
	and	condition4
	and	condition5
THEN	RET=1;	]]></Code>
<Arg><![CDATA[<Arg seed="56dceee8-0d41-4d44-8279-3be59690a765" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="87d68fec-4bc1-4a7a-8db3-b3f265456a8a" version="1" />]]></Plots>
<Extra><![CDATA[<Extra>
<Maxbb val="5" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="5" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="Q指標買進訊號" ID="dfbe5f992bf94b5eae67e08cf3ce3f04" ReturnType="0" ExecType="3" Folder="/ETF策略/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:t1(10,"計算累積價格變動的bar數");
input:t2(5,"計算價格累積變化量移動平均的期別");
input:t3(20,"計算雜訊的移動平均期別");
variable:Qindicator(0);

Qindicator=callfunction("Q指標",t1,t2,t3);

if linearregangle(Qindicator,5)>40
and barslast(linearregangle(Qindicator,5)>45)[1]>20
then ret=1;]]></Code>
<Arg><![CDATA[<Arg seed="8fddb532-331a-4bef-9530-fa182afca63a" version="1"><Param name="計算累積價格變動的bar數" varname="t1" type="1" subtype="0" value="10" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="計算價格累積變化量移動平均的期別" varname="t2" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="計算雜訊的移動平均期別" varname="t3" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="6a322f8a-bf13-45dd-82ee-12a5acb8d407" version="1" />]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c;1,514d2535a36b415cbb0980b17fd6bc15;1,8c2d025a23c548d3a76fba10c22527b4;1,210d0786cfe340538e34c095bc2ba049;1,7b6d505467f34b67aff3816cf394d90c;1,80fa4d5b31cc46ff93f8c9a1551b0529</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<FirstBarDate val="0" />
<Maxbb val="20" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="大跌後的連續跳空上漲" ID="63cb8adbee4243ea98cf08fbaa36dc86" ReturnType="0" ExecType="3" Folder="/抄底策略/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[if close*1.5<close[40]
//過去四十個交易日跌了超過四成
and countif(open > close[1],5)>=3
//過去五天有三天以上開盤比前一天收盤高
and GetSymbolField("tse.tw","收盤價","D")
>average(GetSymbolField("tse.tw","收盤價","D"),10)
//指數位於十日均線之上
and average(volume,5)>2000
//五日均量大於2000張
then ret=1;]]></Code>
<Arg><![CDATA[<Arg seed="76f2f544-7363-44a1-8880-577ffeaf0598" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="f4ce9041-6d65-4c0a-af93-cdbdaff7fbea" version="1" />]]></Plots>
<RefFunc>1,d80cf92ddfcc42e0a6c53ec47edebd49;1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<FirstBarDate val="0" />
<Maxbb val="20" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="開盤委買暴增" ID="2c357a394be34054a0a17e9a726fccf2" ReturnType="0" ExecType="1" Folder="/當沖交易型/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:iVOL(1000);                setinputname(1,"開盤委買賣差張");
input:Ratio(10);                 setinputname(2,"開盤委買力道比");
input:TXT1("適用1分鐘");         setinputname(3,"使用限制");
input:TXT2("僅開盤第1分鐘洗價"); setinputname(4,"使用說明");
settotalbar(300);
if barfreq ="Min" and barinterval =1 and Date= Currentdate and
   Time =90000 and GetQuote("總委買") - GetQuote("總委賣") >iVOL and
   GetQuote("總委買") / summation(volume[1],270) > Ratio 
then ret=1;
]]></Code>
<Arg><![CDATA[<Arg seed="41f09bcf-78ef-4bdf-898f-33a725fd021e" version="1"><Param name="開盤委買賣差張" varname="iVOL" type="1" subtype="0" value="1000" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="開盤委買力道比" varname="Ratio" type="1" subtype="0" value="10" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="使用限制" varname="TXT1" type="3" subtype="0" value="適用1分鐘" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="使用說明" varname="TXT2" type="3" subtype="0" value="僅開盤第1分鐘洗價" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="61a5e1b2-374a-41c7-b5b5-c4b6a73c5d89" version="1" />]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d</RefFunc>
<Extra><![CDATA[<Extra>
<Maxbb val="280" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="300" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="多頭三星" ID="7c8ae3d25e0b48adaa8269e55948844b" ReturnType="0" ExecType="1" Folder="/酒田戰法/" StatusMask="2">
<Desc><![CDATA[近三期開高低收皆呈Ｖ形排列	]]></Desc>
<Code><![CDATA[{																						
[檔名:]	多頭三星			[資料夾:]	酒田戰法	[適用方向]	多															
[說明:]	近三期開高低收皆呈Ｖ形排列																																								
}																						
settotalbar(5);							
{判斷狀況}								
	condition1=	open> open[1] and open[2]>open[1]					;//狀況1:	開盤價排列
	condition2=	high> high[1] and high[2]>high[1]					;//狀況2:	最高價排列
	condition3=	low> low[1] and low[2]>low[1]					;//狀況3:	最低價排列
	condition4=	close> close[1] and close[2]>close[1]					;//狀況4:	收盤價排列
{結果判斷}		
IF		
		condition1
	and	condition2
	and	condition3
	and	condition4
THEN	RET=1;	]]></Code>
<Arg><![CDATA[<Arg seed="80f40e90-5286-4166-99b6-538d45f8587f" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="359e24b6-566f-4106-9672-83b80d5c8e3e" version="1" />]]></Plots>
<Extra><![CDATA[<Extra>
<Maxbb val="5" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="5" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="空頭流星" ID="fad49ae8a8a249fdb8092d6a723db143" ReturnType="0" ExecType="1" Folder="/酒田戰法/" StatusMask="2">
<Desc><![CDATA[紅棒後 跳空開高收黑棒上影線]]></Desc>
<Code><![CDATA[{																						
[檔名:]	空頭流星			[資料夾:]	酒田戰法	[適用方向]	空															
[說明:]	紅棒後 跳空開高收黑棒上影線																																								
}																						
settotalbar(5);						
{判斷狀況}								
	condition1=	open > close[1] and  close < open					;//狀況1:	開高且收黑
	condition2=	( close[1] - open[1] ) >(high[1] -low[1]) * 0.75					;//狀況2:	前期收實體紅K棒
	condition3=	close[1]> close[2]					;//狀況3:	當期收漲
	condition4=	(high - open ) > (open-close) * 2					;//狀況4:	留長上影線
{結果判斷}		
IF		
		condition1
	and	condition2
	and	condition3
	and	condition4
THEN	RET=1;	]]></Code>
<Arg><![CDATA[<Arg seed="7c153e26-7f5f-45ce-95b4-a57e8f03ed83" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="f1181875-bbc2-4c42-9ad4-aa6649daf59b" version="1" />]]></Plots>
<Extra><![CDATA[<Extra>
<Maxbb val="5" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="5" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="SAR買進訊號" ID="697cad294b6c4502839b9fdad247316d" ReturnType="0" ExecType="3" Folder="/波段操作型/" StatusMask="2">
<Desc><![CDATA[SAR轉折往上出現買進訊號]]></Desc>
<Code><![CDATA[input:AFIncrement(0.02);  setinputname(1,"加速因子");
input:AFMax(0.2);  setinputname(2,"加速因子最大值");

settotalbar(100);

variable:
	sarValue(0);
	
sarValue = SAR(AFIncrement, AFIncrement, AFMax);	

if close crosses over sarValue then ret = 1;
]]></Code>
<Arg><![CDATA[<Arg seed="2aa52881-f59f-4ebc-96e4-b7a93e84d86d" version="1"><Param name="加速因子" varname="AFIncrement" type="1" subtype="0" value="0.02" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="加速因子最大值" varname="AFMax" type="1" subtype="0" value="0.2" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="34af7cc3-00b7-4331-af7c-e97472456da9" version="1" />]]></Plots>
<RefFunc>1,1ac64461c4f341bc8e1d3ac1998fd29e;1,6850ead727a842bf883a1501d030ba98</RefFunc>
<Extra><![CDATA[<Extra>
<Maxbb val="5" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="100" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="股價創近期新高" ID="14c7a5851fe24e72926fcd4ca5fea27f" ReturnType="0" ExecType="1" Folder="/價量指標/" StatusMask="2">
<Desc><![CDATA[收盤價突破過去N期以來高點]]></Desc>
<Code><![CDATA[input: Price(close); setinputname(1,"比較價別");
input: Length(20); setinputname(2,"近期期數");
settotalbar(3);
setbarback(Length);
if  Price > highest(high[1] ,Length) then ret=1;



]]></Code>
<Arg><![CDATA[<Arg seed="6bddb615-197a-44a4-af51-5d325a9339ef" version="1"><Param name="比較價別" varname="Price" type="1" subtype="1" value="close" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="近期期數" varname="Length" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="9b99dbc3-ebae-45b1-96bb-b29d5bbb2a49" version="1" />]]></Plots>
<RefFunc>1,61c06064ad98469db9ce30287ae4a2c8;1,2bca774c6b7549c1b0b008d2a54b288e</RefFunc>
<Extra><![CDATA[<Extra>
<Maxbb val="50" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
<IsScriptSetBB val="1" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="空頭吞噬" ID="582aa53d76fd4a6888cc41113edca761" ReturnType="0" ExecType="1" Folder="/酒田戰法/" StatusMask="2">
<Desc><![CDATA[紅棒後 開高下跌破昨低收長黑K棒]]></Desc>
<Code><![CDATA[{																						
[檔名:]	空頭吞噬			[資料夾:]	酒田戰法	[適用方向]	空															
[說明:]	紅棒後 開高下跌破昨低收長黑K棒																																									
}																						
settotalbar(5);								
{判斷狀況}								
	condition1=	( close[1] - open[1] ) > (high[1] -low[1]) * 0.5					;//狀況1:	前期實體紅棒
	condition2=	 high-low >( high[1]-low[1])*2					;//狀況2:	當期波動倍曾
	condition3=	( open - close )>(high -low) * 0.75					;//狀況3:	當期黑K棒
	condition4=	open > close[1] and close < low[1]					;//狀況4:	開高下跌破昨低
{結果判斷}		
IF		
		condition1
	and	condition2
	and	condition3
	and	condition4
THEN	RET=1;	]]></Code>
<Arg><![CDATA[<Arg seed="b4e915c5-36c7-44dc-8c53-421ffe73d904" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="48d29790-c53e-4e7c-a6f0-869e708be752" version="1" />]]></Plots>
<Extra><![CDATA[<Extra>
<Maxbb val="5" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="5" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="主力賣超" ID="8d0667f319f54ac3a39a98e32600fcd6" ReturnType="0" ExecType="1" Folder="/3.出場常用警示/" StatusMask="2">
<Desc><![CDATA[近日主力賣超張數超過一定數量且今日收跌	]]></Desc>
<Code><![CDATA[input:PastDays(3); setinputname(1,"計算天數");
input:summ(2000);setinputname(2,"合計賣超張數門檻");
input:TXT("僅適用日線"); setinputname(3,"使用限制");

settotalbar(PastDays + 3);

if Barfreq = "D" and close< close[1] and
   summation(GetField("LeaderDifference")[1],PastDays) <= summ*-1 then ret=1;]]></Code>
<Arg><![CDATA[<Arg seed="dff07564-b692-4ce2-a824-ba39fb8ca439" version="1"><Param name="計算天數" varname="PastDays" type="1" subtype="0" value="3" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="合計賣超張數門檻" varname="summ" type="1" subtype="0" value="2000" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="使用限制" varname="TXT" type="3" subtype="0" value="僅適用日線" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="a8f2add5-e2c5-49c1-898c-5c7ba357d235" version="1" />]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d</RefFunc>
<Extra><![CDATA[<Extra>
<Maxbb val="15" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="-1" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="盤中突破區間" ID="b0d4d655866b42d6aca9ac2f4839ec06" ReturnType="0" ExecType="1" Folder="/當沖交易型/" StatusMask="2">
<Desc><![CDATA[盤中切算時間點,價格突破切算前區高點]]></Desc>
<Code><![CDATA[input: timeline(100000); setinputname(1,"時間切算點");
input:TXT1("限用分鐘線"); setinputname(2,"使用限制");
input:TXT2("高點自開盤起算"); setinputname(3,"使用說明");
settotalbar(3);
if barfreq<> "Min" then return;
variable:RangeHigh(0);
if date <> date[1] then RangeHigh = 0;
if Time < timeline then RangeHigh = maxlist(RangeHigh,high)
	else if time >= timeline and  RangeHigh > 0 and Close > RangeHigh*1.005 then ret=1 ;
]]></Code>
<Arg><![CDATA[<Arg seed="f309f440-a3d7-4c50-8905-32a149a35e6c" version="1"><Param name="時間切算點" varname="timeline" type="1" subtype="0" value="100000" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="使用限制" varname="TXT1" type="3" subtype="0" value="限用分鐘線" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="使用說明" varname="TXT2" type="3" subtype="0" value="高點自開盤起算" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="5ff52892-bfe2-4b6a-9179-3cfa1b19ca18" version="1" />]]></Plots>
<Extra><![CDATA[<Extra>
<Maxbb val="2" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="高檔覆蓋線" ID="0d56426ab022422baf5720e5a810428c" ReturnType="0" ExecType="1" Folder="/3.出場常用警示/" StatusMask="2">
<Desc><![CDATA[以威廉指標來判斷股價在高檔後,黑棒蓋過紅棒]]></Desc>
<Code><![CDATA[input: Length(10); setinputname(1,"計算期數");

settotalbar(3);
setbarback(maxlist(Length,42));

value1 = PercentR(14) - 100;
value2 = PercentR(28) - 100;
value3 = PercentR(42) - 100;

if  value1= 0 and value2=0 and value3 =0 then //用威廉指標來表示股價在高檔
begin

variable: HighPoint(0),LowPoint(0),RatioThre(0);
HighPoint = highest(high,length);
LowPoint = Lowest(Low,length);

if HighPoint > LowPoint then
 RatioThre=(HighPoint-close)/(HighPoint-LowPoint)*100
else 
 RatioThre=999;
 
if RatioThre<10 and 
   close<open and 
   close[1]>open[1] and 
   close<close[1]-1/2*(close[1]-open[1])
then ret=1;

end;]]></Code>
<Arg><![CDATA[<Arg seed="4132d200-c4f7-4fea-b0f6-4b2e19c3a790" version="1"><Param name="計算期數" varname="Length" type="1" subtype="0" value="10" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="34739790-b836-4dd4-8eb7-e652cce7fa8a" version="1" />]]></Plots>
<RefFunc>1,61c06064ad98469db9ce30287ae4a2c8;1,2bca774c6b7549c1b0b008d2a54b288e;1,f1b429ac13b2447c909302198c18ca56;1,b348a25d74c84ec4b6c1807d146a49fa</RefFunc>
<Extra><![CDATA[<Extra>
<Maxbb val="50" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
<IsScriptSetBB val="1" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="爆量長紅" ID="f7c0ee739f8d4b14ae9fc4604d6e5902" ReturnType="0" ExecType="1" Folder="/價量指標/" StatusMask="2">
<Desc><![CDATA[爆量長紅
]]></Desc>
<Code><![CDATA[settotalbar(8);
if volume >  Average(volume[1],5)  *3    and 
 ( close - open ) >( high -low ) * 0.75  and 
   close > open + (high[1]- low[1])
then ret=1;  


        
        ]]></Code>
<Arg><![CDATA[<Arg seed="b9f47f85-6eba-4976-b8c2-0b2d20fe87ef" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="032bff0a-e769-42e1-82f7-c37fb4db9c06" version="1" />]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c</RefFunc>
<Extra><![CDATA[<Extra>
<Maxbb val="10" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="8" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="ETF乖離反轉作多買進訊號" ID="d2b103ead3474db88764e429e0875e44" ReturnType="0" ExecType="1" Folder="/ETF策略/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:Length(20); setinputname(1,"計算期數");
input:Ratio(21); setinputname(2,"乖離%");

variable:KPrice(0);
if close/average(close,Length)<= 1-Ratio/100 then KPrice = H;
if Close crosses over KPrice
then ret=1 ;
]]></Code>
<Arg><![CDATA[<Arg seed="96a5d82c-6f0c-4fb2-863c-3c52fe65220a" version="1"><Param name="計算期數" varname="Length" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="乖離%" varname="Ratio" type="1" subtype="0" value="21" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="2348960d-d38b-46d8-b76b-7d72d850c244" version="1" />]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c;1,6850ead727a842bf883a1501d030ba98</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<FirstBarDate val="0" />
<Maxbb val="20" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="KO買進訊號" ID="4af85027e7894c16afaca66cef3c0c7e" ReturnType="0" ExecType="3" Folder="/ETF策略/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[Input: Length1(34, "短天期");
Input: Length2(55, "長天期");
variable: ko(0);   

ko = callfunction("KO成交量擺盪指標", Length1, Length2);

value1=average(ko,3);
value2=average(ko,13);

if value1 crosses over value2
and linearregangle(close,5)>20
then ret=1;]]></Code>
<Arg><![CDATA[<Arg seed="dc4ad07d-aa78-4231-b5f4-47a59c37d23b" version="1"><Param name="短天期" varname="Length1" type="1" subtype="0" value="34" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="長天期" varname="Length2" type="1" subtype="0" value="55" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="73743156-dd02-411a-8a84-e6abf6a3866f" version="1" />]]></Plots>
<RefFunc>1,949e616a0b17470eb3397b099c2dec83;1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c;1,26f5e18d32f94a36aab6bac8d2d2a673;1,6850ead727a842bf883a1501d030ba98;1,8c2d025a23c548d3a76fba10c22527b4;1,210d0786cfe340538e34c095bc2ba049;1,7b6d505467f34b67aff3816cf394d90c</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<FirstBarDate val="0" />
<Maxbb val="20" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="投信加持卻遇襲" ID="a33034d55ec34b92b9ec7fecdad94796" ReturnType="0" ExecType="1" Folder="/1.籌碼監控/" StatusMask="2">
<Desc><![CDATA[投信最近一段時間買超,可是今日卻收低破底.

需選用日線及逐筆洗價.]]></Desc>
<Code><![CDATA[Input: pastDays(5); setinputname(1, "計算天數");
Input: _buyAmount(1000); setinputname(2, "買超張數");
input:TXT("僅適用日線"); setinputname(3,"使用限制");

variable: SumForce(0);

settotalbar(pastdays + 3);

if BarFreq <> "D" then return;

if close < lowest(low[1], pastdays) then
begin
	sumForce = Summation(GetField("投信買賣超")[1], pastDays);
	if sumForce > _buyAmount then ret=1;

end;        ]]></Code>
<Arg><![CDATA[<Arg seed="2955d743-77f3-4a75-b8c4-add91b065fa5" version="1"><Param name="計算天數" varname="pastDays" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="買超張數" varname="_buyAmount" type="1" subtype="0" value="1000" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="使用限制" varname="TXT" type="3" subtype="0" value="僅適用日線" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="5cd925d6-e0b4-47a6-83cc-4b6c52b4baf6" version="1" />]]></Plots>
<RefFunc>1,61c06064ad98469db9ce30287ae4a2c8;1,f1b429ac13b2447c909302198c18ca56;1,c122bd6485c544f2bce8f374b5c7440d</RefFunc>
<Extra><![CDATA[<Extra>
<Maxbb val="10" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="-1" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="週線反轉法則" ID="f94e5fac108a46aea681af28750860ec" ReturnType="0" ExecType="2" Folder="/ETF策略/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:rate1(5,"先前週線漲幅");
input:rate2(3,"本週低點跌幅");
input:TXT("僅適用日線","使用限制");

settotalbar(20);

if getfield("high","W")[2]>=getfield("close","W")[3]*(1+rate1/100) 
and low < getfield("close","W")[1]*(1-rate2/100)
then ret=1;
]]></Code>
<Arg><![CDATA[<Arg seed="51f15abc-cb58-4e6f-b9e9-985b5ed65c86" version="1"><Param name="先前週線漲幅" varname="rate1" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="本週低點跌幅" varname="rate2" type="1" subtype="0" value="3" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="使用限制" varname="TXT" type="3" subtype="0" value="僅適用日線" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="05ce003a-abd7-455a-95c7-b1e1142bd307" version="1" />]]></Plots>
<Extra><![CDATA[<Extra>
<Maxbb val="50" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="20" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="跌停一直在成交" ID="f80b9eca65674037a4985b7de015570c" ReturnType="0" ExecType="1" Folder="/當沖交易型/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input: lastvolume1(2000);  setinputname(1,"跌停期間放量張數");
input: lastvolume2(10000); setinputname(2,"當日總成交量上限");
input:TXT1("需使用逐筆洗價"); setinputname(3,"使用限制");
settotalbar(3);
variable: DNLVol(0);

if Date <> Date[1] then DNLVol = 0;

if Close = GetField("跌停價", "D") then 
begin
  DNLVol += GetField("Volume", "Tick");
  if q_BestAskSize1 <lastvolume1 and 
     GetField("Volume", "D") >lastvolume2 and
	 DNLVol > lastvolume1 
  then RET=1;
end;
]]></Code>
<Arg><![CDATA[<Arg seed="272c4551-dfa0-4cfe-9699-68b07df07cb4" version="1"><Param name="跌停期間放量張數" varname="lastvolume1" type="1" subtype="0" value="2000" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="當日總成交量上限" varname="lastvolume2" type="1" subtype="0" value="10000" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="使用限制" varname="TXT1" type="3" subtype="0" value="需使用逐筆洗價" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="04d4c751-c01a-4a3e-b426-0066c89335ed" version="1" />]]></Plots>
<Extra><![CDATA[<Extra>
<Maxbb val="2" />
<script>
<freq support="1;8;11;9;12;10;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="開盤暴量" ID="a5cc441a25a04fcdaff8b95df3b31c0f" ReturnType="0" ExecType="1" Folder="/當沖交易型/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:Vtimes(3);            setinputname(1,"爆量倍數");
input:atVolume(100);            setinputname(2,"暴量門檻張數");
input:TXT1("僅適用1分鐘");  setinputname(3,"使用限制");
input:TXT2("盤中可用");  setinputname(4,"使用說明:建議日內單次觸發");
settotalbar(300);
if barfreq <> "Min" or Barinterval <> 1 then return;

variable: OpenVolume(0), OpenVolumeDate(0);
if CurrentBar = 1 then
  begin
	// 找到當日第一筆分鐘K線的成交量
	//
	variable: idx(0);
	idx = 0;
	while date[idx] = date
	  begin
		OpenVolume = Volume[idx];
		OpenVolumeDate = date[idx];
		idx = idx + 1;
	  end;
  end
else
	if Date <> OpenVolumeDate then
	  begin
		// 開盤量為換日後的第一筆分鐘K線的成交量
		OpenVolumeDate = Date;
		OpenVolume = Volume;
	  end;
if CurrentDate = OpenVolumeDate And 
   OpenVolume > AtVolume And
   OpenVolume > GetQuote("昨量")/270 * Vtimes then ret=1;

]]></Code>
<Arg><![CDATA[<Arg seed="557f9714-696f-4a5a-91e1-58b4211eac0c" version="1"><Param name="爆量倍數" varname="Vtimes" type="1" subtype="0" value="3" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="暴量門檻張數" varname="atVolume" type="1" subtype="0" value="100" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="使用限制" varname="TXT1" type="3" subtype="0" value="僅適用1分鐘" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="使用說明:建議日內單次觸發" varname="TXT2" type="3" subtype="0" value="盤中可用" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="51576bd1-8cf9-461d-939a-ae94b057cfbe" version="1" />]]></Plots>
<Extra><![CDATA[<Extra>
<Maxbb val="270" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="300" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="階梯式下跌" ID="cd8fb42588ca4a0e9e31584d76b90f17" ReturnType="0" ExecType="1" Folder="/3.出場常用警示/" StatusMask="2">
<Desc><![CDATA[開盤09:10之後連續10分鐘內分鐘線走勢呈現階梯式下跌的情形。
僅適用於分鐘線。
]]></Desc>
<Code><![CDATA[input:TXT("5分鐘線以下"); setinputname(1,"使用限制");

settotalbar(13);

if barfreq<> "Min" or barinterval > 5 then return;

switch (barinterval)
begin
   case 1,2,5:
     if time =091000 and TrueAll(open=high and close=low and close< close[1],10/barinterval) then ret=1;
     break;
   case 3:
     if time =090900 and TrueAll(open=high and close=low and close< close[1],3) then ret=1;
     break;
end;]]></Code>
<Arg><![CDATA[<Arg seed="0991259b-5bbc-45ee-9f1a-9e058b911dae" version="1"><Param name="使用限制" varname="TXT" type="3" subtype="0" value="5分鐘線以下" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="e752625d-ce97-4973-8a7d-cc9c13ce9e1f" version="1" />]]></Plots>
<RefFunc>1,93ec7a47222349e7ba8a2257d29196e4</RefFunc>
<Extra><![CDATA[<Extra>
<Maxbb val="10" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="13" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="資減券增" ID="3f2088b848614730abba72bed9562b8c" ReturnType="0" ExecType="1" Folder="/2.市場常用語/" StatusMask="2">
<Desc><![CDATA[融資減少融券增加的個股]]></Desc>
<Code><![CDATA[input:x1(300);setinputname(1,"融資減少張");
input:x2(200);setinputname(2,"融券增加張");
input:x3(10); setinputname(3,"全計佔成交量比例%");
input: Type(1); setinputname(4,"最新資料：0=今日、1=昨日");
input: TXT1("僅適用日線"); setinputname(5,"使用限制");
input: TXT2("盤中無當日資券資料"); setinputname(6,"建議使用單次洗價模式");

settotalbar(3);

value1=GetField("融資增減張數")[Type];//融資增減張數
value2=GetField("融券增減張數")[Type];//融券增減張數

 if value1 <-x1 and 
    value2 > x2 and 
    (value2-value1)/volume[Type]>x3/100
 then ret=1;]]></Code>
<Arg><![CDATA[<Arg seed="83fc2186-556a-4b65-a082-267dabe6039f" version="1"><Param name="融資減少張" varname="x1" type="1" subtype="0" value="300" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="融券增加張" varname="x2" type="1" subtype="0" value="200" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="全計佔成交量比例%" varname="x3" type="1" subtype="0" value="10" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="最新資料：0=今日、1=昨日" varname="Type" type="1" subtype="0" value="1" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="使用限制" varname="TXT1" type="3" subtype="0" value="僅適用日線" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="建議使用單次洗價模式" varname="TXT2" type="3" subtype="0" value="盤中無當日資券資料" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="075cba95-bd0f-4ba3-9b4f-77d8826d8c0d" version="1" />]]></Plots>
<Extra><![CDATA[<Extra>
<Maxbb val="2" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="跌深後的反彈" ID="6de56169000a461facad2b9a1b65a42e" ReturnType="0" ExecType="1" Folder="/抄底策略/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:ratio(10,"近十日最小下跌幅度");

if open*1.025<close[1]//開盤重挫
and close>open //收盤比開盤高
and close*(1+ratio/100)<close[9]
//近十日跌幅超過N%
and low*1.01<open
//開低後又殺低
then ret=1;]]></Code>
<Arg><![CDATA[<Arg seed="34c82d8f-9763-46dc-ab3d-1d6e17549e01" version="1"><Param name="近十日最小下跌幅度" varname="ratio" type="1" subtype="0" value="10" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="8deac63f-e88f-4f35-abff-756915cc2fcd" version="1" />]]></Plots>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<FirstBarDate val="0" />
<Maxbb val="20" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="近日多方火力集中" ID="844bcdb2cdc64f80821f747efabd3a59" ReturnType="0" ExecType="3" Folder="/2.市場常用語/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[settotalbar(10);

variable:CDay(3);
variable:i(1),XData(0),XDataAmount(0),XAmount(0),XV(0),XPrice(0),Trigger(False);

if Currenttime > 170000  or Currenttime < 083000 then i=0; 
Trigger=False;
XAmount =Summation(GetField("成交金額")[i],CDay);XV = Summation(V[i],CDay);XPrice = XAmount/XV/1000;
XDataAmount = Summation(GetField("主力買賣超張數")[i],CDay)/XV; if XDataAmount>0.2 and trueall( XDataAmount[1]<0.1,5) then Trigger=true;
XDataAmount = Summation(GetField("實戶買賣超張數")[i],CDay)/XV; if XDataAmount>0.25 and trueall( XDataAmount[1]<0.1,5) then Trigger=true;
XDataAmount = Summation(GetField("控盤者買賣超張數")[i],CDay)/XV; if XDataAmount>0.25 and trueall( XDataAmount[1]<0.1,5) then Trigger=true;
if C[i]> XPrice and  V>300 and Trigger then ret=1;


variable:iHigh(0),iDate(0);
if high > iHigh then begin iHigh= high;iDate= Date; end;
if DateDiff(Date,iDate) >30  and C > iHigh *0.935 and C<iHigh and
   (Summation(GetField("外資買賣超")[i]*XPrice,CDay) > 30000 or
    Summation(GetField("投信買賣超")[i]*XPrice,CDay) > 30000 or
	Summation(GetField("自營商買賣超")[i]*XPrice,CDay) > 30000)
then ret=1; 
]]></Code>
<Arg><![CDATA[<Arg seed="156460a1-cc36-4e26-a0e4-44f9997e3ed8" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="96884e34-74e1-4b99-95b5-b91f7d23ac14" version="1" />]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d;1,93ec7a47222349e7ba8a2257d29196e4</RefFunc>
<Extra><![CDATA[<Extra>
<Maxbb val="21" />
<script>
<freq support="8;11;9;12;10;13" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="10" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="大黑棒" ID="8775fc5fb08d41d196e24bbbc08018b7" ReturnType="0" ExecType="1" Folder="/3.出場常用警示/" StatusMask="2">
<Desc><![CDATA[股價收黑K棒警示]]></Desc>
<Code><![CDATA[input:Percent(4); setinputname(1,"實體K棒為股價絕對百分比");

settotalbar(3);

if open/close >= 1 + Percent/100  //實體(開盤-收盤)
then ret=1;]]></Code>
<Arg><![CDATA[<Arg seed="da46de90-402c-4843-8ded-891f9bd748ce" version="1"><Param name="實體K棒為股價絕對百分比" varname="Percent" type="1" subtype="0" value="4" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="00bf344f-87b4-492d-a2ef-f3843e939997" version="1" />]]></Plots>
<Extra><![CDATA[<Extra>
<Maxbb val="2" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="MTM轉負" ID="ac05101279694f74999c88dc0a8af766" ReturnType="0" ExecType="3" Folder="/3.出場常用警示/" StatusMask="2">
<Desc><![CDATA[MTM轉負時觸發]]></Desc>
<Code><![CDATA[input: Length(10); SetInputName(1, "期數");

settotalbar(maxlist(Length,6) + 8);

if momentum(close,Length) crosses under 0 then ret=1;
]]></Code>
<Arg><![CDATA[<Arg seed="9b6b79db-60ed-4b7b-be68-a6583ffdc0cb" version="1"><Param name="期數" varname="Length" type="1" subtype="0" value="10" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="e99682e3-99ac-4105-a3ed-9e81125b0819" version="1" />]]></Plots>
<RefFunc>1,239cb1c1f329431ea731982d8f5d94f2;1,9dc3f19597ba44fa91524e91ca67aebd</RefFunc>
<Extra><![CDATA[<Extra>
<Maxbb val="11" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="-1" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="開盤反轉買進訊號" ID="cd10b94e6c7347008af09b87d916215c" ReturnType="0" ExecType="3" Folder="/當沖交易型/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[variable: _BarIndex(0), _Open(0), _Low(0), _High(0), _Volume(0);

if getsymbolfield("tse.tw","收盤價") > average(getsymbolfield("tse.tw","收盤價"),10) then begin
	if Date <> Date[1] then begin
		_BarIndex = 1;
		_Open = Open;
		_Low = Low;
		_High = High;
		_Volume = Volume;
	end else begin
		_Low = minlist(_Low, Low);
		_High = maxlist(_High, High);
		_Volume = _Volume + Volume;
		_BarIndex = _BarIndex + 1;
	end;
  
	Condition1 = GetField("Open", "D") < GetField("Close", "D")[1];
	//開低
	Condition2 = Close > _Low * 1.02 and close>GetField("收盤價","D")[1];
	//收盤比當天低點收高2%且突破前一日高點
	Condition3 = Close*1.2 < GetField("Close", "D")[20]
	//近二十日跌幅超過兩成
	and close*1.07<getfield("close","D")[10];
	//近十日跌幅超過7%
	Condition4 = Time < 93000;
	//時間在九點半之前
	Condition5 = Average(GetField("Volume", "D")[1], 5) >= 1000;
	//五日均量大於1000張
	Condition6 = _Volume > GetField("Volume", "D")[1] * 0.2;
	//今日迄今的量大於過去五日均量的兩成
	if Condition1 And Condition2 And Condition3 And Condition4 And Condition5 And Condition6
	then ret = 1;
end;]]></Code>
<Arg><![CDATA[<Arg seed="468863f4-5d17-42ff-8ee6-e6f9a1661139" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="90601892-04ac-42db-8ca2-77e1b28e60d8" version="1" />]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="300" />
<Maxbb val="50" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="大單敲進" ID="748c581bf90e4c06afcba3b1dbfc27b6" ReturnType="0" ExecType="3" Folder="/2.市場常用語/" StatusMask="2">
<Desc><![CDATA[大單敲進次數大於設定值]]></Desc>
<Code><![CDATA[input: atVolume(100); setinputname(1,"大單門檻");
input: LaTime(10); setinputname(2,"大單筆數");
input:TXT("須逐筆洗價"); setinputname(3,"使用限制");

settotalbar(3);

variable: intrabarpersist Xtime(0);//計數器
variable: intrabarpersist Volumestamp(0);
variable: intrabarpersist XDate(0);

Volumestamp =GetField("Volume", "D");

if Date > XDate or Volumestamp = Volumestamp[1]  then Xtime =0; //開盤那根要歸0次數
XDate = Date;

if GetField("Volume", "Tick") > atVolume and GetField("內外盤","Tick")=1 then  Xtime+=1; //量夠大就加1次

if Xtime > LaTime  then 
begin
	ret=1; 
	Xtime=0;
end;]]></Code>
<Arg><![CDATA[<Arg seed="feb99fe0-0145-47d5-9ae2-e11d220d6245" version="1"><Param name="大單門檻" varname="atVolume" type="1" subtype="0" value="100" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="大單筆數" varname="LaTime" type="1" subtype="0" value="10" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="使用限制" varname="TXT" type="3" subtype="0" value="須逐筆洗價" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="3039eae2-aaa7-4f91-b031-f60f3ba9157f" version="1" />]]></Plots>
<Extra><![CDATA[<Extra>
<Maxbb val="5" />
<script>
<freq support="1;8;11;9;12;10;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="三長上影線" ID="18e2a81dfa5b45f9928b45aba1fd0e8c" ReturnType="0" ExecType="1" Folder="/3.出場常用警示/" StatusMask="2">
<Desc><![CDATA[出現三根上影線]]></Desc>
<Code><![CDATA[input: Percent(1.5); setinputname(1,"上影線佔股價絕對百分比");

settotalbar(5);

condition1 = (high- maxlist(open,close)) > absvalue(open-close)*3; 
condition2 = high > maxlist(open, close) * (100 + Percent)/100;

if trueall( condition1 and condition2, 3) then ret=1;
]]></Code>
<Arg><![CDATA[<Arg seed="cf2919d3-2e7b-4da6-ae13-88d0975bb1cc" version="1"><Param name="上影線佔股價絕對百分比" varname="Percent" type="1" subtype="0" value="1.5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="337983fe-626c-4523-89a3-c2d167f1cfea" version="1" />]]></Plots>
<RefFunc>1,93ec7a47222349e7ba8a2257d29196e4</RefFunc>
<Extra><![CDATA[<Extra>
<Maxbb val="5" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="5" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="5.if..begin..end..then" ID="e3a87f2c88264c95bc4620fcb1e31114" ReturnType="0" ExecType="1" Folder="/!語法範例/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[//當我們的條件需要多行敘述才能完成時，
//可以用begin..end來標示。

//=====================範例：累積漲幅達X%並且今日跳空開高超過Y%=======================================

//例如若要找出前N日漲幅超過X%且今天跳空開高超過Y%的股票

//1.宣告參數：利用input宣告輸入的參數。
input:N(3);//前N日
input:X(10);//前n日漲幅%
input:_Y(4);//缺口大小%

if open>high[1] then //跳空開高
//用begin來呈現if 之後要執行的不只一件的事情
begin
value1=(1-close[1]/close[N])*100;//計算前N天的漲幅 
value2=(open-high[1])/close*100;//計算跳空缺口的大小
end;
//最後用end來宣告if之後要執行程式的結束

//6.設定警示條件：if.. then ret=1;
if value1>=X and value2>=_Y
then ret=1;
]]></Code>
<Arg><![CDATA[<Arg seed="6caa15c9-0058-4a9b-8086-f45ac66a79f6" version="1"><Param name="N" varname="N" type="1" subtype="0" value="3" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="X" varname="X" type="1" subtype="0" value="10" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="_Y" varname="_Y" type="1" subtype="0" value="4" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="885e9ae0-8004-4c4e-b507-ab89c1456fd7" version="1" />]]></Plots>
<Extra><![CDATA[<Extra>
<TotalBar val="30" />
<Maxbb val="15" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="實戶潛進終抬頭" ID="cdfef9c494854e78953432259b3c9e24" ReturnType="0" ExecType="1" Folder="/1.籌碼監控/" StatusMask="2">
<Desc><![CDATA[近日股價在月線下時,實戶大量買進,今日穿越月線漲升.
需選用日線及逐筆洗價.
        ]]></Desc>
<Code><![CDATA[input: pastDays(3); setinputname(1,"計算天數");
input: _BuyRatio(20); setinputname(2,"買超佔比例(%)");
input: length(20); setinputname(3, "整理期間");
input:TXT("僅適用日線"); setinputname(4,"使用限制");

variable: MonthLine(0); //現在的整理期間位置
variable: SumForce(0);
variable: SumTotalVolume(0);
variable: counter(0);

settotalbar(pastdays + 3);

MonthLine = average(close[1],length);

if BarFreq <> "D" then return;

if Close crosses over MonthLine then
begin
  
    counter = summationif(close[1] < MonthLine, 1, pastDays);
    
	if counter  = pastDays then 
	begin
	// 最近一段時間在月線底下的吃貨量
     	SumForce = summationif(close[1] < MonthLine, GetField("實戶買賣超張數")[1], pastDays);
    	SumTotalVolume = Summationif(close[1] < MonthLine, Volume[1], pastDays);
	if SumForce > SumTotalVolume * _BuyRatio / 100  then ret =1;
	end;
end;
]]></Code>
<Arg><![CDATA[<Arg seed="d0f9d392-27e6-4508-8e2f-93d6e57f16c4" version="1"><Param name="計算天數" varname="pastDays" type="1" subtype="0" value="3" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="買超佔比例(%)" varname="_BuyRatio" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="整理期間" varname="length" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="使用限制" varname="TXT" type="3" subtype="0" value="僅適用日線" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="3b9bad43-f231-435d-a216-5fd539a99123" version="1" />]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c;1,6850ead727a842bf883a1501d030ba98;1,95a5e49d2f6f4d369865c6de85a56469</RefFunc>
<Extra><![CDATA[<Extra>
<Maxbb val="30" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="-1" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="第一根漲停" ID="739e390544124481be92e61f4f6ead8f" ReturnType="0" ExecType="1" Folder="/短線操作型/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input: Periods(5); setinputname(1,"N天內第一根漲停");
input: Size(1500); setinputname(2,"漲停委賣張數");
settotalbar(Periods + 3);

if Periods < 1 then return;

if q_ask=GetField("漲停價", "D") and q_bestasksize1<Size then 
begin
	for value1 = 1 to Periods
	begin
		if closeD(value1-1) > closeD(value1) * 1.065 then return;
	end;
	ret=1;
end;]]></Code>
<Arg><![CDATA[<Arg seed="a468042e-711e-4529-ad27-13211823a1e8" version="1"><Param name="N天內第一根漲停" varname="Periods" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="漲停委賣張數" varname="Size" type="1" subtype="0" value="1500" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="42e8afbf-a4f4-402a-b6bd-501e81a1eff2" version="1" />]]></Plots>
<RefFunc>1,e53a55e6d49b466da1125c878df9cf9a</RefFunc>
<Extra><![CDATA[<Extra>
<Maxbb val="20" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="-1" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="波動縮小" ID="2fc04464a25e4982a4ad94238fce633f" ReturnType="0" ExecType="1" Folder="/技術分析/" StatusMask="2">
<Desc><![CDATA[過去N期波動小於特定%
以近期最高點除以最低點計算其幅度]]></Desc>
<Code><![CDATA[// 波動縮小
//
input: Length(20), Percent(7);

settotalbar(3);
setbarback(Length);

SetInputName(1, "期數");
SetInputName(2, "波動幅度%");

Ret = Highest(High, Length) / Lowest(Low, Length) -1 < Percent*0.01;



]]></Code>
<Arg><![CDATA[<Arg seed="1d7db684-87ac-49d9-8011-6d5d79d6f14c" version="1"><Param name="期數" varname="Length" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="波動幅度%" varname="Percent" type="1" subtype="0" value="7" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="9d18b371-4a7a-489d-a002-4d1854e6a9af" version="1" />]]></Plots>
<RefFunc>1,61c06064ad98469db9ce30287ae4a2c8;1,2bca774c6b7549c1b0b008d2a54b288e;1,f1b429ac13b2447c909302198c18ca56</RefFunc>
<Extra><![CDATA[<Extra>
<Maxbb val="20" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
<IsScriptSetBB val="1" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="多頭趨勢已然確立" ID="c60a363e247b4a4c97b69b27868bcafd" ReturnType="0" ExecType="3" Folder="/長線投資/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:CountMonth(6,"計算月數");
input:LSP(25,"多空切換百分比");

variable:pHigh(0),pLow(100000);

if  CurrentDate < DateAdd(Date,"M",CountMonth) then begin
	pHigh = maxlist(h,pHigh);
	pLow = minlist(l,pLow);
end else begin
	pHigh = C;
	pLow = C;
end;

value1= pHigh-(pHigh-pLow)*LSP/100;

if close>value1 
and close[1]<value1[1]
then ret=1;]]></Code>
<Arg><![CDATA[<Arg seed="797f7150-8065-4cc5-ae32-2f0e2fe71aee" version="1"><Param name="計算月數" varname="CountMonth" type="1" subtype="0" value="6" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="多空切換百分比" varname="LSP" type="1" subtype="0" value="25" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="623cef6d-7082-4570-abcf-8c1471993eec" version="1" />]]></Plots>
<Extra><![CDATA[<Extra>
<TotalBar val="300" />
<Maxbb val="50" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="股價穿越突破雙均線" ID="4da423c5cced4adeafed560f62e8c864" ReturnType="0" ExecType="1" Folder="/技術分析/" StatusMask="2">
<Desc><![CDATA[開盤上漲,穿越突破長短期均線時觸發]]></Desc>
<Code><![CDATA[input: shortlength(5); setinputname(1,"短期均線期數");
input: Longlength(20); setinputname(2,"長期均線期數");

settotalbar(3);
setbarback(maxlist(shortlength,Longlength));

variable: Longaverage(0);
variable: shortaverage(0);

Longaverage = Average(close,Longlength);
shortaverage=Average(close,shortlength) ;


if close > maxlist(shortaverage, longaverage) and
     open < minlist(shortaverage, longaverage)
then ret=1;  


        
        ]]></Code>
<Arg><![CDATA[<Arg seed="c2f60680-e75e-4dae-b50e-1982a2c66dba" version="1"><Param name="短期均線期數" varname="shortlength" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="長期均線期數" varname="Longlength" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="91fe7ac6-6108-4533-8e2a-d5a80fb52783" version="1" />]]></Plots>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c</RefFunc>
<Extra><![CDATA[<Extra>
<Maxbb val="60" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
<IsScriptSetBB val="1" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="ADX趨勢成形" ID="3f07726e5ecb4af38f07b1f6326e1ad6" ReturnType="0" ExecType="3" Folder="/技術分析/" StatusMask="2">
<Desc><![CDATA[ADX趨勢成型]]></Desc>
<Code><![CDATA[// ADX趨勢成形
//
input: Length(14), Threshold(25);

variable: pdi_value(0), ndi_value(0), adx_value(0);

settotalbar(maxlist(Length,6) * 13 + 8);

SetInputName(1, "期數");
SetInputName(2, "穿越值");

DirectionMovement(Length, pdi_value, ndi_value, adx_value);

Ret = adx_value Crosses Above Threshold;



]]></Code>
<Arg><![CDATA[<Arg seed="8ff91750-69fc-492d-adfb-fec463d8d97d" version="1"><Param name="期數" varname="Length" type="1" subtype="0" value="14" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="穿越值" varname="Threshold" type="1" subtype="0" value="25" isSerial="1" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="608d9f3f-610e-48af-be68-707ae0fc9613" version="1" />]]></Plots>
<RefFunc>1,7721dca8cc7242c09d21b782bbb59bd9;1,6850ead727a842bf883a1501d030ba98</RefFunc>
<Extra><![CDATA[<Extra>
<Maxbb val="2" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="-1" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="投信外資同步進場" ID="e1937001df104d8ea7ed76cdc572102c" ReturnType="0" ExecType="1" Folder="/短線操作型/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:Fboughts(100); setinputname(1,"外資買超張數");
input:Sboughts(100); setinputname(2,"投信買超張數");
input:TXT1("僅適用日線"); setinputname(3,"使用限制");
settotalbar(3);
if BarFreq <> "D"  then return;
if GetField("外資買賣超")[1]>Fboughts and GetField("投信買賣超")[1]>Sboughts
then ret=1;]]></Code>
<Arg><![CDATA[<Arg seed="79dbee86-48fc-431e-bfa8-2b94d69689a6" version="1"><Param name="外資買超張數" varname="Fboughts" type="1" subtype="0" value="100" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="投信買超張數" varname="Sboughts" type="1" subtype="0" value="100" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="使用限制" varname="TXT1" type="3" subtype="0" value="僅適用日線" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="d98c66cf-7465-4806-a7e6-aae5269ff447" version="1" />]]></Plots>
<Extra><![CDATA[<Extra>
<Maxbb val="2" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="九陽神功" ID="8e69759dd9d1488f9ed7b986a9bf6bbe" ReturnType="0" ExecType="1" Folder="/A股用語/" StatusMask="2">
<Desc><![CDATA[連續9期收上漲]]></Desc>
<Code><![CDATA[// 連續9筆上漲
settotalbar(10);
Ret = TrueAll(Close > Close[1], 9);
]]></Code>
<Arg><![CDATA[<Arg seed="0198fc9c-8f6b-4a5b-b523-8e934b5bf598" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="f3fbdd94-7778-45e0-8559-6dbb2bf1d336" version="1" />]]></Plots>
<RefFunc>1,93ec7a47222349e7ba8a2257d29196e4</RefFunc>
<Extra><![CDATA[<Extra>
<Maxbb val="10" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="10" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="當日時段區間價跌破" ID="488746428b3542e99048b2f4ba687c51" ReturnType="0" ExecType="1" Folder="/價量指標/" StatusMask="2">
<Desc><![CDATA[收盤價或最低價跌破設定區間之低點
        ]]></Desc>
<Code><![CDATA[input:initialtime(090000); setinputname(1,"起算時間HHmmss");
input:timeline(100000);   setinputname(2,"截止時間HHmmss");
input:CloseAtLow(false); setinputname(3,"收盤價亦須創新低");
input:TXT1("限用分鐘線"); setinputname(4,"使用限制");

settotalbar(50);

if barfreq<> "Min" then return;

variable: intervallow(99999999);

if date <> date[1] then intervallow = 99999999;

if time >= initialtime and time <= timeline then 
begin
  intervallow = minlist(low,intervallow);
end;

if time >timeline then
begin
  if CloseAtLow  then  
	Ret = IFF(close < intervallow, 1, 0)
  else  
	Ret = IFF(low < intervallow, 1, 0);
end;]]></Code>
<Arg><![CDATA[<Arg seed="294a9363-b39b-4e81-8b92-09cc71e637dc" version="1"><Param name="起算時間HHmmss" varname="initialtime" type="1" subtype="0" value="90000" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="截止時間HHmmss" varname="timeline" type="1" subtype="0" value="100000" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="收盤價亦須創新低" varname="CloseAtLow" type="2" subtype="0" value="0" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="使用限制" varname="TXT1" type="3" subtype="0" value="限用分鐘線" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="1937fd27-18d3-4097-9236-bbf929a513e2" version="1" />]]></Plots>
<RefFunc>1,8c2d025a23c548d3a76fba10c22527b4</RefFunc>
<Extra><![CDATA[<Extra>
<Maxbb val="50" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="50" />
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="下跌後的吊人線" ID="ed0fe4d120c94bbb81fffcc98f4e140c" ReturnType="0" ExecType="3" Folder="/技術分析/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[
condition1=false;
condition2=false;
condition3=false;
if high<= maxlist(open, close)*1.01	
//條件1:小紅小黑且上影線很小
then condition1=true;
if (close-low)> (open-close)*2 and (close-low)>close*0.02
//條件2:下影線為實體兩倍以上
then condition2=true;
if highest(high,30)>close[1]*1.4
//條件3:近30日來最高點到昨天跌幅超過40%
then condition3=true;
{結果判斷}		
IF		condition1
	and	condition2
	and	condition3
and average(volume,100)>1000
//只計算有量的股票
then ret=1;	
]]></Code>
<Arg><![CDATA[<Arg seed="ac519cbc-ac7a-4c3d-81d3-e8367359d4f7" version="1" />]]></Arg>
<Plots><![CDATA[<Plots seed="e928b46f-4fcd-4f85-91da-3c4a7e7f972a" version="1" />]]></Plots>
<RefFunc>1,61c06064ad98469db9ce30287ae4a2c8;1,2bca774c6b7549c1b0b008d2a54b288e;1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<FirstBarDate val="0" />
<Maxbb val="20" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
<Script Type="3" Name="進入上漲軌道" ID="d8b0c2b72b8b4369a25e88b20d7b185f" ReturnType="0" ExecType="3" Folder="/波段操作型/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:period(12,"期數");

//透過Z的時間安排來決定現在用的是那一根Bar的資料 
variable: Z(0);
if currenttime > 180000 
or currenttime < 083000 then 
	Z =0 
else 
	Z=1;
	
value1=countif(low<lowest(low[1],period),period);
value2=countif(high>highest(high[1],period),period);
value3=value2-value1;
 
if value3 crosses over 4
and tselsindex(10,6)[Z]=1 
then ret=1;]]></Code>
<Arg><![CDATA[<Arg seed="8437ee6a-0557-46ee-8818-4b1ac06b5758" version="1"><Param name="期數" varname="period" type="1" subtype="0" value="12" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Plots><![CDATA[<Plots seed="472895c2-4c33-41e6-9a39-aa6338d0587c" version="1" />]]></Plots>
<RefFunc>1,61c06064ad98469db9ce30287ae4a2c8;1,f1b429ac13b2447c909302198c18ca56;1,d80cf92ddfcc42e0a6c53ec47edebd49;1,2bca774c6b7549c1b0b008d2a54b288e;1,6850ead727a842bf883a1501d030ba98;1,b1f1a25bdc014e109dc92d7f9b6ef207</RefFunc>
<Extra><![CDATA[<Extra>
<TotalBar val="200" />
<FirstBarDate val="0" />
<Maxbb val="20" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="1" />
</Script>
</Scripts>
