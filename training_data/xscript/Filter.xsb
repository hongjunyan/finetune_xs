<Scripts Version="3" AppID="DAQ" UserID="JUSTB-1008" Lang="TW" StatusMask="2">
<Script Type="4" Name="N年平均盈餘本益比" ID="f6f9a57c4aab43bc9a2e0270041c80ce" ReturnType="0" ExecType="1" Folder="/08.財報選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:r1(10);		setinputname(1,"本益比上限");
input:years(8);		setinputname(2,"計算期間(年)");

settotalbar(3);

value1=GetField("最新股本");			//單位=億元
value2=GetField("本期稅後淨利","Y");	//單位=百萬元
value3=average(GetField("本期稅後淨利","Y"), years);	//稅後淨利平均
value4=value3/(value1*10);				//每股盈餘
value6=GetField("收盤價","D");

if value4 > 0 then
begin
	value5 = GetField("收盤價","D") / value4;
	if value5 < r1 then ret = 1;
	
	SetOutputName1("平均盈餘本益比");
	OutputField1(value5);
end;



]]></Code>
<Arg><![CDATA[<Arg seed="74e760f5-95a0-4f9e-bcc6-a18091e99c67" version="1"><Param name="本益比上限" varname="r1" type="1" subtype="0" value="10" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="計算期間(年)" varname="years" type="1" subtype="0" value="8" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<script>
<freq support="8;11" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="MTM穿越0" ID="bf7963fc26fd42499c6cfc88026fa2d6" ReturnType="0" ExecType="1" Folder="/02.基本技術指標/" StatusMask="2">
<Desc><![CDATA[MTM指標向上穿越0。
]]></Desc>
<Code><![CDATA[// MTM往上穿越0軸
//
Input: Length(10);

SetInputName(1, "期數");

settotalbar(maxlist(Length,6));

Ret = Momentum(Close, Length) Crosses Above 0;
]]></Code>
<Arg><![CDATA[<Arg seed="81a651f8-2f68-46d9-947e-4142a2980ddb" version="1"><Param name="期數" varname="Length" type="1" subtype="0" value="10" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="-1" />
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="三次到頂而破" ID="ed2bce2e4c69427aba9794b73e7f9561" ReturnType="0" ExecType="1" Folder="/05.型態選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input: BoxRangePercents(7); setinputname(1,"定義整理區間幅度");
input: HighAreaPercents(1.5); setinputname(2,"定義區間高檔範圍");
variable: BoxHigh(0);

variable:period(10),MaxPeriod(40);

period = 10;
while period < Maxperiod and
	highest(high[1],period) < lowest(low[1],period) *(1+BoxRangePercents/100)
begin period +=1; end;

if period < MaxPeriod then
begin
	BoxHigh = highest(High[1],period); {區間高點}

	if Close > BoxHigh   and  {突破整理區間高點}
	   NthHighest(3,High[1],period) > BoxHigh*(1-HighAreaPercents/100)
	   {昨天以前第3個高點也在高檔區間,即曾經攻高3次}
	   then ret=1;
end;
   ]]></Code>
<Arg><![CDATA[<Arg seed="8c440fae-2bba-4f6a-8fc1-2ed0dcb5d1fe" version="1"><Param name="定義整理區間幅度" varname="BoxRangePercents" type="1" subtype="0" value="7" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="定義區間高檔範圍" varname="HighAreaPercents" type="1" subtype="0" value="1.5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<TotalBar val="3" />
<Maxbb val="0" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="多次到頂而破" ID="ccb05338577c4f7381eea1eb531560ab" ReturnType="0" ExecType="3" Folder="/11.選股機器人/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[setbarfreq("AD");

input:HitTimes(3,"設定觸頂次數");
input:RangeRatio(2,"設定頭部區範圍寬度%");
input:Length(60,"計算期數");

variable: theHigh(0);
variable: HighLowerBound(0);
variable: TouchRangeTimes(0);

//找到過去其間的最高點
theHigh = Highest(High[1],Length);
value1=highestbar(high[1],length);

// 設為瓶頸區間上界
HighLowerBound = theHigh *(100-RangeRatio)/100;

//回算在此區間中 進去瓶頸區的次數
TouchRangeTimes = CountIF(High[1] > HighLowerBound, Length-value1);

Condition1 = TouchRangeTimes >= HitTimes;
Condition2 = close > theHigh;
Condition3 = close[length]*1.2<thehigh;

condition4=false;
if Condition1 and Condition2 and condition3
then condition4=true;

if barslast(condition4=true)=1
then ret=1;

outputfield(1, theHigh, 2, "區間高點", order := -1);
]]></Code>
<Arg><![CDATA[<Arg seed="44222d69-d42a-4fe8-be2e-4660ae552012" version="1"><Param name="設定觸頂次數" varname="HitTimes" type="1" subtype="0" value="3" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="設定頭部區範圍寬度%" varname="RangeRatio" type="1" subtype="0" value="2" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="計算期數" varname="Length" type="1" subtype="0" value="60" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<TotalBar val="10" />
<FirstBarDate val="0" />
<Maxbb val="0" />
<script>
<freq support="11" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="跌破糾結均線" ID="d7bd04430b64490d84d3d8f89064ce3a" ReturnType="0" ExecType="3" Folder="/02.基本技術指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[setbarfreq("AD");

input: shortlength(5); setinputname(1,"短期均線期數");
input: midlength(10); setinputname(2,"中期均線期數");
input: Longlength(20); setinputname(3,"長期均線期數");
input: Percent(5);  setinputname(4,"均線糾結區間%");
input: XLen(20);  setinputname(5,"均線糾結期數");

input: Volpercent(25);  setinputname(6,"放量幅度%");//帶量突破的量是超過最長期的均量多少%
variable: shortaverage(0);
variable: midaverage(0);
variable: Longaverage(0);
variable: AvgHLp(0),AvgH(0),AvgL(0);

shortaverage = average(close,shortlength);
midaverage = average(close,midlength);
Longaverage = average(close,Longlength);
	
AvgH = maxlist(shortaverage,midaverage,Longaverage);
AvgL = minlist(shortaverage,midaverage,Longaverage);

if AvgL > 0 then AvgHLp = 100*AvgH/AvgL -100;

condition1 = trueAll(AvgHLp < Percent,XLen);
condition2 = V >  average(V[1],XLen)*(1+Volpercent/100) ;
condition3 = average(Volume[1], 5) >= 2000;
condition4 = C < AvgL *(0.98) and L < lowest(L[1],XLen);

ret = condition1 and condition2 and condition3 and condition4;

outputfield(1,AvgH,2,"均線上緣", order := -1);
outputfield(2,AvgL,2,"均線下緣");
]]></Code>
<Arg><![CDATA[<Arg seed="7a40792b-11c1-49f9-89d8-497230438edd" version="1"><Param name="短期均線期數" varname="shortlength" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="中期均線期數" varname="midlength" type="1" subtype="0" value="10" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="長期均線期數" varname="Longlength" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="均線糾結區間%" varname="Percent" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="均線糾結期數" varname="XLen" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="放量幅度%" varname="Volpercent" type="1" subtype="0" value="25" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<TotalBar val="10" />
<FirstBarDate val="0" />
<Maxbb val="0" />
<script>
<freq support="11" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="營運現金流大於稅後盈餘" ID="670abc9cb5e84a109fe1fc5edccefb85" ReturnType="0" ExecType="1" Folder="/08.財報選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[settotalbar(3);

value1=GetField("來自營運之現金流量","Q");
value2=GetField("本期稅後淨利","Q");
if value1 > value2
then ret=1;
]]></Code>
<Arg><![CDATA[<Arg seed="e183ddfe-a867-4244-afb6-7c1fd6c58439" version="1" />]]></Arg>
<Extra><![CDATA[<Extra>
<script>
<freq support="14;8;9;10;11;12;13;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="跌破均線後站不回" ID="36a724a88f884a028ff2d62093fa2bb5" ReturnType="0" ExecType="3" Folder="/03.進階技術分析/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:day(3);			setinputname(1,"幾天內未站回");
input:length(20);		setinputname(2,"移動平均線期別");

settotalbar(length + 3);

if close[day-1] crosses under average(close[day-1], length) then
  begin
	variable: keyprice(0);
	
	keyprice = average(close[day-1], length);
	if trueall(close < keyprice, day-1) then ret = 1;
  end;
  
  

]]></Code>
<Arg><![CDATA[<Arg seed="5ebd135e-d2b3-4298-a9db-606c0134cf03" version="1"><Param name="幾天內未站回" varname="day" type="1" subtype="0" value="3" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="移動平均線期別" varname="length" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="-1" />
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="最近N日漲跌幅小於M%" ID="2ffceb7c24b94b87931cc1d795307f23" ReturnType="0" ExecType="1" Folder="/04.價量選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:period(10,"計算區間");
input:ratio(10,"最低漲跌幅");

value1 = rateofchange(close,period-1);
if value1 < ratio then ret=1;

outputfield(1,value1,1,"區間漲跌幅");
]]></Code>
<Arg><![CDATA[<Arg seed="46350dc2-4410-4257-b87c-3f173219f10f" version="1"><Param name="計算區間" varname="period" type="1" subtype="0" value="10" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="最低漲跌幅" varname="ratio" type="1" subtype="0" value="10" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<TotalBar val="3" />
<FirstBarDate val="0" />
<Maxbb val="0" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="除權後的填權行情" ID="b5b20696e3d84dbc840d2b0bef15762c" ReturnType="0" ExecType="3" Folder="/11.選股機器人/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[if  close[1]*1.1<close[20]
and close>close[1]*1.025
and volume>average(volume,20)
then ret=1;

value1=getbaroffset(dateadd(GetField("除權息日期"),"D",-1));
outputfield(1,close[value1],2,"除權參考價");
outputfield(2,-RateOfChange(c,value1),2,"貼權率%", order := 1);
]]></Code>
<Arg><![CDATA[<Arg seed="767ad0b4-1e0b-4998-a47e-4584e188f244" version="1" />]]></Arg>
<Extra><![CDATA[<Extra>
<TotalBar val="10" />
<FirstBarDate val="0" />
<Maxbb val="0" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="即將進入季節性空頭" ID="14aa8c3835d94049ab51178ce1624af2" ReturnType="0" ExecType="3" Folder="/09.時機操作/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[setbarfreq("AM");
settotalbar(3);

array:m1[7](0);
variable:x(0),count(0),avgdn(0);

avgdn=0;

for x=1 to 7 begin
	m1[x]=(close[12*x-1]-close[12*x])/close[12*x];
end;
count=0;
for x=1 to 7 begin
	if m1[x]<-0.02 then begin
		count=count+1;
		avgdn=avgdn+m1[x];
	end;
end;

if count>=6 and close>10
and average(volume,20)>20000
then ret=1;
]]></Code>
<Arg><![CDATA[<Arg seed="17c1c016-7942-4a89-8ec3-473a56fa72a3" version="1" />]]></Arg>
<Extra><![CDATA[<Extra>
<FirstBarDate val="0" />
<Maxbb val="0" />
<script>
<freq support="13" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="交易家數暴增" ID="52e8e2fca52843f9afc342e505b69c81" ReturnType="0" ExecType="1" Folder="/06.籌碼選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[value1=GetField("分公司交易家數","D");
value2=highest(GetField("分公司交易家數","D")[1],20);
if value1-value2>150
then ret=1;]]></Code>
<Arg><![CDATA[<Arg seed="fa0ab838-cf80-4c37-a2e6-cb349a43805b" version="1" />]]></Arg>
<Extra><![CDATA[<Extra>
<TotalBar val="10" />
<FirstBarDate val="0" />
<Maxbb val="0" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="有一定成交值且過去三日漲幅小" ID="432b34316ccb4922a18aedf027455c9b" ReturnType="0" ExecType="1" Folder="/04.價量選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:b1(1.5,"三日漲幅上限");
if volume*close>=30000
and close<=close[2]*(1+b1/100)
then ret=1;]]></Code>
<Arg><![CDATA[<Arg seed="dc7d9d06-a746-4006-8d51-2b71c396ef89" version="1"><Param name="三日漲幅上限" varname="b1" type="1" subtype="0" value="1.5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<TotalBar val="3" />
<FirstBarDate val="0" />
<Maxbb val="0" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="法人買超減融資佔成交量比重增加" ID="a03b674a1756491d934a5fd8dd2578e3" ReturnType="0" ExecType="1" Folder="/06.籌碼選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input: r1(15);				setinputname(1,"籌碼收集比例(%)");
input: volLimit(1000);		setinputname(2,"成交量下限(張)");

settotalbar(3);

value1 = (GetField("法人買賣超張數") - GetField("融資買進張數")) / Volume * 100;

if value1 > r1 and volume > volLimit then
ret = 1;

setoutputname1("法人籌碼收集比例(%)");
outputfield1(value1);

]]></Code>
<Arg><![CDATA[<Arg seed="f954dc47-d223-4bb0-85ad-d7fcb50d6dd4" version="1"><Param name="籌碼收集比例(%)" varname="r1" type="1" subtype="0" value="15" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="成交量下限(張)" varname="volLimit" type="1" subtype="0" value="1000" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<script>
<freq support="8;11;9;12;10;13" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="波動幅度開始變大" ID="ec2b785d114c4d97bfb19d7657958fb8" ReturnType="0" ExecType="3" Folder="/03.進階技術分析/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input: Length(20);		SetInputName(1, "計算區間");
input: VolLimit(1000); SetInputName(2, "成交量限制");

value1 = truerange();
value2 = highest(value1,Length);

SetTotalBar(Length + 3);

if 
	value1 > value2[1] and 
	value1 > value1[1] and 
	close * 1.01 > high and 
	close > close[1] and 
	volume > VolLimit
then ret=1;


]]></Code>
<Arg><![CDATA[<Arg seed="0db04ca6-045f-4c7a-9dbe-f33bc96fc722" version="1"><Param name="計算區間" varname="Length" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="成交量限制" varname="VolLimit" type="1" subtype="0" value="1000" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="-1" />
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="漲勢成形" ID="e085f15d0a1e4f668503f727b5411096" ReturnType="0" ExecType="3" Folder="/04.價量選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[Value1=linearregslope(close,3);
value2=linearregslope(close,5);
value3=linearregslope(close,20);

settotalbar(23);

if 
	value1 > value2 and 
	value2 > value3 and 
	value1 > value1[1] and 
	value1[1] > value1[2] and 
	value1 > 0.3 and 
	value3[2] < 0.1 and 
	value3 > 0
then ret=1;]]></Code>
<Arg><![CDATA[<Arg seed="e938cd7d-40ce-4467-a777-08cb83e8322f" version="1" />]]></Arg>
<Extra><![CDATA[<Extra>
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="23" />
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="法人連續買進達一定標準" ID="fcdf5f0080c242aaa72993da89596eb8" ReturnType="0" ExecType="1" Folder="/06.籌碼選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:day(5);			setinputname(1,"計算天數");
input:ratio1(40);		setinputname(2,"法人買進張數比例下限(%)");
input:times(2);			setinputname(3,"達標天數");
input:volLimit(500);	setinputname(4,"最小成交均量");

SetTotalBar(day + 3);

value1 = (GetField("外資買張") + GetField("投信買張"))/Volume * 100;
value2 = countif(value1 > ratio1, day);
if value2 >= times and average(volume, day) > volLimit then
ret = 1;

SetOutputName1("近日法人買進比例(%)");
OutputField1(value1);
]]></Code>
<Arg><![CDATA[<Arg seed="2b0c1e99-6dc7-4a24-9fdf-30389298ad47" version="1"><Param name="計算天數" varname="day" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="法人買進張數比例下限(%)" varname="ratio1" type="1" subtype="0" value="40" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="達標天數" varname="times" type="1" subtype="0" value="2" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="最小成交均量" varname="volLimit" type="1" subtype="0" value="500" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<script>
<freq support="8;11;9;12;10;13" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="-1" />
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="大跌後的急拉" ID="fd90f28e36594b9ea0de739f288c377f" ReturnType="0" ExecType="3" Folder="/04.價量選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[setbarfreq("AD");

value1=barslast(close>=close[1]*1.07);
if value1[1]>50
//超過50天沒有單日上漲超過7%
and value1=0
//今天上漲超過7%
and average(volume,100)>500
and volume>1000
and close[1]*1.25<close[30]
//過去三十天跌幅超過25%
then ret=1;

outputfield(1,lowest(L,50),2,"前波低點", order := -1);
]]></Code>
<Arg><![CDATA[<Arg seed="95ffe882-b719-4fd9-821f-68edcb50f8e9" version="1" />]]></Arg>
<Extra><![CDATA[<Extra>
<TotalBar val="10" />
<FirstBarDate val="0" />
<Maxbb val="0" />
<script>
<freq support="11" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="券補力道超過一定值" ID="fc8148ba28de4e7d9e3be60cc41a3113" ReturnType="0" ExecType="1" Folder="/06.籌碼選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[value1=GetField("融券餘額張數","D");
input:lowlimit(100,"券補力道下限");
if value1/average(volume,5)*100>lowlimit
then ret=1;]]></Code>
<Arg><![CDATA[<Arg seed="c8692b2e-d0b4-440d-9a65-fd46666dc1c4" version="1"><Param name="券補力道下限" varname="lowlimit" type="1" subtype="0" value="100" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<TotalBar val="10" />
<FirstBarDate val="0" />
<Maxbb val="0" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="新一代金牌定存股" ID="a6df60608b97493495ed091a95b1d288" ReturnType="0" ExecType="3" Folder="/10.價值投資/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:lowlimit(5,"年度獲利下限(億)");

value1=GetField("本期稅後淨利","Y");//單位:百萬
value2=lowest(value1,5);//五年獲利低點
value3=average(value1,5);//五年來平均獲利
if value1/100> lowlimit//獲利超過年度獲利下限
and value1/100<50//獲利沒有超過五十億元
and value1>value1[1]*0.9
and value1[1]>value1[2]*0.9//年度獲利連續兩年未衰退超過一成
and value2*1.3>value3
//五年來獲利最差的時候比平均值沒有掉超過三成

then ret=1;

outputfield(1, value1/100, 1, "稅後淨利(億)", order := 1);
]]></Code>
<Arg><![CDATA[<Arg seed="bba484e7-13b1-4160-b640-137a5c493e33" version="1"><Param name="年度獲利下限(億)" varname="lowlimit" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<TotalBar val="10" />
<FirstBarDate val="0" />
<Maxbb val="0" />
<script>
<freq support="16;8;9;10;11;12;13;14;15" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="股價距離合理價值很遠" ID="4f52393ed61c446cb69c826ed7e31cbe" ReturnType="0" ExecType="3" Folder="/10.價值投資/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[variable: idx(0), t(0);
input:r1(3, "假設未來十年營業利益年成長率");
input:r2(2, "未來十年平均年利率");
input:r3(100, "未來獲利折現合計淨值與市價比");

// 計算未來10年的營業利益折現值

value1=GetField("營業利益","Y");		//單位:百萬
value2=GetField("最新股本");			//單位:億
value3=GetField("每股淨值(元)","y");

value11 = maxlist(GetField("營業利益","Y"),GetField("營業利益","Y")[1],GetField("營業利益","Y")[2],GetField("營業利益","Y")[3],GetField("營業利益","Y")[4]);
value12 = minlist(GetField("營業利益","Y"),GetField("營業利益","Y")[1],GetField("營業利益","Y")[2],GetField("營業利益","Y")[3],GetField("營業利益","Y")[4]);

if trueall(value1>0,5) and (value11-value12)/value11<0.5 then begin
	t = 0;
	for idx =1 to 10 begin
		t = t + value1 * power(1+r1/100,idx)/power(1+r2/100,idx);
	end;

	// t=百萬,value2=億,換成每股
	value5 = t / value2 / 100;
	value6=close/(value3+value5);

	if value6<r3/100
	then ret=1;
end;

outputfield(1, value5, 2, "估算每股營業利益");
outputfield(2, value6, 1, "市價/淨值比", order := -1);
]]></Code>
<Arg><![CDATA[<Arg seed="8e6c39c1-c5c6-4a49-864a-1f51aa0c4944" version="1"><Param name="假設未來十年營業利益年成長率" varname="r1" type="1" subtype="0" value="3" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="未來十年平均年利率" varname="r2" type="1" subtype="0" value="2" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="未來獲利折現合計淨值與市價比" varname="r3" type="1" subtype="0" value="100" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<TotalBar val="3" />
<Maxbb val="0" />
<script>
<freq support="8;11" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="烏龜交易法則之賣出訊號" ID="df4a64412e20413aa8e1742b6dd837de" ReturnType="0" ExecType="3" Folder="/11.選股機器人/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[setbarfreq("AD");

condition1=false;
condition2=false;
 
if L=lowest(L,100)and barslast(L=lowest(L,100))[1]>100
then condition1=true; 
//創百日新低且上一次發生時是在100個交易日之前

if average(volume[1], 5) >= 1000
then condition2=true;

//五日移動平均量大於千張
if condition1 and condition2
then ret=1;
 
outputfield(1,lowest(L,100),2,"跌破低點", order := -1);
]]></Code>
<Arg><![CDATA[<Arg seed="a10b4640-2e33-4b0b-ae8a-0401e5a5d97f" version="1" />]]></Arg>
<Extra><![CDATA[<Extra>
<TotalBar val="10" />
<FirstBarDate val="0" />
<Maxbb val="0" />
<script>
<freq support="11" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="流通在外股數不多" ID="4c2a3f6c5fd9409793ce7d5777868a4a" ReturnType="0" ExecType="1" Folder="/06.籌碼選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[value1=GetField("最新股本");//單位:億
value2=GetField("董監持股佔股本比例","D");
value3=GetField("法人持股比例","D");
if value1*(1-value2/100-value3/100)<50
then ret=1;]]></Code>
<Arg><![CDATA[<Arg seed="4b2ee7a3-0b79-4c33-8a78-2715c012f48f" version="1" />]]></Arg>
<Extra><![CDATA[<Extra>
<TotalBar val="10" />
<FirstBarDate val="0" />
<Maxbb val="0" />
<script>
<freq support="8;11" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="做M頭的股票" ID="754d794e17f14117b393bc7dca1fe211" ReturnType="0" ExecType="3" Folder="/05.型態選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:day(60,"計算區間");//設定計算區間
input:GP(30,"波段漲幅下限");//設定波段漲幅下限，單位是%
input:pc(2,"M頭兩高點價差上限");//設定M頭兩高點價差上限，單位是%
input:rg(30,"波段低點到高點的最少天數");//波段低點到高點的最少天數
input:bc(4,"M谷底距離頭部最低跌幅");//M谷底距離頭部最低跌幅，單位是%

value1=highest(high,day);//找出波段最高點
value2=lowest(low,day);//找出波段最低點
value3=nthhighest(2,high,day);//波段第二高點
value4=nthhighestbar(1,high,day);//最高價在距今第幾根bar
value5=nthlowestbar(1,low,day);//最低價在距今第幾根bar
value6=nthhighestbar(2,high,day);//第二價在距今第幾根bar
value7=lowest(low,maxlist(value4,value6));//從第一個M頭以來的最低點
value8=nthlowestbar(1,low,maxlist(value4,value6));//谷底距今第幾根bar
condition1=false;
condition2=false;
condition3=false;
condition4=false;

if value1>value2*(1+gp/100) then condition1=true;//波段漲幅超過30%
if value5>maxlist(value4,value6)+rg then condition2=true;//低點在圖左邊
if value1<=value3*(1+pc/100) then condition3=true;//兩個高點之間的價差不大
if value8>minlist(value4,value6) and value8<minlist(value4,value6)
then condition4=true;//谷底在兩頭之間

if condition1 and condition2 and condition3 and condition4  
then ret=1;  
]]></Code>
<Arg><![CDATA[<Arg seed="6f89a17e-5e52-4953-bc54-630a577a3a3e" version="1"><Param name="計算區間" varname="day" type="1" subtype="0" value="60" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="波段漲幅下限" varname="GP" type="1" subtype="0" value="30" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="M頭兩高點價差上限" varname="pc" type="1" subtype="0" value="2" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="波段低點到高點的最少天數" varname="rg" type="1" subtype="0" value="30" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="M谷底距離頭部最低跌幅" varname="bc" type="1" subtype="0" value="4" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<TotalBar val="3" />
<Maxbb val="0" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="股價領先大盤創新高" ID="e6102164ca204568baa00b4eda423508" ReturnType="0" ExecType="3" Folder="/11.選股機器人/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input: Length(20, "布林通道天數");
input: BandRange(2, "上下寬度");
variable: up(0);

Condition1 = GetSymbolField("TSE.TW","收盤價","D") > average(GetSymbolField("TSE.TW","收盤價","D"),10);
Condition2 = average(GetSymbolField("TSE.TW","收盤價","D"),5) > average(GetSymbolField("TSE.TW","收盤價","D"),20);

value1=close/GetSymbolField("TSE.TW","收盤價","D");
up = bollingerband(value1, Length, BandRange);
Condition3 = TrueAll(value1 >= up, 3);

// 成交量判斷
Condition99 = Average(Volume[1], 100) >= 1000;

if Condition1 And Condition2 And Condition3 And Condition99 then ret=1;

outputfield(1, rateofchange(c,5), 2, "5日漲幅%", order := 1);
outputfield(2, rateofchange(GetSymbolField("TSE.TW","收盤價","D"),5), 2, "大盤5日漲幅%");
]]></Code>
<Arg><![CDATA[<Arg seed="87dbf23b-011a-4add-b28f-95d84c4db748" version="1"><Param name="布林通道天數" varname="Length" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="上下寬度" varname="BandRange" type="1" subtype="0" value="2" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<TotalBar val="10" />
<FirstBarDate val="0" />
<Maxbb val="0" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="RSI死亡交叉" ID="d7ec1c419e82402abd4f561470a8e8f4" ReturnType="0" ExecType="1" Folder="/02.基本技術指標/" StatusMask="2">
<Desc><![CDATA[RSI指標出現死亡交叉。]]></Desc>
<Code><![CDATA[// RSI短天期往下穿越長天期
//
input: ShortLength(6), LongLength(12);

settotalbar(maxlist(ShortLength,LongLength,6) * 9);

SetInputName(1, "短期期數");
SetInputName(2, "長期期數");

Ret = RSI(Close, ShortLength) Crosses Below RSI(Close, LongLength);



]]></Code>
<Arg><![CDATA[<Arg seed="42c14c8b-fc40-4022-868d-6116d4e5ddd9" version="1"><Param name="短期期數" varname="ShortLength" type="1" subtype="0" value="6" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="長期期數" varname="LongLength" type="1" subtype="0" value="12" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<Maxbb val="7" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="-1" />
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="低修正型股價淨值比" ID="5c2c253959e843f999c8d20bf764b3c6" ReturnType="0" ExecType="1" Folder="/08.財報選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:r1(1);		setinputname(1,"股價淨值比上限");

SetTotalBar(3);

value1 = average(GetField("營業利益成長率", "Y"), 6);		// 近六年平均營業利益成長率
value2 = GetField("每股淨值(元)","Q") * (1 + value1/100);	// 修正後每股淨值
value3 = close / value2;									// 修正後股價淨值比

if 0 < value3 and value3 < r1
then ret=1;

SetOutputName1("修正後股價淨值比");
OutputField1(value3);

]]></Code>
<Arg><![CDATA[<Arg seed="8c896001-c69a-450b-b2b4-8632a17e259c" version="1"><Param name="股價淨值比上限" varname="r1" type="1" subtype="0" value="1" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="N期股價趨勢向上" ID="f317e8743f7c48aaa58311b9b2a8a5fe" ReturnType="0" ExecType="1" Folder="/00.語法範例/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input: Period(10); SetInputName(1, "期別");

settotalbar(3);

Condition1 = rateofchange(close, period) >= Period;
Condition2 = close > close[Period/2];
Condition3 = close > average(close, period);

ret = condition1 and condition2 and condition3;
]]></Code>
<Arg><![CDATA[<Arg seed="1916b220-7028-49ce-8ac9-dd8264799556" version="1"><Param name="期別" varname="Period" type="1" subtype="0" value="10" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="上昇旗形" ID="a1604141038247eda588350a1b3998ca" ReturnType="0" ExecType="3" Folder="/05.型態選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[setbarfreq("AD");

input:period(20,"計算區間");

value2=nthhighest(1,high[1],period);//最高價
value3=nthhighest(2,high[1],period);//第二高價
value4=nthhighest(3,high[1],period);//第三高價
value5=nthhighestbar(1,high[1],period);//最高價距今幾根bar
value6=nthhighestbar(2,high[1],period);//第二高價距今幾根bar
value7=nthhighestbar(3,high[1],period);//第三高價距今幾根bar

condition1=false;
condition2=false;

if value6-value5>3 and value7-value6>3
then condition1=true;//三個高點沒有連在一起，且是愈來愈高

if maxlist(value2,value3,value4)<minlist(value2,value3,value4)*1.07
then condition2=true;//三個高點沒有差多少

 
if condition1 and condition2  
and close crosses over value2
and close[period]*1.05<value2
then ret=1;

outputfield(1, value2, 2, "前波高點", order := -1);
]]></Code>
<Arg><![CDATA[<Arg seed="89843842-811b-460d-a8d6-5a6777b059f8" version="1"><Param name="計算區間" varname="period" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<script>
<freq support="11" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="預估殖利率高的" ID="e7da2cd61ef6493986bee7c35adbba58" ReturnType="0" ExecType="3" Folder="/08.財報選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[value1=GetField("營業利益","Q");//單位:百萬
value2=GetField("月營收","M");//單位:億
value3=GetField("營業利益率","Q");
value4=SUMMATION(GETFIELD("月營收","M"),3);//近三個月營收
value5=value4*value3/100;
//用最近一期營益率去估算的最近一季營業利益
value6=SUMMATION(GetField("營業利益","Q"),3)+value5*100;
//前三季營業利益加上最近一季預估營業利益
value8=GetField("最新股本");//單位億
value9=value6/(value8*100)*10;
//估算出來的EPS

value10=value9/close*100;
//eps/股價*100: 預估殖利率

if value10>10 and value3>0 and close>10
then ret=1;
outputfield(1,value10,1,"殖利率");
outputfield(2,value9,1,"預估EPS");

]]></Code>
<Arg><![CDATA[<Arg seed="c9cfb0dd-6df6-43fd-ad9d-811baec6663e" version="1" />]]></Arg>
<Extra><![CDATA[<Extra>
<TotalBar val="3" />
<FirstBarDate val="0" />
<Maxbb val="0" />
<script>
<freq support="8;11" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="集保張數減少中" ID="f625e0da56a94cd880dce05c1b09e3f5" ReturnType="0" ExecType="1" Folder="/06.籌碼選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input: n(3);			setinputname(1, "計算期間(週)");
input: Amount(1000);	setinputname(2, "減少張數(張)");

SetTotalBar(3);

// 單位=萬張
Value1 = (GetField("集保張數","W")[n] - GetField("集保張數","W")) * 10000;
if Value1 > Amount then
ret = 1;

setoutputname1("減少張數(張)");
OutputField1(Value1);

 ]]></Code>
<Arg><![CDATA[<Arg seed="7883fdf9-27bd-41d1-9d3a-45fb6f76642b" version="1"><Param name="計算期間(週)" varname="n" type="1" subtype="0" value="3" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="減少張數(張)" varname="Amount" type="1" subtype="0" value="1000" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<script>
<freq support="9;8;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="高護城河" ID="9ea497a85beb421f87c8eaf208f3ca60" ReturnType="0" ExecType="3" Folder="/08.財報選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[condition1=false;
condition2=false;
condition3=false;

if trueall(GetField("營業毛利率","Y") >=10,5)
then condition1=true;

if trueall(GetField("來自營運之現金流量","Y")>100,5)
then condition2=true;

if trueall(GetField("股東權益報酬率","Y")>20,5)
then condition3=true;

if condition1 and condition2 and condition3
then ret=1;

outputfield(1,GetField("營業毛利率","Y"),2,"營業毛利率%", order := 1);
]]></Code>
<Arg><![CDATA[<Arg seed="af8a66ff-313d-40b6-8e4c-9bd9c9af0ab3" version="1" />]]></Arg>
<Extra><![CDATA[<Extra>
<FirstBarDate val="0" />
<Maxbb val="0" />
<TotalBar val="3" />
<script>
<freq support="16;8;9;10;11;12;13;14;15" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="法人大買而股價尚未發動" ID="aac4fec4a43c4c63ae2807440264632b" ReturnType="0" ExecType="1" Folder="/06.籌碼選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:day(10);			setinputname(1,"連續買超天數");
input:amount(100);		setinputname(2,"每日至少買超張數(張)");
input:percent1(3);		setinputname(3,"漲幅上限(%)");

SetTotalBar(3);

if trueall(GetField("法人買賣超張數") > amount, day) and 
   RateOfChange(Close, day) < percent1
then ret=1;

]]></Code>
<Arg><![CDATA[<Arg seed="86b6a8b1-5532-45f8-9961-b58344edf1c9" version="1"><Param name="連續買超天數" varname="day" type="1" subtype="0" value="10" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="每日至少買超張數(張)" varname="amount" type="1" subtype="0" value="100" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="漲幅上限(%)" varname="percent1" type="1" subtype="0" value="3" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<script>
<freq support="8;11;9;12;10;13" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="營運現金流量的持續積累" ID="8baab43fb03c43ef97f2449f83517dcf" ReturnType="0" ExecType="3" Folder="/10.價值投資/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:ratio(50, "比例");//總市值減去淨值是十年營運現金流的的多少百分比, 單位是%

var: nv(0);
value1=GetField("來自營運之現金流量","q");//單位百萬
value2=GetField("總市值","D");//單位億
value3=summation(value1,8);//最近八季的營運現金流總和
value4=value3*5;//以最近兩年來推未來十年營運現金流總和

nv=GetField("股東權益總額","Q");//單位百萬
if value2*100-nv<value4*ratio/100
then ret=1;

outputfield(1, 100*value2/value4,1, "市值/現金流", order := -1);
]]></Code>
<Arg><![CDATA[<Arg seed="03f50814-de23-459e-9da9-e217df72fa21" version="1"><Param name="比例" varname="ratio" type="1" subtype="0" value="50" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<TotalBar val="3" />
<Maxbb val="0" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="毛利率上昇月營收成長" ID="8de6352795a6493c9d5c1adc485bd32e" ReturnType="0" ExecType="3" Folder="/08.財報選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[value1=GetField("月營收月增率","M");
value2=GetField("營業毛利率","Q");
if value1>value1[1]
and value2>value2[1]
then ret=1;


 
 


]]></Code>
<Arg><![CDATA[<Arg seed="80195b4e-5721-49ae-be06-78bd867a9f54" version="1" />]]></Arg>
<Extra><![CDATA[<Extra>
<TotalBar val="10" />
<FirstBarDate val="0" />
<Maxbb val="0" />
<script>
<freq support="10;8;9;11;12;13;14;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="本益比小於X倍" ID="6035922ba7744d5e867798620106725a" ReturnType="0" ExecType="1" Folder="/00.語法範例/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[Input: X(10); SetInputName(1, "本益比(倍)");

settotalbar(3);

Value1 = GetField("本益比", "D");
if Value1 < X then Ret = 1;

SetOutputName1("本益比(倍)");
outputfield1(Value1);


]]></Code>
<Arg><![CDATA[<Arg seed="a8f60b9a-2ba7-48d3-af1c-47cd95ff182c" version="1"><Param name="本益比(倍)" varname="X" type="1" subtype="0" value="10" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="布林帶寬大於N%" ID="35c24fefceb7423195502a1d16f9b04a" ReturnType="0" ExecType="1" Folder="/03.進階技術分析/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input: 
	Length(20, "天數"), 
	UpperBand(2, "上"), 
	LowerBand(2, "下"),
	BBW(80,"N");
	
variable: 
	bbandwidth(0);

bbandwidth = bollingerbandwidth(Close, Length, UpperBand, LowerBand);

if bbandwidth >= BBW then ret=1;

outputfield(1,bbandwidth,2,"布林帶寬");
]]></Code>
<Arg><![CDATA[<Arg seed="8d5bf588-e620-4390-ae0f-30310a287a78" version="1"><Param name="天數" varname="Length" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="上" varname="UpperBand" type="1" subtype="0" value="2" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="下" varname="LowerBand" type="1" subtype="0" value="2" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="N" varname="BBW" type="1" subtype="0" value="80" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<TotalBar val="10" />
<FirstBarDate val="0" />
<Maxbb val="0" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="ROE漸入佳境" ID="44c440011e794bb0a539bf6cddfee0e3" ReturnType="0" ExecType="1" Folder="/08.財報選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[value1=GetField("股東權益報酬率","Q");
if GetField("股東權益報酬率","Q")>GetField("股東權益報酬率","Q")[1]
and GetField("股東權益報酬率","Q")>GetField("股東權益報酬率","Q")[4]
then ret=1; ]]></Code>
<Arg><![CDATA[<Arg seed="4fc63ffd-e361-490d-8a56-60bd44f60267" version="1" />]]></Arg>
<Extra><![CDATA[<Extra>
<TotalBar val="3" />
<Maxbb val="0" />
<script>
<freq support="14;8;9;10;11;12;13;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="投信掃貨" ID="c43728b5be96414f846339d35206ee48" ReturnType="0" ExecType="3" Folder="/11.選股機器人/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input: pastDays(5, "計算天數");
input: _BuyRatio(10, "買超佔比例(%)");

variable: SumForce(0);
variable: SumTotalVolume(0);

SumForce = Summation(GetField("投信買賣超"), pastDays);
sumTotalVolume = Summation(Volume, pastDays);
value1 = SumForce / SumTotalVolume * 100;
if value1 > _BuyRatio then ret =1;

outputfield(1,value1,2,"投信買超%", order := 1);
]]></Code>
<Arg><![CDATA[<Arg seed="13e41748-5a71-45cc-8cb2-66e0106a17bc" version="1"><Param name="計算天數" varname="pastDays" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="買超佔比例(%)" varname="_BuyRatio" type="1" subtype="0" value="10" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<FirstBarDate val="0" />
<Maxbb val="0" />
<TotalBar val="3" />
<script>
<freq support="8;11;9;12;10;13" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="外資先前沒買，突然連買三天" ID="b6e3cccab9354a98870c78d755c1968c" ReturnType="0" ExecType="3" Folder="/11.選股機器人/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[setbarfreq("AD");

input: _period(20, "期間");
input: _ratio(5, "買超占成交比重");

condition1 = trueall(GetField("外資買賣超","D")[3]=0, _period);
condition2 = trueall(GetField("外資買賣超","D")*100/volume>=_ratio,3);

if condition1 and condition2 
then ret=1;

value1 = Summation(GetField("外資買賣超","D"), 3) / Summation(Volume, 3) * 100;
outputfield(1,value1,2,"外資買超%", order := 1);
]]></Code>
<Arg><![CDATA[<Arg seed="27e42a60-cbb2-4717-acc4-79e6168ba0a6" version="1"><Param name="期間" varname="_period" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="買超占成交比重" varname="_ratio" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<TotalBar val="3" />
<Maxbb val="0" />
<script>
<freq support="11" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="總市值接近歷史低點" ID="fbbf0cd7295d45e699e7a347a60f8d49" ReturnType="0" ExecType="1" Folder="/08.財報選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input: r1(5);			setinputname(1, "接近低點幅度(%)");
//input:TXT("僅適用月資料"); setinputname(2,"使用限制");
setbarfreq("M");

if barfreq <> "M" then raiseruntimeerror("頻率錯誤");

settotalbar(3);

value1=GetField("總市值","M");
value2=nthlowest(1,GetField("總市值","M"),48);
value3=nthlowest(1,GetField("總市值","M"),24);

if absvalue(value2-value3)*100 / value3 < r1
then 
  begin
	if (value1-value2) * 100 / value2 < r1 and
	   (value1-value3) * 100 / value3 < r1 
	then
		ret=1;
  end;
	
SetOutputName1("最近市值(億)");
OutputField1(value1);
]]></Code>
<Arg><![CDATA[<Arg seed="8e6039de-8dd0-4036-b09f-3427186813b0" version="1"><Param name="接近低點幅度(%)" varname="r1" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<script>
<freq support="10;13" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="過濾沒賺錢的股票" ID="2144f66280ee4369b61aa8a291da7e9e" ReturnType="0" ExecType="1" Folder="/01.常用過濾條件/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[// 過去四季每股盈餘加總必須 > 0
//
SetTotalbar(3);

Value1 = summation(GetField("EPS","Q"), 4);
Ret = Value1 > 0;

]]></Code>
<Arg><![CDATA[<Arg seed="2fc12660-faff-4b4a-a3a1-a64df1022437" version="1" />]]></Arg>
<Extra><![CDATA[<Extra>
<script>
<freq support="14;8;9;10;11;12;13;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="營收市值比位於歷史低檔" ID="f950ea66fc4d4c359e08dcf73a83c8b5" ReturnType="0" ExecType="3" Folder="/08.財報選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:period(60,"計算月數");
input:ratio(10,"距離低點幅度");
setbarfreq("M");
settotalbar(period);

value1=GetField("總市值","M");//單位:億元
value2=GetField("月營收","M");//單位:億元
if value2<>0 then 
	value3=value1/value2
else
	value3=0;

if value3<lowest(value3,period)*(1+ratio/100)
//總市值營收比值距離過去一段時間最低點沒有差多遠
and value3>0
then ret=1;
outputfield(1,value3,2,"總市值/月營收");
outputfield(2,lowest(value3,period),2,"期間最低值");
outputfield(3,value3/lowest(value3,period),2,"兩者的比率");
]]></Code>
<Arg><![CDATA[<Arg seed="8b954681-74d7-4929-a098-3b2cac5b865f" version="1"><Param name="計算月數" varname="period" type="1" subtype="0" value="60" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="距離低點幅度" varname="ratio" type="1" subtype="0" value="10" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<FirstBarDate val="0" />
<Maxbb val="0" />
<script>
<freq support="10;13" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="-1" />
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="本業可能轉虧為盈" ID="6554557ecffe43cba5cbe0b00288f37b" ReturnType="0" ExecType="1" Folder="/08.財報選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[
SetTotalbar(3);

// 計算最新一期月營收的日期(mm=月份)
//
variable: mm(0);
mm = datevalue(getfielddate("月營收","M"),"M");

// 預估最新一季的季營收(單位=億)
//
if mm=1 or mm=4 or mm=7 or mm=10
then value1=GetField("月營收","M") * 3;
if mm=2 or mm=5 or mm=8 or mm=11
then value1=GetField("月營收","M") * 2 + GetField("月營收","M")[1];
if mm=3 or mm=6 or mm=9 or mm=12
then value1=GetField("月營收","M")+GetField("月營收","M")[1]+GetField("月營收","M")[2];

// 預估獲利(單位=百萬) = 季營收 * 毛利率 - 營業費用
//
value2 = value1 * GetField("營業毛利率","Q") - GetField("營業費用","Q");

if value2 > 0 and GetField("營業利益","Q") < 0 then
ret = 1;

SetOutputName1("預估單季營收(億)");
OutputField1(value1);

SetOutputName2("預估單季本業獲利(億)");
OutputField2(value2 / 100);



]]></Code>
<Arg><![CDATA[<Arg seed="ff61baf0-d5c4-4166-bf3d-0037e4251996" version="1" />]]></Arg>
<Extra><![CDATA[<Extra>
<script>
<freq support="10;8;9;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="大跌後法人散戶清浮額" ID="9977ae93a9414cfb8e85b5cb659d737b" ReturnType="0" ExecType="1" Folder="/06.籌碼選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:period(10);	setinputname(1,"計算跌幅區間");
input:percent1(10);	setinputname(2,"區間最小跌幅");

settotalbar(3);

value1=GetField("法人買賣超張數");
value2=GetField("融資增減張數");

if close[period-1] >= close*(1+percent1/100) and 
   value1 < 0 and 
   value2 < 0 and 
   close > close[1]
then ret=1;]]></Code>
<Arg><![CDATA[<Arg seed="b160f9fb-88e3-4d47-a57d-4728c8a64e45" version="1"><Param name="計算跌幅區間" varname="period" type="1" subtype="0" value="10" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="區間最小跌幅" varname="percent1" type="1" subtype="0" value="10" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<script>
<freq support="8;11;9;12;10;13" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="本業推估本益比低於N" ID="6a1f431d34884287873ea574644d04dc" ReturnType="0" ExecType="1" Folder="/10.價值投資/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:peuplimit(15,"預估本益比上限");
value3= summation(GetField("營業利益","Q"),4); //單位百萬;
value4= GetField("最新股本");//單位億;
value5= value3/(value4*10);//每股預估EPS
if value5>0 and close/value5<=peuplimit
then ret=1;]]></Code>
<Arg><![CDATA[<Arg seed="0ff94eac-89bb-4d05-aa5b-b81a764ce9d4" version="1"><Param name="預估本益比上限" varname="peuplimit" type="1" subtype="0" value="15" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<TotalBar val="3" />
<Maxbb val="0" />
<script>
<freq support="8;11" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="獲利追不上固定資本支出" ID="9579aca21ec24985ab09d46e4b8c4ec3" ReturnType="0" ExecType="1" Folder="/08.財報選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:r1(3);		setinputname(1,"連續幾年資本支出增加的速度比稅後淨利高");
//input:TXT("僅適用年資料"); setinputname(2,"使用限制");
setbarfreq("Y");

if barfreq <> "Y" then raiseruntimeerror("頻率錯誤");

settotalbar(3);

if trueall(
	GetField("本期稅後淨利","Y") - GetField("本期稅後淨利","Y")[1] <
	GetField("固定資產","Y") - GetField("固定資產","Y")[1],
	r1)
then ret=1;
]]></Code>
<Arg><![CDATA[<Arg seed="5c764e77-4277-4913-ab77-ccb96a449b19" version="1"><Param name="連續幾年資本支出增加的速度比稅後淨利高" varname="r1" type="1" subtype="0" value="3" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<script>
<freq support="16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="帶量突破均線後未拉回" ID="a1e5161fe1fc4138a4b248190514c216" ReturnType="0" ExecType="3" Folder="/03.進階技術分析/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:day(5);		setinputname(1,"幾天內未站回");
input:length(10);	setinputname(2,"移動平均線期別");
input:percent(20);	setinputname(3,"突破當日成交量超過均量多少%");

SetTotalBar(3);

value1=average(close,length);
value2=average(volume,length);

if close[day-1] crosses over average(close[day-1], length) and
   volume[day-1] > average(volume[day-1], length) * (1+percent/100) and
   volume > 1000
then
  begin
	variable: keyprice(0);
	
	keyprice = average(close[day-1], length);
	if trueall(close > keyprice, day-1) then ret = 1;
  end;
]]></Code>
<Arg><![CDATA[<Arg seed="f301bd80-ab99-4b60-af79-35b030fefd30" version="1"><Param name="幾天內未站回" varname="day" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="移動平均線期別" varname="length" type="1" subtype="0" value="10" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="突破當日成交量超過均量多少%" varname="percent" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="股價下跌而外盤量佔比上升" ID="fc4b6b9c52db4a92814a06dadacea11a" ReturnType="0" ExecType="1" Folder="/03.進階技術分析/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:period(20);		setinputname(1,"計算天期");

settotalbar(period * 2 + 3);

value1 = GetField("外盤量");//日的外盤量
if volume <> 0 then 
	value2 = value1 / volume
else
	value2 = 0;

value3 = average(value2, period);
if linearregslope(value3,period) > 0 and
   linearregslope(close,period) < 0 and 
   volume > 1000
then ret=1;


]]></Code>
<Arg><![CDATA[<Arg seed="2d01c655-c6e5-49eb-9a7f-dda1c6267d9e" version="1"><Param name="計算天期" varname="period" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<script>
<freq support="8;11" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="-1" />
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="盤整後跌破" ID="92f33b569a9b4bd08c8cecbdc1fa77ab" ReturnType="0" ExecType="1" Folder="/03.進階技術分析/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:length(20); 	setinputname(1, "計算期間");
input:percent(7); 	setinputname(2, "設定盤整區間%");

SetTotalBar(3);

value1 = highest(high[1],length);
value2 = lowest(low[1],length);

if 
	close crosses under value2 and 
	value1 < value2 *( 1 + percent * 0.01) //最近幾根bar的收盤價高點與低點差不到N%
then ret=1;
]]></Code>
<Arg><![CDATA[<Arg seed="1bd3f35d-3a4d-4822-8a5b-afe6324d8b40" version="1"><Param name="計算期間" varname="length" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="設定盤整區間%" varname="percent" type="1" subtype="0" value="7" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="EPS連續N季都大於X元" ID="ac27b7c7b2b94a84a689499d2b438ca7" ReturnType="0" ExecType="1" Folder="/00.語法範例/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:N(4); setinputname(1, "期別");
input:X(1); setinputname(2, "元"); 

SetTotalBar(3); 

if TrueAll(GetField("EPS", "Q") > X,N) then ret=1; 

SetOutputName1("EPS(元)(季)"); 
OutputField1(GetField("EPS", "Q")); 
]]></Code>
<Arg><![CDATA[<Arg seed="de23149c-9210-4a8e-8710-335d1e4faa4a" version="1"><Param name="期別" varname="N" type="1" subtype="0" value="4" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="元" varname="X" type="1" subtype="0" value="1" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<script>
<freq support="14;8;9;10;11;12;13;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="RSI黃金交叉且股價非盤整" ID="c9e73409575c45b3aa195eaac7b726ff" ReturnType="0" ExecType="3" Folder="/03.進階技術分析/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:n1(6); 	setinputname(1,"RSI短期天數");
input:n2(12);	setinputname(2,"RSI長期天數");
input:n3(4);	setinputname(3,"盤整期間創新高次數");


settotalbar(maxlist(n1,n2,6) * 9);

value2 = highdays(n2);

if rsi(close,n1) crosses over rsi(close,n2) and
   rsi(close,n1) < 50 and
   value2 >= n3
then ret=1;

]]></Code>
<Arg><![CDATA[<Arg seed="a887c134-1f8a-4ada-97bb-0f8be7c11c84" version="1"><Param name="RSI短期天數" varname="n1" type="1" subtype="0" value="6" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="RSI長期天數" varname="n2" type="1" subtype="0" value="12" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="盤整期間創新高次數" varname="n3" type="1" subtype="0" value="4" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<Maxbb val="12" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="-1" />
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="短期均線跌破長期均線" ID="16c025c0a56a4fa58382f3537dfca082" ReturnType="0" ExecType="1" Folder="/02.基本技術指標/" StatusMask="2">
<Desc><![CDATA[短天期均線向下跌破長天期均線。]]></Desc>
<Code><![CDATA[input: Shortlength(5); setinputname(1,"短期均線期數");
input: Longlength(20); setinputname(2,"長期均線期數");

settotalbar(3);

If Average(Close,Shortlength) crosses under Average(Close,Longlength) then Ret=1;



]]></Code>
<Arg><![CDATA[<Arg seed="7aeab962-aed6-4663-bf81-467eb17f9490" version="1"><Param name="短期均線期數" varname="Shortlength" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="長期均線期數" varname="Longlength" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="近四季EPS合計大於N元" ID="098f8b819a3148be94079eb5acdcd00e" ReturnType="0" ExecType="1" Folder="/08.財報選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:n1(3);
setinputname(1,"每股稅後淨利最低標準");
value1=GetField("每股稅後淨利(元)","Q");
value2=summation(value1,4);
if value2>=n1
then ret=1;
]]></Code>
<Arg><![CDATA[<Arg seed="3f829084-6c8c-45fc-873a-68ed9ec0cfec" version="1"><Param name="每股稅後淨利最低標準" varname="n1" type="1" subtype="0" value="3" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<TotalBar val="3" />
<Maxbb val="0" />
<script>
<freq support="14;8;9;10;11;12;13;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="均線多頭排列" ID="3de51fb8db5c4e738dc4a4d2199c38b9" ReturnType="0" ExecType="1" Folder="/02.基本技術指標/" StatusMask="2">
<Desc><![CDATA[均線呈現多頭排列。]]></Desc>
<Code><![CDATA[input:Leng1(5),Leng2(20),Leng3(60);

variable: ma1(0), ma2(0), ma3(0);

SetInputName(1,"短均線");
SetInputName(2,"中均線");
SetInputName(3,"長均線");

settotalbar(3);

ma1 = average(close, Leng1);
ma2 = average(close, Leng2);
ma3 = average(close, Leng3);

condition1 = close > ma1;
condition2 = ma1 > ma2;
condition3 = ma2 > ma3;

if condition1 and condition2 and condition3 then 
ret = 1;

SetOutputName1("短均線");   
OutputField1(ma1);
SetOutputName2("中均線");   
OutputField2(ma2);
SetOutputName3("長均線");   
OutputField3(ma3);







]]></Code>
<Arg><![CDATA[<Arg seed="74807455-bc07-469e-aa8c-18052eb677c6" version="1"><Param name="短均線" varname="Leng1" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="中均線" varname="Leng2" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="長均線" varname="Leng3" type="1" subtype="0" value="60" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="收盤價近N期跌幅大於X%以上" ID="9898c5cb26c54cfe96c6c81a2533f2e6" ReturnType="0" ExecType="1" Folder="/00.語法範例/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:N(10);	SetInputName(1, "期別");
input:X(5); 	SetInputName(2, "跌幅%");

SetTotalBar(3); 

Value1 = RateOfChange(GetField("收盤價"),N);
if Value1 < -1 * X then ret=1;
 
SetOutputName1("近期跌幅%"); 
OutputField1(Value1); ]]></Code>
<Arg><![CDATA[<Arg seed="4ebb6297-f64d-43e1-9499-b1e8a2ec90ab" version="1"><Param name="期別" varname="N" type="1" subtype="0" value="10" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="跌幅%" varname="X" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<Maxbb val="0" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="EPS連續N年都大於X元" ID="760dcf3c4e034747b640a4913243ba92" ReturnType="0" ExecType="1" Folder="/00.語法範例/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:N(4); setinputname(1, "期別");
input:X(1); setinputname(2, "元"); 

SetTotalBar(3); 

if TrueAll(GetField("EPS", "Y") > X,N) then ret=1; 

SetOutputName1("EPS(元)(年)"); 
OutputField1(GetField("EPS", "Y")); 
]]></Code>
<Arg><![CDATA[<Arg seed="e6bc6218-b09e-4a85-b427-305b06ed2369" version="1"><Param name="期別" varname="N" type="1" subtype="0" value="4" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="元" varname="X" type="1" subtype="0" value="1" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<Maxbb val="0" />
<script>
<freq support="16;8;9;10;11;12;13;14;15" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="大漲股" ID="4dae3554789f403b9b2105975c8f7b3b" ReturnType="0" ExecType="1" Folder="/04.價量選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[condition1=false;
condition2=false;
condition3=false;
//先把簡單的價量條件全部放在condition1
if highest(high,3)<lowest(low,3)*1.15
//區間震盪小於15%
and close>5 
//股價大於5元
and close<200
//股價小於5元
and volume>300
//當日成交量大於300張
and high=highest(high,2)
//創兩日來新高
and close>close[1]*1.02
//最近一日上漲超過2%
then condition1=true;

//用condition2來處理月線斜率大於0.4
value1=average(close,20);
//先算出月線
value2=linearregslope(value1,10);
//算出季線這十天的斜率
if value2>0.4 then condition2=true;
//月線斜率要大於0.4

//處理布林帶寬
input:length(20,"計算天期");
input:width(35,"帶寬%");
variable:up1(0),down1(0),mid1(0),bbandwidth(0);
up1 = bollingerband(Close, Length, 1);
down1 = bollingerband(Close, Length, -1 );
mid1 = (up1 + down1) / 2;

bbandwidth = 100 * (up1 - down1) / mid1;
if bbandwidth <width
then condition3=true;

ret=condition1 and condition2 and condition3;]]></Code>
<Arg><![CDATA[<Arg seed="654635c3-01b9-4450-8419-8c8fa1d76542" version="1"><Param name="計算天期" varname="length" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="帶寬%" varname="width" type="1" subtype="0" value="35" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<TotalBar val="10" />
<FirstBarDate val="0" />
<Maxbb val="0" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="月營收創N期新高" ID="6461078a80404771b68c2700849d9a27" ReturnType="0" ExecType="1" Folder="/00.語法範例/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:N(13); setinputname(1, "期別"); 

SetTotalBar(3); 

if GetField("月營收", "M") >= Highest(GetField("月營收", "M"),N) then ret=1; 

SetOutputName1("月營收"); 
OutputField1(GetField("月營收", "M")); 
]]></Code>
<Arg><![CDATA[<Arg seed="3e44fcc7-6c16-4038-ab39-8ea64e96df45" version="1"><Param name="期別" varname="N" type="1" subtype="0" value="13" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<script>
<freq support="10;8;9;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="可能有填權行情的股票" ID="79a0a6d9c872459c9c7736c32ff0f3d4" ReturnType="0" ExecType="3" Folder="/09.時機操作/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[value1=GetField("除權日期");
value2=GetField("每股稅後淨利(元)","Y");
if value1>date
and datediff(value1,date)<5
//除權後五天內
and trueall(close<close[1]*1.02,3)
//除權前後未大漲
and value2>=2
//每股稅後淨利大於2元
then ret=1;
outputfield(1,value1,0,"今年度除權日");
]]></Code>
<Arg><![CDATA[<Arg seed="5d5ba930-066e-4331-9981-9e62c09279c8" version="1" />]]></Arg>
<Extra><![CDATA[<Extra>
<TotalBar val="10" />
<FirstBarDate val="0" />
<Maxbb val="0" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="上市股可以發行權證的流動性條件" ID="04c2194920154183835ed7caaa3f922e" ReturnType="0" ExecType="1" Folder="/08.財報選股/" StatusMask="2">
<Desc><![CDATA[使用時請設定篩選範圍為上市股。
]]></Desc>
<Code><![CDATA[{
	1. 市值超過100億元
	
	2. (a or b)
		a. 最近3個月成交股數佔已發行股份總額比例達20%以上。
		b. 最近三個月月平均成交股數達1億股以上。

	3. 最近期經會計師查核或核閱之財務報告無虧損
}

settotalbar(3);

// 近三個月成交股數佔以發行股份比例
//
Value1 = Summation(GetField("成交量", "M"), 3) * 100 / (GetField("發行張數","D") * 10000);

// 最近三個月月平均成交股數
//
Value2 = Average(GetField("成交量", "M"), 3) * 1000;

if GetField("總市值","D") >= 100 and 
   (Value1 >= 20 or Value2 >= 10000000) and 
   GetField("每股稅後淨利(元)","Q") > 0 
then 
Ret = 1;


 ]]></Code>
<Arg><![CDATA[<Arg seed="31d8bb06-316c-45bb-8401-b3b9c7f92368" version="1" />]]></Arg>
<Extra><![CDATA[<Extra>
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="N期股價趨勢向下" ID="54f19658275e4c74981fa74ce06cfcbd" ReturnType="0" ExecType="1" Folder="/00.語法範例/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input: Period(10); SetInputName(1, "期別");

settotalbar(3);

Condition1 = rateofchange(close, period) <= -1 * Period;
Condition2 = close < close[Period/2];
Condition3 = close < average(close, period);

ret = condition1 and condition2 and condition3;
]]></Code>
<Arg><![CDATA[<Arg seed="e84a743b-a352-4f16-8b6b-ca9656065942" version="1"><Param name="期別" varname="Period" type="1" subtype="0" value="10" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="雙KD向上" ID="5b1ff3a470ff4a33ace73e300c68567e" ReturnType="0" ExecType="3" Folder="/03.進階技術分析/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[setbarfreq("AD");

input: Length_D(9, "日KD期間");
input: Length_W(5, "周KD期間");

variable:rsv_d(0),kk_d(0),dd_d(0);
variable:rsv_w(0),kk_w(0),dd_w(0);

stochastic(Length_D, 3, 3, rsv_d, kk_d, dd_d);
xf_stochastic("W", Length_W, 3, 3, rsv_w, kk_w, dd_w);

condition1 = kk_d crosses above dd_d;		// 日KD crosses over
condition2 = xf_crossover("W", kk_w, dd_w);	// 周KD crosses over
condition3 = average(volume[1], 5) >= 1000;

condition4 = kk_d[1] <= 30;							// 日K 低檔
condition5 = xf_getvalue("W", kk_w, 1) <= 50;		// 周K 低檔

ret = condition1 and condition2 and condition3 and condition4 and condition5;

outputfield(1,kk_d,2,"日K值");
outputfield(2,kk_w,2,"週K值", order := -1);
]]></Code>
<Arg><![CDATA[<Arg seed="48755dae-fce1-48b2-89fe-471e7b432088" version="1"><Param name="日KD期間" varname="Length_D" type="1" subtype="0" value="9" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="周KD期間" varname="Length_W" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<TotalBar val="10" />
<FirstBarDate val="0" />
<Maxbb val="0" />
<script>
<freq support="11" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="長時間未破底後創新高" ID="e4102ff10eb44bd2b7dc2e3425b5c2b3" ReturnType="0" ExecType="3" Folder="/05.型態選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[setbarfreq("AD");

input:period(90,"未破底區間");
input:percent(25,"盤整區間漲幅上限");

condition1=false;
condition2=false;
value1=lowest(low,period);
if value1=low[period-1]
then condition1=true;

if highest(high[1],period)<=value1*(1+percent/100)
then condition2=true;

if condition1 and condition2 and close crosses over highest(close[1],period)
then ret=1;

outputfield(1,value1,2,"前波低點", order := -1);
]]></Code>
<Arg><![CDATA[<Arg seed="bc19e418-379f-47bb-b242-84473d8e5a11" version="1"><Param name="未破底區間" varname="period" type="1" subtype="0" value="90" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="盤整區間漲幅上限" varname="percent" type="1" subtype="0" value="25" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<TotalBar val="10" />
<FirstBarDate val="0" />
<Maxbb val="0" />
<script>
<freq support="11" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="高F_Score的股票" ID="916133936e9b4b45b82629d600e7f445" ReturnType="0" ExecType="3" Folder="/08.財報選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[setbarfreq("Q");
settotalbar(5);

variable:score(0);

value1=GetField("資產報酬率","Q");
value2=GetField("來自營運之現金流量","Q");//單位百萬
value3=GetField("本期稅後淨利","Q");//單位百萬
value5=GetField("負債比率","Q");
value6=GetField("流動比率","Q");
value7=GetField("現金增資佔股本比重","y");
value8=GetField("營業毛利率","Q");
value9=GetField("總資產週轉率(次)","Q");

if date<>date[1] then score=0;
if value1>0 then score=score+1;
if value1-value1[3]>0 then score=score+1;
if value2>0 then score=score+1;
if value3>value2 then score=score+1;
if value5<value5[3] then score=score+1;
if value6>value6[3] then score=score+1;
if value7<=value7[3] then score=score+1;
if value8>value8[3] then score=score+1;
if value9>value9[3] then score=score+1;

if score>=8 
then ret=1;]]></Code>
<Arg><![CDATA[<Arg seed="a52b01fa-9786-4352-b9d0-2e1ac4cb6958" version="1" />]]></Arg>
<Extra><![CDATA[<Extra>
<Maxbb val="0" />
<script>
<freq support="14" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="5" />
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="下跌後的吊人線" ID="7b147ab6db074b6cb55eb7a06edcbb37" ReturnType="0" ExecType="3" Folder="/05.型態選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[setbarfreq("AD");

condition1=false;
condition2=false;
condition3=false;

if high<= maxlist(open, close)*1.01	
//狀況1:小紅小黑且上影線很小
then condition1=true;

if (close-low)> absvalue(open-close)*2 and (close-low)>close*0.02
//狀況2:下影線為實體兩倍以上
then condition2=true;

if highest(high,30)>close[1]*1.4
//狀況3:近30日來最高點到昨天跌幅超過40%
then condition3=true;
{結果判斷}		
IF		
		condition1
	and	condition2
	and	condition3

THEN	RET=1;	

outputfield(1,high,2,"K棒高點", order := -1);
]]></Code>
<Arg><![CDATA[<Arg seed="21632219-56ae-4182-ab5e-490149f4c551" version="1" />]]></Arg>
<Extra><![CDATA[<Extra>
<TotalBar val="10" />
<FirstBarDate val="0" />
<Maxbb val="0" />
<script>
<freq support="11" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="多頭轉強" ID="9a0f7fff437f42e8aff052136da29552" ReturnType="0" ExecType="3" Folder="/04.價量選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[setbarfreq("AD");

input:length(10, "天期");
variable: sumUp(0), sumDown(0), up(0), down(0),RS(0);

if CurrentBar = 1 then  begin
    sumUp = Average(maxlist(close - close[1], 0), length);
    sumDown = Average(maxlist(close[1] - close, 0), length);
end else begin
	up = maxlist(close - close[1], 0);
	down = maxlist(close[1] - close, 0);
    sumUp = sumUp[1] + (up - sumUp[1]) / length;
	sumDown = sumDown[1] + (down - sumDown[1]) / length;
end;

if sumdown<>0
then rs=sumup/sumdown;

if rs crosses over 4
and close<close[3]*1.06
//最近3日漲幅小於6%
and Average(Volume[1], 100) >= 500
//成交量判斷
then ret=1;

outputfield(1, nthlowest(1,low[1],length), 2, "區間低點", order := -1);





 ]]></Code>
<Arg><![CDATA[<Arg seed="825229d8-a2b2-49c6-8e57-e5fbd7701398" version="1"><Param name="天期" varname="length" type="1" subtype="0" value="10" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<TotalBar val="10" />
<FirstBarDate val="0" />
<Maxbb val="0" />
<script>
<freq support="11" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="千張大戶減少而散戶增加" ID="ee301a41c59a494380547329855d5037" ReturnType="0" ExecType="3" Folder="/06.籌碼選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[//說明：如果本週大戶散戶集保資料尚未更新，則會用上週資料代替本週。

var:sameweek(0); 

setbarfreq("W");
settotalbar(3);

if getinfo("FilterMode") = 1 then  
	sameweek = 0 
else if 
	datediff(GetFielddate("收盤價","D"),GetFielddate("收盤價","W")) < 6 
then  sameweek = 1 else  sameweek = 0; 

value1=GetField("大戶持股人數","W",param:=1000)[sameweek];
value2=GetField("散戶持股人數","W",param:=400)[sameweek];

if value1<value1[1]
and value2>value2[1]
then ret=1;

outputfield(1,value1,0,"本週大戶人數");
outputfield(2,value1[1],0,"上週大戶人數");
outputfield(3,value1-value1[1],0,"大戶減少數");
outputfield(4,value2,0,"本週散戶人數");
outputfield(5,value2[1],0,"上週散戶人數");
outputfield(6,value2-value2[1],0,"散戶增加數");
]]></Code>
<Arg><![CDATA[<Arg seed="f38df256-71b6-4e12-ba86-1cabce7075da" version="1" />]]></Arg>
<Extra><![CDATA[<Extra>
<FirstBarDate val="0" />
<Maxbb val="0" />
<ScriptComplexity val="11" />
<script>
<freq support="9;12" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="過濾小型股票" ID="de38ff5f10064ea89ed49a7edd7cfb02" ReturnType="0" ExecType="1" Folder="/01.常用過濾條件/" StatusMask="2">
<Desc><![CDATA[過濾股本過小的股票。]]></Desc>
<Code><![CDATA[input:MinCapital(10);	// 股本(億)

SetInputName(1, "最小股本(億)");

SetTotalBar(3);

Ret = GetField("最新股本") > MinCapital;
]]></Code>
<Arg><![CDATA[<Arg seed="6b8d7698-41e9-4e39-9c59-9e5834e353c5" version="1"><Param name="最小股本(億)" varname="MinCapital" type="1" subtype="0" value="10" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<script>
<freq support="8;11" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="股價突破投信成本線" ID="9e48fcc9edbe4e5fb7e7a70f761048f1" ReturnType="0" ExecType="1" Folder="/06.籌碼選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[Input: period(20, "期間(天)");

variable: avg_b(0);

settotalbar(period + 5);

if GetField("Volume") > 0 then 
	Value5 = GetField("投信買張")*GetField("成交金額(元)")/(GetField("Volume")*1000)	 
else 
	Value5 = 0;

Value1 = summation(Value5, period);
Value2 = summation(GetField("投信買張"), period);
  
if Value2 > 0 and Value2 <> Value2[1] then avg_b = Value1 / Value2;

if close cross over avg_b then ret=1;
 ]]></Code>
<Arg><![CDATA[<Arg seed="f2774dcd-1889-4657-a6cc-5e5fde1e6762" version="1"><Param name="期間(天)" varname="period" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<FirstBarDate val="0" />
<Maxbb val="0" />
<script>
<freq support="8;11;9;12;10;13" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="-1" />
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="再跌就有斷頭賣壓的股票" ID="bc8d250b95c94689b975d4018919178f" ReturnType="0" ExecType="3" Folder="/06.籌碼選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[setbarfreq("AD");

input:period(30, "波段天期");

value2=nthhighestbar(1,close,period);//波段高點在第幾根Bar
if GetField("融資餘額張數","D")>average(volume,5)
//融資餘額大於五日均量
and GetField("融資餘額張數","D")[value2]>10000
//融資餘額大於一萬張
and GetField("融資餘額張數","D")[value2]>10000
//最高點時融資餘額也大於一萬張
and close*1.2<=close[value2]//波段跌幅超過兩成
then ret=1;

]]></Code>
<Arg><![CDATA[<Arg seed="7065127a-cbc9-4d74-af0f-4818358df040" version="1"><Param name="波段天期" varname="period" type="1" subtype="0" value="30" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<TotalBar val="3" />
<Maxbb val="0" />
<script>
<freq support="11" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="股息配發率超過一定比率" ID="67547fc0c1bb4dd6a13409bcc3fdd6c5" ReturnType="0" ExecType="3" Folder="/08.財報選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:ratio(60,"股息配發率%");
value1=GetField("每股稅後淨利(元)","Y");
value2=GetField("現金股利","Y");
if value1>0
then value3=value2/value1*100;//股息配發率

if trueall(value3>ratio,3) then ret=1;]]></Code>
<Arg><![CDATA[<Arg seed="2c5c5091-16e3-403a-b7e8-c29539326c5d" version="1"><Param name="股息配發率%" varname="ratio" type="1" subtype="0" value="60" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<TotalBar val="3" />
<FirstBarDate val="0" />
<Maxbb val="0" />
<script>
<freq support="16;8;9;10;11;12;13;14;15" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="創百日來新高但距離低點不太遠" ID="40d1932417d7412c8249f89f2baa343c" ReturnType="0" ExecType="1" Folder="/04.價量選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:day(100);			setinputname(1,"計算區間");
input:percents(14);		setinputname(2,"距離區間最低點漲幅");

SetTotalBar(3);

value1 = lowest(close, day-1);
if high = highest(close, day-1) and value1 * (1 + percents/100) >= high
then ret=1;]]></Code>
<Arg><![CDATA[<Arg seed="7a2cfb14-27ff-4f55-967c-44b8e693b607" version="1"><Param name="計算區間" varname="day" type="1" subtype="0" value="100" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="距離區間最低點漲幅" varname="percents" type="1" subtype="0" value="14" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="營益率由負轉正且持續上揚" ID="a9e1059f47a1496e8c6f347117637ee9" ReturnType="0" ExecType="1" Folder="/08.財報選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[settotalbar(3);

if 
	GetField("營業利益率","Q")[2]<0 and 
	GetField("營業利益率","Q")[1]>0 and
	GetField("營業利益率","Q") > GetField("營業利益率","Q")[1] and
	GetField("月營收月增率","M") > 0 and 
	GetField("月營收月增率","M")[1] >0
then ret=1;

]]></Code>
<Arg><![CDATA[<Arg seed="56c5bac1-16cd-4492-bd50-021b841eeb7b" version="1" />]]></Arg>
<Extra><![CDATA[<Extra>
<script>
<freq support="10;8;9;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="股魚選股策略" ID="c8ab4ea01a114941869c34f68a4c74b2" ReturnType="0" ExecType="2" Folder="/08.財報選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[value1=GetField("營業利益","Q");//單位百萬
value2=GetField("稅前淨利","Q");//單位百萬
value3=GetField("來自營運之現金流量","Q");//單位百萬
value4=GetField("資本支出金額","Q");//單位百萬
value5=GetField("利息支出","Q");//單位百萬
value6=GetField("所得稅費用","Q");//單位百萬
condition1=false;
condition2=false;
condition3=false;

if value2>0 then begin
	if value1/value2*100>80
	then condition1=true;  //本業獲利佔八成以上
end;

if value3-value4-value5-value6>0 //自由現金流量大於零
then condition2=true;

value7=GetField("利息保障倍數","Y");
value8=GetField("股東權益報酬率","Y");//單位%
value9=GetField("營業利益率","Q");//單位%
value10=GetField("本益比","D");
value11=GetField("殖利率","D");
value12=GetField("每股淨值(元)","Q");
value13=value12*value8/8;//獲利能力比率

if value7>20 and value8>8 and value9>0 and value10<12 and value11>6 and close<value13
then condition3=true;

if condition1 and condition2 and condition3
then ret=1;

outputfield(1,GetField("股東權益報酬率","Y"),2,"ROE");
outputfield(2,GetField("殖利率","D"),2,"殖利率", order := 1);
]]></Code>
<Arg><![CDATA[<Arg seed="df361aaf-719a-4cc5-a320-38b998531217" version="1" />]]></Arg>
<Extra><![CDATA[<Extra>
<TotalBar val="3" />
<Maxbb val="0" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="過濾低價股票" ID="f3edc34151b948bdafcb025fce093e83" ReturnType="0" ExecType="1" Folder="/01.常用過濾條件/" StatusMask="2">
<Desc><![CDATA[過濾股價過低的股票。]]></Desc>
<Code><![CDATA[input:PriceLimit(5);

SetInputName(1, "最小股價");

SetTotalBar(3);

Ret = close > PriceLimit;
]]></Code>
<Arg><![CDATA[<Arg seed="a34505e4-8cf8-494a-be2f-b2f38a89c3c5" version="1"><Param name="最小股價" varname="PriceLimit" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="漲多後跌破頭部" ID="f522c27327ff4aeb93a467b2b2628b70" ReturnType="0" ExecType="1" Folder="/04.價量選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:ratio(50);
input:period(100);
setinputname(1,"波段漲幅");
condition1=false;
value1=highestbar(close,period);//波段最高價距今幾根bar
value2=lowest(close[1],value1);
if value1>5 and close>close[100]*(1+ratio/100)
and close crosses under value2
then ret=1;]]></Code>
<Arg><![CDATA[<Arg seed="863b739e-0df4-4643-b293-75907ab68def" version="1"><Param name="波段漲幅" varname="ratio" type="1" subtype="0" value="50" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="period" varname="period" type="1" subtype="0" value="100" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<TotalBar val="3" />
<Maxbb val="0" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="漲勢加速" ID="e01e25b9a129425db80f96fc81f9eca4" ReturnType="0" ExecType="3" Folder="/04.價量選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[setbarfreq("AD");
 
variable:aspeed(0),dspeed(0),a1(0),d1(0),p1(0),ap1(0);
if close>close[1] then aspeed=(close-close[1])/close*100
else aspeed=0;
if close<close[1] then dspeed=(close[1]-close)/close*100
else dspeed=0;

a1=average(aspeed,5);
d1=average(dspeed,5);

p1=a1-d1;
ap1=average(p1,9);

if p1 crosses over ap1
and rsi(close,6)<=75
and close*1.3<close[30]

then ret=1;

outputfield(1, nthlowest(1,low[1],9), 2, "近期低點", order := -1);
]]></Code>
<Arg><![CDATA[<Arg seed="1f52fd50-87a4-4a53-b564-bc3ed6cd99c9" version="1" />]]></Arg>
<Extra><![CDATA[<Extra>
<TotalBar val="10" />
<FirstBarDate val="0" />
<Maxbb val="0" />
<script>
<freq support="11" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="葛拉罕的選股兩標準" ID="82d6c26db860466596f281178d172c78" ReturnType="0" ExecType="1" Folder="/08.財報選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[value1=summation(GetField("本期稅後淨利","Q"),4);//單位:百萬
value2=GetField("負債總額","Q");
value3=GetField("資產總額","Q");
value4=GetField("總市值","D");//單位:億

if value4<value1*7/100
and value3>value2*2
then ret=1;

outputfield(1,value1/100,0,"近四季獲利(億)");
outputfield(2,value1/100*7,0,"獲利的七倍(億)");
outputfield(3,value4,0,"總市值");
outputfield(4,value2,0,"負債");
outputfield(5,value3,0,"資產");]]></Code>
<Arg><![CDATA[<Arg seed="3ead2047-5478-4e77-a9b2-9252ccf98862" version="1" />]]></Arg>
<Extra><![CDATA[<Extra>
<TotalBar val="10" />
<FirstBarDate val="0" />
<Maxbb val="0" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="多頭下起漲前的籌碼收集" ID="9e21af69828c411a98aeb5c0b35f3aac" ReturnType="0" ExecType="3" Folder="/11.選股機器人/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[setbarfreq("AD");

value1=GetField("分公司買進家數");
value2=GetField("分公司賣出家數");
value3=value2-value1;
value4=countif(value3>20,10);
if value4>6 and close[30]>close*1.1
then ret=1;

outputfield(1,value1,0,"買進家數", order := -1);
outputfield(2,value2,0,"賣出家數");
]]></Code>
<Arg><![CDATA[<Arg seed="aab70b96-377a-4dd0-a9ac-590cff3a60fb" version="1" />]]></Arg>
<Extra><![CDATA[<Extra>
<TotalBar val="10" />
<FirstBarDate val="0" />
<Maxbb val="0" />
<script>
<freq support="11" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="五年內有至少三年營收成長" ID="f472317cfd8d4df5a22636eb33c458e7" ReturnType="0" ExecType="3" Folder="/08.財報選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[value1=GetField("營業收入淨額","Y");
value2=value1-value1[1];
if countif(value2>0,5)>=3
then ret=1;
]]></Code>
<Arg><![CDATA[<Arg seed="0eb5b9f2-c31d-4668-b710-dce0406c8845" version="1" />]]></Arg>
<Extra><![CDATA[<Extra>
<TotalBar val="3" />
<FirstBarDate val="0" />
<Maxbb val="0" />
<script>
<freq support="16;8;9;10;11;12;13;14;15" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="投信從空手到開始佈局" ID="1cb4729aa3384f238efd114b7d86554a" ReturnType="0" ExecType="1" Folder="/06.籌碼選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input: r1(500);		setinputname(1,"先前買超上限張數");
input: r2(5000);	setinputname(2,"近一日買超金額下限(萬元)");
input: length(20);	setinputname(3,"投信布局天數");

setTotalBar(3);

if trueall(GetField("投信買賣超","D")[1] < r1, length) and 
   GetField("投信買賣超","D") * close > r2 * 10
then ret=1;

SetOutputName1("投信買賣超(張)");
OutputField1(GetField("投信買賣超","D"));]]></Code>
<Arg><![CDATA[<Arg seed="c3d013a6-4d31-4297-99fb-acb25929ce94" version="1"><Param name="先前買超上限張數" varname="r1" type="1" subtype="0" value="500" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="近一日買超金額下限(萬元)" varname="r2" type="1" subtype="0" value="5000" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="投信布局天數" varname="length" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="站在五十二週高點之上" ID="eabc6b32f3d64b02aad90c9b3bb17dac" ReturnType="0" ExecType="3" Folder="/04.價量選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[value1=GetField("最高價","w");
value2=highest(value1[1],52);
if close>value2 then ret=1;]]></Code>
<Arg><![CDATA[<Arg seed="86063fbf-567f-4bd3-b2b8-509e1eba4f14" version="1" />]]></Arg>
<Extra><![CDATA[<Extra>
<TotalBar val="3" />
<Maxbb val="0" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="季營收連N季YOY正成長" ID="eae514c591fc40a29d35bf81402b745d" ReturnType="0" ExecType="3" Folder="/08.財報選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:n(12,"期數(單位:季)");
setbarfreq("Q");
settotalbar(n+4);

value1=GetField("營業收入淨額","Q");//單位:百萬
if trueall(value1>value1[4],n)
then ret=1;]]></Code>
<Arg><![CDATA[<Arg seed="25c67dcc-8910-49cf-a8b9-d4eb44349965" version="1"><Param name="期數(單位:季)" varname="n" type="1" subtype="0" value="12" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<FirstBarDate val="0" />
<Maxbb val="0" />
<script>
<freq support="14" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="-1" />
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="低預估本益比攻勢發動" ID="0aeaacf39a494b2fb5817279d5436930" ReturnType="0" ExecType="3" Folder="/10.價值投資/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[value1=GetField("月營收","M");//單位:億元
value2=GetField("稅後淨利率","Q");
value3=GetField("最新股本");//單位:億元
if value3<>0 then
value6=(value1*value2*12)/(value3*10);//單月營收推估的本業EPS
if value6<>0 then 
value7=close/value6;

value4=GetField("總市值");
value5=average(GetField("總市值"),600);

if value4<value5*0.7
and close=highest(close,10)
then ret=1;

outputfield(1,value7,2,"推估本益比", order := -1);



 ]]></Code>
<Arg><![CDATA[<Arg seed="152891a6-82e0-4f50-a250-1f0c4d79694a" version="1" />]]></Arg>
<Extra><![CDATA[<Extra>
<FirstBarDate val="0" />
<Maxbb val="0" />
<TotalBar val="700" />
<script>
<freq support="8;11" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="可能轉虧為盈" ID="1967ebf978ec4c9fa1f277299562f6fe" ReturnType="0" ExecType="1" Folder="/11.選股機器人/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[// 計算最新一期月營收的日期(mm=月份)
//
variable: mm(0);
mm = datevalue(getfielddate("月營收","M"),"M");

// 預估最新一季的季營收(單位=億)
//
if mm=1 or mm=4 or mm=7 or mm=10
then value1=GetField("月營收","M") * 3;
if mm=2 or mm=5 or mm=8 or mm=11
then value1=GetField("月營收","M") * 2 + GetField("月營收","M")[1];
if mm=3 or mm=6 or mm=9 or mm=12
then value1=GetField("月營收","M")+GetField("月營收","M")[1]+GetField("月營收","M")[2];

// 預估獲利(單位=百萬) = 季營收 * 毛利率 - 營業費用
//
value2 = value1 * GetField("營業毛利率","Q") - GetField("營業費用","Q");

if value2 > 0 and GetField("營業利益","Q") < 0 then
ret = 1;

outputfield(1,value1,2,"預估單季營收(億)", order := 1);
outputfield(2, value2 / 100,2, "預估單季本業獲利(億)");
]]></Code>
<Arg><![CDATA[<Arg seed="b1578a8c-a6f2-41bd-849d-1b4ad555b204" version="1" />]]></Arg>
<Extra><![CDATA[<Extra>
<FirstBarDate val="0" />
<Maxbb val="0" />
<TotalBar val="3" />
<script>
<freq support="10;8;9;11;12;13;14;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="借券增" ID="30bb18dc9cba474390acb5a770c46a56" ReturnType="0" ExecType="1" Folder="/06.籌碼選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:lowlimit(200,"借券增加張數");
input:days(3,"計算天數");
setbarfreq("D");
settotalbar(3);

value1=GetField("借券賣出餘額張數","D")-GetField("借券賣出餘額張數","D")[days];//借券賣出餘額張數增加數
if value1>=lowlimit
then ret=1;

outputfield(1,value1,"借券賣出餘額張數增加數");
]]></Code>
<Arg><![CDATA[<Arg seed="f7246996-7a2b-47a5-9e63-58a1ba5f2e4a" version="1"><Param name="借券增加張數" varname="lowlimit" type="1" subtype="0" value="200" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="計算天數" varname="day" type="1" subtype="0" value="3" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<FirstBarDate val="0" />
<Maxbb val="0" />
<script>
<freq support="8;11" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="法人買超" ID="2652c8f829c04812bde60d246268a9bf" ReturnType="0" ExecType="1" Folder="/06.籌碼選股/" StatusMask="2">
<Desc><![CDATA[近期三大法人持續買超且股價上揚。]]></Desc>
<Code><![CDATA[input: Length(10); setinputname(1,"計算天數");
input: UpRatio(3.5); setinputname(2, "上漲幅度(%)");
input: VolumeRatio(5); setinputname(3, "買超佔比例(%)");

variable: SumForce(0);
variable: SumTotalVolume(0);

settotalbar(3);

if RateOfChange(Close, 1) >= UpRatio then
begin
	SumTotalVolume = Summation(volume, Length);
	SumForce = Summation(GetField("法人買賣超張數"), Length);
	if SumForce > SumTotalVolume * VolumeRatio / 100 then ret =1;
end;

SetOutputName1("三大法人累計買超張數");
OutputField1(SumForce);
]]></Code>
<Arg><![CDATA[<Arg seed="d34b42da-d523-4eaf-9660-2c18db52b864" version="1"><Param name="計算天數" varname="Length" type="1" subtype="0" value="10" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="上漲幅度(%)" varname="UpRatio" type="1" subtype="0" value="3.5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="買超佔比例(%)" varname="VolumeRatio" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<script>
<freq support="8;11;9;12;10;13" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="高毛利低獲利營收暴衝" ID="205c3a8c227d441896c13938843ce88d" ReturnType="0" ExecType="1" Folder="/08.財報選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:
	smr(5,"月營收月增率"),
	syr(10,"月營收年增率"),
	gr(45,"營業毛利率"),
	epsy(1,"年EPS"),
	epsq(0.5,"季EPS");

value1=GetField("月營收月增率","M");
value2=GetField("月營收年增率","M");
value3=GetField("營業毛利率","Q");

if value1> smr //月營收月增率大於10%
and value2> syr//月營收年增率大於10%
and value3>= gr//毛利率大於45%
and GetField("每股稅後淨利(元)","Y")<epsy//最近一年稅後EPS小於1
and GetField("每股稅後淨利(元)","Q")<epsq//最近一季稅後EPS小於0.5
and GetField("每股營業額(元)","Y")>10//每股年營收大於10
then ret=1; 
]]></Code>
<Arg><![CDATA[<Arg seed="f16b203a-05fe-49a2-9c01-eccbe11ab42c" version="1"><Param name="月營收月增率" varname="smr" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="月營收年增率" varname="syr" type="1" subtype="0" value="10" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="營業毛利率" varname="gr" type="1" subtype="0" value="45" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="年EPS" varname="epsy" type="1" subtype="0" value="1" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="季EPS" varname="epsq" type="1" subtype="0" value="0.5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<TotalBar val="3" />
<Maxbb val="0" />
<script>
<freq support="10;8;9;11;12;13;14;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="PB跌到歷年低點區且低於0.8" ID="a8205a0fb8e44734a77697f0b3ec80a9" ReturnType="0" ExecType="3" Folder="/10.價值投資/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[value1=GetField("股價淨值比","Y");
value2=lowest(value1,4);
if value1<value2*1.3 and value1<=0.8
then ret=1;

outputfield(1, GetField("股價淨值比","Y"),2, "PB比", order := -1);
]]></Code>
<Arg><![CDATA[<Arg seed="eabae65e-5056-434a-9309-926840294e20" version="1" />]]></Arg>
<Extra><![CDATA[<Extra>
<TotalBar val="3" />
<Maxbb val="0" />
<script>
<freq support="16;8;9;10;11;12;13;14;15" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="創最低總市值" ID="346cba574a714dda8629ad3626f1e5d2" ReturnType="0" ExecType="3" Folder="/04.價量選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:period(36,"計算的月份數");
setbarfreq("M");

if GetField("總市值","M")=lowest(GetField("總市值","M"),period)
then ret=1;

]]></Code>
<Arg><![CDATA[<Arg seed="c3c0451b-72a5-4bf4-a4e1-ef74ddd053a3" version="1"><Param name="計算的月份數" varname="period" type="1" subtype="0" value="36" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<TotalBar val="3" />
<Maxbb val="0" />
<script>
<freq support="10;13" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="無量變有量" ID="910e6b610da742d0bc9d67e9acfa4b81" ReturnType="0" ExecType="3" Folder="/04.價量選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:v1(1000,"前一期成交量");
input:v2(1000,"最新期成交量");
if trueall(volume[1]<=v1,10) and volume>v2 
then ret=1; ]]></Code>
<Arg><![CDATA[<Arg seed="661dde0e-bfa3-40de-855f-e173294fd7b7" version="1"><Param name="前一期成交量" varname="v1" type="1" subtype="0" value="1000" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="最新期成交量" varname="v2" type="1" subtype="0" value="1000" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<TotalBar val="10" />
<FirstBarDate val="0" />
<Maxbb val="0" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="融資追捧" ID="b9cf9949e8564eab9053fbe24116910c" ReturnType="0" ExecType="1" Folder="/06.籌碼選股/" StatusMask="2">
<Desc><![CDATA[融資餘額創新高且股價上揚。]]></Desc>
<Code><![CDATA[input: Length(10); setinputname(1,"近期天數");
input: UpRatio(3.5); setinputname(2, "上漲幅度(%)");

settotalbar(3);

if RateOfChange(Close, 1) >= UpRatio and
	Getfield("融資餘額張數") > 0 and
	Getfield("融資餘額張數") = highest(Getfield("融資餘額張數"), Length)  
then ret=1;

SetOutputName1("融資餘額張數");
OutputField1(Getfield("融資餘額張數"));
]]></Code>
<Arg><![CDATA[<Arg seed="2abf3fe0-0fa8-4a67-af47-f52bc169e134" version="1"><Param name="近期天數" varname="Length" type="1" subtype="0" value="10" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="上漲幅度(%)" varname="UpRatio" type="1" subtype="0" value="3.5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<script>
<freq support="8;11;9;12;10;13" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="突破箱型" ID="0029b7d987a842aaa25d4ff7d22e1053" ReturnType="0" ExecType="1" Folder="/05.型態選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:period(20);
input:rangeratio(10);
variable:h1(0),h2(0),l1(0),l2(0),hd1(0),hd2(0),ld1(0),ld2(0);
h1=nthhighest(1,high,period);
h2=nthhighest(2,high,period);
l1=nthlowest(1,low,period);
l2=nthlowest(2,low,period);
hd1=nthhighestbar(1,high,period);
hd2=nthhighestbar(2,high,period);
ld1=nthlowestbar(1,low,period);
ld2=nthlowestbar(2,low,period);
if absvalue(hd1[1]-hd2[1])>=4 and absvalue(ld1[1]-ld2[1])>=4
and h1[1]-h2[1]<=h1[1]*0.02
and l2[1]-l1[1]<=l1[1]*0.02
and h1[1]<=l1[1]*(1+rangeratio/100)
then begin
if close crosses over h1[1]
and volume >=average(volume,period)*1.3
then ret=1;
end;]]></Code>
<Arg><![CDATA[<Arg seed="8feeccc0-e9af-421a-8486-58b055172db2" version="1"><Param name="period" varname="period" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="rangeratio" varname="rangeratio" type="1" subtype="0" value="10" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<TotalBar val="10" />
<FirstBarDate val="0" />
<Maxbb val="0" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="法人買進佔成交量超過25%" ID="01ca6e304498404388ba3712c2230b8d" ReturnType="0" ExecType="1" Folder="/06.籌碼選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:r1(45);
setinputname(1,"法人買進佔成交量比例下限%");
value1=GetField("外資買張","D");
value2=GetField("投信買張","D");
value3=GetField("自營商買張","D");
if volume<>0 then 
value4=(value1+value2+value3)/volume;
if value4*100>r1
then ret=1;]]></Code>
<Arg><![CDATA[<Arg seed="226eb5a0-933d-48f4-bb99-c9cc8bbded35" version="1"><Param name="法人買進佔成交量比例下限%" varname="r1" type="1" subtype="0" value="45" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<TotalBar val="3" />
<Maxbb val="0" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="N年累計營業利益市值比" ID="705a94d928da48e1914f7302e93f4c19" ReturnType="0" ExecType="1" Folder="/08.財報選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:r1(50);		setinputname(1,"累計營業利益佔總市值比例(%)");
input:years(10);		setinputname(2,"計算期間(年)");

settotalbar(3);

value1=GetField("總市值","D");		//單位億
value2=summation(GetField("營業利益","y"),years);
value3=value2/value1;				//單位=百分比

if value3 < r1
then ret=1;

setoutputname1("累計營業利益佔市值比例(%)");
outputfield1(value3);




]]></Code>
<Arg><![CDATA[<Arg seed="e293ad67-63bf-49ea-bd3b-756f9ca0efdd" version="1"><Param name="累計營業利益佔總市值比例(%)" varname="r1" type="1" subtype="0" value="50" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="計算期間(年)" varname="years" type="1" subtype="0" value="10" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="週轉率大於X%" ID="2ce78f4e06c54924b01509d2a0de31d3" ReturnType="0" ExecType="1" Folder="/00.語法範例/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[Input: X(5); SetInputName(1, "週轉率%");

settotalbar(3);

Value1 = GetField("週轉率","D");
if Value1 > X then Ret = 1;

SetOutputName1("週轉率%");
outputfield1(Value1);

]]></Code>
<Arg><![CDATA[<Arg seed="a876fe49-db70-4409-8ba7-1cfc4c01996a" version="1"><Param name="週轉率%" varname="X" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<Maxbb val="0" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="平台整理後突破" ID="45ae3462c9e34d98ba3409ee9a4dd9e1" ReturnType="0" ExecType="3" Folder="/05.型態選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[setbarfreq("AD");

input:Period(20, "平台區間");
input:ratio(10, "整理幅度(%)");
input:ratio1(3,"各高點(低點)間的差異幅度");

variable:h1(0),h2(0),L1(0),L2(0);

h1=nthhighest(1,high[1],period);
h2=nthhighest(4,high[1],period);
l1=nthlowest(1,low[1],period);
l2=nthlowest(4,low[1],period);

if (h1-l1)/l1<=ratio/100
  and (h1-h2)/h2<=ratio1/100
  and (l2-l1)/l1<=ratio1/100
  and close crosses over h1
  and close[period+30]*1.1<h1
  and volume> average(volume,period)
then ret=1;

outputfield(1, h1, 2, "區間高點", order := -1);
]]></Code>
<Arg><![CDATA[<Arg seed="e9fff184-8e5b-46d4-bca7-d1e7cdd6da38" version="1"><Param name="平台區間" varname="Period" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="整理幅度(%)" varname="ratio" type="1" subtype="0" value="10" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="各高點(低點)間的差異幅度" varname="ratio1" type="1" subtype="0" value="3" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<TotalBar val="10" />
<FirstBarDate val="0" />
<Maxbb val="0" />
<script>
<freq support="11" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="修正式價量指標黃金交叉" ID="3fb10266a9d8454aadd68b415ff27b75" ReturnType="0" ExecType="3" Folder="/04.價量選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[setbarfreq("AD");

input:day(10, "移動平均線天數");

variable:tvp(0),mpc(0);
mpc=(open+high+low+close)/4;

if mpc[1]<>0
then tvp=tvp[1]+(mpc-mpc[1])/mpc[1]*volume
else tvp=tvp[1];

value1=average(tvp,day);
If tvp crosses over value1 and volume>1000
and tvp>value1*1.05
then ret=1;

outputfield(1,average(c,day),2,"10日線", order := -1);
]]></Code>
<Arg><![CDATA[<Arg seed="99e54c37-4c5b-47e2-8d51-fba7e1f39cef" version="1"><Param name="移動平均線天數" varname="day" type="1" subtype="0" value="10" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<TotalBar val="10" />
<FirstBarDate val="0" />
<Maxbb val="0" />
<script>
<freq support="11" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="月營收年增率移動平均黃金交叉b" ID="8833102609434b5999dc1048ee6bd648" ReturnType="0" ExecType="3" Folder="/11.選股機器人/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[value1=GetField("月營收年增率","M");

if average(value1,4) crosses over average(value1,12)
and value1 > 0
then ret=1;

outputfield(1,value1,2,"月營收年增率%", order := 1);
]]></Code>
<Arg><![CDATA[<Arg seed="5194b619-ebfa-41d0-af9f-5bf2a11e81c8" version="1" />]]></Arg>
<Extra><![CDATA[<Extra>
<TotalBar val="3" />
<Maxbb val="0" />
<script>
<freq support="10;8;9;11;12;13;14;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="月營收YOYN月移動平均大於X" ID="05585eb1e01a43c1becd0bf20d030aa5" ReturnType="0" ExecType="3" Folder="/07.月營收選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:lowlimit(10,"年增率下限");
input:period(12,"移動平均線的期別");

if average(GetField("月營收年增率","M"),period) >= lowlimit
then ret=1;]]></Code>
<Arg><![CDATA[<Arg seed="598ea392-4054-4c48-9431-2f41d40467fb" version="1"><Param name="年增率下限" varname="lowlimit" type="1" subtype="0" value="10" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="移動平均線的期別" varname="period" type="1" subtype="0" value="12" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<TotalBar val="10" />
<FirstBarDate val="0" />
<Maxbb val="0" />
<script>
<freq support="10;8;9;11;12;13;14;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="散戶買進比例上揚" ID="8b4514f7f3514eb5a96e701e2ba9f50c" ReturnType="0" ExecType="1" Folder="/06.籌碼選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[Input: r1(50);	setinputname(1, "散戶買進比例下限(%)");
Input: r2(500);	setinputname(2, "五日均量下限(張)");

SetTotalBar(28);

value1=GetField("散戶買張");
value2=value1/volume*100;		// 散戶買張比例
value3=average(value2,5);		// 短期散戶比例
value4=average(value2,20);		// 長期散戶比例

if value2 > r1 and
   value3 crosses above value4 and
   average(volume,5) > r2
then ret=1;

SetOutputName1("散戶買進比例(%)");
OutputField1(value2);


]]></Code>
<Arg><![CDATA[<Arg seed="73eac337-4953-4c2e-9088-36b704effd6b" version="1"><Param name="散戶買進比例下限(%)" varname="r1" type="1" subtype="0" value="50" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="五日均量下限(張)" varname="r2" type="1" subtype="0" value="500" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<script>
<freq support="8;11;9;12;10;13" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="28" />
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="營收高於預期" ID="9db3bd79cc1541f1896b82b57330794b" ReturnType="0" ExecType="1" Folder="/07.月營收選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input: r1(10);		setinputname(1, "月營收年增率增加幅度下限(%)");
//input:TXT("僅適用月線"); setinputname(2,"使用限制");
setbarfreq("M");

If barfreq <> "M" then raiseruntimeerror("頻率設定有誤");

settotalbar(3);

value1=GetField("月營收年增率","M");
value2=average(GetField("月營收年增率","M")[1],3);
if value1-value2 > r1
then ret=1;

setoutputname1("月營收年增率(%)");
outputfield1(value1);

]]></Code>
<Arg><![CDATA[<Arg seed="95c79a30-cb8d-46ef-89f8-cd5f2b9b6860" version="1"><Param name="月營收年增率增加幅度下限(%)" varname="r1" type="1" subtype="0" value="10" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<script>
<freq support="10;13" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="近N年EPS成長率平均大於X%" ID="dfbbd6c2a6be4c47b21c7dd24498cb4b" ReturnType="0" ExecType="1" Folder="/08.財報選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input: N(5), X(10);
setbarfreq("Y");

setinputname(1, "期別");
setinputname(2, "平均EPS成長率(%)");

SetTotalBar(N+3);

Value1 = Average(RateOfChange(GetField("每股稅後淨利(元)","Y"), 1), N);

Ret = Value1 > X;

SetOutputName1("平均EPS成長率(%)");
OutputField1(Value1);


]]></Code>
<Arg><![CDATA[<Arg seed="a96b2b44-683c-4b8a-a554-3c8558ec8e51" version="1"><Param name="期別" varname="N" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="平均EPS成長率(%)" varname="X" type="1" subtype="0" value="10" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<script>
<freq support="16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="-1" />
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="底部越來越高且資金流入的蓄勢股" ID="11d9faea1be74b869586ff80a508ecf8" ReturnType="0" ExecType="1" Folder="/03.進階技術分析/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:r1(7);		setinputname(1,"近來漲幅上限%");

SetTotalBar(8);

value1 = RateOfChange(close, 12);
value2 = lowest(low,3);
value3 = lowest(low,8);
value4 = lowest(low,13);

condition1=false;
condition2=false;

if 
	value1 < r1 and
	value2 > value3 and 
	value3 > value4 and
	close = highest(close,13)
then 
	condition1=true;

Value5=average(GetField("佔全市場成交量比","D"),13);

if linearregslope(Value5,5) > 0
then condition2=true;

if condition1 and condition2
then ret=1;


]]></Code>
<Arg><![CDATA[<Arg seed="ebcc4c2a-ff85-4892-8f84-86ec77d2f628" version="1"><Param name="近來漲幅上限%" varname="r1" type="1" subtype="0" value="7" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="8" />
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="PB來到近年來低點" ID="089302fa111c45b29b089d8534fd608c" ReturnType="0" ExecType="1" Folder="/08.財報選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:r1(10);	setinputname(1,"PB距離N個月來低點只剩N%");
input:r2(60);	setinputname(2,"N個月以來");
//input:TXT("僅適用月資料"); setinputname(3,"使用限制");
setbarfreq("M");

if barfreq <> "M" then raiseruntimeerror("頻率錯誤");

settotalbar(3);

value1=GetField("股價淨值比","M");
value2=lowest(GetField("股價淨值比","M"),r2);
value3=average(GetField("股價淨值比","M"),r2);

if value1 < value3 and value1 < value2*(1+r1/100)
then ret=1;

setoutputname1("股價淨值比");
outputfield1(value1);
]]></Code>
<Arg><![CDATA[<Arg seed="78d64270-0e9a-489a-9307-c945a131bd32" version="1"><Param name="PB距離N個月來低點只剩N%" varname="r1" type="1" subtype="0" value="10" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="N個月以來" varname="r2" type="1" subtype="0" value="60" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<script>
<freq support="10;13" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="股價低於N年平均股利的N倍" ID="a55bd21b55d74f718b4fe8b3c212e0b5" ReturnType="0" ExecType="3" Folder="/08.財報選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:N1(5);
input:N2(16);
setinputname(1,"股利平均的年數");
setinputname(2,"股利的倍數");
value1=GetField("股利合計","Y");
value2=average(value1,N1);
if close<value2*N2
then ret=1;

]]></Code>
<Arg><![CDATA[<Arg seed="f1288386-496c-463e-9dac-e924ae1e1222" version="1"><Param name="股利平均的年數" varname="N1" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="股利的倍數" varname="N2" type="1" subtype="0" value="16" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<TotalBar val="3" />
<Maxbb val="0" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="毛利率創一年新高" ID="8b5dde752f6a4fbb94548c3cae719864" ReturnType="0" ExecType="3" Folder="/11.選股機器人/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[value1=GetField("營業毛利率","Q");
if value1=highest(value1,12)
then ret=1;]]></Code>
<Arg><![CDATA[<Arg seed="a2a69469-5db5-471d-871d-cd96551ff292" version="1" />]]></Arg>
<Extra><![CDATA[<Extra>
<TotalBar val="3" />
<FirstBarDate val="0" />
<Maxbb val="0" />
<script>
<freq support="14;8;9;10;11;12;13;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="短期均線穿越長期均線" ID="344862d8215b4259845871d6f8f025a3" ReturnType="0" ExecType="1" Folder="/02.基本技術指標/" StatusMask="2">
<Desc><![CDATA[短天期均線向上穿越長天期均線。
]]></Desc>
<Code><![CDATA[input: Shortlength(5); setinputname(1,"短期均線期數");
input: Longlength(20); setinputname(2,"長期均線期數");

settotalbar(3);

If Average(Close,Shortlength) crosses over Average(Close,Longlength) then Ret=1;



        ]]></Code>
<Arg><![CDATA[<Arg seed="07abeae5-407b-43b9-af15-28586cdaed77" version="1"><Param name="短期均線期數" varname="Shortlength" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="長期均線期數" varname="Longlength" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="累計月營收年增率連續N月成長" ID="776791c72c594c1ea494ecb73cd5332b" ReturnType="0" ExecType="3" Folder="/07.月營收選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:period(6,"計算區間");
settotalbar(period+1);
value1=GetField("累計營收年增率","M");
if trueall(value1>value1[1],period)
then ret=1;
]]></Code>
<Arg><![CDATA[<Arg seed="e9b4ff0d-f262-4406-b1c5-e759a6ba1275" version="1"><Param name="計算區間" varname="period" type="1" subtype="0" value="6" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<Maxbb val="0" />
<script>
<freq support="10;8;9;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="-1" />
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="下降趨勢明確" ID="a767ea51e54c4bc1aca960fb7f065bd2" ReturnType="0" ExecType="1" Folder="/05.型態選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:Length(20,"期間");   //"計算期間"
settotalbar(20);

LinearReg(close, Length, 0, value1, value2, value3, value4);
//做收盤價20天線性回歸
{value1:斜率,value4:預期值}

value5=rsquare(close,value4,20);
//算收盤價與線性回歸值的R平方

if value1<0 and value5>0.2
then ret=1;
]]></Code>
<Arg><![CDATA[<Arg seed="3f89b3d3-952d-4a4f-aea8-5c4ead238a11" version="1"><Param name="期間" varname="Length" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<Maxbb val="0" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="20" />
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="法人主力敢買又敢拉的股票" ID="337b9397f3c5456db6100d462dbf9925" ReturnType="0" ExecType="3" Folder="/06.籌碼選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[value1=GetField("法人買賣超張數");
value2=GetField("主力買賣超張數");
value3=value1+value2;
value4=GetField("內外盤比","D");//外盤量/內盤量*100

condition1=false;
condition2=false;
condition3=false;

if countif(value3>300,5)>=4 or countif(value3>300,4)>=3
then condition1=true; 

if value3>volume*0.3 and value4>50
then condition2=true;

if high<=close*1.02
then condition3=true;

if condition1 and condition2 and condition3
then ret=1;

 ]]></Code>
<Arg><![CDATA[<Arg seed="7980d1c7-5512-402c-920c-23f10454e572" version="1" />]]></Arg>
<Extra><![CDATA[<Extra>
<TotalBar val="3" />
<FirstBarDate val="0" />
<Maxbb val="0" />
<script>
<freq support="8;11;9;12;10;13" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="即將進入季節性多頭" ID="2379066f68644867b0167137342de645" ReturnType="0" ExecType="3" Folder="/09.時機操作/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[setbarfreq("AM");
settotalbar(3);

array:m1[7](0);
variable:x(0),count(0),avgup(0);

avgup = 0;

for x=1 to 7 begin
	m1[x]=(close[12*x-1]-close[12*x])/close[12*x];
end;
count=0;
for x=1 to 7 begin
	if m1[x]>0.02 then begin
		count=count+1;
		avgup=avgup+m1[x];
	end;
end;

if count>=6 and close>5 
and average(volume,20)>10000
then ret=1;

]]></Code>
<Arg><![CDATA[<Arg seed="25d8ea17-3f48-4e29-9285-27715787746c" version="1" />]]></Arg>
<Extra><![CDATA[<Extra>
<FirstBarDate val="0" />
<Maxbb val="0" />
<script>
<freq support="13" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="RSI高檔背離" ID="3fe7e8fb6e38444e8d35ab4c2e1319d4" ReturnType="0" ExecType="1" Folder="/02.基本技術指標/" StatusMask="2">
<Desc><![CDATA[RSI指標由高檔區往下且與價格趨勢背離。]]></Desc>
<Code><![CDATA[// RSI由高檔區往下, 與價格趨勢背離
//
Input: RSILength(6), Threshold(80), Region(5);
variable: rsiValue(0);

settotalbar(maxlist(RSILength,6) * 9);

SetInputName(1, "期數");
SetInputName(2, "高檔值");
SetInputName(3, "日期區間");

RSIValue = RSI(Close, RSILength);
If RSIValue Crosses Below Threshold and
   RSIValue < Lowest(RSIValue, Region) and 
   Close >= Highest(Close, Region) then
	Ret = 1;

setoutputname1("RSI");
outputfield1(RSIValue);
        
        ]]></Code>
<Arg><![CDATA[<Arg seed="535da0e0-25fe-4630-9f67-621354fc18f6" version="1"><Param name="期數" varname="RSILength" type="1" subtype="0" value="6" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="高檔值" varname="Threshold" type="1" subtype="0" value="80" isSerial="1" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="日期區間" varname="Region" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<Maxbb val="7" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="-1" />
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="帶量突破均線" ID="04a0d8473fb1433980814989b6dd6abb" ReturnType="0" ExecType="1" Folder="/02.基本技術指標/" StatusMask="2">
<Desc><![CDATA[價位突破均線且成交量放大。]]></Desc>
<Code><![CDATA[// 帶量突破均線
//
input: Length(10), VolFactor(2);

SetInputName(1, "期數");
SetInputName(2, "成交量放大倍數");

settotalbar(3);

if close > Average(close, Length) and  close[1] <  Average(close, Length) and
   volume > Average(volume[1], Length) * VolFactor 
then ret=1;  



        ]]></Code>
<Arg><![CDATA[<Arg seed="27b2cf6b-748c-45d8-baa2-1503f4a57385" version="1"><Param name="期數" varname="Length" type="1" subtype="0" value="10" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="成交量放大倍數" varname="VolFactor" type="1" subtype="0" value="2" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="RSI低檔背離" ID="c4b458b20cc442989f3f5388ead82f08" ReturnType="0" ExecType="1" Folder="/02.基本技術指標/" StatusMask="2">
<Desc><![CDATA[RSI指標由低檔區往上且與價格趨勢背離。]]></Desc>
<Code><![CDATA[// RSI由下往上, 與價格趨勢背離
Input: RSILength(6, "期數"), Threshold(20, "低檔值"), Region(5, "日期區間");
variable: rsiValue(0);

settotalbar(maxlist(RSILength,6) * 8 + 8);

RSIValue = RSI(Close, RSILength);
If RSIValue Crosses Above Threshold and
   RSIValue >= Highest(RSIValue, Region) and
   Close <= Lowest(Close, Region) then
   Ret = 1;
outputfield1(RSIValue,"RSI");]]></Code>
<Arg><![CDATA[<Arg seed="99c53adf-082f-439f-a7df-20410699b090" version="1"><Param name="期數" varname="RSILength" type="1" subtype="0" value="6" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="低檔值" varname="Threshold" type="1" subtype="0" value="20" isSerial="1" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="日期區間" varname="Region" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<RefFunc>1,c122bd6485c544f2bce8f374b5c7440d;1,3a62e42e463c46b58e5dee79ae1e581c;1,d64c2a71d3ea43d985ca22ef62a5a8de;1,6850ead727a842bf883a1501d030ba98;1,2bca774c6b7549c1b0b008d2a54b288e;1,f1b429ac13b2447c909302198c18ca56</RefFunc>
<Extra><![CDATA[<Extra>
<Maxbb val="7" />
<ScriptComplexity val="1" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="-1" />
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="週KD低檔黃金交叉" ID="a5c2d73a0c9547e9a2f0688ffbb7d1b5" ReturnType="0" ExecType="3" Folder="/02.基本技術指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[// KD指標, K值由下往上穿越D值
//
input: Length(9), RSVt(3), Kt(3);
variable: rsv(0), k(0), _d(0);

SetInputName(1, "天數");
SetInputName(2, "RSVt權數");
SetInputName(3, "Kt權數");

Stochastic(Length, RSVt, Kt, rsv, k, _d);

Ret = k crosses above _d and k<30;]]></Code>
<Arg><![CDATA[<Arg seed="1075336e-68dd-4c45-9b6f-e3f245506185" version="1"><Param name="天數" varname="Length" type="1" subtype="0" value="9" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="RSVt權數" varname="RSVt" type="1" subtype="0" value="3" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="Kt權數" varname="Kt" type="1" subtype="0" value="3" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<TotalBar val="3" />
<Maxbb val="0" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="布林通道超賣" ID="dcdc0d809aab49689e977cd80f446c9a" ReturnType="0" ExecType="1" Folder="/02.基本技術指標/" StatusMask="2">
<Desc><![CDATA[最低價低於布林通道指標的下緣。]]></Desc>
<Code><![CDATA[// 布林通道超賣訊號
//
Input: Length(20), LowerBand(2);

SetInputName(1, "期數");
SetInputName(2, "通道下緣");

settotalbar(3);

Ret = Low <= bollingerband(Close, Length, -1 * LowerBand);



        ]]></Code>
<Arg><![CDATA[<Arg seed="e97d18be-ddc5-4bf5-ad04-8e9ebc190d32" version="1"><Param name="期數" varname="Length" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="通道下緣" varname="LowerBand" type="1" subtype="0" value="2" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="帳上現金少" ID="e9a250b6297f4affa286bd558cc010f0" ReturnType="0" ExecType="1" Folder="/08.財報選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:r1(50);	setinputname(1,"帳上現金(單位:百萬元)");

settotalbar(3);

value1=GetField("現金及約當現金","Q");
if value1 < r1
then ret=1;

SetOutputName1("帳上現金(百萬)");
OutputField1(value1);
]]></Code>
<Arg><![CDATA[<Arg seed="672a8cce-8ff5-4d1d-9f62-3a6014965136" version="1"><Param name="帳上現金(單位:百萬元)" varname="r1" type="1" subtype="0" value="50" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<script>
<freq support="14;8;9;10;11;12;13;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="營收月增率比歷年突出" ID="0d0299c7dac746f99c4cf3906b24d239" ReturnType="0" ExecType="1" Folder="/07.月營收選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:r1(5);		setinputname(1,"月營收月增幅與過往三年的數字增加百分比(%)");
//input:TXT("僅適用月線"); setinputname(2,"使用限制");
setbarfreq("M");

If barfreq <> "M" then raiseruntimeerror("頻率設定有誤");

value1 = GetField("月營收月增率","M");
value2 = average(GetField("月營收月增率","M"),3);
value3 = average(GetField("月營收月增率","M")[12],3);
value4 = average(GetField("月營收月增率","M")[24],3);
value5 = average(GetField("月營收月增率","M")[36],3);

value6 = (value3 + value4 + value5) / 3;
if (value2 - value6) > r1 then
ret = 1;

SetOutputName1("近3月月營收增幅平均");
OutputField1(value2);
]]></Code>
<Arg><![CDATA[<Arg seed="246b6928-ad3d-4be9-925d-dc08721c4daf" version="1"><Param name="月營收月增幅與過往三年的數字增加百分比(%)" varname="r1" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<script>
<freq support="10;13" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="營業利益均線向上" ID="f6833770083743bc82535fa8ed7952a5" ReturnType="0" ExecType="3" Folder="/08.財報選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[setbarfreq("Q");
settotalbar(10);
value1=GetField("營業利益","Q");
if linearregslope(average(value1,5),5)>0
then ret=1;]]></Code>
<Arg><![CDATA[<Arg seed="78430126-43c2-443b-9302-c22cfab214ae" version="1" />]]></Arg>
<Extra><![CDATA[<Extra>
<FirstBarDate val="0" />
<Maxbb val="0" />
<script>
<freq support="14" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="10" />
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="法人大出籌碼" ID="6c196965c4904dad8b18b4dea6642659" ReturnType="0" ExecType="1" Folder="/06.籌碼選股/" StatusMask="2">
<Desc><![CDATA[法人大出籌碼]]></Desc>
<Code><![CDATA[input:r1(45);
setinputname(1,"法人賣出佔成交量比例下限%");
value1=GetField("外資賣張","D");
value2=GetField("投信賣張","D");
value3=GetField("自營商賣張","D");
if volume<>0 then 
value4=(value1+value2+value3)/volume;
if value4*100>r1
then ret=1;]]></Code>
<Arg><![CDATA[<Arg seed="690162c7-acaf-4d39-bdab-fc1822fe444e" version="1"><Param name="法人賣出佔成交量比例下限%" varname="r1" type="1" subtype="0" value="45" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<TotalBar val="3" />
<Maxbb val="0" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="營業外收入愈來愈高" ID="c5e12ace2bec4f31965b0773a9115175" ReturnType="0" ExecType="1" Folder="/08.財報選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[settotalbar(3);

if trueall(GetField("營業外收入合計","Y") > GetField("營業外收入合計","Y")[1], 3) 
then ret=1;

]]></Code>
<Arg><![CDATA[<Arg seed="a0d9fbb5-021a-4db5-9a3f-75a0325f1e17" version="1" />]]></Arg>
<Extra><![CDATA[<Extra>
<script>
<freq support="16;8;9;10;11;12;13;14;15" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="千張大戶暴增" ID="fd58f6466b2c4cd282830c98a2c082fe" ReturnType="0" ExecType="3" Folder="/06.籌碼選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[//說明：如果本週大戶散戶集保資料尚未更新，則會用上週資料代替本週。

var:sameweek(0); 

setbarfreq("W");
settotalbar(3);

if getinfo("FilterMode") = 1 then  
	sameweek = 0 
else if 
	datediff(GetFielddate("收盤價","D"),GetFielddate("收盤價","W")) < 6 
then  sameweek = 1 else  sameweek = 0; 

value1=GetField("大戶持股人數","W",param:=1000)[sameweek];
value2=GetField("散戶持股人數","W",param:=400)[sameweek];
if value1>value1[1]
and value2<value2[1]
then ret=1;
outputfield(1,value1,0,"本週大戶人數");
outputfield(2,value1[1],0,"上週大戶人數");
outputfield(3,value1-value1[1],0,"大戶增加數");
outputfield(4,value2,0,"本週散戶人數");
outputfield(5,value2[1],0,"上週散戶人數");]]></Code>
<Arg><![CDATA[<Arg seed="53e1f128-ea5d-445f-b1e1-c2b48d23aef8" version="1" />]]></Arg>
<Extra><![CDATA[<Extra>
<FirstBarDate val="0" />
<Maxbb val="0" />
<ScriptComplexity val="11" />
<script>
<freq support="9;12" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="主力長期收集" ID="e281ab4c463c4b1ca62b2e4c53dd9082" ReturnType="0" ExecType="1" Folder="/06.籌碼選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:period(60,"計算區間");
setbarfreq("D");
settotalbar(period);

value1=GetField("分公司買進家數","D");
value2=GetField("分公司賣出家數","D");
condition1=false;
if countif(value1<value2,period)>period/2
then condition1=true;

if condition1
and close>open*1.035
and GetField("主力買賣超張數","D")>0
and summation(GetField("主力買賣超張數","D"),5)>0
and summation(GetField("主力買賣超張數","D"),20)>0
and summation(GetField("主力買賣超張數","D"),60)>0
and summation(GetField("主力買賣超張數","D"),120)>0
then ret=1;

]]></Code>
<Arg><![CDATA[<Arg seed="038714cf-96c5-4eb4-80f7-25df1aa0b043" version="1"><Param name="計算區間" varname="period" type="1" subtype="0" value="60" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<FirstBarDate val="0" />
<Maxbb val="0" />
<script>
<freq support="8;11" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="-1" />
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="N年來漲了M倍的公司" ID="52508f18dab84d33865c4ea6e581b712" ReturnType="0" ExecType="3" Folder="/04.價量選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:y1(10,"計算的年數");
input:ratio(800,"上漲的倍數%");

value1=rateofchange(GetField("收盤價","AM"),y1*12);

if value1>=ratio
then ret=1;]]></Code>
<Arg><![CDATA[<Arg seed="83777a06-a18d-4d34-b4d7-a042937c44c2" version="1"><Param name="計算的年數" varname="y1" type="1" subtype="0" value="10" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="上漲的倍數%" varname="ratio" type="1" subtype="0" value="800" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<TotalBar val="3" />
<FirstBarDate val="0" />
<Maxbb val="0" />
<script>
<freq support="13;8;9;10;11;12;14;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="本業獲利佔八成以上" ID="f4ae9803d26148e68e8be3a5ca1e9b46" ReturnType="0" ExecType="1" Folder="/08.財報選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[value1=GetField("營業利益","Q");//單位百萬
value2=GetField("稅前淨利","Q");//單位百萬
if value2>0
then begin
if value1/value2*100>80
then ret=1;
end;]]></Code>
<Arg><![CDATA[<Arg seed="e5658f83-2bf4-49bb-b938-0e7805bfde43" version="1" />]]></Arg>
<Extra><![CDATA[<Extra>
<TotalBar val="3" />
<Maxbb val="0" />
<script>
<freq support="14;8;9;10;11;12;13;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="籌碼集中度超過兩成的股票" ID="d386c0a89b9a4e9caf96ff0527532ea1" ReturnType="0" ExecType="1" Folder="/06.籌碼選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:day(10,"天數");
input:ratio(20,"最低百分比");
setbarfreq("D");
settotalbar(day+3);

value1=GetField("主力買賣超張數","D");

if volume<>0 then 
	value2=summation(value1,day)/summation(volume,day)*100;
if value2>=ratio then 
	ret=1;
	
outputfield(1,value2,0,"籌碼集中度");
]]></Code>
<Arg><![CDATA[<Arg seed="c3a62911-c935-4f53-a08c-23a4e41633b4" version="1"><Param name="天數" varname="day" type="1" subtype="0" value="10" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="最低百分比" varname="ratio" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<FirstBarDate val="0" />
<Maxbb val="0" />
<script>
<freq support="8;11" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="-1" />
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="自營商拉抬" ID="a8dcda42f51946a9a36821213ed9ea10" ReturnType="0" ExecType="1" Folder="/06.籌碼選股/" StatusMask="2">
<Desc><![CDATA[近期自營商持續買超且股價上揚。]]></Desc>
<Code><![CDATA[// 
//
input: Length(10); setinputname(1,"計算天數");
input: UpRatio(3.5); setinputname(2, "上漲幅度(%)");
input: VolumeRatio(5); setinputname(3, "買超佔比例(%)");

variable: SumForce(0);
variable: SumTotalVolume(0);

settotalbar(3);

if RateOfChange(Close, 1) >= UpRatio then
begin
	SumTotalVolume = Summation(volume, Length);
	SumForce = Summation(GetField("自營商買賣超"), Length);
	if SumForce > SumTotalVolume * VolumeRatio / 100 then ret =1;
end;

SetOutputName1("自營商累計買超張數");
OutputField1(SumForce);
]]></Code>
<Arg><![CDATA[<Arg seed="230179fa-20ce-4b20-88d5-a4ae95642ebb" version="1"><Param name="計算天數" varname="Length" type="1" subtype="0" value="10" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="上漲幅度(%)" varname="UpRatio" type="1" subtype="0" value="3.5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="買超佔比例(%)" varname="VolumeRatio" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<script>
<freq support="8;11;9;12;10;13" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="布林帶寬小於N%" ID="2703298e2aed4caeb70c9f6263634030" ReturnType="0" ExecType="1" Folder="/03.進階技術分析/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input: 
	Length(20, "天數"), 
	UpperBand(2, "上"), 
	LowerBand(2, "下"),
	BBW(20,"N");
	
variable: 
	bbandwidth(0);

bbandwidth = bollingerbandwidth(Close, Length, UpperBand, LowerBand);

if bbandwidth <= BBW then ret=1;

outputfield(1,bbandwidth,2,"布林帶寬");
]]></Code>
<Arg><![CDATA[<Arg seed="c09a407f-b192-4be0-a634-f1ef9fb47444" version="1"><Param name="天數" varname="Length" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="上" varname="UpperBand" type="1" subtype="0" value="2" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="下" varname="LowerBand" type="1" subtype="0" value="2" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="N" varname="BBW" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<TotalBar val="10" />
<FirstBarDate val="0" />
<Maxbb val="0" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="近五年至少有一年營業利益超過五億" ID="5e9fc3867a37436cbdf39d39c1c1a753" ReturnType="0" ExecType="3" Folder="/08.財報選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:years(5,"期間");
setbarfreq("Y");
settotalbar(5);

value1=GetField("營業利益","Y");//單位: 百萬
if highest(value1,years)>=500
then ret=1;]]></Code>
<Arg><![CDATA[<Arg seed="8c6abdec-9259-47e8-b721-05a46dfc442c" version="1"><Param name="期間" varname="years" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<Maxbb val="0" />
<script>
<freq support="16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="5" />
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="總市值跌到歷年低點" ID="a796fafc7ab641c8ae010c7abb4dcc62" ReturnType="0" ExecType="3" Folder="/04.價量選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[setbarfreq("Y");
settotalbar(8);

value1=GetField("總市值","Y");
value2=lowest(value1,8);
if value1<value2*1.1
then ret=1;]]></Code>
<Arg><![CDATA[<Arg seed="29c0d8a9-262f-4d40-a75a-8eeea2ccce83" version="1" />]]></Arg>
<Extra><![CDATA[<Extra>
<Maxbb val="0" />
<script>
<freq support="16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="8" />
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="可能由虧轉盈" ID="c2dcf7b56d184be9b3b84f1342900e20" ReturnType="0" ExecType="1" Folder="/08.財報選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[// 計算最新一期月營收的日期(mm=月份)
//
variable: mm(0);
mm = datevalue(getfielddate("月營收","M"),"M");

setbarfreq("M");

// 預估最新一季的季營收(單位=億)
//
if mm=1 or mm=4 or mm=7 or mm=10
then value1=GetField("月營收","M") * 3;
if mm=2 or mm=5 or mm=8 or mm=11
then value1=GetField("月營收","M") * 2 + GetField("月營收","M")[1];
if mm=3 or mm=6 or mm=9 or mm=12
then value1=GetField("月營收","M")+GetField("月營收","M")[1]+GetField("月營收","M")[2];

// 預估獲利(單位=百萬) = 季營收 * 毛利率 - 營業費用
//
value2 = value1 * GetField("營業毛利率","Q") - GetField("營業費用","Q");

if GetField("營業利益","Q")<0
and value2>0 
then ret=1;

outputfield(1,value2 / 100,2,"預估單季本業獲利(億)");
outputfield(2,GetField("營業利益","Q"),0,"最近一季營業利益");
]]></Code>
<Arg><![CDATA[<Arg seed="7e860af5-13df-41e0-8fdc-2ea1680fa4fe" version="1" />]]></Arg>
<Extra><![CDATA[<Extra>
<TotalBar val="10" />
<FirstBarDate val="0" />
<Maxbb val="0" />
<script>
<freq support="10;13" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="平台整理後跌破" ID="75b36a8a951941a899c933e9d03a1b86" ReturnType="0" ExecType="3" Folder="/05.型態選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[setbarfreq("AD");

input:Period(15, "平台區間");
input:ratio(7, "整理幅度(%)");
input:ratio1(2,"各高點(低點)間的差異幅度");

variable:h1(0),h2(0),L1(0),L2(0);

h1=nthhighest(1,high[1],period);
h2=nthhighest(4,high[1],period);
l1=nthlowest(1,low[1],period);
l2=nthlowest(4,low[1],period);
 
if (h1-l1)/l1<=ratio/100
and (h1-h2)/h2<=ratio1/100
and (l2-l1)/l1<=ratio1/100
and close crosses below l1
and close[period+30]>l1*1.1
then ret=1;

outputfield(1, l1, 2, "區間低點", order := -1);
]]></Code>
<Arg><![CDATA[<Arg seed="b3f2f6dd-f4f0-46bb-b63f-d3ec573e926f" version="1"><Param name="平台區間" varname="Period" type="1" subtype="0" value="15" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="整理幅度(%)" varname="ratio" type="1" subtype="0" value="7" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="各高點(低點)間的差異幅度" varname="ratio1" type="1" subtype="0" value="2" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<TotalBar val="10" />
<FirstBarDate val="0" />
<Maxbb val="0" />
<script>
<freq support="11" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="區間內股價創新高天數達一定水準" ID="1ab7eaff97cb499e9303c77fea4501e8" ReturnType="0" ExecType="1" Folder="/04.價量選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:period(10,"計算區間");
input:lowlimit(3,"附合條件的最低次數");
if countif(high=highest(high,20),period)>=lowlimit
then ret=1;]]></Code>
<Arg><![CDATA[<Arg seed="d454a776-2098-4d0a-8967-736a15919291" version="1"><Param name="計算區間" varname="period" type="1" subtype="0" value="10" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="附合條件的最低次數" varname="lowlimit" type="1" subtype="0" value="3" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<TotalBar val="10" />
<FirstBarDate val="0" />
<Maxbb val="0" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="五日週轉率大於二十日週轉率" ID="566ed092fa9e4736b9984292aece85c6" ReturnType="0" ExecType="1" Folder="/04.價量選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[if turnoverrate(5)>turnoverrate(20)
then ret=1;
outputfield(1,turnoverrate(5),1,"5日平均週轉率");
outputfield(2,turnoverrate(20),1,"20日平均週轉率");
]]></Code>
<Arg><![CDATA[<Arg seed="736ae9af-17ee-4218-9b89-e807803f6a72" version="1" />]]></Arg>
<Extra><![CDATA[<Extra>
<TotalBar val="10" />
<FirstBarDate val="0" />
<Maxbb val="0" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="券增價漲" ID="460545d1795d4236a33b8a3e6abe5f51" ReturnType="0" ExecType="1" Folder="/06.籌碼選股/" StatusMask="2">
<Desc><![CDATA[融券餘額創新高且股價上揚。]]></Desc>
<Code><![CDATA[input: Length(10); setinputname(1,"近期天數");
input: UpRatio(3.5); setinputname(2, "上漲幅度(%)");

settotalbar(3);

if RateOfChange(Close, 1) >= UpRatio and
	Getfield("融券餘額張數") > 0 and
	Getfield("融券餘額張數") = highest(Getfield("融券餘額張數"), Length)  
then ret=1;

SetOutputName1("融券餘額張數");
OutputField1(Getfield("融券餘額張數"));
]]></Code>
<Arg><![CDATA[<Arg seed="1ca9f31c-0914-4bb7-93ed-47a83e1f2e14" version="1"><Param name="近期天數" varname="Length" type="1" subtype="0" value="10" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="上漲幅度(%)" varname="UpRatio" type="1" subtype="0" value="3.5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<script>
<freq support="8;11;9;12;10;13" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="中小型股整理結束" ID="ea422dd5b2694935bc5b9fc3bc86666b" ReturnType="0" ExecType="3" Folder="/11.選股機器人/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[setbarfreq("AD");

//盤整後噴出
input: Periods(20,"計算期數");
input: Ratio(3,"近期波動幅度%");
input: Direction(1,"方向:1突破 -1跌破");
 
condition1 = false;

if (highest(high[1],Periods-1) - lowest(low[1],Periods-1))/close[1] <= ratio*0.01 
then condition1=true//近期波動在?%以內
else return;

if condition1 and Direction > 0 and high = highest(high, Periods)
and close>close[1]*1.02
then ret=1;//盤整後往上突破

outputfield(1,highest(high[1],Periods-1),2,"整理區高點", order := -1);
]]></Code>
<Arg><![CDATA[<Arg seed="3b013149-4b3f-46df-8bb1-56a1c06f9678" version="1"><Param name="計算期數" varname="Periods" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="近期波動幅度%" varname="Ratio" type="1" subtype="0" value="3" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="方向:1突破 -1跌破" varname="Direction" type="1" subtype="0" value="1" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<FirstBarDate val="0" />
<Maxbb val="0" />
<TotalBar val="300" />
<script>
<freq support="11" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="資產報酬率達到一定的水準且沒有明顯下滑" ID="cf4b5173b8984f4e9b0e86c5bb608041" ReturnType="0" ExecType="3" Folder="/08.財報選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[value1=GetField("資產報酬率","Q");
value2=average(value1,4);
value3=linearregslope(value2,5);
if value3>0
then ret=1;]]></Code>
<Arg><![CDATA[<Arg seed="b28693ff-bd95-4144-a18e-95775cdb39cd" version="1" />]]></Arg>
<Extra><![CDATA[<Extra>
<TotalBar val="3" />
<FirstBarDate val="0" />
<Maxbb val="0" />
<script>
<freq support="14;8;9;10;11;12;13;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="天價上影線賣出訊號" ID="f6fee16dfb4345eba0b3664e108a3fb5" ReturnType="0" ExecType="3" Folder="/11.選股機器人/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[setbarfreq("AD");

variable:Kprice(0);

if H > O*1.03 and C <O and H = highest(H,255) then Kprice = L;

condition1 = c crosses below Kprice;
condition2 = average(volume[1], 5) >= 500;
ret = condition1 and condition2;

outputfield(1,Kprice,2,"關卡價", order := -1);
]]></Code>
<Arg><![CDATA[<Arg seed="b26d0ab0-d888-460e-b9f3-0fbb1d9948b9" version="1" />]]></Arg>
<Extra><![CDATA[<Extra>
<TotalBar val="10" />
<FirstBarDate val="0" />
<Maxbb val="0" />
<script>
<freq support="11" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="PEG指標" ID="1f1035bb3fd641e1865e6ee52c550c78" ReturnType="0" ExecType="1" Folder="/08.財報選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:r1(1);	setinputname(1,"PEG上限");

settotalbar(3);

// PEG指標
//
value1 = GetField("本益比","D");
value2 = GetField("月營收年增率","M"); 
if value1 > 0 and value2 > 0 and value1 / value2 < r1 then
ret=1;

SetOutputName1("PEG指標");
OutputField1(value1 / value2);

]]></Code>
<Arg><![CDATA[<Arg seed="93815aa6-a4a3-4202-bb0e-bdd86d84b9cc" version="1"><Param name="PEG上限" varname="r1" type="1" subtype="0" value="1" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="流動資產減負債超過市值N成" ID="46cd6f0df91e48069ae1aea93589602a" ReturnType="0" ExecType="1" Folder="/08.財報選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:ratio(80,"佔總市值百分比%");
if (GetField("流動資產","Q")-GetField("負債總額","Q"))*100>GetField("總市值","D")*ratio/100
then ret=1;]]></Code>
<Arg><![CDATA[<Arg seed="867b4c60-f840-4dd9-8a78-71bd2fd98c20" version="1"><Param name="佔總市值百分比%" varname="ratio" type="1" subtype="0" value="80" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<TotalBar val="3" />
<FirstBarDate val="0" />
<Maxbb val="0" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="上游價格指標趨勢向上" ID="ba3ef036486544978b2b47bebad2f448" ReturnType="0" ExecType="3" Folder="/11.選股機器人/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input: Period(20, "天期"); 
Condition1 = rateofchange(GetField("上游股價指標"), period) >= Period; 
Condition2 = GetField("上游股價指標") > GetField("上游股價指標")[Period/2]; 
Condition3 = GetField("上游股價指標") > average(GetField("上游股價指標"), period); 
ret = condition1 and condition2 and condition3; 

outputfield(1,rateofchange(GetField("上游股價指標","D"),period),2,"上游漲幅%", order := 1);
]]></Code>
<Arg><![CDATA[<Arg seed="099243f8-446c-405b-a437-9fa11b417bed" version="1"><Param name="天期" varname="Period" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<FirstBarDate val="0" />
<Maxbb val="0" />
<TotalBar val="3" />
<script>
<freq support="8;11" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="佔大盤成交量比開始上昇" ID="7217e31653a5440c827ccb7adb5fc22b" ReturnType="0" ExecType="3" Folder="/03.進階技術分析/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[value1=GetField("佔全市場成交量比","D");

SetTotalBar(5);

if value1[4]=lowest(value1,5) and 
   value1=highest(value1,5) and 
   close crosses above average(close,5)
then ret=1;

SetOutputName1("佔全市場成交量比(%)");
OutputField1(value1);
]]></Code>
<Arg><![CDATA[<Arg seed="e1a91141-d5b7-4d87-b187-b5a24a02c22a" version="1" />]]></Arg>
<Extra><![CDATA[<Extra>
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="5" />
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="MACD死亡交叉" ID="d98e744cdaf44cf785082560b004e543" ReturnType="0" ExecType="1" Folder="/02.基本技術指標/" StatusMask="2">
<Desc><![CDATA[MACD指標出現死亡交叉。]]></Desc>
<Code><![CDATA[// MACD 死亡交叉 (dif向下穿越macd)
//
input: FastLength(12), SlowLength(26), MACDLength(9);
variable: difValue(0), macdValue(0), oscValue(0);

SetTotalBar((maxlist(FastLength,SlowLength,6) + MACDLength) * 4);

SetInputName(1, "DIF短期期數");
SetInputName(2, "DIF長期期數");
SetInputName(3, "MACD期數");

MACD(weightedclose(), FastLength, SlowLength, MACDLength, difValue, macdValue, oscValue);

Ret = difValue Crosses Below macdValue;



]]></Code>
<Arg><![CDATA[<Arg seed="b6667719-694a-457b-90b5-91aff2509ca9" version="1"><Param name="DIF短期期數" varname="FastLength" type="1" subtype="0" value="12" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="DIF長期期數" varname="SlowLength" type="1" subtype="0" value="26" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="MACD期數" varname="MACDLength" type="1" subtype="0" value="9" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<Maxbb val="2" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="-1" />
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="股價小於近N期平均" ID="d1246a8ae1b74613b651012e074813d1" ReturnType="0" ExecType="1" Folder="/00.語法範例/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:N(5); setinputname(1, "期別"); 

SetTotalBar(3);

Value1 = Average(GetField("Close"),N);
if GetField("Close") < Value1 then ret=1; 

SetOutputName1("均價");
outputfield1(Value1);

]]></Code>
<Arg><![CDATA[<Arg seed="90fd6397-1218-4140-bfec-e9a621e58f51" version="1"><Param name="期別" varname="N" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="每股來自營運現金流量" ID="68144bc735144c0ab4120c934c7c123b" ReturnType="0" ExecType="1" Folder="/08.財報選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:r1(25);	setinputname(1,"來自營運的現金流量佔股本比率下限%");

settotalbar(3);

value1=GetField("最新股本");				// 單位=億
value2=GetField("來自營運之現金流量","Q");	// 單位=百萬
value3=value2/value1;						// 單位=%

if value3 > r1
then ret=1;

setoutputname1("來自營運的現金流量佔股本比率(%)");
outputfield1(value3);]]></Code>
<Arg><![CDATA[<Arg seed="cb4f5427-3674-4eb6-a048-27acce24cce6" version="1"><Param name="來自營運的現金流量佔股本比率下限%" varname="r1" type="1" subtype="0" value="25" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<script>
<freq support="8;11" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="KD黃金交叉" ID="8706ccc94c0148e7b274a222bba3cf28" ReturnType="0" ExecType="3" Folder="/02.基本技術指標/" StatusMask="2">
<Desc><![CDATA[KD指標出現黃金交叉。]]></Desc>
<Code><![CDATA[// KD指標, K值由下往上穿越D值
//
input: Length(9), RSVt(3), Kt(3);
variable: rsv(0), k(0), _d(0);

SetTotalBar(maxlist(Length,6) * 3);

SetInputName(1, "天數");
SetInputName(2, "RSVt權數");
SetInputName(3, "Kt權數");

Stochastic(Length, RSVt, Kt, rsv, k, _d);

Ret = k crosses above _d;
]]></Code>
<Arg><![CDATA[<Arg seed="25a2d73e-d131-4989-9104-369891902319" version="1"><Param name="天數" varname="Length" type="1" subtype="0" value="9" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="RSVt權數" varname="RSVt" type="1" subtype="0" value="3" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="Kt權數" varname="Kt" type="1" subtype="0" value="3" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<Maxbb val="9" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="-1" />
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="長紅" ID="c3662dc65f8a4ac1ab8e0aefad1a7b62" ReturnType="0" ExecType="1" Folder="/05.型態選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[if close>=open*1.035
then ret=1;]]></Code>
<Arg><![CDATA[<Arg seed="894bf9c2-4415-4c40-b829-45759727a895" version="1" />]]></Arg>
<Extra><![CDATA[<Extra>
<TotalBar val="3" />
<Maxbb val="0" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="投信可能會作帳的股票" ID="511f910f51f944a8a7d83b99f92cfdb6" ReturnType="0" ExecType="3" Folder="/09.時機操作/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[setbarfreq("AD");
settotalbar(50);

input:r1(50,"股本上限單位億");
input:day(30,"天期");
input:r2(15,"區間買超天數");
input:r3(5000,"區間合計買超張數");
input:r4(30,"漲幅上限");

value1=GetField("投信買張","D");
value2=GetField("最新股本");//單位:億

condition1=false;
condition2=false;
condition3=false;

if value2<r1
then condition1=true;//股本小於50億元

value3=countif(value1>50,day);
if value3>=r2
then condition2=true;//近30天裡有超過15天買超

if summation(value1,day)>r3
then condition3=true;//近30天合計買超超過5000張

if condition1 and condition2 and condition3
and close<close[day-1]*(1+r4/100)
then ret=1;

outputfield(1,summation(value1,day),0,"投信累計買進", order := 1);
]]></Code>
<Arg><![CDATA[<Arg seed="edb5a4fe-17f8-4733-bd50-6158cbbf571b" version="1"><Param name="股本上限單位億" varname="r1" type="1" subtype="0" value="50" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="天期" varname="day" type="1" subtype="0" value="30" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="區間買超天數" varname="r2" type="1" subtype="0" value="15" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="區間合計買超張數" varname="r3" type="1" subtype="0" value="5000" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="漲幅上限" varname="r4" type="1" subtype="0" value="30" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<script>
<freq support="11" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="50" />
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="總市值位於歷史低檔區" ID="43436005bf9445a1a2455d957ece99bf" ReturnType="0" ExecType="3" Folder="/11.選股機器人/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[setbarfreq("AD");

input:period(1250,"計算天數");
input:ratio(10,"距離低點幅度");

value1=GetField("總市值");
value2=lowest(GetField("總市值"),period);

if value1<value2*(1+ratio/100)
//總市值距離過去一段時間最低點沒有差多遠
then begin

	if close=highest(close,20)
	and close<close[19]*1.07
	and close crosses over average(close,20)
	and close<=15

	then ret=1;

end;

outputfield(1, value1, 2, "總市值(億)", order := -1);
]]></Code>
<Arg><![CDATA[<Arg seed="e15fd41f-0344-4b4a-a2f8-319753de9023" version="1"><Param name="計算天數" varname="period" type="1" subtype="0" value="1250" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="距離低點幅度" varname="ratio" type="1" subtype="0" value="10" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<FirstBarDate val="0" />
<Maxbb val="0" />
<TotalBar val="1600" />
<script>
<freq support="11" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="利息支出佔股本比例" ID="85977e68e0044dc89cfd3ffc92f587d6" ReturnType="0" ExecType="1" Folder="/08.財報選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:r1(5);	setinputname(1,"利息支出佔股本比例(%)");

settotalbar(3);

value1=GetField("最新股本");		//單位億
value2=GetField("利息支出","Y");	//單位百萬

value3=value2/(value1*100) * 100;

if value3 > r1
then ret=1;

SetOutputName1("利息支出佔股本比例(%)");
OutputField1(value3);
]]></Code>
<Arg><![CDATA[<Arg seed="bebd1345-d2a3-47d1-805b-0b35af12c2ee" version="1"><Param name="利息支出佔股本比例(%)" varname="r1" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<script>
<freq support="8;11" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="KD與均線同步出現買進訊號" ID="023163215b6f4c7cb4e900eeedcf1536" ReturnType="0" ExecType="3" Folder="/03.進階技術分析/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input: Length(60, "均線期間");

variable:rsv1(0),k1(0),d1(0);

stochastic(9,3,3,rsv1,k1,d1);

// K線黃金交叉
condition1 = k1 crosses over d1;

condition2 = close crosses over average(close,Length) or close[1] crosses over average(close[1],Length);

// 確認有一定的成交量
condition3 = average(volume,20) > 1000;

ret = condition1 and condition2 and condition3;

outputfield(1,average(close,Length),2,"60日均線", order := -1);
]]></Code>
<Arg><![CDATA[<Arg seed="a095215e-6a6e-46c5-80cf-10a0b30e5a5d" version="1"><Param name="均線期間" varname="Length" type="1" subtype="0" value="60" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<FirstBarDate val="0" />
<Maxbb val="0" />
<TotalBar val="27" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="市值研發費用比" ID="3f6ff9620e8c41b8a65140f8e9256b07" ReturnType="0" ExecType="1" Folder="/08.財報選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:n(5);						setinputname(1,"研發費用市值比");

settotalbar(3);

value1=GetField("總市值");				// 單位=億
value2=GetField("研發費用","Y");		// 單位=百萬
value3=value2 / value1;					// % 
if value3 > n
then ret=1;

SetOutputName1("研發費用市值比");
OutputField1(value3);
]]></Code>
<Arg><![CDATA[<Arg seed="5757c05b-9e7d-4d2b-b1bf-a31efb0e18f7" version="1"><Param name="研發費用市值比" varname="n" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<script>
<freq support="8;11;9;12;10;13;14;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="週轉率高點買進" ID="22d08de04da94a87b78e2f52f56a0137" ReturnType="0" ExecType="3" Folder="/11.選股機器人/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[setbarfreq("AD");

value1=GetField("成交金額");
value2=GetField("總成交次數","D");
if value2>0 then value3=value1/value2;

if value3=highest(value3,200)
and close>close[1]*1.025
and close[2]<close[12]*1.05
and volume>2000
then ret=1;

outputfield(1, GetField("週轉率","D"), 2, "週轉率%", order := 1);
]]></Code>
<Arg><![CDATA[<Arg seed="cce8366e-0986-4d85-9918-8ceef85d5512" version="1" />]]></Arg>
<Extra><![CDATA[<Extra>
<TotalBar val="10" />
<FirstBarDate val="0" />
<Maxbb val="0" />
<script>
<freq support="11" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="現增佔比低" ID="cc26be4ec43a488b8012f7f3de15472f" ReturnType="0" ExecType="1" Folder="/08.財報選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[value1=GetField("現金增資佔股本比重","Y");
if value1<20
then ret=1;

]]></Code>
<Arg><![CDATA[<Arg seed="ce5255fa-c45c-49f9-b6ab-dd71a05c1cdf" version="1" />]]></Arg>
<Extra><![CDATA[<Extra>
<TotalBar val="10" />
<FirstBarDate val="0" />
<Maxbb val="0" />
<script>
<freq support="16;8;9;10;11;12;13;14;15" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="主力發動股" ID="94b810146b6146779df900d1ef6129eb" ReturnType="0" ExecType="1" Folder="/06.籌碼選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[//成交量 連續 3 日遞減
//股價 > 20日均線 10%

if volume<volume[1] 
and volume[1]<volume[2]
and close>average(close,20)*1.1
then ret=1;]]></Code>
<Arg><![CDATA[<Arg seed="c2d0c0fa-3e76-4d57-b6b5-efd5bec66fcf" version="1" />]]></Arg>
<Extra><![CDATA[<Extra>
<TotalBar val="10" />
<FirstBarDate val="0" />
<Maxbb val="0" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="MTM跌破0" ID="036c1a5d287e4f2b8046b23e731fbaa8" ReturnType="0" ExecType="1" Folder="/02.基本技術指標/" StatusMask="2">
<Desc><![CDATA[MTM指標向下跌破0。]]></Desc>
<Code><![CDATA[// MTM往下跌破0軸
//
Input: Length(10);

SetInputName(1, "期數");

settotalbar(maxlist(Length,6));

Ret = Momentum(Close, Length) Crosses Below 0;



]]></Code>
<Arg><![CDATA[<Arg seed="c8151e06-9803-4d05-abcd-a6bc9126ba89" version="1"><Param name="期數" varname="Length" type="1" subtype="0" value="10" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="-1" />
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="外資拉抬" ID="3a96aa40ae1c473eb1b6dd78980341ca" ReturnType="0" ExecType="1" Folder="/06.籌碼選股/" StatusMask="2">
<Desc><![CDATA[近期外資持續買超且股價上揚。]]></Desc>
<Code><![CDATA[input: Length(10); setinputname(1,"計算天數");
input: UpRatio(3.5); setinputname(2, "上漲幅度(%)");
input: VolumeRatio(5); setinputname(3, "買超佔比例(%)");

variable: SumForce(0);
variable: SumTotalVolume(0);

settotalbar(3);

if RateOfChange(Close, 1) >= UpRatio then
begin
	SumTotalVolume = Summation(volume, Length);
	SumForce = Summation(GetField("外資買賣超"), Length);
	if SumForce > SumTotalVolume * VolumeRatio / 100 then ret =1;
end;

SetOutputName1("外資累計買超張數");
OutputField1(SumForce);
]]></Code>
<Arg><![CDATA[<Arg seed="44e7490f-a925-4ef1-b9b0-56fe22dc2d0c" version="1"><Param name="計算天數" varname="Length" type="1" subtype="0" value="10" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="上漲幅度(%)" varname="UpRatio" type="1" subtype="0" value="3.5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="買超佔比例(%)" varname="VolumeRatio" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<script>
<freq support="8;11;9;12;10;13" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="斷頭後的止跌" ID="1fd5be493dff48c787bd5dcf583eeb2b" ReturnType="0" ExecType="1" Folder="/06.籌碼選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[
input:Length(4); setinputname(1,"計算區間");
input:DVOL(3000); setinputname(2,"區間融資減少張數");
input:R1(30);	 setinputname(3,"區間跌幅(%)");	

SetTotalBar(3);

if Close > Close[1] and 
   RateOfChange(Close, Length) < -1 * R1 and
   GetField("融資餘額張數")[Length] - GetField("融資餘額張數") > DVOL 
then ret=1;

]]></Code>
<Arg><![CDATA[<Arg seed="603bcfd4-68b2-4727-802d-eacd47f06b7c" version="1"><Param name="計算區間" varname="Length" type="1" subtype="0" value="4" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="區間融資減少張數" varname="DVOL" type="1" subtype="0" value="3000" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="區間跌幅(%)" varname="R1" type="1" subtype="0" value="30" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<script>
<freq support="8;11;9;12;10;13" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="收盤價收N日來新低" ID="ed444227b561454e8731401d184aee26" ReturnType="0" ExecType="1" Folder="/04.價量選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:period(100);
setinputname(1,"計算天數");
value1=LOWEST(LOW,period);

if LOW=value1 
then ret=1; ]]></Code>
<Arg><![CDATA[<Arg seed="6d47f896-ff9e-448c-b649-cc4d3c70aac9" version="1"><Param name="計算天數" varname="period" type="1" subtype="0" value="100" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<TotalBar val="3" />
<Maxbb val="0" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="漲勢變強" ID="f84d1fa39f4a4428a9447a81fdea148f" ReturnType="0" ExecType="1" Folder="/04.價量選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input: Length(100);		setinputname(1,"計算期數");
input: RRatio(100);		setinputname(2,"盤漲最大漲幅%");

settotalbar(3);

variable: Scores(0);

if Close > Open and Close > Close[2]*1.07  {紅棒且累計三天漲幅大於7%}
   and Close < Close[Length]*(1+RRatio/100)  {累計漲幅不超過%}
then 
  begin
	scores = countif(close > close[1], length);
	If scores >= Length / 2 then ret=1;
  end;


 ]]></Code>
<Arg><![CDATA[<Arg seed="aab861b4-a7a7-4cc7-ae71-22e769d46939" version="1"><Param name="計算期數" varname="Length" type="1" subtype="0" value="100" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="盤漲最大漲幅%" varname="RRatio" type="1" subtype="0" value="100" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="跌不下去的高殖利率股" ID="b036f2db77cd4cb28bf77c1b6bbd9355" ReturnType="0" ExecType="3" Folder="/10.價值投資/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:N(20, "天期");
 
condition1 = L = Lowest(L,N);
condition2 = H = Highest(H,N);
 
if condition2
//股價創區間以來高點
and	TrueAll(Condition1=false,N)
//這段區間都未破底
and close<close[N-1]*1.05
and volume>600
//區間股價漲幅不大
then ret=1;

outputfield(1, GetField("股東權益報酬率","Q"),2, "股東權益%", order := 1);
outputfield(2, GetField("現金股利","Y"),2, "現金股利");
]]></Code>
<Arg><![CDATA[<Arg seed="0c6bff83-20ab-4a45-8501-e6e308b482a8" version="1"><Param name="天期" varname="N" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<TotalBar val="10" />
<FirstBarDate val="0" />
<Maxbb val="0" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="低PB股的逆襲" ID="27c736947dad41418ef49da4f7408b93" ReturnType="0" ExecType="3" Folder="/10.價值投資/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[if close<15
and H = highest(H,20)
and close<lowest(low,20)*1.07
and highest(h,40)>close*1.1
then ret=1;

outputfield(1, GetField("股價淨值比","D"),2, "PB比", order := 1);
]]></Code>
<Arg><![CDATA[<Arg seed="11b8f711-3d08-4e5f-b538-c6ba9b949bd2" version="1" />]]></Arg>
<Extra><![CDATA[<Extra>
<TotalBar val="10" />
<FirstBarDate val="0" />
<Maxbb val="0" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="近期有大額資本支出" ID="2b62d10cd1fd48fda8cd06e42cdf3dfe" ReturnType="0" ExecType="3" Folder="/08.財報選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:period(20,"計算N季");
input:lm(30,"比均值增加的幅度");
input:cm(500,"單季資本支出金額下限");
settotalbar(period+1);

value1=GetField("資本支出金額","Q");//單位: 百萬
value2=GetField("資本支出營收比","Q");//單位：%
value3=average(value1,period);
value4=average(value2,period);

if value1>cm//資本支出超過一定金額
and value1>value3*(1+lm/100)
and value2>value4*(1+lm/100)
then ret=1;]]></Code>
<Arg><![CDATA[<Arg seed="59b6df64-4dff-4fbc-b426-f8ba0b159a4b" version="1"><Param name="計算N季" varname="period" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="比均值增加的幅度" varname="lm" type="1" subtype="0" value="30" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="單季資本支出金額下限" varname="cm" type="1" subtype="0" value="500" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<FirstBarDate val="0" />
<Maxbb val="0" />
<script>
<freq support="14;8;9;10;11;12;13;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="-1" />
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="主力買超超過門檻" ID="f0848453326943b1b35cdc5a2d2ba708" ReturnType="0" ExecType="1" Folder="/06.籌碼選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input: Length(5); 	setinputname(1,"計算天數");
input: limit1(20);	setinputname(2,"買超佔成交量比例");

variable: r1(0), volTotal(0),ratio(0);

SetTotalBar(3);

r1 = summation(GetField("主力買賣超張數"), Length);
volTotal = summation(Volume, Length);

if voltotal<>0 then 
  begin
	ratio = r1 / voltotal * 100;
    if ratio >= limit1 and average(volume,20) > 500 then ret=1;
	
	setoutputname1("主力買賣超比重(%)");
	outputfield1(ratio);
  end;
]]></Code>
<Arg><![CDATA[<Arg seed="b32c814b-856c-4b71-89da-8bf8fb141427" version="1"><Param name="計算天數" varname="Length" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="買超佔成交量比例" varname="limit1" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<script>
<freq support="8;11;9;12;10;13" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="流動資產減負債超過總市值N成" ID="a50a3ce6ec844b9d82bba5200eec6355" ReturnType="0" ExecType="1" Folder="/08.財報選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:ratio(80,"比率下限");

value1=GetField("流動資產","Q");//單位百萬
value2=GetField("負債總額","Q");//單位百萬
value3=GetField("總市值","D");//單位億

if (value1-value2)>=value3*ratio
then ret=1;]]></Code>
<Arg><![CDATA[<Arg seed="8e070be2-6733-4ffe-89e5-4469599fd645" version="1"><Param name="比率下限" varname="ratio" type="1" subtype="0" value="80" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<TotalBar val="3" />
<FirstBarDate val="0" />
<Maxbb val="0" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="股價蠢蠢欲動" ID="f148029505e5461bad24cd8a11e5a61b" ReturnType="0" ExecType="3" Folder="/03.進階技術分析/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[SetTotalBar(23);

value1=truerange();
value2=highest(value1,20);

if value1 > value2[1] and 
   value1 > value1[1] and 
   close*1.01 > high and 
   close > close[1]
then ret=1;
]]></Code>
<Arg><![CDATA[<Arg seed="1fa609d4-c8d6-42a5-8ca1-918340c21100" version="1" />]]></Arg>
<Extra><![CDATA[<Extra>
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="23" />
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="M日內連續N日上漲" ID="b39f7eb1c4214bf387d37072c4f8df74" ReturnType="0" ExecType="1" Folder="/04.價量選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:day(11);
input:m1(3);
setinputname(1,"計算天期");
setinputname(2,"連續上漲天數");

variable:x(0),count(0);
count=0;
for x=0 to day-m1 
begin
if close[x]>close[x+1]
and close[x+1]>close[x+2]
and close[x+2]>close[x+3]
then count=count+1;
end;
if count>=1
then ret=1;


]]></Code>
<Arg><![CDATA[<Arg seed="38969b46-8075-4636-b661-bf126eb68df4" version="1"><Param name="計算天期" varname="day" type="1" subtype="0" value="11" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="連續上漲天數" varname="m1" type="1" subtype="0" value="3" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<TotalBar val="3" />
<Maxbb val="0" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="籌碼安定比率" ID="2cb8cd91729e407798907f759421fe2a" ReturnType="0" ExecType="1" Folder="/06.籌碼選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:r1(60);	setinputname(1,"投信外資及董監合計持股比例下限(%)");

SetTotalBar(3);

value1=GetField("投信持股比例","D");
value2=GetField("外資持股比例","D");
value3=GetField("董監持股佔股本比例","D");
value4=value1+value2+value3;

if value4 > r1
then ret=1;

]]></Code>
<Arg><![CDATA[<Arg seed="9fce166d-698e-4f45-86f7-1857fce2952a" version="1"><Param name="投信外資及董監合計持股比例下限(%)" varname="r1" type="1" subtype="0" value="60" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<Maxbb val="50" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="EPS連續N季衰退" ID="bfc890ba90504a41a4244c6602bf3844" ReturnType="0" ExecType="1" Folder="/00.語法範例/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:N(4); SetInputName(1, "期別");
 
SetTotalBar(3); 

if TrueAll(GetField("EPS","Q") < GetField("EPS","Q")[1],N) then ret=1; 

SetOutputName1("EPS(元)(季)"); 
OutputField1(GetField("EPS","Q")); 
]]></Code>
<Arg><![CDATA[<Arg seed="59fd51f6-6738-4d92-9b91-3cd0e3ac8d58" version="1"><Param name="期別" varname="N" type="1" subtype="0" value="4" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<script>
<freq support="14;8;9;10;11;12;13;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="投信第一天大買" ID="4a421467470249a0ba1a12d81505432c" ReturnType="0" ExecType="1" Folder="/11.選股機器人/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[setbarfreq("AD");

input: v1(500, "投信估計持股上限(張)");

value1=GetField("投信持股","D");
value2=GetField("投信買賣超","D");

if value1 < v1 and value2 > VOLUME*0.2
then ret=1;

outputfield(1,GetField("投信買賣超","D"),0,"投信買超", order := 1);
]]></Code>
<Arg><![CDATA[<Arg seed="246bed8c-e3ac-4c2f-b005-e87838187ed6" version="1"><Param name="投信估計持股上限(張)" varname="v1" type="1" subtype="0" value="500" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<TotalBar val="3" />
<Maxbb val="0" />
<script>
<freq support="11" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="突破糾結均線" ID="40542167bcc540df8c31652539f70dcc" ReturnType="0" ExecType="1" Folder="/03.進階技術分析/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input: shortlength(5); 	setinputname(1,"短期均線期數");
input: midlength(10); 	setinputname(2,"中期均線期數");
input: Longlength(20); 	setinputname(3,"長期均線期數");
input: Percent(2);  	setinputname(4,"均線糾結區間%");
input: Volpercent(25);  setinputname(5,"放量幅度%");//帶量突破的量是超過最長期的均量多少%
input: VolLimit(2000); 	setinputname(6,"最小成交量");

variable: shortaverage(0);
variable: midaverage(0);
variable: Longaverage(0);
variable: maxaverage(0);


shortaverage = average(close,shortlength);
midaverage = average(close,midlength);
Longaverage = average(close,Longlength);
maxaverage = maxlist(shortaverage,midaverage,Longaverage);

SetTotalBar(8);

if 
	volume > average(volume,Longlength) * (1 + volpercent * 0.01) and 
	volume > VolLimit and
    Close crosses over maxaverage 
then
  begin
	value1= absvalue(shortaverage -midaverage);
	value2= absvalue(midaverage -Longaverage);
	value3= absvalue(Longaverage -shortaverage);
	if maxlist(value1,value2,value3)*100 < Percent*Close then  ret=1;
  end;
  ]]></Code>
<Arg><![CDATA[<Arg seed="d3476e83-64a6-4838-8d31-496f00d10354" version="1"><Param name="短期均線期數" varname="shortlength" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="中期均線期數" varname="midlength" type="1" subtype="0" value="10" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="長期均線期數" varname="Longlength" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="均線糾結區間%" varname="Percent" type="1" subtype="0" value="2" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="放量幅度%" varname="Volpercent" type="1" subtype="0" value="25" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="最小成交量" varname="VolLimit" type="1" subtype="0" value="2000" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="8" />
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="營收上昇費用降低" ID="906c238872b64297b0307cca16722da1" ReturnType="0" ExecType="3" Folder="/08.財報選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:period(5,"計算的季別");
input:count(2,"符合條件之最低次數");
setbarfreq("Q");
settotalbar(period+1);

value1=GetField("營業收入淨額","Q");//單位百萬
value2=GetField("營業費用","Q");//單位百萬

if countif(value1>value1[1] and value2<value2[1],period)>=count
then ret=1;]]></Code>
<Arg><![CDATA[<Arg seed="6ca5eaf1-6637-479e-a6d9-aeefefd5f503" version="1"><Param name="計算的季別" varname="period" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="符合條件之最低次數" varname="count" type="1" subtype="0" value="2" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<FirstBarDate val="0" />
<Maxbb val="0" />
<script>
<freq support="14" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="-1" />
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="大戶進散戶出" ID="7852d9c8550b42788668445f7b98382c" ReturnType="0" ExecType="1" Folder="/06.籌碼選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[//說明：如果本週大戶散戶集保資料尚未更新，則會用上週資料代替本週。

input: offset(9999,"不用調整，相容用參數");
input: periods(3, "連續期別");
var:sameweek(0); 

setbarfreq("W");
settotalbar(3);

if getinfo("FilterMode") = 1 then  
	sameweek = 0 
else if 
	datediff(GetFielddate("收盤價","D"),GetFielddate("收盤價","W")) < 6 
then  sameweek = 1 else  sameweek = 0; 

condition1 = trueall(getfield("大戶持股比例", "W", param:=400)[sameweek] > getfield("大戶持股比例", "W", param:=400)[sameweek+1], periods);
condition2 = trueall(getfield("散戶持股比例", "W", param:=100)[sameweek] < getfield("散戶持股比例", "W", param:=100)[sameweek+1], periods);

ret= condition1 and condition2;

outputfield(1, getfield("大戶持股比例", "W", param:=400)[sameweek], 2, "大戶比例");
outputfield(2, getfield("散戶持股比例", "W", param:=100)[sameweek], 2, "散戶比例");]]></Code>
<Arg><![CDATA[<Arg seed="858d97b4-bace-4a14-935b-641121122421" version="1"><Param name="不用調整，相容用參數" varname="offset" type="1" subtype="0" value="9999" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="連續期別" varname="periods" type="1" subtype="0" value="3" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<FirstBarDate val="0" />
<Maxbb val="0" />
<ScriptComplexity val="33" />
<script>
<freq support="9;12" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="上一季本業賺錢" ID="0d195a5cf6a54e7583994c1c66fa1895" ReturnType="0" ExecType="1" Folder="/08.財報選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[value1=GetField("營業利益率","Q");
if value1>0
then ret=1;]]></Code>
<Arg><![CDATA[<Arg seed="7a5eaee1-ef97-4ae6-b921-e4ad3ec64796" version="1" />]]></Arg>
<Extra><![CDATA[<Extra>
<TotalBar val="3" />
<Maxbb val="0" />
<script>
<freq support="14;8;9;10;11;12;13;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="N日內三大法人曾同步買超" ID="d1d3f08a77b84e80902d347f41bc9c87" ReturnType="0" ExecType="1" Folder="/06.籌碼選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:days(20,"計算天期");
setbarfreq("D");
settotalbar(days+1);

value1=GetField("外資買賣超","D");
value2=GetField("投信買賣超","D");
value3=GetField("自營商自行買賣買賣超","D");
condition1=value1>0 and value2>0 and value3>0;
if barslast(condition1)<days
then ret=1;]]></Code>
<Arg><![CDATA[<Arg seed="cc1becc2-4056-41c6-8f96-76ff36ee8e0a" version="1"><Param name="計算天期" varname="day" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<FirstBarDate val="0" />
<Maxbb val="0" />
<script>
<freq support="8;11" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="-1" />
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="N日以來投信曾大買過" ID="dc6b68f261e742a0959895d512ec2849" ReturnType="0" ExecType="3" Folder="/06.籌碼選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:period(250,"計算期間");
input:days(5,"計算買進的天數");
input:amount(3000,"大買的最低張數");
setbarfreq("D");
settotalbar(period+days);

value1=GetField("投信買張");
value2=summation(value1,days);
if countif(value2>=amount,period)>=1
then ret=1;
]]></Code>
<Arg><![CDATA[<Arg seed="50c18220-93b6-42ca-a333-3e3477e760ca" version="1"><Param name="計算期間" varname="period" type="1" subtype="0" value="250" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="計算買進的天數" varname="day" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="大買的最低張數" varname="amount" type="1" subtype="0" value="3000" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<FirstBarDate val="0" />
<Maxbb val="0" />
<script>
<freq support="8;11" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="-1" />
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="RSI黃金交叉" ID="2c221eab3f0b420083c14a14d8eacbb2" ReturnType="0" ExecType="1" Folder="/02.基本技術指標/" StatusMask="2">
<Desc><![CDATA[RSI指標出現黃金交叉。]]></Desc>
<Code><![CDATA[// RSI短天期往上穿越長天期
//
input: ShortLength(6), LongLength(12);

settotalbar(maxlist(ShortLength,LongLength,6) * 9);

SetInputName(1, "短期期數");
SetInputName(2, "長期期數");

Ret = RSI(Close, ShortLength) Crosses Above RSI(Close, LongLength);




]]></Code>
<Arg><![CDATA[<Arg seed="0f6b63e9-adc9-49c7-a6bd-ad9706e3009e" version="1"><Param name="短期期數" varname="ShortLength" type="1" subtype="0" value="6" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="長期期數" varname="LongLength" type="1" subtype="0" value="12" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<Maxbb val="7" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="-1" />
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="KD死亡交叉" ID="ef1ad1fa22d8455ab2e01c9eb42864fe" ReturnType="0" ExecType="3" Folder="/02.基本技術指標/" StatusMask="2">
<Desc><![CDATA[KD指標出現死亡交叉。]]></Desc>
<Code><![CDATA[// KD指標, K值由上往下穿越D值
//
input: Length(9), RSVt(3), Kt(3);
variable: rsv(0), k(0), _d(0);

SetTotalBar(maxlist(Length,6) * 3);

SetInputName(1, "天數");
SetInputName(2, "RSVt權數");
SetInputName(3, "Kt權數");

Stochastic(Length, RSVt, Kt, rsv, k, _d);

Ret = k crosses below _d;
]]></Code>
<Arg><![CDATA[<Arg seed="bf75f769-926c-4dbf-8dce-07302c208555" version="1"><Param name="天數" varname="Length" type="1" subtype="0" value="9" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="RSVt權數" varname="RSVt" type="1" subtype="0" value="3" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="Kt權數" varname="Kt" type="1" subtype="0" value="3" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<Maxbb val="9" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="-1" />
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="今收破昨高" ID="549ea9dd90cc4241a1e7d65645054e7f" ReturnType="0" ExecType="1" Folder="/04.價量選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[if close>=high[1]
then ret=1;]]></Code>
<Arg><![CDATA[<Arg seed="cbe44518-95be-446a-9c71-71baa99c3275" version="1" />]]></Arg>
<Extra><![CDATA[<Extra>
<TotalBar val="10" />
<FirstBarDate val="0" />
<Maxbb val="0" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="月營收推估出的低本益比股" ID="fae897c7ec414e4eb9e7c7a054a75089" ReturnType="0" ExecType="1" Folder="/10.價值投資/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:peraito(10,"預估本益比上限");

value1=GetField("月營收","M");//單位:億元
value3=GetField("本期稅後淨利","Q");//單位百萬
value4=GetField("營業利益率","Q");
value5=GetField("最新股本");//單位:億元

condition1=false;
condition2=false;
if value5<>0 then
value6=(value1*value4*12)/(value5*100)*10;//單月營收推估的本業EPS
if value6<>0 then 
value7=close/value6;

if value7<peraito and value7>0 and value3>200
then ret=1;

outputfield(1,value7,0,"推估本益比", order := -1);
outputfield(2,value6,2,"推估EPS");
outputfield(3,value1,2,"月營收");
outputfield(4,value4,2,"營業利益率");
outputfield(5,value5,2,"最新股本");


 ]]></Code>
<Arg><![CDATA[<Arg seed="f779418d-380b-4511-b9a2-4d3c40928ca6" version="1"><Param name="預估本益比上限" varname="peraito" type="1" subtype="0" value="10" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<TotalBar val="3" />
<Maxbb val="0" />
<script>
<freq support="8;11" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="投信爭買的小型成長股" ID="5da5f230d0b54cbeaa49b2c19c8cef8b" ReturnType="0" ExecType="1" Folder="/06.籌碼選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input: miniratio(10); 	setinputname(1,"投信買進佔今日總量%");
input: lv(5000); 		setinputname(2,"投信持股張數上限");
input: holdratio(10); 	setinputname(3,"投信持股比例上限%");

SetTotalBar(3);

value1=GetField("投信買張");			//投信買張
value2=GetField("投信持股");			//投信持股
value3=GetField("投信持股比例");		//投信持股比例 

if  
   value1 > volume * miniratio*0.01 and //買進張數/成交量 >= minratio
   value2 < lv and 						//原來庫存低
   value3 < holdratio and 				//原來庫存低
   GetField("公司類別","M") = "小型股" 	//小型股
then ret=1;

SetOutputName1("投信買張");
OutputField1(value1);
]]></Code>
<Arg><![CDATA[<Arg seed="1db9c6cd-f99b-4ff8-8dda-4460ff44a67b" version="1"><Param name="投信買進佔今日總量%" varname="miniratio" type="1" subtype="0" value="10" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="投信持股張數上限" varname="lv" type="1" subtype="0" value="5000" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="投信持股比例上限%" varname="holdratio" type="1" subtype="0" value="10" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<script>
<freq support="8;11;9;12;10;13" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="月營收創N期新低" ID="79f4d0db73a4432587b4096f7be4734e" ReturnType="0" ExecType="1" Folder="/00.語法範例/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:N(13); setinputname(1, "期別"); 

SetTotalBar(3); 

if GetField("月營收", "M") <= Lowest(GetField("月營收", "M"),N) then ret=1; 

SetOutputName1("月營收"); 
OutputField1(GetField("月營收", "M")); 
]]></Code>
<Arg><![CDATA[<Arg seed="f7fdf747-5478-4029-a200-761756acbeed" version="1"><Param name="期別" varname="N" type="1" subtype="0" value="13" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<Maxbb val="0" />
<script>
<freq support="10;8;9;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="突破下降旗型" ID="3c1437d5cbfa4dee8e02dc05bec5ebfa" ReturnType="0" ExecType="3" Folder="/05.型態選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input: Length(100);		Setinputname(1, "區間");
input: UpRatio(2);		SetInputName(2, "當日上漲幅度%");
input: VolLimit(300);	SetInputName(3, "當日成交量下限");

variable: hDate(date),day(0),KeyPrice(0),HighPrice(0);

settotalbar(Length + 3);

if high = highest(high,Length) then hDate = date;

day = datediff(date,hdate);

if day =0 and day[1] > 0 then KeyPrice = Close;

if day >0 and day[1] = 0 then HighPrice = High;

if KeyPrice > 0 and HighPrice > 0 and day > 2 and day <= Length / 2 and 
	Close > Open * (1 + 0.01 * UpRatio) and 
	Close >= highest(High,3) and
	volume > VolLimit and 
	Close > KeyPrice and 
	Close < HighPrice  
then ret=1;


 ]]></Code>
<Arg><![CDATA[<Arg seed="280613d8-0945-48d9-a0ed-3df6f674156e" version="1"><Param name="區間" varname="Length" type="1" subtype="0" value="100" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="當日上漲幅度%" varname="UpRatio" type="1" subtype="0" value="2" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="當日成交量下限" varname="VolLimit" type="1" subtype="0" value="300" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="-1" />
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="BBand出現買進訊號" ID="b99b7e7865c448b794a444fddb5e086b" ReturnType="0" ExecType="3" Folder="/02.基本技術指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:length(20);
variable:up1(0),down1(0),mid1(0),bbandwidth(0);
up1 = bollingerband(Close, Length, 1);
down1 = bollingerband(Close, Length, -1 );
mid1 = (up1 + down1) / 2;

bbandwidth = 100 * (up1 - down1) / mid1;
if bbandwidth crosses above 5 and close > up1 and close> up1[1]
and average(close,20)>average(close,20)[1]
then ret=1;]]></Code>
<Arg><![CDATA[<Arg seed="d28b8d37-30e2-4556-bd8f-c550c2b04fb9" version="1"><Param name="length" varname="length" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<TotalBar val="3" />
<Maxbb val="0" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="跌勢後的內困三日翻紅" ID="cbe11ad986424efb8819ad7b8b5387e9" ReturnType="0" ExecType="3" Folder="/05.型態選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[setbarfreq("AD");

If close[4]=lowest(close,20)
and close[4]*1.2<=close[24]
and open[3]>close[3]*0.01
And close[2]>open[2]*0.01
And close[1]>open[1]*0.01
And close>high[4]
and volume>average(volume,5)
and average(volume,100)>=1000

Then
ret=1;

outputfield(1,close[4],2,"前波低點", order := -1);


]]></Code>
<Arg><![CDATA[<Arg seed="8147150b-5e3e-42f8-94fd-74a27ee9c432" version="1" />]]></Arg>
<Extra><![CDATA[<Extra>
<TotalBar val="10" />
<FirstBarDate val="0" />
<Maxbb val="0" />
<script>
<freq support="11" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="最近4季EPS合計大於X元" ID="e1967bb93bc84feeacb7752644105485" ReturnType="0" ExecType="1" Folder="/00.語法範例/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:X(5); SetInputName(1, "元");

variable: N(4);

SetTotalBar(3); 

Value1 = Summation(GetField("EPS","Q"),N);
if Value1 > X then ret=1; 

SetOutputName1("EPS合計"); 
OutputField1(Value1); 
]]></Code>
<Arg><![CDATA[<Arg seed="6960402e-faec-4f2c-ac25-44b50d9dd19d" version="1"><Param name="元" varname="X" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<script>
<freq support="14;8;9;10;11;12;13;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="旺季不旺" ID="24739d08cb5143aab59195dbb4e7436d" ReturnType="0" ExecType="1" Folder="/07.月營收選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:r1(5,"過去幾年月營收單月成長幅度下限%");
setbarfreq("M");
settotalbar(3);

value1=GetField("月營收月增率","M");
value2=GetField("月營收月增率","M")[12];
value3=GetField("月營收月增率","M")[24];
value4=GetField("月營收月增率","M")[36];

value5=(value2+value3+value4)/3;

if value2 > r1 and value3 > r1 and value4 > r1 and value1 < value5
then ret=1;
]]></Code>
<Arg><![CDATA[<Arg seed="b494fd5b-ebd7-4561-a5de-1bf0f67bb7b4" version="1"><Param name="過去幾年月營收單月成長幅度下限%" varname="r1" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<script>
<freq support="10;13" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="主力慢慢收集籌碼後攻堅" ID="0d1d69c4ecb54c67b4d11c756937eb4a" ReturnType="0" ExecType="3" Folder="/06.籌碼選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[setbarfreq("AD");

input:period(10,"籌碼計算天期");
 
Value1=GetField("分公司買進家數","D");
value2=GetField("分公司賣出家數","D");
value3=(value2-value1);
//賣出的家數比買進家數多的部份
value4=average(close,5);

if period<>0 then begin
   if countif(value3>30, period)/period >0.7
   then ret=1;
end;

outputfield(1, countif(value3>30, period), 0, "進貨天數", order := 1);
]]></Code>
<Arg><![CDATA[<Arg seed="950b1e46-2409-4046-94e4-6e67a7871b05" version="1"><Param name="籌碼計算天期" varname="period" type="1" subtype="0" value="10" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<TotalBar val="10" />
<FirstBarDate val="0" />
<Maxbb val="0" />
<script>
<freq support="11" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="最近三個月營收明顯成長" ID="9e7de21101fb4f9fbd3620bccec68c25" ReturnType="0" ExecType="3" Folder="/07.月營收選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[settotalbar(3);
value1=GetField("月營收月增率","M");
value2=GetField("月營收年增率","M");
condition1=false;
condition2=false;

if average(value1,3)>10 and average(value2,3)>10
and value1>value1[1]
and value2>value2[1] 
then condition1=true;

if trueall(value1>5 and value2>5,3)
then condition2=true;
if condition1 and condition2 then ret=1;

outputfield(1,value1,1,"月營收月增率");
outputfield(2,value1[1],1,"上個月營收月增率");
outputfield(3,value2,1,"月營收年增率");
outputfield(4,value2[1],1,"上個月營收年增率");

]]></Code>
<Arg><![CDATA[<Arg seed="40e8b4b4-e8c0-4aa2-a76d-df86763fbb89" version="1" />]]></Arg>
<Extra><![CDATA[<Extra>
<FirstBarDate val="0" />
<Maxbb val="0" />
<script>
<freq support="10;8;9;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="收盤價創N日來新高" ID="96cadb5ad4c741a5ba882984c8742e30" ReturnType="0" ExecType="1" Folder="/04.價量選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:period(100,"計算天數");
if close=highest(close,period)
then ret=1;
value2=GetField("總市值","D");
outputfield(1,value2,0,"總市值");
]]></Code>
<Arg><![CDATA[<Arg seed="8c5fae83-541e-4555-97e6-09edddd49c5e" version="1"><Param name="計算天數" varname="period" type="1" subtype="0" value="100" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<TotalBar val="3" />
<Maxbb val="0" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="過去三年來自營運的現金流量都大於零" ID="e4770d0622f34daaa33b1a5181a1f675" ReturnType="0" ExecType="3" Folder="/08.財報選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[value1=GetField("來自營運之現金流量","Y");
if trueall(value1>0,3)
then ret=1;]]></Code>
<Arg><![CDATA[<Arg seed="f8f5bd04-08b3-474b-81c3-ccd88b2c83d3" version="1" />]]></Arg>
<Extra><![CDATA[<Extra>
<TotalBar val="3" />
<FirstBarDate val="0" />
<Maxbb val="0" />
<script>
<freq support="16;8;9;10;11;12;13;14;15" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="特定日期迄今漲跌幅超過一定幅度" ID="0f860762f43e4f75a83021b0affeee58" ReturnType="0" ExecType="1" Folder="/04.價量選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:startdate(20160203);
input:ratio(15,"漲幅下限");

value1=getbaroffset(startdate);
value2=rateofchange(close,value1);

if value2>ratio
then ret=1;

outputfield(1,value2,1,"區間漲跌幅");
outputfield(2,GetField("股價淨值比","D"),2,"股價淨值比");
outputfield(3,GetField("月營收年增率","M"),2,"月營收年增率");
outputfield(4,GetField("本益比","D"),1,"本益比");]]></Code>
<Arg><![CDATA[<Arg seed="16aa4ab8-9274-43cf-a96b-cbc0f4904d52" version="1"><Param name="startdate" varname="startdate" type="1" subtype="0" value="20160203" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="漲幅下限" varname="ratio" type="1" subtype="0" value="15" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<TotalBar val="3" />
<FirstBarDate val="0" />
<Maxbb val="0" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="每股流動資產遠大於股價" ID="e54bd6d6ee5549bd950ee40ad794d0f5" ReturnType="0" ExecType="1" Folder="/10.價值投資/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:percent(20);
setinputname(1,"每股易變現資產與股價間的落差比");
value1=GetField("現金及約當現金","Q");//百萬;
value2=GetField("短期投資","Q");//百萬
value3=GetField("應收帳款及票據","Q");//百萬
value4=GetField("長期投資","Q");//百萬
value5=GetField("負債總額","Q");//百萬
value6=GetField("最新股本");//單位: 億
value7=(value1+value2+value3+value4-value5)/(value6*10);
if value7>close*(1+percent/100)
then ret=1;
]]></Code>
<Arg><![CDATA[<Arg seed="8f3eff09-33ed-4405-97bc-78531ae02e36" version="1"><Param name="每股易變現資產與股價間的落差比" varname="percent" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<TotalBar val="3" />
<Maxbb val="0" />
<script>
<freq support="8;11" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="營業利益率不曾大幅下滑" ID="6208cf52dad148e9aa9501ab7069ec8b" ReturnType="0" ExecType="3" Folder="/08.財報選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:r1(5, "營業利益率QOQ最大衰退幅度");
input:p1(5, "計算的季期數");

SetTotalBar(p1 + 4);
value1=GetField("營業利益率","Q");
if trueall(value1*(1+r1/100)>value1[1],p1)
then ret=1;
]]></Code>
<Arg><![CDATA[<Arg seed="bac45e4f-0474-4e47-86d3-3a369b9570b1" version="1"><Param name="營業利益率QOQ最大衰退幅度" varname="r1" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="計算的季期數" varname="p1" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<script>
<freq support="14;8;9;10;11;12;13;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="-1" />
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="築底指標出現買進訊號" ID="4c696cdf4497462da585408ba3777260" ReturnType="0" ExecType="1" Folder="/03.進階技術分析/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input: period(125);		setinputname(1, "計算區間長度");
input: length1(5);		setinputname(2, "短天期");
input: length2(20);		setinputname(3, "長天期");

variable:zd(0),zdma1(0),zdma2(0);

SetTotalBar(Period + 8);

zd = countif(close>=close[1],period) / countif(close<close[1],period);
zdma1 = average(zd,length1);
zdma2 = average(zd,length2);

if zdma1<1 and zdma2<1 and zdma1 crosses above zdma2
then ret=1;]]></Code>
<Arg><![CDATA[<Arg seed="61e2accc-8f8d-4c8c-9b00-8e22a3021b70" version="1"><Param name="計算區間長度" varname="period" type="1" subtype="0" value="125" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="短天期" varname="length1" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="長天期" varname="length2" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="-1" />
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="年營收成長率超過一定比例" ID="fd57cf8a1e934676b8dfefd614c8acce" ReturnType="0" ExecType="3" Folder="/08.財報選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[setbarfreq("Y");
settotalbar(5);

value1=GetField("營收成長率","Y");
value2=average(value1,5);
if trueall(value1>0,5) and value2>=25
then ret=1;

OutputField(1,value1,"年度營收成長率");
OutputField(2,value2,"五年平均營收成長率");
]]></Code>
<Arg><![CDATA[<Arg seed="ddbe1103-ebe8-415a-b03a-2512afd06734" version="1" />]]></Arg>
<Extra><![CDATA[<Extra>
<Maxbb val="0" />
<script>
<freq support="16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="5" />
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="收盤價近N期漲幅大於X%以上" ID="8a00dff9366842d294cce5366fdcd6ca" ReturnType="0" ExecType="1" Folder="/00.語法範例/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:N(10);	SetInputName(1, "期別");
input:X(5); 	SetInputName(2, "漲幅%");

SetTotalBar(3); 

Value1 = RateOfChange(GetField("收盤價"),N);
if Value1 > X then ret=1;
 
SetOutputName1("近期漲幅%"); 
OutputField1(Value1); ]]></Code>
<Arg><![CDATA[<Arg seed="99f4fa69-309c-40b7-aa98-ca9dd4079492" version="1"><Param name="期別" varname="N" type="1" subtype="0" value="10" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="漲幅%" varname="X" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="現金很多的公司" ID="2ba6f75987324dfcb128d3f5f661d3a2" ReturnType="0" ExecType="1" Folder="/08.財報選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input: lowlimit(10,"償債後現金及短投最少金額");

value1=GetField("現金及約當現金","Q");//單位百萬
value2=GetField("短期投資","Q");//單位百萬
value3=GetField("短期借款","Q");//單位百萬
value4=(value1+value2-value3)/100;//單位億之現金及短期投資合計金額

if value4>=lowlimit
then ret=1;

outputfield(1,value4,"償債後現金及短投金額(億)");
]]></Code>
<Arg><![CDATA[<Arg seed="09bf857f-49bd-4ba6-a1a8-4f17016ba428" version="1"><Param name="償債後現金及短投最少金額" varname="lowlimit" type="1" subtype="0" value="10" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<TotalBar val="3" />
<Maxbb val="0" />
<script>
<freq support="14;8;9;10;11;12;13;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="波段漲幅不大，近N日有過漲停的" ID="61ebf47023d74fd5a6f64d4e907fc1ec" ReturnType="0" ExecType="1" Folder="/04.價量選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:day(10,"計算區間");
value1=GetField("漲停價","D");
if trueany(close=value1,day)
//近十日有一天漲停
and close<close[30]*1.2
//近三十日漲幅不到兩成

then ret=1;]]></Code>
<Arg><![CDATA[<Arg seed="00a4a93b-0519-4dda-8710-eefddc5be7d6" version="1"><Param name="計算區間" varname="day" type="1" subtype="0" value="10" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<TotalBar val="3" />
<FirstBarDate val="0" />
<Maxbb val="0" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="外資由空翻多" ID="2ff3babda762416b96fe44e9b14db55d" ReturnType="0" ExecType="1" Folder="/06.籌碼選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[setbarfreq("D");
settotalbar(3);

if summation(GetField("外資買賣超","D"),20)<0
and trueall(GetField("外資買賣超","D")>200,3)
then ret=1;

]]></Code>
<Arg><![CDATA[<Arg seed="867f6de6-75a1-477b-a8d8-93392ecaa638" version="1" />]]></Arg>
<Extra><![CDATA[<Extra>
<FirstBarDate val="0" />
<Maxbb val="0" />
<script>
<freq support="8;11" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="價值雪球股" ID="1395a402fcd44e999d1d2d352a8cbbd2" ReturnType="0" ExecType="3" Folder="/10.價值投資/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[if GetField("本益比","D") < 15 and
   GetField("股價淨值比","D") <2 and
   GetField("殖利率","D") > 3  and
   GetField("營收成長率","Q") >0 and
   GetField("營業利益","Q") >GetField("營業利益","Q")[1] and
   C > Lowest(L,255) + (highest(h,255)-Lowest(L,255))*0.5
   then ret=1;
   
outputfield(1,GetField("本益比","D"),1,"本益比");
outputfield(2,GetField("股價淨值比","D"),1,"PB比");
outputfield(3,GetField("殖利率","D"),2, "殖利率", order := 1);
]]></Code>
<Arg><![CDATA[<Arg seed="89f75132-2177-4c56-8bcc-1271dcbf9b2e" version="1" />]]></Arg>
<Extra><![CDATA[<Extra>
<TotalBar val="3" />
<Maxbb val="0" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="EPS連續N年都小於X元" ID="c6c29031236e4001ad252a37ab7ac3d7" ReturnType="0" ExecType="1" Folder="/00.語法範例/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:N(4); setinputname(1, "期別");
input:X(0); setinputname(2, "元"); 

SetTotalBar(3); 

if TrueAll(GetField("EPS", "Y") < X,N) then ret=1; 

SetOutputName1("EPS(元)(年)"); 
OutputField1(GetField("EPS", "Y")); 
]]></Code>
<Arg><![CDATA[<Arg seed="c7200c55-deb5-4af2-b035-3ee99f4d6c23" version="1"><Param name="期別" varname="N" type="1" subtype="0" value="4" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="元" varname="X" type="1" subtype="0" value="0" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<Maxbb val="0" />
<script>
<freq support="16;8;9;10;11;12;13;14;15" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="公司官僚化" ID="5b4c3f71efd841b297359ef65b99e247" ReturnType="0" ExecType="1" Folder="/08.財報選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[// 連續4期[管理費用/營業收入淨額的比例]成長
//
//input:TXT("僅適用季資料"); setinputname(1,"使用限制");
setbarfreq("Q");

if barfreq <> "Q" then raiseruntimeerror("頻率錯誤");

settotalbar(3);

Ret = TrueAll(
	GetField("管理費用","Q")/GetField("營業收入淨額","Q") > 
	GetField("管理費用","Q")[1]/GetField("營業收入淨額","Q")[1], 4);








]]></Code>
<Arg><![CDATA[<Arg seed="5d6036c3-37b5-4cdf-a3ea-97bdc4de32b9" version="1" />]]></Arg>
<Extra><![CDATA[<Extra>
<script>
<freq support="14" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="突破整理格局" ID="6fafdbcd7d0e4f75bb544ac6e1c1ccd7" ReturnType="0" ExecType="3" Folder="/05.型態選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:limit1(7);		setinputname(1,"定義整理的區間幅度");
input:limit2(2);		setinputname(2,"定義三個頂點間的差距");
input:rangemax(30);		setinputname(3,"整理區間最長日期限制");
input:vollimit(500);	setinputname(4,"突破時成交量最小值");

variable: period(0);

SetTotalBar(rangemax + 3);

period = 5;
repeat
 begin
	value1=simplehighest(high[1],period);
	value2=simplelowest(low[1],period);
	period=period+1;
 end;	
until period >= rangemax or (value1 > value2 * (1 + limit1/100));

if period < rangemax
then
  begin
	value3=nthhighest(1, high[1], period);
	value4=nthhighest(3, high[1], period);

	if value3 <= value4 * (1 + limit2/100) and 
	   close crosses over value3 and
	   volume > vollimit
	then ret=1;
  end;
  



]]></Code>
<Arg><![CDATA[<Arg seed="4ac95fed-1203-4272-9cbe-78a10a41fd45" version="1"><Param name="定義整理的區間幅度" varname="limit1" type="1" subtype="0" value="7" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="定義三個頂點間的差距" varname="limit2" type="1" subtype="0" value="2" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="整理區間最長日期限制" varname="rangemax" type="1" subtype="0" value="30" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="突破時成交量最小值" varname="vollimit" type="1" subtype="0" value="500" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="-1" />
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="月營收年增率移動平均黃金交叉" ID="174a673d187548039ac4f7fbe0062c60" ReturnType="0" ExecType="3" Folder="/07.月營收選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[value1=GetField("月營收年增率","M");

if average(value1,4) crosses over average(value1,12)
and value1 > 0
then ret=1;

outputfield(1,value1,2,"月營收年增率%", order := 1);
]]></Code>
<Arg><![CDATA[<Arg seed="5194b619-ebfa-41d0-af9f-5bf2a11e81c8" version="1" />]]></Arg>
<Extra><![CDATA[<Extra>
<TotalBar val="3" />
<Maxbb val="0" />
<script>
<freq support="10;8;9;11;12;13;14;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="底部愈墊愈高且資金流入的蓄勢股" ID="0e2b4ce62a5a4fb78a5de1d875b2f7dd" ReturnType="0" ExecType="3" Folder="/04.價量選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:r1(7,"近來漲幅上限%");

value1 = RateOfChange(close, 12);
value2 = lowest(low,3);
value3 = lowest(low,8);
value4 = lowest(low,13);

condition1=false;
condition2=false;

if 
	value1 < r1 and
	value2 > value3 and 
	value3 > value4 and
	close = highest(close,13)
then 
	condition1=true;

Value5=average(GetField("佔全市場成交量比","D"),13);

if linearregslope(Value5,5) > 0
then condition2=true;

if condition1 and condition2
then ret=1;

outputfield(1,value2,2,"前波低點", order := -1);
]]></Code>
<Arg><![CDATA[<Arg seed="a9ae78b8-79f9-404b-9153-464243d72f13" version="1"><Param name="近來漲幅上限%" varname="r1" type="1" subtype="0" value="7" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<FirstBarDate val="0" />
<Maxbb val="0" />
<TotalBar val="8" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="近N日主力合計買超大於M張" ID="d3e2bb1f10184fbd8a53f96c4e18c177" ReturnType="0" ExecType="1" Folder="/06.籌碼選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[value1=GetField("主力買賣超張數","D");
input:days(5,"計算天期");
input:lowmit(200,"買超最低張數");
if summation(value1,days)>=lowmit
then ret=1;]]></Code>
<Arg><![CDATA[<Arg seed="cf408806-3e3a-4890-aaa9-00e04886b02e" version="1"><Param name="計算天期" varname="day" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="買超最低張數" varname="lowmit" type="1" subtype="0" value="200" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<TotalBar val="10" />
<FirstBarDate val="0" />
<Maxbb val="0" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="多空分數翻昇" ID="dee93ce3ed1b4c9cb3539a5539392cc9" ReturnType="0" ExecType="1" Folder="/03.進階技術分析/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[// 計算技術指標分數序列, 判斷指標分數是否翻轉
//
settotalbar(168);

value1 = techscore();
value2 = average(value1, 10);
if value2 crosses above 5 then ret = 1;


]]></Code>
<Arg><![CDATA[<Arg seed="861895f0-5494-4912-96a1-de4dd6af43c4" version="1" />]]></Arg>
<Extra><![CDATA[<Extra>
<Maxbb val="20" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="168" />
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="過濾低成交量股票" ID="54f825a88c8f4d89902d6c3c27a4e907" ReturnType="0" ExecType="1" Folder="/01.常用過濾條件/" StatusMask="2">
<Desc><![CDATA[過濾成交量過低的股票。]]></Desc>
<Code><![CDATA[input:Length(5);
input:VolumeLimit(500);
 
SetInputName(1, "均量天期");
SetInputName(2, "最小均量");

SetTotalBar(3);

Value1 = Average(volume, Length);
Ret = Value1 > VolumeLimit;

SetOutputName1("成交均量");
OutputField1(Value1);]]></Code>
<Arg><![CDATA[<Arg seed="57cacee5-82d3-4565-a415-6b85c93951de" version="1"><Param name="均量天期" varname="Length" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="最小均量" varname="VolumeLimit" type="1" subtype="0" value="500" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="借券賣出餘額張數大減" ID="4ea4e66a9eb24717aef1159c90f96dce" ReturnType="0" ExecType="3" Folder="/06.籌碼選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input: amount(1000);		setinputname(1, "減少張數");

SetTotalBar(3);

value1 = GetField("借券賣出餘額張數");
if value1[1] - value1 > amount
then ret=1;

setoutputname1("借券賣出減少張數");
outputfield1(value1[1] - value1);
]]></Code>
<Arg><![CDATA[<Arg seed="68e2c94d-70f5-454e-b3a9-977e79e07633" version="1"><Param name="減少張數" varname="amount" type="1" subtype="0" value="1000" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<script>
<freq support="8;11;9;12;10;13" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="主力偷偷調節後下殺" ID="1eecab6ad0384867a3429246277dc205" ReturnType="0" ExecType="3" Folder="/06.籌碼選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[setbarfreq("AD");

input:period(10,"籌碼計算天期");
 
Value1=GetField("分公司買進家數","D");
value2=GetField("分公司賣出家數","D");
value3=(value1-value2);
//買進家數減去賣出家數，代表籌碼發散的情況
value4=average(close,5);
//計算發散程度的五日移動平均
 
if period<>0 then begin
	if countif(value3>10, period)/period >0.6
	//區間裡超過六成以上的日子主力都是站在出貨那一邊
	and linearregslope(value4,5)>0
	//發散程度之五日移動平均線短期趨勢是向上
	then ret=1;
end;

outputfield(1, countif(value3>10, period), 0, "出貨天數", order := 1);
]]></Code>
<Arg><![CDATA[<Arg seed="f543d642-b3ec-49c3-9a6c-44209b723162" version="1"><Param name="籌碼計算天期" varname="period" type="1" subtype="0" value="10" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<TotalBar val="10" />
<FirstBarDate val="0" />
<Maxbb val="0" />
<script>
<freq support="11" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="月營收大成長的公司" ID="5018431ac8534d49b09bda5e66685609" ReturnType="0" ExecType="3" Folder="/07.月營收選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[
value1=GetField("月營收","M");//億
value2=GetField("營業利益率","Q");
value3=value1*12*value2/100;
value4=GetField("最新股本");//億
variable:FEPS(0);
FEPS=value3/value4*10;
setoutputname1("用月營收預估的本業EPS");
outputfield1(FEPS);
if feps<>0
then value5=close/feps;
setoutputname2("用月營收預估的本益比");
outputfield2(value5);
if value5<12 and value5>0
then condition1=true;

input:lowlimit(20);//單位:%
setinputname(1,"成長百分比");
value6=GetField("月營收月增率","M");
value7=GetField("月營收年增率","M");

if value6>=lowlimit
and value7>=lowlimit
and value6[1]>0
then condition2=true;

if condition1 and condition2
then ret=1;
]]></Code>
<Arg><![CDATA[<Arg seed="a9ec9ffb-bdfb-488e-9ea7-8d785da600a8" version="1"><Param name="成長百分比" varname="lowlimit" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<TotalBar val="3" />
<Maxbb val="0" />
<script>
<freq support="8;11" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="MACD黃金交叉" ID="4517c0dc9e034d0aa28e3d1ad16a0d5a" ReturnType="0" ExecType="1" Folder="/02.基本技術指標/" StatusMask="2">
<Desc><![CDATA[MACD指標出現黃金交叉。]]></Desc>
<Code><![CDATA[// MACD 黃金交叉 (dif向上穿越macd)
//
input: FastLength(12), SlowLength(26), MACDLength(9);
variable: difValue(0), macdValue(0), oscValue(0);

SetTotalBar((maxlist(FastLength,SlowLength,6) + MACDLength) * 4);

SetInputName(1, "DIF短期期數");
SetInputName(2, "DIF長期期數");
SetInputName(3, "MACD期數");

MACD(weightedclose(), FastLength, SlowLength, MACDLength, difValue, macdValue, oscValue);

Ret = difValue Crosses Above macdValue;



]]></Code>
<Arg><![CDATA[<Arg seed="3b07937c-7e30-4100-ae4a-b14d33d368b6" version="1"><Param name="DIF短期期數" varname="FastLength" type="1" subtype="0" value="12" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="DIF長期期數" varname="SlowLength" type="1" subtype="0" value="26" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="MACD期數" varname="MACDLength" type="1" subtype="0" value="9" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<Maxbb val="2" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="-1" />
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="投信初介入" ID="e8c5de9b381e4796bffca5f3e6ca3a67" ReturnType="0" ExecType="3" Folder="/11.選股機器人/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[setbarfreq("AD");

input: day(30, "投信交易期間");

value1 = summation(GetField("投信買賣超")[1], day); 
value2 = summation(volume[2], day);

condition1 = value1 < value2 * 0.02;
//先前投信不怎麼買這檔股票

condition2 = GetField("投信買賣超")>= volume[1] * 0.15;
//投信開始較大買超

condition3 = H > H[1];
//買了股價有往上攻

condition4 = C > C[1];
//今天收盤有往上走

condition5=close<close[10]*1.05;

RET = condition1 and condition2 and condition3 and condition4 and condition5;

outputfield(1,GetField("投信買賣超","D"),0,"投信買超", order := 1);
]]></Code>
<Arg><![CDATA[<Arg seed="a5b99aef-1203-4973-9170-93fda8a4350f" version="1"><Param name="投信交易期間" varname="day" type="1" subtype="0" value="30" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<TotalBar val="10" />
<FirstBarDate val="0" />
<Maxbb val="0" />
<script>
<freq support="11" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="近期漲幅不大" ID="686059242586449fb769a2f717ea62a9" ReturnType="0" ExecType="1" Folder="/05.型態選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:period(20,"計算區間");
input:ratio(7,"最低漲跌幅");

if close[period-1]<>0
and (close/close[period-1]-1)*100<ratio
then ret=1;

outputfield(1,GetField("法說會日期","M"),0,"法說會日期", order := -1);
]]></Code>
<Arg><![CDATA[<Arg seed="485b36d4-076a-4515-bb54-222416bf06b0" version="1"><Param name="計算區間" varname="period" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="最低漲跌幅" varname="ratio" type="1" subtype="0" value="7" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<FirstBarDate val="0" />
<Maxbb val="0" />
<TotalBar val="3" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="最近幾季存貨增加的比營收還快" ID="8c0dc5fdb4fa4da599bc0f1d4da504f7" ReturnType="0" ExecType="3" Folder="/08.財報選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:r1(4 ,"存貨比營收成長率大的連續季數");
setbarfreq("Q");
settotalbar(r1+2);

value1=GetField("營業收入淨額","Q");
value2=GetField("存貨","Q");

value3=rateofchange(value1,1);
value4=rateofchange(value2,1);
value5=value4-value3;

if trueall(value5>0,r1)
and trueall(value5-value5[1]>0,r1)
then ret=1;
]]></Code>
<Arg><![CDATA[<Arg seed="8097920c-ab35-4499-bac6-75c1f7e7e4a8" version="1"><Param name="存貨比營收成長率大的連續季數" varname="r1" type="1" subtype="0" value="4" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<script>
<freq support="14" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="-1" />
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="高現金股利政策且營運仍佳" ID="add0db5176e24c72b1da5b8dc8fcd035" ReturnType="0" ExecType="3" Folder="/08.財報選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:peratio(17,"本益比上限倍數");
input:ratio(60,"現金股利佔股利之比重下限");
input:epsl(2,"預估本益EPS下限");
input:rate1(5,"累計營收成長率下限");
 
value1=GetField("累計營收年增率","M");//單位%
value2=GetField("現金股利佔股利比重","Y");
value3=GetField("營業利益","Q");//單位百萬;
value4=GetField("最新股本");//單位億;
value5=summation(value3,4)/(value4*10);//每股預估EPS

if value1>=rate1 //本業持續成長
and value2>=ratio //主要以現金股利為主
and value5>=EPSl //每股推估本業獲利高
and value5/close<=peratio //本益比低
then ret=1;

]]></Code>
<Arg><![CDATA[<Arg seed="d25f74da-32f1-4b2a-bee7-c31a5fb1d3e9" version="1"><Param name="本益比上限倍數" varname="peratio" type="1" subtype="0" value="17" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="現金股利佔股利之比重下限" varname="ratio" type="1" subtype="0" value="60" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="預估本益EPS下限" varname="epsl" type="1" subtype="0" value="2" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="累計營收成長率下限" varname="rate1" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<TotalBar val="3" />
<Maxbb val="0" />
<script>
<freq support="8;11" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="法人淨買超比例高" ID="99bb5c9bf9f742ef863e891bcfa04306" ReturnType="0" ExecType="1" Folder="/06.籌碼選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:ratio(30);		setinputname(1,"比例下限(%)");
input:period(3);		setinputname(2,"計算區間");
input:volLimit(1000);	setinputname(3,"成交量下限(張)");

settotalbar(3);

value1 = Summation(Volume - GetField("資券互抵張數"), period);
value2 = Summation(GetField("法人買賣超張數"), period);
value3 = value2 / value1 * 100;

if value3 > ratio and volume > volLimit then
ret = 1;

SetOutputName1("近日法人淨買超比例(%)");
OutputField1(value3);

]]></Code>
<Arg><![CDATA[<Arg seed="fa06d2b9-dea7-455a-94a3-a83123ff1655" version="1"><Param name="比例下限(%)" varname="ratio" type="1" subtype="0" value="30" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="計算區間" varname="period" type="1" subtype="0" value="3" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="成交量下限(張)" varname="volLimit" type="1" subtype="0" value="1000" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<script>
<freq support="8;11;9;12;10;13" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="週線月線黃金交叉且站穩" ID="b9047b76837646f5a0abfe47e81df388" ReturnType="0" ExecType="3" Folder="/02.基本技術指標/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[setbarfreq("AD");

value1=average(close,5);
value2=average(close,20);
if value1[3] crosses over value2[3]
and trueall(close>close[1]and close>value1,5)
then ret=1 ;

outputfield(1,value1,2,"週線", order := -1);
outputfield(2,value2,2,"月線");
]]></Code>
<Arg><![CDATA[<Arg seed="94481460-7cd0-4034-aaa6-2528c266be1f" version="1" />]]></Arg>
<Extra><![CDATA[<Extra>
<TotalBar val="10" />
<FirstBarDate val="0" />
<Maxbb val="0" />
<script>
<freq support="11" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="固定資產佔股本比率低於N%" ID="e0a91104b3734e5d91395fdcb276d47b" ReturnType="0" ExecType="1" Folder="/08.財報選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:r1(10,"固定資產佔股本比例(單位%)");

value1=GetField("最新股本");//單位億
value2=GetField("固定資產","Q");
value3=value2/(value1*100);

if value3<r1/100
then ret=1;]]></Code>
<Arg><![CDATA[<Arg seed="56cfc7d4-024c-413b-adb5-01f029ba7266" version="1"><Param name="固定資產佔股本比例(單位%)" varname="r1" type="1" subtype="0" value="10" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<script>
<freq support="8;11" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="官股買超比重" ID="3fbd06e1fe0c45a2876171bac0608028" ReturnType="0" ExecType="1" Folder="/06.籌碼選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input: lowlimit(30, "官股買超比重(%)");

value1 = getfield("官股券商買賣超張數", "D");
if value1 > 0 then begin
	value2 = value1 * 100 / volume;
	if value2 >= lowlimit then ret=1;
end;
	
	]]></Code>
<Arg><![CDATA[<Arg seed="a74b3f3f-538b-46c2-a850-8499a1a7863d" version="1"><Param name="官股買超比重(%)" varname="lowlimit" type="1" subtype="0" value="30" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<TotalBar val="10" />
<FirstBarDate val="0" />
<Maxbb val="0" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="跌到52週低點之下" ID="52d7fcddf6d243d69751cee15a276d54" ReturnType="0" ExecType="3" Folder="/04.價量選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[setbarfreq("W");

if close<lowest(low[1],52) then ret=1;]]></Code>
<Arg><![CDATA[<Arg seed="74657c9f-f879-497c-8d39-3676ea9a9362" version="1" />]]></Arg>
<Extra><![CDATA[<Extra>
<TotalBar val="3" />
<Maxbb val="0" />
<script>
<freq support="9;12" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="價量同步創N期新高" ID="53a760f2d26d4fba9951cc23c4307761" ReturnType="0" ExecType="3" Folder="/04.價量選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:period(100,"計算天數");

value1=highest(high,period);
value2=highest(volume,period);
if high=value1 and volume=value2
then ret=1;
]]></Code>
<Arg><![CDATA[<Arg seed="b6631f17-190c-4743-900d-4092ac036514" version="1"><Param name="計算天數" varname="period" type="1" subtype="0" value="100" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<TotalBar val="3" />
<Maxbb val="0" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="盤整N日後突破" ID="17b4288717e04c7c88c2f0519a4f85d2" ReturnType="0" ExecType="3" Folder="/04.價量選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:period(20,"盤整的天數");
input:ratio(5,"盤整的最大波動範圍");

if highest(close,period)[1]<lowest(close,period)[1]*(1+ratio/100)
and close > highest(close,period)[1]
and volume >average(volume,period)
and volume>2000
then ret=1;]]></Code>
<Arg><![CDATA[<Arg seed="5007bbe5-32c7-41d6-96f8-ceffd6fe4dc9" version="1"><Param name="盤整的天數" varname="period" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="盤整的最大波動範圍" varname="ratio" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<TotalBar val="10" />
<FirstBarDate val="0" />
<Maxbb val="0" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="考慮成長率的股利回推合理股價" ID="2791d39309c34eb58af404f2f6278b9b" ReturnType="0" ExecType="1" Folder="/08.財報選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:r(6,"年預期報酬率單位%");
variable: s1(0);

value1=average(GetField("現金股利","Y"),5);

if lowest(GetField("現金股利","Y")[1],3)>0 then 
	s1=lowest(rateofchange(GetField("現金股利","Y"),1),3);

if value1>1 and r>s1 and s1>0then begin
	value2=value1/(r-s1)*100;
	if close<>0 then 
		value3=(value2-close)/close*100;
	if value3>10
	and GetField("現金股利","Y")>GetField("現金股利","Y")[1]
	then ret=1;
	
	outputfield(1,value1,1,"平均現金股利");
	outputfield(2,s1,1,"近年最低股利成長率");

end;
]]></Code>
<Arg><![CDATA[<Arg seed="4c4bf28b-07b1-4bf1-82b3-2c79296f1144" version="1"><Param name="年預期報酬率單位%" varname="r" type="1" subtype="0" value="6" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<TotalBar val="10" />
<FirstBarDate val="0" />
<Maxbb val="0" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="EPS連續N季成長" ID="131a715d644d45aa8f8c9a97c35b3cc8" ReturnType="0" ExecType="1" Folder="/00.語法範例/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:N(4); SetInputName(1, "期別");
 
SetTotalBar(3); 

if TrueAll(GetField("EPS","Q") > GetField("EPS","Q")[1],N) then ret=1; 

SetOutputName1("EPS(元)(季)"); 
OutputField1(GetField("EPS","Q")); 
]]></Code>
<Arg><![CDATA[<Arg seed="425cd13f-eeda-403d-80a4-d22414858033" version="1"><Param name="期別" varname="N" type="1" subtype="0" value="4" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<Maxbb val="0" />
<script>
<freq support="14;8;9;10;11;12;13;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="股價跌破走跌後的高壓電線" ID="114be2370e9a4967a64711645de0a0ae" ReturnType="0" ExecType="1" Folder="/03.進階技術分析/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[SetTotalBar(8);

value1 = (average(close,30) + average(close,72)) / 2;	//地心引力線
value2 = value1*1.2;//高壓電線
value3 = linearregslope(value2,5);

if absvalue(value3) <= 0.1 and close crosses under value1
then ret=1;

]]></Code>
<Arg><![CDATA[<Arg seed="49214485-888e-41d9-8fb6-7faec6516bdd" version="1" />]]></Arg>
<Extra><![CDATA[<Extra>
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="8" />
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="不明買盤介入" ID="375658acced448c7966e36d79b000600" ReturnType="0" ExecType="1" Folder="/06.籌碼選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:period(5);	setinputname(1,"均線期間");
input:ratio(30);	setinputname(2,"不明買盤比重%");

settotalbar(period + 7);

value1=GetField("法人買張","D");
value2=GetField("資券互抵張數","D");
value3=GetField("散戶買張","D");
value4=volume - value1 - value2 - value3;
value5=value4*100/volume;	// 不明買盤的比重
value6=average(value5,period);

if value6 crosses over ratio
then ret=1;

SetOutputName1("不明買盤比重(%)");
OutputField1(value5);
]]></Code>
<Arg><![CDATA[<Arg seed="6acbb485-65cb-46c1-92d1-dcf48069e231" version="1"><Param name="均線期間" varname="period" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="不明買盤比重%" varname="ratio" type="1" subtype="0" value="30" isSerial="1" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="-1" />
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="投信拉抬" ID="159fb559d0134f3e9b4bb992257cb07f" ReturnType="0" ExecType="1" Folder="/06.籌碼選股/" StatusMask="2">
<Desc><![CDATA[近期投信持續買超且股價上揚。]]></Desc>
<Code><![CDATA[input: Length(10); setinputname(1,"計算天數");
input: UpRatio(3.5); setinputname(2, "上漲幅度(%)");
input: VolumeRatio(5); setinputname(3, "買超佔比例(%)");

variable: SumForce(0);
variable: SumTotalVolume(0);

settotalbar(3);

if RateOfChange(Close, 1) >= UpRatio then
begin
	SumTotalVolume = Summation(volume, Length);
	SumForce = Summation(GetField("投信買賣超"), Length);
	if SumForce > SumTotalVolume * VolumeRatio / 100 then ret =1;
end;

SetOutputName1("投信累計買超張數");
OutputField1(SumForce);
]]></Code>
<Arg><![CDATA[<Arg seed="3568972e-73cf-417e-88f5-868731b2a30f" version="1"><Param name="計算天數" varname="Length" type="1" subtype="0" value="10" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="上漲幅度(%)" varname="UpRatio" type="1" subtype="0" value="3.5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="買超佔比例(%)" varname="VolumeRatio" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<script>
<freq support="8;11;9;12;10;13" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="營運趨緩" ID="68f704c93b2e407a9d9772b0921205d8" ReturnType="0" ExecType="1" Folder="/07.月營收選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input: months(24);	setinputname(1, "月營收計算期間(月)");
input: quarters(16);setinputname(2, "營業毛利率計算期間(季)");

settotalbar(3);

value1=GetField("月營收年增率","M");
value2=GetField("營業毛利率","Q");
if value1 = lowest(GetField("月營收年增率","M"), months) and
   value2 = lowest(GetField("營業毛利率","Q"), quarters) then
ret = 1;



]]></Code>
<Arg><![CDATA[<Arg seed="e4772da3-aa23-4170-ad29-1a0ce0b37af0" version="1"><Param name="月營收計算期間(月)" varname="months" type="1" subtype="0" value="24" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="營業毛利率計算期間(季)" varname="quarters" type="1" subtype="0" value="16" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<script>
<freq support="10;8;9;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="現金總市值比" ID="4bfd5e1f6ffd4ba9b799872f89e59304" ReturnType="0" ExecType="1" Folder="/08.財報選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[value1=GetField("現金及約當現金","Q");//單位百萬
value2=GetField("短期投資","Q");//單位百萬
value3=(value1+value2)/100;//單位億之現金及短期投資合計金額
value4=GetField("總市值","D");//單位:億
if value4<>0
then value5=value3/value4;//現金總市值比;
if value5>0.7 and value3>3 //現金總市值比大於0.7且現金及短投合計超過3億
then ret=1;

outputfield(1, value5, 1, "現金總市值比", order := 1);
]]></Code>
<Arg><![CDATA[<Arg seed="fd8cbf99-b7ea-486b-82b1-914f4a3060b0" version="1" />]]></Arg>
<Extra><![CDATA[<Extra>
<TotalBar val="3" />
<Maxbb val="0" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="突破糾結均線" ID="65a5087a119247358adfe6081b94d8d0" ReturnType="0" ExecType="3" Folder="/11.選股機器人/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[setbarfreq("AD");

input: shortlength(5); setinputname(1,"短期均線期數");
input: midlength(10); setinputname(2,"中期均線期數");
input: Longlength(20); setinputname(3,"長期均線期數");
input: Percent(5);  setinputname(4,"均線糾結區間%");
input: XLen(20);  setinputname(5,"均線糾結期數");

input: Volpercent(25);  setinputname(6,"放量幅度%");//帶量突破的量是超過最長期的均量多少%
variable: shortaverage(0);
variable: midaverage(0);
variable: Longaverage(0);
variable: AvgHLp(0),AvgH(0),AvgL(0);

shortaverage = average(close,shortlength);
midaverage = average(close,midlength);
Longaverage = average(close,Longlength);
		
AvgH = maxlist(shortaverage,midaverage,Longaverage);
AvgL = minlist(shortaverage,midaverage,Longaverage);

if AvgL > 0 then AvgHLp = 100*AvgH/AvgL -100;

condition1 = trueAll(AvgHLp < Percent,XLen);
condition2 = V > average(V[1],XLen)*(1+Volpercent/100) ;
condition3 = C > AvgH *(1.02) and H > highest(H[1],XLen);
condition4 = average(volume[1], 5) >= 1000; 

ret = condition1 and condition2 and condition3 and condition4;

outputfield(1,AvgH,2,"均線上緣", order := -1);
outputfield(2,AvgL,2,"均線下緣");


]]></Code>
<Arg><![CDATA[<Arg seed="50813088-318c-4ce3-9aa6-16f47710f01f" version="1"><Param name="短期均線期數" varname="shortlength" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="中期均線期數" varname="midlength" type="1" subtype="0" value="10" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="長期均線期數" varname="Longlength" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="均線糾結區間%" varname="Percent" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="均線糾結期數" varname="XLen" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="放量幅度%" varname="Volpercent" type="1" subtype="0" value="25" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<TotalBar val="10" />
<FirstBarDate val="0" />
<Maxbb val="0" />
<script>
<freq support="11" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="累計營收年增率黃金交叉" ID="24eaa9c6c9ed42f2a5cec7fd70ed2952" ReturnType="0" ExecType="3" Folder="/07.月營收選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[value1=GetField("累計營收年增率","M");
input: r1(3),r2(12);
setinputname(1,"短天期");
setinputname(2,"長天期");
if average(value1,r1) crosses over average(value1,r2)+5
and value1>10
then ret=1;
]]></Code>
<Arg><![CDATA[<Arg seed="1b68a4dc-a8bb-4430-b739-044dee69014f" version="1"><Param name="短天期" varname="r1" type="1" subtype="0" value="3" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="長天期" varname="r2" type="1" subtype="0" value="12" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<TotalBar val="3" />
<Maxbb val="0" />
<script>
<freq support="10;8;9;11;12;13;14;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="炒高後無量反轉下跌" ID="f442df11ac2b4fea83da40f61b3c5903" ReturnType="0" ExecType="3" Folder="/04.價量選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[setbarfreq("AD");

input: Periods(150,"計算期數");
input: Ratio(20,"期間漲幅%");

if close < close[4]
and close*1.1>highest(close,periods)
//離最高不到一成
and close >= close[Periods] *(1 + Ratio*0.01)
//過去半年漲幅超過五成
and average(volume[1],5)*1.5 < average(volume[1],20)
//最近幾天成交量大幅縮小
then ret=1;

outputfield(1,highest(close,periods),2,"波段高點", order := -1);
]]></Code>
<Arg><![CDATA[<Arg seed="7e29bfeb-1a7b-4344-8bd4-e414fb4eda8d" version="1"><Param name="計算期數" varname="Periods" type="1" subtype="0" value="150" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="期間漲幅%" varname="Ratio" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<TotalBar val="10" />
<FirstBarDate val="0" />
<Maxbb val="0" />
<script>
<freq support="11" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="股價超過N日未再破底" ID="0e3e78e0d27d4bea8ef30cee2573f33e" ReturnType="0" ExecType="1" Folder="/04.價量選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:period(30);
input:day(10);
setinputname(1,"計算期間");
setinputname(2,"未破底天數");
value1=lowestbar(low,period);
if value1>day
then ret=1;]]></Code>
<Arg><![CDATA[<Arg seed="e2c37a2e-3437-4dbb-a2a5-d103805b7f33" version="1"><Param name="計算期間" varname="period" type="1" subtype="0" value="30" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="未破底天數" varname="day" type="1" subtype="0" value="10" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<TotalBar val="3" />
<Maxbb val="0" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="下降趨勢改變" ID="050e26de5d6a4c7098806d269c211943" ReturnType="0" ExecType="3" Folder="/05.型態選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:Length(20); 		setinputname(1,"下降趨勢計算期數");
input:VolLimit(1000);	setinputname(2,"突破量");

variable: kk(0);

settotalbar(maxlist(length, 5) + 3);

If CurrentBar = 1 then
	kk = 0
else
	kk = kk[1] + (close - close[1])/close[1] * Volume;

value1 = linearregslope(kk, Length);
value2 = linearregslope(kk, 5);

IF value1 < 0 and value2 > 0 AND VOLUME > VolLimit then ret=1;

]]></Code>
<Arg><![CDATA[<Arg seed="aa3ad68d-2c31-456b-a59e-6e3ab95dd76a" version="1"><Param name="下降趨勢計算期數" varname="Length" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="突破量" varname="VolLimit" type="1" subtype="0" value="1000" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="-1" />
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="法人逢低買超破億元" ID="36c5c249a3b944f69bcdc02fb6e91ccf" ReturnType="0" ExecType="1" Folder="/06.籌碼選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:day(5,"計算期別");
input:lowlimit(1,"單位:億元");
setbarfreq("D");
settotalbar(day);

value1=GetField("法人買賣超張數","D");
value2=summation(value1,day);
value3=value1*value2/10000;

if value3>=1 
and close*1.1<close[30]
then ret=1;
]]></Code>
<Arg><![CDATA[<Arg seed="3ee2ff61-e03f-41a6-b246-1567fa94852f" version="1"><Param name="計算期別" varname="day" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="單位:億元" varname="lowlimit" type="1" subtype="0" value="1" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<FirstBarDate val="0" />
<Maxbb val="0" />
<script>
<freq support="8;11" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="-1" />
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="布林通道超買" ID="8a60fdb6f5064c88b39cba273e29041b" ReturnType="0" ExecType="1" Folder="/02.基本技術指標/" StatusMask="2">
<Desc><![CDATA[最高價大於布林通道指標的上緣。]]></Desc>
<Code><![CDATA[// 布林通道超買訊號
//
Input: Length(20), UpperBand(2);

SetInputName(1, "期數");
SetInputName(2, "通道上緣");

settotalbar(3);

Ret = High >= bollingerband(Close, Length, UpperBand);



]]></Code>
<Arg><![CDATA[<Arg seed="3cdc7ddb-725a-461a-8117-2bfd9af4a83f" version="1"><Param name="期數" varname="Length" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="通道上緣" varname="UpperBand" type="1" subtype="0" value="2" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="波動幅度開始變大且往上攻" ID="34bba115ef7e4083b1b3854e52cfb575" ReturnType="0" ExecType="3" Folder="/04.價量選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[SetBarFreq("AD");

input: Length(20, "計算區間");
input: VolLimit(1000, "成交量限制");

value1 = truerange();
value2 = highest(value1,Length);

SetTotalBar(Length + 3);

if 
	value1 > value2[1] and 
	value1 > value1[1] and 
	close * 1.01 > high and 
	close > close[1] and 
	volume > VolLimit
then ret=1;

outputfield(1,close[1],2,"前波低點", order := -1);

]]></Code>
<Arg><![CDATA[<Arg seed="56045d2f-d5b9-49f4-93e8-d585e9a0e127" version="1"><Param name="計算區間" varname="Length" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="成交量限制" varname="VolLimit" type="1" subtype="0" value="1000" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<FirstBarDate val="0" />
<Maxbb val="0" />
<script>
<freq support="11" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="-1" />
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="烏龜交易法則之買進訊號" ID="6f489ed90891469d9b65a687dddea49a" ReturnType="0" ExecType="3" Folder="/11.選股機器人/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[setbarfreq("AD");

condition1=false;
condition2=false;
 
if high=highest(high,100)and barslast(high=highest(high,100))[1]>100
then condition1=true; 
//創百日新高且上一次發生時是在100個交易日之前

if average(volume[1], 5) >= 1000
then condition2=true;

//五日移動平均量大於千張
if condition1 and condition2
then ret=1;
 
outputfield(1,highest(high,100),2,"突破高點", order := -1);

]]></Code>
<Arg><![CDATA[<Arg seed="bef7da2e-355e-43f1-a56d-d71fd4796820" version="1" />]]></Arg>
<Extra><![CDATA[<Extra>
<TotalBar val="10" />
<FirstBarDate val="0" />
<Maxbb val="0" />
<script>
<freq support="11" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="均線空頭排列" ID="21caf2a794e94295a655f95119c0e7fe" ReturnType="0" ExecType="1" Folder="/02.基本技術指標/" StatusMask="2">
<Desc><![CDATA[均線呈現空頭排列。]]></Desc>
<Code><![CDATA[input:Leng1(5),Leng2(20),Leng3(60);

variable: ma1(0), ma2(0), ma3(0);

SetInputName(1,"短均線");
SetInputName(2,"中均線");
SetInputName(3,"長均線");

settotalbar(3);

ma1 = average(close, Leng1);
ma2 = average(close, Leng2);
ma3 = average(close, Leng3);

condition1 = close < ma1;
condition2 = ma1 < ma2;
condition3 = ma2 < ma3;

if condition1 and condition2 and condition3 then 
ret = 1;

SetOutputName1("短均線");   
OutputField1(ma1);
SetOutputName2("中均線");   
OutputField2(ma2);
SetOutputName3("長均線");   
OutputField3(ma3);







]]></Code>
<Arg><![CDATA[<Arg seed="bfeedc54-0b9f-4516-b95b-48428a99559c" version="1"><Param name="短均線" varname="Leng1" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="中均線" varname="Leng2" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="長均線" varname="Leng3" type="1" subtype="0" value="60" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="獲利穩定的公司" ID="491cb91e0438435f9a8f44f3a7f3ef34" ReturnType="0" ExecType="1" Folder="/08.財報選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[setbarfreq("Y");
settotalbar(5);
value1=GetField("每股稅後淨利(元)","Y");
if trueall(value1>=2,5)//過去五年每年都賺超過兩元
and highest(value1,5)<lowest(value1,5)*1.5//獲利的高低差距在忍受範圍
then ret=1;
outputfield(1,highest(value1,5),1,"最高EPS");
outputfield(2,lowest(value1,5),1,"最低EPS");]]></Code>
<Arg><![CDATA[<Arg seed="2aef5359-81a3-4568-af56-d25ccb9cde47" version="1" />]]></Arg>
<Extra><![CDATA[<Extra>
<FirstBarDate val="0" />
<Maxbb val="0" />
<script>
<freq support="16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="5" />
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="月營收成長動能加快" ID="6a2ea1b5fe8f48f78ac9d7c839420e7e" ReturnType="0" ExecType="3" Folder="/07.月營收選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[setbarfreq("M");

value1=average(GetField("月營收年增率","M"),3);
//月營收年增率三個月平均
value2=average(GetField("月營收年增率","M"),12);
//月營收年增率十二個月平均
if value1 crosses over value2
//黃金交叉
and value1>5
and value1-value2>5
and value2>=1
then ret=1;
outputfield(1,value1,0,"3個月平均");
outputfield(2,value2,0,"12個月平均");
outputfield(3,(close-close[1])/close[1]*100,1,"本月漲跌幅");]]></Code>
<Arg><![CDATA[<Arg seed="b357bf7b-d7d1-41a5-b533-f4eb0957a541" version="1" />]]></Arg>
<Extra><![CDATA[<Extra>
<TotalBar val="10" />
<FirstBarDate val="0" />
<Maxbb val="0" />
<script>
<freq support="10;13" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="突破繼續型態" ID="c20707620b1d42c481889cb60dba22b5" ReturnType="0" ExecType="3" Folder="/05.型態選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[setbarfreq("AD");

variable:iHigh(0); iHigh=maxlist(iHigh,H);
variable:iLow(100000); iLow=minlist(iLow,L);
variable:hitlow(0),hitlowdate(0);
//觸低次觸與最後一次觸低日期
if iLow = Low then begin
	hitlow+=1;
	hitlowdate =date;
end;

if DateAdd(hitlowdate,"M",2) < Date and//如果自觸低點那天1個月後都沒有再觸低
iHigh/iLow < 1.3 and //波動在三成以內
iHigh = High
//來到設定日期以來最高點
then ret =1;

outputfield(1, highest(high[1],100), 2, "前波高點", order := -1);
]]></Code>
<Arg><![CDATA[<Arg seed="54d332bf-3826-4094-bdff-5ba8e297c609" version="1" />]]></Arg>
<Extra><![CDATA[<Extra>
<script>
<freq support="11" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="殺過頭" ID="92648eff5392488cb229855c3946878a" ReturnType="0" ExecType="3" Folder="/11.選股機器人/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[setbarfreq("AD");

input:day(5,"短期天數");
input:period(20,"波段天數");
input:r1(20,"波段最低跌幅");
input:r2(10,"短期最低跌幅");
input:r3(2,"本日急拉幅度");
input:v1(1000,"成交量下限");

condition1=false;
condition2=false;
condition3=false;
 
if highest(high,period)>=close[1]*(1+r1/100)
then condition1=true;
 
if highest(high,day)>=close[1]*(1+r2/100)
then condition2=true;
 
if close>=close[1]*(1+r3/100) and v1>=1000
then condition3=true;
 
if condition1 and condition2 and condition3
then ret=1;

outputfield(1,lowest(low,period),2,"前波低點", order := -1);
]]></Code>
<Arg><![CDATA[<Arg seed="72a4b419-841a-41aa-a9c6-913d75ed63de" version="1"><Param name="短期天數" varname="day" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="波段天數" varname="period" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="波段最低跌幅" varname="r1" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="短期最低跌幅" varname="r2" type="1" subtype="0" value="10" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="本日急拉幅度" varname="r3" type="1" subtype="0" value="2" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="成交量下限" varname="v1" type="1" subtype="0" value="1000" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<TotalBar val="10" />
<FirstBarDate val="0" />
<Maxbb val="0" />
<script>
<freq support="11" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="過濾冷門股票" ID="d0fd82b8aab54745ba76f1f847c1b07b" ReturnType="0" ExecType="1" Folder="/01.常用過濾條件/" StatusMask="2">
<Desc><![CDATA[過濾股價過低以及成交量過低的股票。]]></Desc>
<Code><![CDATA[input:PriceLimit(5),Length(5), VolumeLimit(500);

SetInputName(1, "最小股價");
SetInputName(2, "均量天期");
SetInputName(3, "最小均量");

SetTotalBar(3);

Value1 = Average(volume,Length);
if close > PriceLimit and Value1 > VolumeLimit Then
ret = 1;

]]></Code>
<Arg><![CDATA[<Arg seed="ae7715da-7dad-4b42-a758-2666079cd269" version="1"><Param name="最小股價" varname="PriceLimit" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="均量天期" varname="Length" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="最小均量" varname="VolumeLimit" type="1" subtype="0" value="500" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<Maxbb val="0" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="長期都填權的股票" ID="1d846e48491b4f83912fc157fe2a6acd" ReturnType="0" ExecType="1" Folder="/09.時機操作/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:N(5);

if getfield("除權息日期") = date then
begin
value1 = date;
value2 = c[1];
value3 = currentbar;
end;

if value1 > 0
  AND currentbar - value3 = N - 1
  AND c > value2
then
begin
value4 = date;
value5 = c;
condition1 = true;
end;

if condition1 then ret=1;

outputfield(1,value1,0,"除權息日期");
outputfield(2,value2,2,"除權息前一天收盤");
outputfield(4,value4,0,"N天後日期");
outputfield(5,value5,2,"N天後收盤");]]></Code>
<Arg><![CDATA[<Arg seed="5075f3be-0048-458d-b832-318fd31c18df" version="1"><Param name="N" varname="N" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<TotalBar val="10" />
<FirstBarDate val="0" />
<Maxbb val="0" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="營收月增率優於平均" ID="6622991c99404ac5aa83d63a0a650ff2" ReturnType="0" ExecType="3" Folder="/07.月營收選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[value1=GetField("月營收月增率","M");
value2=average(value1,36);
if value1>10
and value1>value2*1.3
then ret=1;]]></Code>
<Arg><![CDATA[<Arg seed="0f993c1b-41d4-4b33-9b43-1544cae9d5dc" version="1" />]]></Arg>
<Extra><![CDATA[<Extra>
<TotalBar val="3" />
<Maxbb val="0" />
<script>
<freq support="10;8;9;11;12;13;14;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="多次到底而跌破" ID="26a6e5971b464e66b518e629793b8574" ReturnType="0" ExecType="3" Folder="/04.價量選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[setbarfreq("AD");

input:HitTimes(3,"設定觸底次數");
input:RangeRatio(1,"設定底部區範圍寬度%");
input:Length(20,"計算期數");

variable: theLow(0); 
variable: LowUpperBound(0); 
variable: TouchRangeTimes(0);

//找到過去期間的最低點
theLow = lowest(low[1],Length); 

// 設為瓶頸區間上界
LowUpperBound = theLow *(100+RangeRatio)/100; 

//期間中進入瓶頸區間的低點次數,每根K棒要歸0
TouchRangeTimes = CountIF(Low[1] < LowUpperBound, Length);
 
Condition1 = TouchRangeTimes >= HitTimes;
Condition2 = close < theLow;
Condition3 = Average(Volume, 5) >= 1000;
 
Ret = Condition1 And Condition2 And Condition3;

outputfield(1, theLow, 2, "區間低點", order := -1);

]]></Code>
<Arg><![CDATA[<Arg seed="9c7f10db-f3a7-4275-a6c3-b72536ce4753" version="1"><Param name="設定觸底次數" varname="HitTimes" type="1" subtype="0" value="3" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="設定底部區範圍寬度%" varname="RangeRatio" type="1" subtype="0" value="1" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="計算期數" varname="Length" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<TotalBar val="10" />
<FirstBarDate val="0" />
<Maxbb val="0" />
<script>
<freq support="11" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="淡季不淡" ID="9e80ddbd475d46c991ac5514039e2090" ReturnType="0" ExecType="1" Folder="/08.財報選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:r1(5);	setinputname(1,"過去幾年月營收單月衰退幅度下限(%)");
input:r2(0);	setinputname(2,"最近一個月營收月增率下限(%)");
//input:TXT("僅適用月線"); setinputname(3,"使用限制");
setbarfreq("M");

If barfreq <> "M" then raiseruntimeerror("頻率設定有誤");

settotalbar(3);

value1=GetField("月營收月增率","M");
value2=GetField("月營收月增率","M")[12];
value3=GetField("月營收月增率","M")[24];
value4=GetField("月營收月增率","M")[36];

if value2 < -r1 and value3 < -r1 and value4 < -r1 and value1 > r2
then ret=1;




]]></Code>
<Arg><![CDATA[<Arg seed="09c6ae77-f40a-4149-ac6d-ef475f6048cf" version="1"><Param name="過去幾年月營收單月衰退幅度下限(%)" varname="r1" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="最近一個月營收月增率下限(%)" varname="r2" type="1" subtype="0" value="0" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<script>
<freq support="10;13" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="營收再起飛" ID="4347bcec837946138b71427c7ee5b246" ReturnType="0" ExecType="1" Folder="/07.月營收選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[//input:TXT("僅適用月線"); setinputname(1,"使用限制");
setbarfreq("M");

If barfreq <> "M" then raiseruntimeerror("頻率設定有誤");

settotalbar(23);

value1=GetField("月營收年增率","M");
value2=average(GetField("月營收年增率","M"), 3);
value3=linearregslope(value2,20);
value4=linearregslope(value2,5);

if value3 < 0 and value4 crosses above 0
then ret=1;
]]></Code>
<Arg><![CDATA[<Arg seed="b995100c-1740-4036-bf0a-90213c7a0cb8" version="1" />]]></Arg>
<Extra><![CDATA[<Extra>
<script>
<freq support="10;13" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="23" />
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="多日價量背離後跌破" ID="27beb72ef00644d087f465a3dac75363" ReturnType="0" ExecType="3" Folder="/04.價量選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[setbarfreq("AD");

input:Length(5, "計算期數");
input:times(3, "價量背離次數");
input:Dist(20, "距離");

variable:count(0),KPrice(0),hDate(0);

count = CountIf(close > close[1] and volume < volume[1], Length);

if count > times then  begin
  hDate=Date;
  Kprice = lowest(l,length);
end;

Condition1 = Close crosses below Kprice;
Condition2 = DateDiff(Date,hdate) < Dist;
Ret = Condition1 And Condition2;

outputfield(1,Kprice,2,"關卡價", order := -1);
]]></Code>
<Arg><![CDATA[<Arg seed="dce5195e-f7e8-485e-a5bc-d9920c80836e" version="1"><Param name="計算期數" varname="Length" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="價量背離次數" varname="times" type="1" subtype="0" value="3" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="距離" varname="Dist" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<TotalBar val="10" />
<FirstBarDate val="0" />
<Maxbb val="0" />
<script>
<freq support="11" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="每年本業都獲利且趨勢向上" ID="b2eb9c0e9be442d8833927cf39fc343d" ReturnType="0" ExecType="3" Folder="/08.財報選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:lm(200,"年營業利益下限");
settotalbar(5);

value1=GetField("營業利益","Y");//百萬
if trueall(value1>lm,5)
//週去五年都賺超過一億
and linearregslope(value1,5)>0
//五年的營業利益趨勢往上
then ret=1;]]></Code>
<Arg><![CDATA[<Arg seed="75e8738b-3ce9-497d-b68c-e60a07e7a45d" version="1"><Param name="年營業利益下限" varname="lm" type="1" subtype="0" value="200" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<FirstBarDate val="0" />
<Maxbb val="0" />
<script>
<freq support="16;8;9;10;11;12;13;14;15" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="5" />
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="多空分數轉空" ID="3da7185f3b9a4c7aa2d811eeacf1c23a" ReturnType="0" ExecType="1" Folder="/03.進階技術分析/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[// 計算技術指標分數序列, 判斷指標分數是否翻轉
//
settotalbar(168);

value1 = techscore();
value2 = average(value1, 10);
if value2 crosses under 10 then ret = 1;





 ]]></Code>
<Arg><![CDATA[<Arg seed="86c25e46-c7a2-4458-83c8-557ab8c8105c" version="1" />]]></Arg>
<Extra><![CDATA[<Extra>
<Maxbb val="20" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="168" />
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="股價大於近N期平均" ID="b4e501e81165420aa39178bf961a2fb0" ReturnType="0" ExecType="1" Folder="/00.語法範例/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:N(5); setinputname(1, "期別"); 

SetTotalBar(3);

Value1 = Average(GetField("Close"),N);
if GetField("Close") > Average(GetField("Close"),N) then ret=1; 

SetOutputName1("均價");
outputfield1(Value1);

]]></Code>
<Arg><![CDATA[<Arg seed="774b2d8b-01e5-41d6-8959-f2a2d12233c9" version="1"><Param name="期別" varname="N" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="融資大減後轉強" ID="c42f4f2dde0743dab1e2218385c2327f" ReturnType="0" ExecType="1" Folder="/06.籌碼選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input: period(80);		setinputname(1, "計算區間");
input: v1(3000);		setinputname(2, "融資減少張數");

SetTotalBar(3);

value1 = highestbar(close,period);
value2 = GetField("融資餘額張數")[value1] - GetField("融資餘額張數");

if  value2 > v1 and 
	trueall(close > close[1],3)
then ret=1;

SetOutputName1("融資減少張數");
OutputField1(value2);

]]></Code>
<Arg><![CDATA[<Arg seed="09e46eaa-0fd9-436f-858b-b292bd08fdd9" version="1"><Param name="計算區間" varname="period" type="1" subtype="0" value="80" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="融資減少張數" varname="v1" type="1" subtype="0" value="3000" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<script>
<freq support="8;11;9;12;10;13" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="在上昇趨勢中的股票" ID="ee548ade26c143728d43263abd41ec43" ReturnType="0" ExecType="1" Folder="/05.型態選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:Length(20,"期間");   //"計算期間"
settotalbar(20);

LinearReg(close, Length, 0, value1, value2, value3, value4);
//做收盤價20天線性回歸
{value1:斜率,value4:預期值}

value5=rsquare(close,value4,20);
//算收盤價與線性回歸值的R平方

if value1>0 and value5>0.2
then ret=1;]]></Code>
<Arg><![CDATA[<Arg seed="1ade92e9-83ca-437b-ac40-324b5b489b3d" version="1"><Param name="期間" varname="Length" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<Maxbb val="0" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="20" />
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="增資股即將出籠" ID="86830602eb544fbfac710a226d8c13cb" ReturnType="0" ExecType="3" Folder="/06.籌碼選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[setbarfreq("AD");

value1=GetField("現增新股上市日");
value2=GetField("現增比率");//每千股可認股數
value3=GetField("現增價格");
value4=GetField("融券餘額張數","D");
value5=GetField("普通股股本","Q");//單位:億

if value1>date and datediff(value1,date)<10//增資股快上市了
and value5*10000*value2/1000>2000//增資張數大於5000張
and value4[30]>value4-1000//近一個月融券增加沒有超過1000張
and value3*1.1<close//股價仍比現增價格高超過一成
then ret=1;

outputfield(1,value1,0,"新股上市日", order := -1);
outputfield(2,value2,2,"現增比率");
outputfield(3,close-value3,2,"現增價差");
]]></Code>
<Arg><![CDATA[<Arg seed="e3367a95-acd7-40cb-9708-d3660b545e58" version="1" />]]></Arg>
<Extra><![CDATA[<Extra>
<TotalBar val="3" />
<FirstBarDate val="0" />
<Maxbb val="0" />
<script>
<freq support="11" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="現金不少但股價淨值比低" ID="203b4da02dbb4dbfbafd4b4eff95dc8a" ReturnType="0" ExecType="1" Folder="/08.財報選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:r1(0,"來自營運之現金流量下限");
input:r2(10,"現金及約當現金單位億元");
input:r3(0.8,"股價淨值比上限");

value1=GetField("來自營運之現金流量","Q");
value2=GetField("現金及約當現金","Q");
value3=GetField("股價淨值比","D");

if value1>r1
and value2/100>r2
and value3<r3
then ret=1;
 ]]></Code>
<Arg><![CDATA[<Arg seed="8f877b5b-600b-419b-b57c-5c071564662c" version="1"><Param name="來自營運之現金流量下限" varname="r1" type="1" subtype="0" value="0" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="現金及約當現金單位億元" varname="r2" type="1" subtype="0" value="10" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="股價淨值比上限" varname="r3" type="1" subtype="0" value="0.8" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<TotalBar val="10" />
<FirstBarDate val="0" />
<Maxbb val="0" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="投信掃貨" ID="1efe9ef3693f40569116f0e4c91d08d9" ReturnType="0" ExecType="1" Folder="/06.籌碼選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input: pastDays(5); 		setinputname(1,"計算天數");
input: _BuyRatio(10); 		setinputname(2,"買超佔比例(%)");

variable: SumForce(0);
variable: SumTotalVolume(0);

SetTotalBar(3);

SumForce = Summation(GetField("投信買賣超"), pastDays);
sumTotalVolume = Summation(Volume, pastDays);
value1 = SumForce / SumTotalVolume * 100;
if value1 > _BuyRatio then ret =1;

SetOutputName1("買超佔比例(%)");
OutputField1(value1);


]]></Code>
<Arg><![CDATA[<Arg seed="4c88cc20-ac61-4347-a1ee-260e0995347a" version="1"><Param name="計算天數" varname="pastDays" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="買超佔比例(%)" varname="_BuyRatio" type="1" subtype="0" value="10" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<script>
<freq support="8;11;9;12;10;13" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="下游價格指標趨勢向上" ID="d7a5d406c01541e782857970f4a7ab25" ReturnType="0" ExecType="3" Folder="/11.選股機器人/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input: Period(20, "天期"); 
Condition1 = rateofchange(GetField("下游股價指標"), period) >= Period; 
Condition2 = GetField("下游股價指標") > GetField("下游股價指標")[Period/2]; 
Condition3 = GetField("下游股價指標") > average(GetField("下游股價指標"), period); 
ret = condition1 and condition2 and condition3; 

outputfield(1,rateofchange(GetField("下游股價指標","D"),Period),2,"下游漲幅%", order := 1);
]]></Code>
<Arg><![CDATA[<Arg seed="a4951fff-71aa-4fb1-a6a0-3d057429f87a" version="1"><Param name="天期" varname="Period" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<FirstBarDate val="0" />
<Maxbb val="0" />
<TotalBar val="3" />
<script>
<freq support="8;11" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="月營收創新低" ID="c28600e57e674cf78362d89047b85d8d" ReturnType="0" ExecType="3" Folder="/07.月營收選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:period(36, "期別");
settotalbar(period + 5);

value1=GetField("月營收","M");
value2=lowest(GetField("月營收","M"),period);

if value1=value2
and value1[1]=value2[1]
then ret=1;

outputfield(1, value1,2,"月營收(億)", order := 1);



]]></Code>
<Arg><![CDATA[<Arg seed="9858ccd1-0e54-4d00-81fa-5b0c7f823b6e" version="1"><Param name="期別" varname="period" type="1" subtype="0" value="36" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<Maxbb val="0" />
<script>
<freq support="10;8;9;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="-1" />
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="營收年增率由負轉正，且至少連續3個月" ID="1ac5d23d2a69411e94ce243ef8d4157e" ReturnType="0" ExecType="3" Folder="/07.月營收選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[value1=GetField("月營收年增率","M");
input:period(3);
if trueall(value1>0,period) and value1[3]<0
then ret=1;]]></Code>
<Arg><![CDATA[<Arg seed="e6e5b23a-7bcb-43fc-8d89-7f5440117bab" version="1"><Param name="period" varname="period" type="1" subtype="0" value="3" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<TotalBar val="3" />
<Maxbb val="0" />
<script>
<freq support="10;8;9;11;12;13;14;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="即將董監改選" ID="f7a4275fdd514f6185f7b8ff856f8f85" ReturnType="0" ExecType="1" Folder="/08.財報選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input: day(180);		setinputname(1, "距離董監改選日期(天)");

settotalbar(3);

// 董監每三年得改選一次
//
variable: lastdate(0), diff(0), years_3(0);

lastdate = GetField("董監事就任日期");
diff = datediff(currentdate, lastdate);
years_3 = 365*3;

OutputField(1,lastdate,"董監事就任日期");
OutputField(2,diff,"改選天數");

ret = diff < years_3 and diff > years_3 - day;
 
]]></Code>
<Arg><![CDATA[<Arg seed="f0e5ef92-3dce-4712-b5b4-464ae214b8d0" version="1"><Param name="距離董監改選日期(天)" varname="day" type="1" subtype="0" value="180" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="預期報酬率高的公司" ID="ccec605614a644b1aea77e34cbafd112" ReturnType="0" ExecType="1" Folder="/08.財報選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input: tp(150,"最低目標預期報酬率");

value1=GetField("累計營收年增率","M");
value2=GetField("月營收","M");//單位:億
value3=GetField("營業毛利率","Q");
value4=GetField("營業費用","Q");//單位百萬
value5=GetField("加權平均股本","Q");//單位億

{用月營收*毛利率-季營業費用/3來當單月本業獲利，
乘12當未來一年的本業獲利除以股本為預估的未來一年EPS}
value6=((value2*value3/100-value4/300)*12/(value5))*10;

//未來一年預估EPS*累計營收年增率為目標價
//但若累計營收年增率不到10就以10倍本益比來算目標價
if value1>10 and value1<20 then value7=value6*value1
else if value1>=20 then value7=value6*20
else value7=value6*10;

//用預估EPS乘上累計營收成長率當成目標價
if close<>0
then value8=((value7-close)/close)*100;

if GetField("月營收月增率","M")<30 and GetField("月營收年增率","M")<50
then begin
	if value8 > tp then ret=1;
	outputfield(1,value8,"預期報酬率");
	outputfield(2,value7,"目標價");
	outputfield(3,value6,"預估EPS");
	outputfield(4,value2,"最近月營收(億)");
	outputfield(5,value3,"毛利率");
	outputfield(6,value4,"季營業費用(百萬)");
	outputfield(7,value5,"加權股本(億)");
end;]]></Code>
<Arg><![CDATA[<Arg seed="228459a2-606b-4dfb-9f2d-f9e1f75fdfbd" version="1"><Param name="最低目標預期報酬率" varname="tp" type="1" subtype="0" value="150" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<TotalBar val="3" />
<Maxbb val="0" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="多指標都出現買進訊號" ID="7ab2fcc8d9a3403992cf839c09f54e47" ReturnType="0" ExecType="3" Folder="/03.進階技術分析/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[settotalbar(120);

//=========計算RSI======================
Input:rsilength(6);		Setinputname(1,"設定RSI計算天期");
input:rsilimit(50);		Setinputname(2,"設定RSI要突破的限制");

Value1=rsi(close,rsilength);//計算RSI的值

//==========計算威廉指標==================
input: rLength(3);		SetInputName(3, "設定威廉指標天期");
input: rLimit(-50);		SetInputName(4, "設定威廉指標的限制");

value2 = PercentR(rLength) - 100;

//============計算DMI=======================
input: dmiLength(10);	setinputname(5,"設定DMI天期");
variable: pdi_value(0), ndi_value(0), adx_value(0);
DirectionMovement(dmiLength, pdi_value, ndi_value, adx_value);
value4=pdi_value;

//============純粹只是想確認本週股價都沒有跌破前週低==============
condition1 = GetField("Low", "W") > GetField("Low", "W")[1];

//============ XQ: tt指標==========================================
input: Length(10);		SetInputName(6, "設定tt指標計算期數");

variable: kk(0), qu(0), qd(0), qf(0), tt(0);

qf = 0;
qu = 0;
qd = 0;

for kk = 1 to length
  begin
	if close[(kk - 1)] > close[kk] then
		qu = qu + Volume[(kk - 1)]
	else
	  begin
		if close[(kk - 1)] < close[kk] then
			qd = qd + Volume[(kk - 1)]
		else { close[(kk - 1)] = close[kk] }
			qf = qf + Volume[(kk - 1)];
	  end;
  end;

if (qd + qf/2) <> 0 then
	tt = 100 * (qu + qf/2) /(qd + qf/2)
else
	tt = 1000;

value5=tt;

//==================設定警示條件====================================
if value1 > rsilimit 
and value2 > rLimit
and condition1 = true
and value4 > 0
and value5 > 800 
then ret=1; 
]]></Code>
<Arg><![CDATA[<Arg seed="e05d8126-1315-44e6-a0c1-536ca4a0b6cd" version="1"><Param name="設定RSI計算天期" varname="rsilength" type="1" subtype="0" value="6" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="設定RSI要突破的限制" varname="rsilimit" type="1" subtype="0" value="50" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="設定威廉指標天期" varname="rLength" type="1" subtype="0" value="3" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="設定威廉指標的限制" varname="rLimit" type="1" subtype="0" value="-50" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="設定DMI天期" varname="dmiLength" type="1" subtype="0" value="10" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="設定tt指標計算期數" varname="Length" type="1" subtype="0" value="10" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<Maxbb val="10" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="120" />
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="台幣升值受災股" ID="ec7ac066b57842e68fecdc532b2e8f51" ReturnType="0" ExecType="1" Folder="/09.時機操作/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[value1=GetField("每股營業額(元)","Y");
value2=GetField("外銷比率","Y");
if value1>20 and value2>90
//每股營收超過20且外銷比率超過九成
then ret=1;

outputfield(1,value1,0,"每股營收");
outputfield(2,value2,0,"外銷比率");



]]></Code>
<Arg><![CDATA[<Arg seed="cc6eb4ca-6015-4613-97a1-67fb07deeca0" version="1" />]]></Arg>
<Extra><![CDATA[<Extra>
<TotalBar val="10" />
<FirstBarDate val="0" />
<Maxbb val="0" />
<script>
<freq support="16;8;9;10;11;12;13;14;15" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="月營收出現死亡交叉" ID="cd8b90795ba541e2959d4637c15df61f" ReturnType="0" ExecType="3" Folder="/07.月營收選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:shortterm(4);
input:longterm(12);
setinputname(1,"短期均線");
setinputname(2,"長期均線");

if average(GetField("月營收","M"),shortterm)*1.1
< average(GetField("月營收","M"),longterm)
then ret=1;
]]></Code>
<Arg><![CDATA[<Arg seed="2d270500-4246-4aae-a4e3-3a3137f291f2" version="1"><Param name="短期均線" varname="shortterm" type="1" subtype="0" value="4" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="長期均線" varname="longterm" type="1" subtype="0" value="12" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<TotalBar val="3" />
<Maxbb val="0" />
<script>
<freq support="10;8;9;11;12;13;14;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="企業價值除以自由現金流的倍數低於一水準" ID="8ef4c22f234647f193faf08b063be06b" ReturnType="0" ExecType="3" Folder="/08.財報選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input: t1(4,"倍數");
setbarfreq("Q");
settotalbar(4);

value1=GetField("企業價值","Q");//單位百萬
value2=GetField("來自營運之現金流量","Q");//單位百萬
value3=GetField("資本支出金額","Q");//單位百萬
value4=GetField("所得稅費用","Q");//單位百萬
value5=GetField("利息支出","Q");//單位百萬
value6=value2-value3-value4-value5;
//自由現金流量 = 營運現金流量 - 資本支出 - 利息 - 稅金
value7=summation(value6,4);
//最近四期現金流量

if value1<t1*value7 then ret=1;
outputfield(1,value1,0,"企業價值");
outputfield(2,value7,0,"近四季自由現金流合計");


]]></Code>
<Arg><![CDATA[<Arg seed="b8120707-a0b8-483f-a911-a0cffedff291" version="1"><Param name="倍數" varname="t1" type="1" subtype="0" value="4" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<FirstBarDate val="0" />
<Maxbb val="0" />
<script>
<freq support="14" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="4" />
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="外盤成交變多" ID="87b9581998dc4dedbd8cc24ccdcdb2d4" ReturnType="0" ExecType="1" Folder="/03.進階技術分析/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:shortPeriod(5);		setinputname(1,"短期平均");
input:midPeriod(12);		setinputname(2,"長期平均");
input:minVolume(2000);		setinputname(3,"成交量門檻");

variable:
	sVolume(0),
	bVolume(0),
	ratio(0),
	ratioAvgShort(0),
	ratioAvgLong(0);

SetTotalBar(MaxList(shortPeriod, midPeriod) + 3);
	
sVolume = GetField("內盤量", "D");//內盤量
bVolume = GetField("外盤量", "D"); //外盤量
if sVolume + bVolume <> 0 then
	ratio = bVolume / (sVolume + bVolume) * 100
else
	ratio = 50;
	
ratioAvgShort = average(ratio,shortPeriod);
ratioAvgLong = average(ratio,midPeriod);

if 
	volume > minVolume and 
	ratioAvgShort < 40 and 
	ratioAvgLong < 40 and 
	absvalue(ratioAvgShort-ratioAvgLong) < 10 and 
	ratioAvgShort crosses above ratioAvgLong
then 
	ret=1; 

]]></Code>
<Arg><![CDATA[<Arg seed="2a651494-3b8d-4811-8241-1cde4271efd5" version="1"><Param name="短期平均" varname="shortPeriod" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="長期平均" varname="midPeriod" type="1" subtype="0" value="12" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="成交量門檻" varname="minVolume" type="1" subtype="0" value="2000" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="-1" />
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="可能由盈轉虧" ID="5b9fce88962742b19a58752e482f4c42" ReturnType="0" ExecType="1" Folder="/11.選股機器人/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[// 計算最新一期月營收的日期(mm=月份)
//
variable: mm(0);
mm = datevalue(getfielddate("月營收","M"),"M");

// 預估最新一季的季營收(單位=億)
//
if mm=1 or mm=4 or mm=7 or mm=10
then value1=GetField("月營收","M") * 3;
if mm=2 or mm=5 or mm=8 or mm=11
then value1=GetField("月營收","M") * 2 + GetField("月營收","M")[1];
if mm=3 or mm=6 or mm=9 or mm=12
then value1=GetField("月營收","M")+GetField("月營收","M")[1]+GetField("月營收","M")[2];

// 預估獲利(單位=百萬) = 季營收 * 毛利率 - 營業費用
//
value2 = value1 * GetField("營業毛利率","Q") - GetField("營業費用","Q");

ret = 1;

outputfield(1,value2 / 100,2,"預估單季本業獲利(億)", order := 1);




]]></Code>
<Arg><![CDATA[<Arg seed="b013de7c-d162-47c7-96e6-135e4277fa58" version="1" />]]></Arg>
<Extra><![CDATA[<Extra>
<FirstBarDate val="0" />
<Maxbb val="0" />
<TotalBar val="3" />
<script>
<freq support="10;8;9;11;12;13;14;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="本業推估本益比低於N" ID="e871341fd0a444b7ba06cc1053f3d14e" ReturnType="0" ExecType="3" Folder="/08.財報選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:epsl(15,"預估本益比上限");

value3= summation(GetField("營業利益","Q"),4); //單位百萬;
value4= GetField("最新股本");//單位億;
value5= value3/(value4*10);//每股預估EPS
if value5>0 and close/value5<=epsl
then ret=1;

outputfield(1,close/value5,1,"預估本益比", order := 1);
]]></Code>
<Arg><![CDATA[<Arg seed="d628cbe5-9343-4c40-a217-9e8c2e99165f" version="1"><Param name="預估本益比上限" varname="epsl" type="1" subtype="0" value="15" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<TotalBar val="3" />
<Maxbb val="0" />
<script>
<freq support="8;11" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="主流股蓄勢待發" ID="b898d713aa32498aa9c2735173e77ec7" ReturnType="0" ExecType="1" Folder="/06.籌碼選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:days(10);
input: FastLength(12, "DIF短期期數"), SlowLength(26, "DIF長期期數"), MACDLength(9, "MACD期數");
variable: difValue(0), macdValue(0), oscValue(0),Kprice(0);

settotalbar(100);
MACD(weightedclose(), FastLength, SlowLength, MACDLength, difValue, macdValue, oscValue);
if absvalue((average(close,20)-close)/close)*100<2
and absvalue((average(close,60)-close)/close)*100<2
and close=highest(close,days)
and macdvalue>macdvalue[1]
and macdvalue>0
and difvalue>0
then ret=1;
]]></Code>
<Arg><![CDATA[<Arg seed="2558c096-d788-41ea-a069-e7915ecdb546" version="1"><Param name="day" varname="day" type="1" subtype="0" value="10" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="DIF短期期數" varname="FastLength" type="1" subtype="0" value="12" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="DIF長期期數" varname="SlowLength" type="1" subtype="0" value="26" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="MACD期數" varname="MACDLength" type="1" subtype="0" value="9" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<FirstBarDate val="0" />
<Maxbb val="0" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="100" />
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="股東權益報酬率高且穩定" ID="6839c5ea032d4cd2963a71bfa23c0a1c" ReturnType="0" ExecType="1" Folder="/08.財報選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:years(5);		setinputname(1,"評估期間(年)");
input:r1(15);		setinputname(2,"ROE下限(%)");
input:r2(3);		setinputname(3,"ROE最大差異(%)");
input:fx("資料頻率");	SetInputName(4, "使用限制:請選擇年頻率");

if barfreq <> "Y" then raiseruntimeerror("頻率錯誤");

settotalbar(3);

value1=GetField("股東權益報酬率","Y");

value2=lowest(GetField("股東權益報酬率","Y"), years);
value3=highest(GetField("股東權益報酬率","Y"), years);

if (value3 - value2) < r2 and value2 > r1 
then ret=1;

setoutputname1("ROE(%)");
outputfield1(value1);


]]></Code>
<Arg><![CDATA[<Arg seed="83272179-5972-4065-a8e6-c7ff5669c995" version="1"><Param name="評估期間(年)" varname="years" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="ROE下限(%)" varname="r1" type="1" subtype="0" value="15" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="ROE最大差異(%)" varname="r2" type="1" subtype="0" value="3" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="使用限制:請選擇年頻率" varname="fx" type="3" subtype="0" value="資料頻率" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<script>
<freq support="16;8;9;10;11;12;13;14;15" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="法定盈餘公積已提足，配股能力提昇" ID="7d8e45f559244121b0b20aa87715496c" ReturnType="0" ExecType="1" Folder="/08.財報選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[value1=GetField("法定盈餘公積","Q");	//百萬

value2=GetField("最新股本");			//億

value3=GetField("本期稅後淨利","Q");	//百萬

// 稅後淨利 + 法定盈餘公積 > 股本
//
if value1 + value3 > value2*100
then ret=1;

]]></Code>
<Arg><![CDATA[<Arg seed="c40ef8f6-e4cb-48df-97a0-685cde19a11e" version="1" />]]></Arg>
<Extra><![CDATA[<Extra>
<script>
<freq support="8;11" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="最近4季EPS合計小於X元" ID="50ad77a5400b49769e47b9e0486d34b7" ReturnType="0" ExecType="1" Folder="/00.語法範例/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:X(0); SetInputName(1, "元");

variable: N(4);

SetTotalBar(3); 

Value1 = Summation(GetField("EPS","Q"),N);
if Value1 < X then ret=1; 

SetOutputName1("EPS合計"); 
OutputField1(Value1); 
]]></Code>
<Arg><![CDATA[<Arg seed="2dfa34c8-f27b-4669-893c-0af0f4927ed2" version="1"><Param name="元" varname="X" type="1" subtype="0" value="0" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<script>
<freq support="14;8;9;10;11;12;13;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="股本篩選" ID="8cb4bf9857d94f6d984e340512823278" ReturnType="0" ExecType="1" Folder="/01.常用過濾條件/" StatusMask="2">
<Desc><![CDATA[篩選股本介於X億到Y億之間的股票。]]></Desc>
<Code><![CDATA[input:MinCapital(10);
input:MaxCapital(50); 

SetInputName(1, "最小股本(億)");
SetInputName(2, "最大股本(億)");

SetTotalBar(3);

Value1 = GetField("最新股本");

// 介於兩者之間
Ret = Value1 >= MinCapital and Value1 <= MaxCapital;


]]></Code>
<Arg><![CDATA[<Arg seed="f22bf288-38a4-450b-b207-58fe7f73e4ef" version="1"><Param name="最小股本(億)" varname="MinCapital" type="1" subtype="0" value="10" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="最大股本(億)" varname="MaxCapital" type="1" subtype="0" value="50" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<Maxbb val="0" />
<script>
<freq support="8;11" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="曾經一個月漲超過兩成的股票" ID="032d9e7d87ca445ca4336eeff409ab6d" ReturnType="0" ExecType="1" Folder="/04.價量選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[setbarfreq("M");
settotalbar(12);

if close>close[1]*1.2 then 
begin
	ret=1;
	outputfield(1,intportion(date*0.01),0,"上漲的月份");
end;

]]></Code>
<Arg><![CDATA[<Arg seed="fbde6893-889f-426d-ba7f-96d93d962a74" version="1" />]]></Arg>
<Extra><![CDATA[<Extra>
<FirstBarDate val="0" />
<Maxbb val="0" />
<script>
<freq support="10;13" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="12" />
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="趨勢成形" ID="3b1746c2e5164494954f12fe6d3e31f3" ReturnType="0" ExecType="3" Folder="/03.進階技術分析/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[// ADX趨勢成形
//
input: Length(14), Threshold(25);

variable: pdi_value(0), ndi_value(0), adx_value(0);

SetTotalBar(Length*11);

SetInputName(1, "期數");
SetInputName(2, "穿越值");

DirectionMovement(Length, pdi_value, ndi_value, adx_value);

if adx_value Crosses Above Threshold and close=high
then ret=1;]]></Code>
<Arg><![CDATA[<Arg seed="8fbd192c-e4ed-46cb-bb8e-3e79e151b1e9" version="1"><Param name="期數" varname="Length" type="1" subtype="0" value="14" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="穿越值" varname="Threshold" type="1" subtype="0" value="25" isSerial="1" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<Maxbb val="14" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="-1" />
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="股本膨脹營收獲利跟不上" ID="77b841ce3b99415f808d0ef6769828da" ReturnType="0" ExecType="3" Folder="/08.財報選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[//input:TXT("僅適用年資料"); setinputname(1,"使用限制");
setbarfreq("Y");

if barfreq <> "Y" then raiseruntimeerror("頻率錯誤");

settotalbar(4);

value1 = RateOfChange(GetField("普通股股本","Y"), 1);
value2 = RateOfChange(GetField("營業收入淨額","Y"), 1);
value3 = GetField("營業利益成長率","Y");

if 
	value1 > value2 and
	value1 > value3 and
	value1[1] > value2[1] and
	value1[1] > value3[1]
then
ret = 1;



]]></Code>
<Arg><![CDATA[<Arg seed="5360b438-d453-452d-82e4-3959946cdf2c" version="1" />]]></Arg>
<Extra><![CDATA[<Extra>
<script>
<freq support="16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="4" />
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="說好的好業績一直沒有來" ID="f51412aa91f1405cb169a91f77221817" ReturnType="0" ExecType="1" Folder="/08.財報選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input: r1(5);		setinputname(1, "月營收月增率上限(%)");
input: r2(30);		setinputname(2, "預估本益比下限");

settotalbar(3);

value1 = 4 * GetField("每股稅後淨利(元)","Q");	// 預估每股盈餘(年)
if value1 > 0 then
	value2 = close / value1				//本益比
else	
	value2 = 0;	

if value2 > r2 and 
   trueall(GetField("月營收月增率","M") < r1, 3) 
then ret = 1;

setoutputname1("預估每股盈餘(元)");
outputfield1(value1);

]]></Code>
<Arg><![CDATA[<Arg seed="fcc34e92-7903-4d0f-99a6-f164b875842e" version="1"><Param name="月營收月增率上限(%)" varname="r1" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="預估本益比下限" varname="r2" type="1" subtype="0" value="30" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="成交量放大" ID="c5da72c091c64cb98378aa6cbe832022" ReturnType="0" ExecType="1" Folder="/02.基本技術指標/" StatusMask="2">
<Desc><![CDATA[挑選成交量比前幾日均量放大的股票。]]></Desc>
<Code><![CDATA[input: Length(5), VolFactor(2);

SetInputName(1, "均量區間");
SetInputName(2, "放大倍數");

settotalbar(3);

Ret = Volume > Average(Volume[1], Length) * VolFactor;
]]></Code>
<Arg><![CDATA[<Arg seed="13ac6c9b-efd2-4c47-9e4c-8fc40d67337f" version="1"><Param name="均量區間" varname="Length" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="放大倍數" varname="VolFactor" type="1" subtype="0" value="2" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="上櫃股可以發行權證的流動性條件" ID="5a46baf404d747338c42ebff370cbc62" ReturnType="0" ExecType="1" Folder="/08.財報選股/" StatusMask="2">
<Desc><![CDATA[使用時請設定篩選範圍為上櫃股。
]]></Desc>
<Code><![CDATA[{
	1. 市值超過40億元
	
	2. (a or b)
		a. 最近3個月成交股數佔已發行股份總額比例達10%以上。
		b. 最近三個月月平均成交股數達3000萬股以上。

	3. 最近期經會計師查核或核閱之財務報告無虧損
}

settotalbar(3);

// 近三個月成交股數佔以發行股份比例
//
Value1 = Summation(GetField("成交量", "M"), 3) * 100 / (GetField("發行張數","D") * 10000);

// 最近三個月月平均成交股數
//
Value2 = Average(GetField("成交量", "M"), 3) * 1000;

if GetField("總市值","D") >= 40 and 
   (Value1 > 10 or Value2 > 3000000) and 
   GetField("每股稅後淨利(元)","Q") > 0 
then 
Ret = 1;


 ]]></Code>
<Arg><![CDATA[<Arg seed="5c5056b0-2aff-4291-b061-f5c661c57f86" version="1" />]]></Arg>
<Extra><![CDATA[<Extra>
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="毛利率沒掉的兇" ID="420d321cce344498aca2ed12f83cd025" ReturnType="0" ExecType="3" Folder="/08.財報選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:ratio(10,"毛利率單季衰退幅度上限");
input:period(10,"計算的期間，單位是季");

value1=GetField("營業毛利率","Q");
if trueall(value1>value1[1]*(1-ratio/100),period)
then ret=1;]]></Code>
<Arg><![CDATA[<Arg seed="132fb8f1-00c6-441a-8334-efe372ff0b87" version="1"><Param name="毛利率單季衰退幅度上限" varname="ratio" type="1" subtype="0" value="10" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="計算的期間，單位是季" varname="period" type="1" subtype="0" value="10" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<TotalBar val="10" />
<FirstBarDate val="0" />
<Maxbb val="0" />
<script>
<freq support="14;8;9;10;11;12;13;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="最近五年ROE平均高於某值" ID="3f816207e3b1489eb784025e5baaab88" ReturnType="0" ExecType="3" Folder="/08.財報選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:r1(15,"平均報酬率");

if average(GetField("股東權益報酬率","Y"),5)>r1
then ret=1;

outputfield(1,GetField("股東權益報酬率","Y"),1,"最近一年");
outputfield(2,GetField("股東權益報酬率","Y")[1],1,"前一年");
outputfield(3,GetField("股東權益報酬率","Y")[2],1,"前兩年");
outputfield(4,GetField("股東權益報酬率","Y")[3],1,"前三年");
outputfield(5,GetField("股東權益報酬率","Y")[4],1,"前四年");
outputfield(6,average(GetField("股東權益報酬率","Y"),5),1,"平均");
]]></Code>
<Arg><![CDATA[<Arg seed="8b843608-d094-4f00-b5f5-df9d3c56f8c9" version="1"><Param name="平均報酬率" varname="r1" type="1" subtype="0" value="15" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<script>
<freq support="16;8;9;10;11;12;13;14;15" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="週線二連紅" ID="f07cdd2b3ff6457c85096d792624eacc" ReturnType="0" ExecType="3" Folder="/04.價量選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[SetBarFreq("AW");

if rateofchange(close,2)[1]>0 and rateofchange(close,2)[2]>0
and close<close[2]*1.07
and close[10]>close*1.2
then ret=1;

outputfield(1,close[2],2,"前波低點", order := -1);
]]></Code>
<Arg><![CDATA[<Arg seed="fa02c358-399f-4aee-b13b-68434d6cb19d" version="1" />]]></Arg>
<Extra><![CDATA[<Extra>
<TotalBar val="10" />
<FirstBarDate val="0" />
<Maxbb val="0" />
<script>
<freq support="12" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="過去M日有N日HHLL" ID="bc71049b8314425e8989aca352d535d4" ReturnType="0" ExecType="1" Folder="/04.價量選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:days(5,"計算天期");
input:occurrence(2, "發生次數");

condition1= high>high[1] and low>low[1] ;
value1=countif(condition1,days);
if value1>=occurrence then ret=1;

]]></Code>
<Arg><![CDATA[<Arg seed="a2257f4d-04ff-474d-abc5-dbecd4b1be30" version="1"><Param name="計算天期" varname="day" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="發生次數" varname="occurrence" type="1" subtype="0" value="2" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<TotalBar val="10" />
<FirstBarDate val="0" />
<Maxbb val="0" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="EPS連續N季都小於X元" ID="17d4313cf9e4413dbcd6b989cfb6611c" ReturnType="0" ExecType="1" Folder="/00.語法範例/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:N(4); setinputname(1, "期別");
input:X(0); setinputname(2, "元"); 

SetTotalBar(3); 

if TrueAll(GetField("EPS", "Q") < X,N) then ret=1; 

SetOutputName1("EPS(元)(季)"); 
OutputField1(GetField("EPS", "Q")); 
]]></Code>
<Arg><![CDATA[<Arg seed="93335ba8-36a4-48c4-902f-b7ec26f7f0b9" version="1"><Param name="期別" varname="N" type="1" subtype="0" value="4" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="元" varname="X" type="1" subtype="0" value="0" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<Maxbb val="0" />
<script>
<freq support="14;8;9;10;11;12;13;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="可預期的營收成長股" ID="f04058fbf9974129815815412111b87f" ReturnType="0" ExecType="1" Folder="/07.月營收選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[// 找出過去幾年這個月的營收都會成長的股票
//
input: years(3, "過去N年");
input: growrate(10, "YOY成長%");

variable: mm(0);
variable: count(0);
variable: idx(0);

settotalbar(1);

// 最新一期營收月份
//
mm = Month(getfielddate("月營收", "M"));

// 下一期營收月份
mm = mm + 1;
if mm > 12 then mm = 1;

while count < years begin
	if Month(getfielddate("月營收", "M")[idx]) = mm then begin
		// 看同月份的營收YOY是否符合標準, 不符合的話就不用再找了
		if getfield("月營收年增率", "M")[idx] < growrate then return;
		count = count + 1;
	end;
	idx = idx + 1;	
end;

ret = 1;



]]></Code>
<Arg><![CDATA[<Arg seed="4f912931-d2dc-4020-bb97-98fadca6617a" version="1"><Param name="過去N年" varname="years" type="1" subtype="0" value="3" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="YOY成長%" varname="growrate" type="1" subtype="0" value="10" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<FirstBarDate val="0" />
<Maxbb val="0" />
<script>
<freq support="10;8;9;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="1" />
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="創百日新高但距低點不遠" ID="f6a602c6de4d439f9fc022517a33343d" ReturnType="0" ExecType="3" Folder="/11.選股機器人/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:day(200,"計算區間");
input:day1(20,"短線漲幅計算區間");
input:percents(10,"距離區間最低點漲幅");

value1=lowest(close,day1-1);
if close=highest(close,day-1)
and value1*(1+percents/100)>=high
and high >= value1*1.05
and volume >= average(volume[1], 5)

then ret=1;

outputfield(1, value1, 2, "區間低點", order := -1);
]]></Code>
<Arg><![CDATA[<Arg seed="a781a4b7-f348-4b37-bf98-3eabf918a875" version="1"><Param name="計算區間" varname="day" type="1" subtype="0" value="200" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="短線漲幅計算區間" varname="day1" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="距離區間最低點漲幅" varname="percents" type="1" subtype="0" value="10" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<TotalBar val="10" />
<FirstBarDate val="0" />
<Maxbb val="0" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="流動資產市值比" ID="b999e12d8af247cb85cbae1378a5d455" ReturnType="0" ExecType="1" Folder="/08.財報選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:r1(12);			setinputname(1,"流動資產市值比下限%");

settotalbar(3);

value1=GetField("流動資產","Q");	// 單位=百萬
value2=GetField("總市值","D");		// 單位=億
value3=value1/value2;				// 單位=%
if value3 < r1
then ret=1;

setoutputname1("流動資產市值比%");
outputfield1(value3);
]]></Code>
<Arg><![CDATA[<Arg seed="96fdb742-1b3c-42dc-89aa-0343506b410c" version="1"><Param name="流動資產市值比下限%" varname="r1" type="1" subtype="0" value="12" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="主力公司派可能出貨中" ID="c04060898e9842cdba921d8ce7af243b" ReturnType="0" ExecType="1" Folder="/06.籌碼選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:Period(5);	setinputname(1,"近期偏弱期間");
input:Rate1(1000);	setinputname(2,"法人及散戶合計賣出上限");
input:Rate2(5000);	setinputname(3,"成交量下限");
input:Ratio(1); 	setinputname(4,"接近低點幅度");

SetTotalBar(3);
 
if Close < Close[Period] and  {近期股價累計為下跌}
   Close < Lowest(Low,Period)* (1+Ratio/100) and {接近期間低點}
   Average(Volume,Period) > Rate2    {偏弱期間均量大於成交量下限}
then 
  begin  
	value1= GetField("法人持股","D") - GetField("法人持股","D")[Period]; {期間法人累計買賣超}
	value2= GetField("融資餘額張數","D") - GetField("融資餘額張數","D")[Period] ; {期間融資累計增減}
	value3= GetField("融券餘額張數","D") - GetField("融券餘額張數","D")[Period];{期間融券累計增減}
 
	if value1 + value2 -value3 >  Rate1 * -1 then ret=1;
  end;
]]></Code>
<Arg><![CDATA[<Arg seed="e59973c8-2d0b-4577-ab1c-dcc816ad0ccb" version="1"><Param name="近期偏弱期間" varname="Period" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="法人及散戶合計賣出上限" varname="Rate1" type="1" subtype="0" value="1000" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="成交量下限" varname="Rate2" type="1" subtype="0" value="5000" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="接近低點幅度" varname="Ratio" type="1" subtype="0" value="1" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="天量後價量未再創新高" ID="d4ede89171eb4a7c9e6483bcbb93d698" ReturnType="0" ExecType="1" Folder="/03.進階技術分析/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:XLength(60); 	setinputname(1,"長期大量計算期數");
input:Length(3); 	setinputname(2,"超過n日價量未再創新高");

variable: PriceHighBar(0),VolumeHighBar(0);

settotalbar(3);

VolumeHighBar = highestbar(volume, XLength);
PriceHighBar = highestbar(high, Length);

// 近日內成交量創新高, 可是價格沒有創新高
//
if VolumeHighBar > 0 and 
   VolumeHighBar <= Length and
   PriceHighBar = VolumeHighBar then
ret = 1;
]]></Code>
<Arg><![CDATA[<Arg seed="b7e45827-df6e-4082-b32d-54e331f71000" version="1"><Param name="長期大量計算期數" varname="XLength" type="1" subtype="0" value="60" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="超過n日價量未再創新高" varname="Length" type="1" subtype="0" value="3" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<Maxbb val="0" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="籌碼從散戶手裡被收集" ID="6a2ad5791bd54fe4b76f803c2db8865e" ReturnType="0" ExecType="3" Folder="/06.籌碼選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:ratio(200);		setinputname(1,"控盤者買張除以散戶買張的比例(%)");
input:volLimit(2000);	setinputname(2,"成交量下限(張)");

settotalbar(3);

value1=GetField("控盤者買張");
value2=GetField("散戶買張");
value3=value1/value2 * 100;

if volume > volLimit and value3 > ratio and value3[1] > ratio
then ret=1;

]]></Code>
<Arg><![CDATA[<Arg seed="bd3bad56-05a7-4cdb-b8a4-00558ce68d22" version="1"><Param name="控盤者買張除以散戶買張的比例(%)" varname="ratio" type="1" subtype="0" value="200" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="成交量下限(張)" varname="volLimit" type="1" subtype="0" value="2000" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<script>
<freq support="8;11;9;12;10;13" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="毛利沒掉營收成長費用減少" ID="008cb0bdb76048bbac243ed02fa57576" ReturnType="0" ExecType="3" Folder="/08.財報選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:ratio(10,"毛利率單季衰退幅度上限");
input:period1(10,"計算的期間，單位是季");
input:period2(5,"計算的季別");
input:count(2,"符合條件之最低次數");
setbarfreq("Q");
settotalbar(maxlist(period1,period2)+1);

value1=GetField("營業毛利率","Q");
value2=GetField("營業收入淨額","Q");//單位百萬
value3=GetField("營業費用","Q");//單位百萬

if trueall(value1>value1[1]*(1-ratio/100),period1)
and countif(value2>value2[1]and value3<value3[1],period2)>=count
then ret=1;]]></Code>
<Arg><![CDATA[<Arg seed="9f2571e6-71bc-4ca2-8c27-8c6e17e84c00" version="1"><Param name="毛利率單季衰退幅度上限" varname="ratio" type="1" subtype="0" value="10" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="計算的期間，單位是季" varname="period1" type="1" subtype="0" value="10" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="計算的季別" varname="period2" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="符合條件之最低次數" varname="count" type="1" subtype="0" value="2" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<FirstBarDate val="0" />
<Maxbb val="0" />
<script>
<freq support="14" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="-1" />
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="高現金報酬率" ID="2ef8015cba574fc490b48157e6818d83" ReturnType="0" ExecType="1" Folder="/08.財報選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:r1(5);		setinputname(1,"現金報酬率下限(%)");

settotalbar(3);

// 自由現金流
//
value1 = GetField("來自營運之現金流量","Q") - (GetField("固定資產","Q") - GetField("固定資產","Q")[1]);

// 淨利息費用

value2=GetField("利息支出","Q") - GetField("利息收入","Q");				

// 現金報酬率(%)
//
value3 = (value1 + value2) / GetField("企業價值","Q") * 100;

if value3 > r1 then ret = 1;
 
SetOutputName1("現金報酬率(%)");
OutputField1(value3);
 ]]></Code>
<Arg><![CDATA[<Arg seed="378d1791-39df-44eb-abc3-8adb288ae32f" version="1"><Param name="現金報酬率下限(%)" varname="r1" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<script>
<freq support="14;8;9;10;11;12;13;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="低本益比低PB高殖利率" ID="6dc4bbe91c8e43cfba21a609f5eacae8" ReturnType="0" ExecType="1" Folder="/10.價值投資/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[{本益比小於 15 倍 股價淨值比小於 2 倍 殖利率大於 3%}



if GetField("本益比","D") < 10 and
   GetField("股價淨值比","D") <1.5 and
   GetField("殖利率","D") > 3  and
   GetField("營收成長率","Q") >0 
    
    
   then ret=1;
   
   ]]></Code>
<Arg><![CDATA[<Arg seed="a34f9db5-77ae-4ff2-85d8-aca2952e78db" version="1" />]]></Arg>
<Extra><![CDATA[<Extra>
<TotalBar val="3" />
<FirstBarDate val="0" />
<Maxbb val="0" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="外資完全不碰的股票有人在收籌碼" ID="44e010933de040d78a8b61740baae552" ReturnType="0" ExecType="1" Folder="/06.籌碼選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input: period(5);				setinputname(1, "計算期間");
input: investorLimit(2000);		setinputname(2, "外資持股上限");
input: ratio(50);				setinputname(3, "主力買張比重(%)");
input: volLimit(500);			setinputname(4, "成交均量下限");

SetTotalBar(3);

// 主力買張比重
value1 = summation(GetField("主力買張","D"), period);
value2 = summation(volume, period);
value3 = value1 / value2 * 100;

if GetField("外資持股","D") < investorLimit and value3 > ratio and value2 > volLimit * period  
then ret=1;

SetOutputName1("主力買張比重(%)");
OutputField1(value3);

]]></Code>
<Arg><![CDATA[<Arg seed="869af5a2-68a0-4100-979f-8cb1094fa79c" version="1"><Param name="計算期間" varname="period" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="外資持股上限" varname="investorLimit" type="1" subtype="0" value="2000" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="主力買張比重(%)" varname="ratio" type="1" subtype="0" value="50" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="成交均量下限" varname="volLimit" type="1" subtype="0" value="500" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="現金佔總市值比例" ID="71fadb77164044ef8ff1bc232711c23a" ReturnType="0" ExecType="1" Folder="/08.財報選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input: r1(50);		setinputname(1,"現金佔總市值比例%");

settotalbar(3);

value1=GetField("現金及約當現金","Q");	// 單位=百萬
value2=GetField("總市值","D");			// 單位=億
value3=value1/value2;					// 單位=%

if value3 > r1 then ret=1;

SetoutputName1("現金佔總市值比例%");
OutputField1(value3);
]]></Code>
<Arg><![CDATA[<Arg seed="a8bd3c68-1f9c-4507-a9b9-3b39389baacf" version="1"><Param name="現金佔總市值比例%" varname="r1" type="1" subtype="0" value="50" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="籌碼被發散" ID="84a8e61edf8645f1bbaa7309fbae554c" ReturnType="0" ExecType="3" Folder="/06.籌碼選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[setbarfreq("AD");

input:period(10, "天期");

value1=GetField("分公司賣出家數");
value2=GetField("分公司買進家數");

if linearregslope(value1,period)<0
//賣出的家數愈來愈少
and linearregslope(value2,period)>0
//買進的家數愈來愈多 
and value2>300
and close>close[period]*1.05
//但這段期間股價在漲
and close>close[1]*1.025
//今天又漲超過2.5%
then ret=1;

outputfield(1,value2,0,"買進家數", order := 1);
outputfield(2,value1,0,"賣出家數");

]]></Code>
<Arg><![CDATA[<Arg seed="52da7abb-b103-4f60-8366-8e58aff3552c" version="1"><Param name="天期" varname="period" type="1" subtype="0" value="10" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<TotalBar val="10" />
<FirstBarDate val="0" />
<Maxbb val="0" />
<script>
<freq support="11" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="最新一季可能虧錢的公司" ID="d27f8acf707545c88e388f5a2ace4137" ReturnType="0" ExecType="3" Folder="/08.財報選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[setbarfreq("M");

value1=GetField("月營收","M");//單位:億
value2=value1[2]+value1[3]+value1[4];
value3=GetField("營業毛利率","Q");
value4=GetField("營業費用","Q");//單位:百萬

if value2*value3/100-value4/100<0  
then ret=1;]]></Code>
<Arg><![CDATA[<Arg seed="384e937c-e8f5-4b64-acfc-6bb65b597209" version="1" />]]></Arg>
<Extra><![CDATA[<Extra>
<TotalBar val="3" />
<Maxbb val="0" />
<script>
<freq support="10;13" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="量價背離" ID="68e8cf45ab554685bf0dd94c2b3e4e63" ReturnType="0" ExecType="1" Folder="/04.價量選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:length(10);		setinputname(1,"計算區間");

settotalbar(length + 3);

value1 = average(close,length);
value2 = average(volume,length);
value3 = linearregslope(value1,length);
value4 = linearregslope(value2,length);

if value2 > 1000 and value3 < 0 and value4 > 0
then ret=1;

]]></Code>
<Arg><![CDATA[<Arg seed="0927b705-cb4b-432b-beff-133c1a840629" version="1"><Param name="計算區間" varname="length" type="1" subtype="0" value="10" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="-1" />
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="CCI超賣" ID="8a7349fc0d59410ebd3efed7a9f3552c" ReturnType="0" ExecType="1" Folder="/02.基本技術指標/" StatusMask="2">
<Desc><![CDATA[CCI指標過低。
]]></Desc>
<Code><![CDATA[// CCI超賣
//
Input: Length(14), AvgLength(9), OverSold(-100);
Variable: cciValue(0), cciMAValue(0);

SetTotalBar(maxlist(AvgLength + Length + 1,6) + 3);

SetInputName(1, "期數");
SetInputName(2, "平滑期數");
SetInputName(3, "超賣值");

cciValue = CommodityChannel(Length);
cciMAValue = Average(cciValue, AvgLength);

Condition1 = cciMAValue Crosses Below OverSold;
If condition1 then ret = 1;

SetOutputName1("CCI");
OutputField1(cciValue);
]]></Code>
<Arg><![CDATA[<Arg seed="a101350e-c365-4721-a949-174cdf21abf6" version="1"><Param name="期數" varname="Length" type="1" subtype="0" value="14" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="平滑期數" varname="AvgLength" type="1" subtype="0" value="9" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="超賣值" varname="OverSold" type="1" subtype="0" value="-100" isSerial="1" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="-1" />
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="毛利率沒掉的兇" ID="7bf94457f7454160acf30f767dd4ea7b" ReturnType="0" ExecType="3" Folder="/11.選股機器人/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:ratio(10,"毛利率單季衰退幅度上限");
input:period(10,"計算的期間，單位是季");

value1=GetField("營業毛利率","Q");
if trueall(value1>value1[1]*(1-ratio/100),period)
then ret=1;]]></Code>
<Arg><![CDATA[<Arg seed="770cad08-c328-44ba-a0df-ae64cdb2c740" version="1"><Param name="毛利率單季衰退幅度上限" varname="ratio" type="1" subtype="0" value="10" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="計算的期間，單位是季" varname="period" type="1" subtype="0" value="10" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<TotalBar val="3" />
<FirstBarDate val="0" />
<Maxbb val="0" />
<script>
<freq support="14;8;9;10;11;12;13;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="投信第一天大買進" ID="75c1ea597ac24b7fb382797ba8dd3626" ReturnType="0" ExecType="3" Folder="/06.籌碼選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[value1=GetField("最新股本");//單位:億
value2=GetField("投信買張","D");
value3=value2*close/10;  //單位:萬}

 
 
condition1=value3>200 and value1<80;
 
condition2=filter(condition1,5);

if condition2 
then ret=1;



]]></Code>
<Arg><![CDATA[<Arg seed="73637f49-3d31-44b3-b8c4-1d92d98b4c38" version="1" />]]></Arg>
<Extra><![CDATA[<Extra>
<TotalBar val="3" />
<FirstBarDate val="0" />
<Maxbb val="0" />
<script>
<freq support="8;11" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="行業轉強個股也轉強" ID="392686f5e75c4f5bbbd38fc05f21208d" ReturnType="0" ExecType="3" Folder="/04.價量選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:period(20,"計算區間");
setbarfreq("D");
settotalbar(20);

value1=GetField("同業股價指標","D");
value2=GetField("佔全市場成交量比","D");

if value1=highest(value1,period)
and value2=highest(value2,period)
then ret=1;
]]></Code>
<Arg><![CDATA[<Arg seed="af1ef1fe-dfdc-4399-8dd9-aa0eff1903a7" version="1"><Param name="計算區間" varname="period" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<FirstBarDate val="0" />
<Maxbb val="0" />
<script>
<freq support="8;11" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="20" />
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="K棒突破布林值上緣" ID="68e9b211b3d9472088e09a1ee9718270" ReturnType="0" ExecType="1" Folder="/03.進階技術分析/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[Input: 
	Length(20, "期數"), 
	UpperBand(2, "通道上緣");

settotalbar(3);

Ret = close >= bollingerband(Close, Length, UpperBand);]]></Code>
<Arg><![CDATA[<Arg seed="a90c7614-ddca-4d99-8bcf-3427aad6db98" version="1"><Param name="期數" varname="Length" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="通道上緣" varname="UpperBand" type="1" subtype="0" value="2" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<FirstBarDate val="0" />
<Maxbb val="0" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="月營收創新高股價離高點有些距離" ID="919fcd68c59645f0b04910cb0b482244" ReturnType="0" ExecType="3" Folder="/07.月營收選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[value1=highest(getfield("月營收","M"),48);
value2=highest(GetField("總市值","D"),500);

if getfield("月營收","M")=value1
and value2>GetField("總市值","D")*1.2
then ret=1;]]></Code>
<Arg><![CDATA[<Arg seed="32b77adb-bf89-4ad7-90cd-53099e193ab4" version="1" />]]></Arg>
<Extra><![CDATA[<Extra>
<TotalBar val="300" />
<Maxbb val="50" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name=" 基本範例" ID="c80a30a98c4b4e61987e53c8df94dde2" ReturnType="0" ExecType="1" Folder="/00.語法範例/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[// 選股範例程式
//

// 使用GetField來取得欄位的數值。請按F7或從「編輯」|「插入欄位」選項內啟動插入欄位的畫面。
// GetField函數的第一個參數是欄位名稱，例如 "每股稅後淨利(元)"，
// GetField函數的第二個參數是欄位的期別，例如 "Q"代表季資料，"M"代表月資料,"Y"代表年資料。
//
Value1 = GetField("每股稅後淨利(元)","Q");

// 如果GetField函數的第二個參數省略的話，則系統會根據執行這個腳本時所設定的頻率來決定
// 資料的期別。請務必注意引用腳本時必須設定正確的頻率，否則可能會遇到執行錯誤的情形。
//
Value2 = GetField("每股稅後淨利(元)");

// 可以使用任何XSScript的語法來做運算，如果股票符合預期的話請設定Ret = 1，以下面一行為例
// 這個腳本會選到最新一年每股稅後淨利 > 5元的股票
//
Ret = GetField("每股稅後淨利(元)","Y") > 5;

// ＊＊　在這個目錄內有更多的程式範本可以參考　＊＊
//]]></Code>
<Arg><![CDATA[<Arg seed="3c5170b7-3b36-433a-a96c-034526889be9" version="1" />]]></Arg>
<Extra><![CDATA[<Extra>
<script>
<freq support="14;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="高護城河的公司" ID="23b8bac09d4e4ec8876d7cf52bfa36ad" ReturnType="0" ExecType="3" Folder="/08.財報選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[condition1=false;
condition2=false;
condition3=false;

//每年毛利率都大於10%
if trueall(GetField("營業毛利率","Y")>=10,4) then condition1=true;

//每年來自營運的現金流量都大於1億
if trueall(GetField("來自營運之現金流量","Y")>100,4) then condition2=true;

//股東權益報酬率大於15%
if trueall(GetField("股東權益報酬率","Y")>15,4) then condition3=true;

if condition1 and condition2 and condition3
then ret=1;]]></Code>
<Arg><![CDATA[<Arg seed="b00ccff5-e8ce-4a0d-ac46-8cfbd650e2c2" version="1" />]]></Arg>
<Extra><![CDATA[<Extra>
<TotalBar val="3" />
<Maxbb val="0" />
<script>
<freq support="16;8;9;10;11;12;13;14;15" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="連續兩日籌碼在收集" ID="30d5581fac6f413cbdb15f011e94fcc0" ReturnType="0" ExecType="3" Folder="/06.籌碼選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[value1=GetField("分公司買進家數","D");
value2=GetField("分公司賣出家數","D");
value3=value2-value1;
if trueall(value3>30,2)
then ret=1;]]></Code>
<Arg><![CDATA[<Arg seed="90ac0744-cedc-4d84-9baf-bc319771737c" version="1" />]]></Arg>
<Extra><![CDATA[<Extra>
<TotalBar val="3" />
<Maxbb val="0" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="股票名稱不含F股" ID="827440bb9b854988a60fd64caab9af36" ReturnType="0" ExecType="1" Folder="/01.常用過濾條件/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[variable:sn("");
sn=symbolname;
if instr(sn,"F")=0
and instr(sn,"Y")=0 then ret=1;
outputfield(1,sn,0,"symbolname");]]></Code>
<Arg><![CDATA[<Arg seed="f528ab07-bd4d-4bd3-af48-00a3b1b27112" version="1" />]]></Arg>
<Extra><![CDATA[<Extra>
<TotalBar val="3" />
<FirstBarDate val="0" />
<Maxbb val="0" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="冷門股出量" ID="a9b4ad864d8840a48dd389a137f9ebae" ReturnType="0" ExecType="1" Folder="/03.進階技術分析/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:limit1(700);		setinputname(1,"均量上限");
input:limit2(1000);		setinputname(2,"突破量");

SetTotalBar(3);

value1 = average(volume,5);
 
if value1 < limit1 and volume > limit2 and High > close[1] and volume > volume[1]
then ret=1;
]]></Code>
<Arg><![CDATA[<Arg seed="4bbdb5ea-32d6-4c0f-b76d-45759222cd9c" version="1"><Param name="均量上限" varname="limit1" type="1" subtype="0" value="700" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="突破量" varname="limit2" type="1" subtype="0" value="1000" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="旺季來臨前" ID="ddb38fe3533041239c8768cf5117b153" ReturnType="0" ExecType="3" Folder="/09.時機操作/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[settotalbar(40);

variable:W1(0),W2(0),W3(0),F1(0),F2(0),F3(0);

value1=GetField("月營收","M");//單位:億元

W1=(value1[12]+value1[13]+value1[14])/3;
W2=(value1[24]+value1[25]+value1[26])/3;
W3=(value1[36]+value1[37]+value1[38])/3;

F1=(value1[11]+value1[10]+value1[9])/3;
F2=(value1[23]+value1[22]+value1[21])/3;
F3=(value1[35]+value1[34]+value1[33])/3;

if F1>=W1*1.25 and F2>=W2*1.25 and F3>=W3*1.25

then ret=1;

]]></Code>
<Arg><![CDATA[<Arg seed="2136e31e-6f35-4fdd-97a7-55642e67d113" version="1" />]]></Arg>
<Extra><![CDATA[<Extra>
<FirstBarDate val="0" />
<Maxbb val="0" />
<script>
<freq support="10;8;9;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="40" />
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="公司連續N年獲利大於X億" ID="e8a1dea3f4df4e7e9356fa5833ca7ea5" ReturnType="0" ExecType="1" Folder="/08.財報選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:lowlimit(1,",金額下單位億元");
input:period(10,"連續年度數");
value1=GetField("本期稅後淨利","Y");//單位百萬
if trueall(value1>lowlimit*100,period) 
then ret=1;
]]></Code>
<Arg><![CDATA[<Arg seed="2cdbbe23-1595-4c90-a30e-e5efba2cad7a" version="1"><Param name=",金額下單位億元" varname="lowlimit" type="1" subtype="0" value="1" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="連續年度數" varname="period" type="1" subtype="0" value="10" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<TotalBar val="3" />
<Maxbb val="0" />
<script>
<freq support="16;8;9;10;11;12;13;14;15" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="突破股票箱" ID="33e26c779fc64dc7a877ecf813efab9d" ReturnType="0" ExecType="3" Folder="/05.型態選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:length(12);		setinputname(1, "股票箱區間長度");
input:boxrange(10);		setinputname(2, "箱區高低範圍(%)");
	
settotalbar(3);	
	
value1=NthHighest(1,high,length);
value3=nthhighest(3,high,length);
value4=Nthlowest(1,low,length);
value5=nthlowest(3,low,length);

if 
  value1[1] <= 1.03 * value3[1] and 
  value5[1] <= 1.03 * value4[1] and 
  value1[1] <= (1 + 0.01 * boxrange) * value4[1] and 
  close > value1[1]
then ret=1;

]]></Code>
<Arg><![CDATA[<Arg seed="201946e0-4122-4963-aa04-3a3f9a8bb4a3" version="1"><Param name="股票箱區間長度" varname="length" type="1" subtype="0" value="12" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="箱區高低範圍(%)" varname="boxrange" type="1" subtype="0" value="10" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="千張大戶增持" ID="116254ea7c794e3fbe952a49c9be1c11" ReturnType="0" ExecType="1" Folder="/06.籌碼選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[//說明：如果本週大戶散戶集保資料尚未更新，則會用上週資料代替本週。

input: offset(9999,"不用調整，相容用參數");
input: ratio(10, "增加比例%");
var:sameweek(0);

setbarfreq("W");
settotalbar(3);
 
if getinfo("FilterMode") = 1 then  
	sameweek = 0 
else if 
	datediff(GetFielddate("收盤價","D"),GetFielddate("收盤價","W")) < 6 
then  sameweek = 1 else  sameweek = 0; 

value1=GetField("大戶持股比例","W",param:=1000)[sameweek];
if value1 > (value1[1] * (1 + ratio/100)) then ret=1;

outputfield(1, value1, 2, "大戶比例");
outputfield(2, value1[1], 2, "大戶比例[1]");
]]></Code>
<Arg><![CDATA[<Arg seed="0b5b9431-ac8d-41ec-a55b-0e39a6512be3" version="1"><Param name="不用調整，相容用參數" varname="offset" type="1" subtype="0" value="9999" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="增加比例%" varname="ratio" type="1" subtype="0" value="10" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<FirstBarDate val="0" />
<Maxbb val="0" />
<ScriptComplexity val="6" />
<script>
<freq support="9;12" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="3" />
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="股價突破外資成本線" ID="f689f697ebf244bd9502127764e67424" ReturnType="0" ExecType="1" Folder="/06.籌碼選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[Input: period(20, "期間(天)");
variable: avg_b(0);
setbarfreq("D");
settotalbar(period+7);

if GetField("Volume") > 0 then 
	Value5 = GetField("外資買張")*GetField("成交金額")*100000/GetField("Volume")
else
	Value5 = 0;

Value1 = summation(Value5, period);
Value2 = summation(GetField("外資買張"), period);
 
if Value2 > 0 then avg_b = Value1 / Value2;
if close cross over avg_b then ret=1;]]></Code>
<Arg><![CDATA[<Arg seed="d79687a9-5ab1-4f3a-b1f1-6d9ea68696bf" version="1"><Param name="期間(天)" varname="period" type="1" subtype="0" value="20" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<FirstBarDate val="0" />
<Maxbb val="0" />
<script>
<freq support="8;11" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="-1" />
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="外資買超後隔天會漲的機率很高的股票" ID="9e853bf3989844f5becc328739b1d9af" ReturnType="0" ExecType="3" Folder="/06.籌碼選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:n(500,"樣本數");
settotalbar(n);
value1=GetField("外資買賣超","D");
variable:x1(0),y(0),c1(0),c2(0),c3(0);
if value1[1]>200 
then begin
x1=1;
c1=c1+1;
//外資買超的次數
end
else x1=0;

if close>open
then begin
y=1;
c2=c2+1;
//上漲的次數
end
else y=0;

if value1[1]>200
and close>open
then c3=c3+1;
//上漲且外資買超的次數

value2=c1/n; //外資買超的機率
value3=c2/n; //上漲的機率
value4=c3/c2;//收紅且外資買超的機率
value5=value4*value3/value2;
if countif(value1[1]>200,n)>20
then ret=1;
outputfield(1,value5*100,0,"外資前一日買超隔天收高的機率");
outputfield(2,c1,0,"上漲次數");
outputfield(3,c2,"外資買超次數");
outputfield(4,c3,0,"上漲且外資買超");





]]></Code>
<Arg><![CDATA[<Arg seed="aca64ae3-b296-4afa-a730-25669a6e9ec5" version="1"><Param name="樣本數" varname="n" type="1" subtype="0" value="500" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<FirstBarDate val="0" />
<Maxbb val="0" />
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="-1" />
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="過去N日價穩量縮" ID="176e1f559dfc469ba58d69d74065208c" ReturnType="0" ExecType="1" Folder="/04.價量選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input:days(10,"計算期間");
input:vhilimit(1000,"量的上限");
input:philimit(5,"價格波動上限");
setbarfreq("D");
settotalbar(days);

value1=highest(high,days);
value2=lowest(low,days);
value3=(value1-value2)/value2*100;
if trueall(volume<vhilimit,days)
and trueall(value3<philimit,days)
then ret=1;]]></Code>
<Arg><![CDATA[<Arg seed="5b64e139-9958-44c3-9fc5-44590558c436" version="1"><Param name="計算期間" varname="day" type="1" subtype="0" value="10" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="量的上限" varname="vhilimit" type="1" subtype="0" value="1000" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="價格波動上限" varname="philimit" type="1" subtype="0" value="5" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<FirstBarDate val="0" />
<Maxbb val="0" />
<script>
<freq support="8;11" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="-1" />
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="CCI超買" ID="1bc25f30cadb48ef811fe221d697fc9e" ReturnType="0" ExecType="1" Folder="/02.基本技術指標/" StatusMask="2">
<Desc><![CDATA[CCI指標過高。
]]></Desc>
<Code><![CDATA[// CCI超買
//
Input: Length(14), AvgLength(9), OverBought(100);
Variable: cciValue(0), cciMAValue(0);

SetTotalBar(maxlist(AvgLength + Length + 1,6) + 3);

SetInputName(1, "期數");
SetInputName(2, "平滑期數");
SetInputName(3, "超買值");

cciValue = CommodityChannel(Length);
cciMAValue = Average(cciValue, AvgLength);

Condition1 = cciMAValue Crosses Over OverBought;
If condition1 then ret = 1;

SetOutputName1("CCI");
OutputField1(cciValue);
]]></Code>
<Arg><![CDATA[<Arg seed="66a998ff-493b-48a9-bd51-3a440d9b15f0" version="1"><Param name="期數" varname="Length" type="1" subtype="0" value="14" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="平滑期數" varname="AvgLength" type="1" subtype="0" value="9" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="超買值" varname="OverBought" type="1" subtype="0" value="100" isSerial="1" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
<IsScriptSetTB val="1" />
<TotalBar val="-1" />
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="投信持股從無到有" ID="c6c6c160db554fab87fb79127cf2be18" ReturnType="0" ExecType="1" Folder="/06.籌碼選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[input: v1(2000);	setinputname(1, "投信估計持股上限(張)");
input: v2(300);		setinputname(2, "近一日買賣超(張)");

value1=GetField("投信持股","D");
value2=GetField("投信買賣超","D");

if value1 < v1 and value2 > v2
then ret=1;

SetOutputName1("投信買賣超(張)");
OutputField1(value2);

]]></Code>
<Arg><![CDATA[<Arg seed="9451b94c-3609-4389-bfbf-3252cd67d396" version="1"><Param name="投信估計持股上限(張)" varname="v1" type="1" subtype="0" value="2000" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /><Param name="近一日買賣超(張)" varname="v2" type="1" subtype="0" value="300" isSerial="0" isArray="0" isRef="0" inputkind="0" quickedit="0" keytype="0" /></Arg>]]></Arg>
<Extra><![CDATA[<Extra>
<script>
<freq support="8;9;10;11;12;13;14;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
<Script Type="4" Name="昨天成交量不到2000張今天已超過2000張" ID="d2293ce6248941b38cbba8436472205d" ReturnType="0" ExecType="3" Folder="/04.價量選股/" StatusMask="2">
<Desc><![CDATA[]]></Desc>
<Code><![CDATA[if volume[1]<2000
and volume>2000
and close=highest(close,20)
then ret=1;]]></Code>
<Arg><![CDATA[<Arg seed="ccec39df-4085-49f3-af6b-61bb5093b52d" version="1" />]]></Arg>
<Extra><![CDATA[<Extra>
<TotalBar val="3" />
<Maxbb val="0" />
<script>
<freq support="8;11;9;12;10;13;14;15;16" />
</script>
</Extra>
]]></Extra>
<ScriptRunVer val="0" />
</Script>
</Scripts>
